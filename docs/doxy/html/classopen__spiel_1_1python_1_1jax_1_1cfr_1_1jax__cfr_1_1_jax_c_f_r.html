<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.jax.cfr.jax_cfr.JaxCFR Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1jax.html">jax</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1jax_1_1cfr.html">cfr</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr.html">jax_cfr</a></li><li class="navelem"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html">JaxCFR</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.jax.cfr.jax_cfr.JaxCFR Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for open_spiel.python.jax.cfr.jax_cfr.JaxCFR:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r__coll__graph.png" border="0" usemap="#aopen__spiel_8python_8jax_8cfr_8jax__cfr_8_jax_c_f_r_coll__map" alt="Collaboration graph"/></div>
<map name="aopen__spiel_8python_8jax_8cfr_8jax__cfr_8_jax_c_f_r_coll__map" id="aopen__spiel_8python_8jax_8cfr_8jax__cfr_8_jax_c_f_r_coll__map">
<area shape="rect" title=" " alt="" coords="5,5,183,440"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa9c0416eeb85758170b019f62a1cbeb1" id="r_aa9c0416eeb85758170b019f62a1cbeb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9c0416eeb85758170b019f62a1cbeb1">__init__</a> (self, pyspiel.Game <a class="el" href="#a6e4f7aebcc313232713182d01f4611fa">game</a>, regret_matching_plus=True, alternating_updates=True, linear_averaging=True)</td></tr>
<tr class="separator:aa9c0416eeb85758170b019f62a1cbeb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41c3fe9d4e6a6310b29848917e9a4f27" id="r_a41c3fe9d4e6a6310b29848917e9a4f27"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41c3fe9d4e6a6310b29848917e9a4f27">init</a> (self)</td></tr>
<tr class="separator:a41c3fe9d4e6a6310b29848917e9a4f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb88039a6a02b4d0090a0abc5c3c5424" id="r_adb88039a6a02b4d0090a0abc5c3c5424"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb88039a6a02b4d0090a0abc5c3c5424">multiple_steps</a> (self, int iterations)</td></tr>
<tr class="separator:adb88039a6a02b4d0090a0abc5c3c5424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d11483beff07f087b51f3a2dd71135" id="r_a14d11483beff07f087b51f3a2dd71135"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14d11483beff07f087b51f3a2dd71135">evaluate_and_update_policy</a> (self)</td></tr>
<tr class="separator:a14d11483beff07f087b51f3a2dd71135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84cf0fd4888936d3f2e32e0e4b6e8e01" id="r_a84cf0fd4888936d3f2e32e0e4b6e8e01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84cf0fd4888936d3f2e32e0e4b6e8e01">step</a> (self)</td></tr>
<tr class="separator:a84cf0fd4888936d3f2e32e0e4b6e8e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0910f3504760574539421133ff14f38" id="r_ad0910f3504760574539421133ff14f38"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad0910f3504760574539421133ff14f38">propagate_strategy</a> (self, current_strategies)</td></tr>
<tr class="separator:ad0910f3504760574539421133ff14f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6834860978cca10cacb933c376711e" id="r_adb6834860978cca10cacb933c376711e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb6834860978cca10cacb933c376711e">jit_step</a> (self, <a class="el" href="#a8e63bb9df42af71f958c3af03b50295e">regrets</a>, <a class="el" href="#a03be2215701b9f2a4667cc43ec10e67c">averages</a>, average_policy_update_coefficient, <a class="el" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>)</td></tr>
<tr class="separator:adb6834860978cca10cacb933c376711e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d5702d1015be97dfddab2d0a3947e5c" id="r_a7d5702d1015be97dfddab2d0a3947e5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d5702d1015be97dfddab2d0a3947e5c">average_policy</a> (self)</td></tr>
<tr class="separator:a7d5702d1015be97dfddab2d0a3947e5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6e4f7aebcc313232713182d01f4611fa" id="r_a6e4f7aebcc313232713182d01f4611fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e4f7aebcc313232713182d01f4611fa">game</a></td></tr>
<tr class="separator:a6e4f7aebcc313232713182d01f4611fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2335a503fc7f32599eb95bacc3fb3b6" id="r_aa2335a503fc7f32599eb95bacc3fb3b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa2335a503fc7f32599eb95bacc3fb3b6">timestep</a></td></tr>
<tr class="separator:aa2335a503fc7f32599eb95bacc3fb3b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74c875e94e88abf041abd665fdfa2503" id="r_a74c875e94e88abf041abd665fdfa2503"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74c875e94e88abf041abd665fdfa2503">constants</a></td></tr>
<tr class="separator:a74c875e94e88abf041abd665fdfa2503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e63bb9df42af71f958c3af03b50295e" id="r_a8e63bb9df42af71f958c3af03b50295e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e63bb9df42af71f958c3af03b50295e">regrets</a></td></tr>
<tr class="separator:a8e63bb9df42af71f958c3af03b50295e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03be2215701b9f2a4667cc43ec10e67c" id="r_a03be2215701b9f2a4667cc43ec10e67c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03be2215701b9f2a4667cc43ec10e67c">averages</a></td></tr>
<tr class="separator:a03be2215701b9f2a4667cc43ec10e67c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af316fa78abc4b7103762257f2324d980" id="r_af316fa78abc4b7103762257f2324d980"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af316fa78abc4b7103762257f2324d980">regret_matching</a></td></tr>
<tr class="separator:af316fa78abc4b7103762257f2324d980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5e6470f1cc612052583d6f617fed3d6" id="r_ab5e6470f1cc612052583d6f617fed3d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5e6470f1cc612052583d6f617fed3d6">update_regrets</a></td></tr>
<tr class="separator:ab5e6470f1cc612052583d6f617fed3d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a815167df1d241a039e4fd3e3a6da74" id="r_a5a815167df1d241a039e4fd3e3a6da74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a815167df1d241a039e4fd3e3a6da74">iset_map</a></td></tr>
<tr class="separator:a5a815167df1d241a039e4fd3e3a6da74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab0d3d1891e3780ff7c34d1d774f59cbc" id="r_ab0d3d1891e3780ff7c34d1d774f59cbc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0d3d1891e3780ff7c34d1d774f59cbc">_regret_matching_plus</a></td></tr>
<tr class="separator:ab0d3d1891e3780ff7c34d1d774f59cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e21d8342d9727326d8996597ce736ed" id="r_a9e21d8342d9727326d8996597ce736ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e21d8342d9727326d8996597ce736ed">_alternating_updates</a></td></tr>
<tr class="separator:a9e21d8342d9727326d8996597ce736ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1d048930a1c6a8988a053b61b231e29" id="r_ac1d048930a1c6a8988a053b61b231e29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1d048930a1c6a8988a053b61b231e29">_linear_averaging</a></td></tr>
<tr class="separator:ac1d048930a1c6a8988a053b61b231e29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Class for CFR and CFR.

First it prepares all the structures in `init`, then it just reuses them
within jitted function `jit_step`.
</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00101">101</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa9c0416eeb85758170b019f62a1cbeb1" name="aa9c0416eeb85758170b019f62a1cbeb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c0416eeb85758170b019f62a1cbeb1">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pyspiel.Game</td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>regret_matching_plus</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>alternating_updates</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>linear_averaging</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00108">108</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  114</span>  ):</div>
<div class="line"><span class="lineno">  115</span>    self.game = game</div>
<div class="line"><span class="lineno">  116</span>    self._regret_matching_plus = regret_matching_plus</div>
<div class="line"><span class="lineno">  117</span>    self._alternating_updates = alternating_updates</div>
<div class="line"><span class="lineno">  118</span>    self._linear_averaging = linear_averaging</div>
<div class="line"><span class="lineno">  119</span>    self.timestep = 1</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    self.init()</div>
<div class="line"><span class="lineno">  122</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7d5702d1015be97dfddab2d0a3947e5c" name="a7d5702d1015be97dfddab2d0a3947e5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d5702d1015be97dfddab2d0a3947e5c">&#9670;&#160;</a></span>average_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.average_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Extracts the average policy from JAX structures into a TabularPolicy.</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00515">515</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  515</span>  <span class="keyword">def </span>average_policy(self):</div>
<div class="line"><span class="lineno">  516</span>    <span class="stringliteral">&quot;&quot;&quot;Extracts the average policy from JAX structures into a TabularPolicy.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  517</span>    averages = [</div>
<div class="line"><span class="lineno">  518</span>        np.asarray(self.averages[pl]) <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  519</span>    ]</div>
<div class="line"><span class="lineno">  520</span>    averages = [</div>
<div class="line"><span class="lineno">  521</span>        averages[pl] / np.sum(averages[pl], -1, keepdims=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  522</span>        <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  523</span>    ]</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    avg_strategy = policy.TabularPolicy(self.game)</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(2):</div>
<div class="line"><span class="lineno">  528</span>      <span class="keywordflow">for</span> iset, val <span class="keywordflow">in</span> self.iset_map[pl].items():</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> iset:</div>
<div class="line"><span class="lineno">  530</span>          <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  531</span>        state_policy = avg_strategy.policy_for_key(iset)</div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(state_policy)):</div>
<div class="line"><span class="lineno">  533</span>          state_policy[i] = averages[pl][val][i]</div>
<div class="line"><span class="lineno">  534</span>    <span class="keywordflow">return</span> avg_strategy</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="ttc" id="alow__level__alloc__test_8cc_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc__test_8cc_source.html#l00046">low_level_alloc_test.cc:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="jax__cfr_8py_source.html#l00338">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.averages</a>, <a class="el" href="jax__cfr_8py_source.html#l00313">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.constants</a>, <a class="el" href="api__test_8py_source.html#l00115">open_spiel.integration_tests.api_test.EnforceAPIOnFullTreeBase.game</a>, <a class="el" href="api__test_8py_source.html#l00276">open_spiel.integration_tests.api_test.EnforceAPIOnPartialTreeBase.game</a>, <a class="el" href="gamut_8py_source.html#l00072">open_spiel.python.algorithms.adidas_utils.games.gamut.GAMUT.game</a>, <a class="el" href="pyspiel__tensor__game_8py_source.html#l00036">open_spiel.python.algorithms.adidas_utils.games.pyspiel_tensor_game.PyspielTensorGame.game</a>, <a class="el" href="best__response_8py_source.html#l00283">open_spiel.python.algorithms.best_response.CPPBestResponsePolicy.game</a>, <a class="el" href="mmd__dilated_8py_source.html#l00161">open_spiel.python.algorithms.mmd_dilated.MMDDilatedEnt.game</a>, <a class="el" href="noisy__policy_8py_source.html#l00052">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.game</a>, <a class="el" href="chat__game__psro__example_8py_source.html#l00262">open_spiel.python.examples.chat_game_psro_example.PSRO.game</a>, <a class="el" href="jax__cfr_8py_source.html#l00115">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.game</a>, <a class="el" href="distribution_8py_source.html#l00045">open_spiel.python.mfg.distribution.Distribution.game</a>, <a class="el" href="linear__quadratic_8py_source.html#l00143">open_spiel.python.mfg.games.linear_quadratic.MFGLinearQuadraticState.game</a>, <a class="el" href="periodic__aversion_8py_source.html#l00166">open_spiel.python.mfg.games.periodic_aversion.MFGPeriodicAversionState.game</a>, <a class="el" href="value_8py_source.html#l00055">open_spiel.python.mfg.value.ValueFunction.game</a>, <a class="el" href="policy_8py_source.html#l00117">open_spiel.python.policy.Policy.game</a>, <a class="el" href="rl__environment_8py_source.html#l00459">open_spiel.python.rl_environment.Environment.game()</a>, <a class="el" href="policy__test_8py_source.html#l00235">open_spiel.python.tests.policy_test.TabularTicTacToePolicyTest.game</a>, <a class="el" href="treeviz_8py_source.html#l00151">open_spiel.python.visualizations.treeviz.GameTree.game</a>, <a class="el" href="cfr_8h_source.html#l00371">open_spiel::algorithms::PartiallyDeserializedCFRSolver.game</a>, <a class="el" href="alpha__zero_8h_source.html#l00031">open_spiel::algorithms::torch_az::AlphaZeroConfig.game</a>, <a class="el" href="rbc_8h_source.html#l00178">open_spiel::rbc::RbcState.game()</a>, <a class="el" href="acpc__game_8h_source.html#l00146">open_spiel::universal_poker::acpc_cpp::ACPCState.game()</a>, <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01008">utils.PurePolicyResponse.game</a>, <a class="el" href="jax__cfr_8py_source.html#l00348">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.iset_map</a>, and <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2fictitious__play_8py_source.html#l00170">open_spiel.python.algorithms.fictitious_play.XFPSolver.compute_best_responses()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,192,111"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html#a5eda9be6e375bbe3e2a741972e7c2538" title=" " alt="" coords="254,5,466,46"/>
<area shape="poly" title=" " alt="" coords="182,67,261,48,262,53,184,73"/>
<area shape="rect" href="classopen__spiel_1_1rbc_1_1_rbc_state.html#a18b4ca0d86d7b879857c41f0b32c079f" title=" " alt="" coords="274,71,446,111"/>
<area shape="poly" title=" " alt="" coords="192,88,259,88,259,94,192,94"/>
<area shape="rect" href="classopen__spiel_1_1universal__poker_1_1acpc__cpp_1_1_a_c_p_c_state.html#a9aae625ba54d15deca7a03e8857cf583" title=" " alt="" coords="240,136,481,177"/>
<area shape="poly" title=" " alt="" coords="184,109,262,129,261,134,182,115"/>
<area shape="rect" href="namespaceopen__spiel.html#a2abc2a9bf725d541a7da3b6f3c4c6ec4" title=" " alt="" coords="529,78,683,104"/>
<area shape="poly" title=" " alt="" coords="447,88,514,88,514,94,447,94"/>
<area shape="rect" href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011" title=" " alt="" coords="731,53,909,78"/>
<area shape="poly" title=" " alt="" coords="683,79,715,75,716,81,684,85"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="774,102,866,128"/>
<area shape="poly" title=" " alt="" coords="684,97,759,106,758,111,683,102"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a7d5702d1015be97dfddab2d0a3947e5c_icgraph">
<area shape="rect" title=" " alt="" coords="614,5,800,46"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#a269a6c5777fc6d965a73fb153e1ab2f0" title=" " alt="" coords="297,5,566,46"/>
<area shape="poly" title=" " alt="" coords="598,28,566,28,566,23,598,23"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#aeb1140b6136d2e0afaa4c75bc4a2296c" title=" " alt="" coords="5,5,249,46"/>
<area shape="poly" title=" " alt="" coords="281,28,249,28,249,23,281,23"/>
</map>
</div>

</div>
</div>
<a id="a14d11483beff07f087b51f3a2dd71135" name="a14d11483beff07f087b51f3a2dd71135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d11483beff07f087b51f3a2dd71135">&#9670;&#160;</a></span>evaluate_and_update_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.evaluate_and_update_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Wrapper to step().

Ensures interchangability with
open_spiel.python.algorithms.cfr._CFRSolverBase.
</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00359">359</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  359</span>  <span class="keyword">def </span>evaluate_and_update_policy(self):</div>
<div class="line"><span class="lineno">  360</span>    <span class="stringliteral">&quot;&quot;&quot;Wrapper to step().</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">    Ensures interchangability with</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">    open_spiel.python.algorithms.cfr._CFRSolverBase.</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  365</span>    self.step()</div>
<div class="line"><span class="lineno">  366</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="meta__selfplay__agent_8py_source.html#l00090">meta_selfplay_agent.MetaSelfplayAgent.step</a>, <a class="el" href="nash__evolutionary__search_8py_source.html#l00100">nash_evolutionary_search.NashCMAES.step()</a>, <a class="el" href="nash__random__search_8py_source.html#l00103">nash_random_search.NashRandomSearch.step()</a>, <a class="el" href="double__oracle_8py_source.html#l00108">open_spiel.python.algorithms.double_oracle.DoubleOracleSolver.step()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00236">open_spiel.python.algorithms.eva.EVAAgent.step()</a>, <a class="el" href="algorithms_2exploitability__descent_8py_source.html#l00150">open_spiel.python.algorithms.exploitability_descent.Solver.step()</a>, <a class="el" href="ismcts_8py_source.html#l00141">open_spiel.python.algorithms.ismcts.ISMCTSBot.step()</a>, <a class="el" href="algorithms_2mcts_8py_source.html#l00289">open_spiel.python.algorithms.mcts.MCTSBot.step()</a>, <a class="el" href="mcts__agent_8py_source.html#l00035">open_spiel.python.algorithms.mcts_agent.MCTSAgent.step()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="random__agent_8py_source.html#l00029">open_spiel.python.algorithms.random_agent.RandomAgent.step()</a>, <a class="el" href="rnad_8py_source.html#l00953">open_spiel.python.algorithms.rnad.rnad.RNaDSolver.step()</a>, <a class="el" href="tabular__multiagent__qlearner_8py_source.html#l00234">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner.step()</a>, <a class="el" href="tabular__qlearner_8py_source.html#l00095">open_spiel.python.algorithms.tabular_qlearner.QLearner.step()</a>, <a class="el" href="wolf__phc_8py_source.html#l00155">open_spiel.python.algorithms.wolf_phc.WoLFPHC.step()</a>, <a class="el" href="wolf__phc_8py_source.html#l00043">open_spiel.python.algorithms.wolf_phc.WoLFSchedule.step()</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00323">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.step()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00219">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.step()</a>, <a class="el" href="gtp_8py_source.html#l00108">open_spiel.python.bots.gtp.GTPBot.step()</a>, <a class="el" href="human_8py_source.html#l00082">open_spiel.python.bots.human.HumanBot.step()</a>, <a class="el" href="bots_2policy_8py_source.html#l00070">open_spiel.python.bots.policy.PolicyBot.step()</a>, <a class="el" href="uniform__random_8py_source.html#l00066">open_spiel.python.bots.uniform_random.UniformRandomBot.step()</a>, <a class="el" href="catch_8py_source.html#l00073">open_spiel.python.environments.catch.Environment.step()</a>, <a class="el" href="cliff__walking_8py_source.html#l00083">open_spiel.python.environments.cliff_walking.Environment.step()</a>, <a class="el" href="iterated__matrix__game_8py_source.html#l00089">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame.step()</a>, <a class="el" href="nego__nbs__example_8py_source.html#l00226">open_spiel.python.examples.nego_nbs_example.MaxBot.step()</a>, <a class="el" href="rl__response_8py_source.html#l00139">open_spiel.python.examples.rl_response.FirstActionAgent.step()</a>, <a class="el" href="roshambo__population__example_8py_source.html#l00063">open_spiel.python.examples.roshambo_population_example.BotAgent.step()</a>, <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00165">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy.step()</a>, <a class="el" href="bandit__regret_8py_source.html#l00347">open_spiel.python.mfg.algorithms.bandit_regret.PolynomialWeightAlgorithm.step()</a>, <a class="el" href="bandit__regret_8py_source.html#l00234">open_spiel.python.mfg.algorithms.bandit_regret.RegretMinimizer.step()</a>, <a class="el" href="mf__psro_8py_source.html#l00092">open_spiel.python.mfg.algorithms.mf_psro.MeanFieldPSRO.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00449">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.SoftMaxMunchausenDQN.step()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00220">open_spiel.python.pytorch.eva.EVAAgent.step()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="ppo_8py_source.html#l00256">open_spiel.python.pytorch.ppo.PPO.step()</a>, <a class="el" href="rl__agent_8py_source.html#l00045">open_spiel.python.rl_agent.AbstractAgent.step()</a>, <a class="el" href="rl__environment_8py_source.html#l00282">open_spiel.python.rl_environment.Environment.step()</a>, <a class="el" href="rl__tools_8py_source.html#l00050">open_spiel.python.rl_tools.ConstantSchedule.step()</a>, <a class="el" href="rl__tools_8py_source.html#l00080">open_spiel.python.rl_tools.LinearSchedule.step()</a>, <a class="el" href="rl__tools_8py_source.html#l00028">open_spiel.python.rl_tools.ValueSchedule.step()</a>, <a class="el" href="vector__env_8py_source.html#l00040">open_spiel.python.vector_env.SyncVectorEnv.step()</a>, <a class="el" href="go__board_8cc_source.html#l00586">open_spiel::go::GoBoard::GroupIter.step()</a>, <a class="el" href="phantom__go__board_8cc_source.html#l00715">open_spiel::phantom_go::PhantomGoBoard::GroupIter.step()</a>, <a class="el" href="polynomial__weights_8py_source.html#l00108">polynomial_weights.PolynomialWeightAlgorithm.step()</a>, <a class="el" href="mfg_2algorithms_2regret_2regret__matching_8py_source.html#l00135">regret_matching.RegretMatching.step()</a>, <a class="el" href="regret__minimizer_8py_source.html#l00098">regret_minimizer.RegretMinimizer.step()</a>, and <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00142">rnn_meta_selfplay_agent.MetaSelfplayAgent.step</a>.</p>

</div>
</div>
<a id="a41c3fe9d4e6a6310b29848917e9a4f27" name="a41c3fe9d4e6a6310b29848917e9a4f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41c3fe9d4e6a6310b29848917e9a4f27">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.init </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Constructor.</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00123">123</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  123</span>  <span class="keyword">def </span>init(self):</div>
<div class="line"><span class="lineno">  124</span>    <span class="stringliteral">&quot;&quot;&quot;Constructor.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    players = self.game.num_players()</div>
<div class="line"><span class="lineno">  127</span>    depth_history_utility = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  128</span>    depth_history_previous_iset = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  129</span>    depth_history_previous_action = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  130</span>    depth_history_iset = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  131</span>    depth_history_actions = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  132</span>    depth_history_next_history = []</div>
<div class="line"><span class="lineno">  133</span>    depth_history_player = []</div>
<div class="line"><span class="lineno">  134</span>    depth_history_chance = []</div>
<div class="line"><span class="lineno">  135</span>    depth_history_previous_history = []</div>
<div class="line"><span class="lineno">  136</span>    depth_history_action_mask = []</div>
<div class="line"><span class="lineno">  137</span>    depth_history_chance_probabilities = []</div>
<div class="line"><span class="lineno">  138</span>    <span class="comment"># Previous action is mapping of both iset and action!</span></div>
<div class="line"><span class="lineno">  139</span>    iset_previous_action = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  140</span>    iset_action_mask = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  141</span>    iset_action_depth = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  142</span>    ids = [0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  143</span>    pl_isets = [{} <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  144</span>    distinct_actions = max(</div>
<div class="line"><span class="lineno">  145</span>        self.game.num_distinct_actions(), self.game.max_chance_outcomes()</div>
<div class="line"><span class="lineno">  146</span>    )</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players):</div>
<div class="line"><span class="lineno">  149</span>      pl_isets[pl][<span class="stringliteral">&#39;&#39;</span>] = ids[pl]</div>
<div class="line"><span class="lineno">  150</span>      ids[pl] += 1</div>
<div class="line"><span class="lineno">  151</span>      am = [0] * distinct_actions</div>
<div class="line"><span class="lineno">  152</span>      am[0] = 1</div>
<div class="line"><span class="lineno">  153</span>      iset_action_mask[pl].append(am)</div>
<div class="line"><span class="lineno">  154</span>      iset_previous_action[pl].append(0)</div>
<div class="line"><span class="lineno">  155</span>      iset_action_depth[pl].append(0)</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    PreviousInfo = namedtuple(</div>
<div class="line"><span class="lineno">  158</span>        <span class="stringliteral">&#39;PreviousInfo&#39;</span>,</div>
<div class="line"><span class="lineno">  159</span>        (<span class="stringliteral">&#39;actions&#39;</span>, <span class="stringliteral">&#39;isets&#39;</span>, <span class="stringliteral">&#39;prev_actions&#39;</span>, <span class="stringliteral">&#39;history&#39;</span>, <span class="stringliteral">&#39;player&#39;</span>),</div>
<div class="line"><span class="lineno">  160</span>    )</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="keyword">def </span>_traverse_tree(state, previous_info, depth, chance=1.0):</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>      <span class="keywordflow">if</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(depth_history_next_history) &lt;= depth:</div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players):</div>
<div class="line"><span class="lineno">  166</span>          depth_history_utility[pl].append([])</div>
<div class="line"><span class="lineno">  167</span>          depth_history_previous_iset[pl].append([])</div>
<div class="line"><span class="lineno">  168</span>          depth_history_previous_action[pl].append([])</div>
<div class="line"><span class="lineno">  169</span>          depth_history_iset[pl].append([])</div>
<div class="line"><span class="lineno">  170</span>          depth_history_actions[pl].append([])</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>        depth_history_next_history.append([])</div>
<div class="line"><span class="lineno">  173</span>        depth_history_player.append([])</div>
<div class="line"><span class="lineno">  174</span>        depth_history_chance.append([])</div>
<div class="line"><span class="lineno">  175</span>        depth_history_previous_history.append([])</div>
<div class="line"><span class="lineno">  176</span>        depth_history_action_mask.append([])</div>
<div class="line"><span class="lineno">  177</span>        depth_history_chance_probabilities.append([])</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>      history_id = <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(depth_history_previous_history[depth])</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>      next_history_temp = [0] * distinct_actions</div>
<div class="line"><span class="lineno">  182</span>      depth_history_next_history[depth].append(next_history_temp)</div>
<div class="line"><span class="lineno">  183</span>      depth_history_player[depth].append(state.current_player())</div>
<div class="line"><span class="lineno">  184</span>      depth_history_chance[depth].append(chance)</div>
<div class="line"><span class="lineno">  185</span>      depth_history_previous_history[depth].append(previous_info.history)</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>      actions_mask = [0] * distinct_actions</div>
<div class="line"><span class="lineno">  188</span>      <span class="keywordflow">for</span> a <span class="keywordflow">in</span> state.legal_actions():</div>
<div class="line"><span class="lineno">  189</span>        actions_mask[a] = 1</div>
<div class="line"><span class="lineno">  190</span>      depth_history_action_mask[depth].append(actions_mask)</div>
<div class="line"><span class="lineno">  191</span>      chance_probabilities = [0.0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(distinct_actions)]</div>
<div class="line"><span class="lineno">  192</span>      <span class="keywordflow">if</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  193</span>        <span class="keywordflow">for</span> a, prob <span class="keywordflow">in</span> state.chance_outcomes():</div>
<div class="line"><span class="lineno">  194</span>          chance_probabilities[a] = prob</div>
<div class="line"><span class="lineno">  195</span>      <span class="keywordflow">elif</span> <span class="keywordflow">not</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  196</span>        chance_probabilities = [1.0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(distinct_actions)]</div>
<div class="line"><span class="lineno">  197</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  198</span>        chance_probabilities = [</div>
<div class="line"><span class="lineno">  199</span>            1.0 / distinct_actions <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(distinct_actions)</div>
<div class="line"><span class="lineno">  200</span>        ]</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>      depth_history_chance_probabilities[depth].append(chance_probabilities)</div>
<div class="line"><span class="lineno">  203</span>      <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players):</div>
<div class="line"><span class="lineno">  204</span>        depth_history_utility[pl][depth].append(</div>
<div class="line"><span class="lineno">  205</span>            state.rewards()[pl] <span class="keywordflow">if</span> <span class="keywordflow">not</span> state.is_chance_node() <span class="keywordflow">else</span> 0.0</div>
<div class="line"><span class="lineno">  206</span>        )</div>
<div class="line"><span class="lineno">  207</span>        depth_history_previous_iset[pl][depth].append(previous_info.isets[pl])</div>
<div class="line"><span class="lineno">  208</span>        depth_history_previous_action[pl][depth].append(</div>
<div class="line"><span class="lineno">  209</span>            previous_info.actions[pl]</div>
<div class="line"><span class="lineno">  210</span>        )</div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">if</span> state.current_player() == pl:</div>
<div class="line"><span class="lineno">  212</span>          iset = state.information_state_string()</div>
<div class="line"><span class="lineno">  213</span>          <span class="keywordflow">if</span> iset <span class="keywordflow">not</span> <span class="keywordflow">in</span> pl_isets[pl]:</div>
<div class="line"><span class="lineno">  214</span>            pl_isets[pl][iset] = ids[pl]</div>
<div class="line"><span class="lineno">  215</span>            ids[pl] += 1</div>
<div class="line"><span class="lineno">  216</span>            iset_previous_action[pl].append(previous_info.actions[pl])</div>
<div class="line"><span class="lineno">  217</span>            iset_action_mask[pl].append(actions_mask)</div>
<div class="line"><span class="lineno">  218</span>            iset_action_depth[pl].append(previous_info.prev_actions[pl])</div>
<div class="line"><span class="lineno">  219</span>          depth_history_iset[pl][depth].append(pl_isets[pl][iset])</div>
<div class="line"><span class="lineno">  220</span>          depth_history_actions[pl][depth].append([</div>
<div class="line"><span class="lineno">  221</span>              i + pl_isets[pl][iset] * distinct_actions</div>
<div class="line"><span class="lineno">  222</span>              <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(distinct_actions)</div>
<div class="line"><span class="lineno">  223</span>          ])</div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  225</span>          depth_history_iset[pl][depth].append(0)</div>
<div class="line"><span class="lineno">  226</span>          depth_history_actions[pl][depth].append(</div>
<div class="line"><span class="lineno">  227</span>              [0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(distinct_actions)]</div>
<div class="line"><span class="lineno">  228</span>          )</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>      <span class="keywordflow">for</span> a <span class="keywordflow">in</span> state.legal_actions():</div>
<div class="line"><span class="lineno">  231</span>        new_chance = chance * chance_probabilities[a]</div>
<div class="line"><span class="lineno">  232</span>        <span class="keyword">assert</span> new_chance &gt; 0.0</div>
<div class="line"><span class="lineno">  233</span>        new_actions = tuple(</div>
<div class="line"><span class="lineno">  234</span>            previous_info.actions[pl]</div>
<div class="line"><span class="lineno">  235</span>            <span class="keywordflow">if</span> state.current_player() != pl</div>
<div class="line"><span class="lineno">  236</span>            <span class="keywordflow">else</span> pl_isets[pl][iset] * distinct_actions + a</div>
<div class="line"><span class="lineno">  237</span>            <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players)</div>
<div class="line"><span class="lineno">  238</span>        )</div>
<div class="line"><span class="lineno">  239</span>        new_infosets = tuple(</div>
<div class="line"><span class="lineno">  240</span>            previous_info.isets[pl]</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordflow">if</span> state.current_player() != pl</div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordflow">else</span> pl_isets[pl][iset]</div>
<div class="line"><span class="lineno">  243</span>            <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players)</div>
<div class="line"><span class="lineno">  244</span>        )</div>
<div class="line"><span class="lineno">  245</span>        new_prev_actions = tuple(</div>
<div class="line"><span class="lineno">  246</span>            previous_info.prev_actions[pl] + int(state.current_player() == pl)</div>
<div class="line"><span class="lineno">  247</span>            <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players)</div>
<div class="line"><span class="lineno">  248</span>        )</div>
<div class="line"><span class="lineno">  249</span>        new_info = PreviousInfo(</div>
<div class="line"><span class="lineno">  250</span>            new_actions,</div>
<div class="line"><span class="lineno">  251</span>            new_infosets,</div>
<div class="line"><span class="lineno">  252</span>            new_prev_actions,</div>
<div class="line"><span class="lineno">  253</span>            history_id,</div>
<div class="line"><span class="lineno">  254</span>            state.current_player(),</div>
<div class="line"><span class="lineno">  255</span>        )</div>
<div class="line"><span class="lineno">  256</span>        new_state = state.clone()</div>
<div class="line"><span class="lineno">  257</span>        new_state.apply_action(a)</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>        <span class="comment"># simple workaround if the next element was not visited yet</span></div>
<div class="line"><span class="lineno">  260</span>        next_history_temp[a] = (</div>
<div class="line"><span class="lineno">  261</span>            <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(depth_history_player[depth + 1])</div>
<div class="line"><span class="lineno">  262</span>            <span class="keywordflow">if</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(depth_history_player) &gt; depth + 1</div>
<div class="line"><span class="lineno">  263</span>            <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  264</span>        )</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>        _traverse_tree(new_state, new_info, depth + 1, new_chance)</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    s = self.game.new_initial_state()</div>
<div class="line"><span class="lineno">  269</span>    _traverse_tree(</div>
<div class="line"><span class="lineno">  270</span>        s,</div>
<div class="line"><span class="lineno">  271</span>        PreviousInfo(</div>
<div class="line"><span class="lineno">  272</span>            tuple(0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)),</div>
<div class="line"><span class="lineno">  273</span>            tuple(0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)),</div>
<div class="line"><span class="lineno">  274</span>            tuple(0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(players)),</div>
<div class="line"><span class="lineno">  275</span>            0,</div>
<div class="line"><span class="lineno">  276</span>            0,</div>
<div class="line"><span class="lineno">  277</span>        ),</div>
<div class="line"><span class="lineno">  278</span>        0,</div>
<div class="line"><span class="lineno">  279</span>    )</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="keyword">def </span>convert_to_jax(x):</div>
<div class="line"><span class="lineno">  282</span>      <span class="keywordflow">return</span> [jnp.asarray(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> x]</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    <span class="keyword">def </span>convert_to_jax_players(x):</div>
<div class="line"><span class="lineno">  285</span>      <span class="keywordflow">return</span> [[jnp.asarray(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> x[pl]] <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    depth_history_utility = convert_to_jax_players(depth_history_utility)</div>
<div class="line"><span class="lineno">  288</span>    depth_history_iset = convert_to_jax_players(depth_history_iset)</div>
<div class="line"><span class="lineno">  289</span>    depth_history_previous_iset = convert_to_jax_players(</div>
<div class="line"><span class="lineno">  290</span>        depth_history_previous_iset</div>
<div class="line"><span class="lineno">  291</span>    )</div>
<div class="line"><span class="lineno">  292</span>    depth_history_actions = convert_to_jax_players(depth_history_actions)</div>
<div class="line"><span class="lineno">  293</span>    depth_history_previous_action = convert_to_jax_players(</div>
<div class="line"><span class="lineno">  294</span>        depth_history_previous_action</div>
<div class="line"><span class="lineno">  295</span>    )</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    depth_history_next_history = convert_to_jax(depth_history_next_history)</div>
<div class="line"><span class="lineno">  298</span>    depth_history_player = convert_to_jax(depth_history_player)</div>
<div class="line"><span class="lineno">  299</span>    depth_history_chance = convert_to_jax(depth_history_chance)</div>
<div class="line"><span class="lineno">  300</span>    depth_history_previous_history = convert_to_jax(</div>
<div class="line"><span class="lineno">  301</span>        depth_history_previous_history</div>
<div class="line"><span class="lineno">  302</span>    )</div>
<div class="line"><span class="lineno">  303</span>    depth_history_chance_probabilities = convert_to_jax(</div>
<div class="line"><span class="lineno">  304</span>        depth_history_chance_probabilities</div>
<div class="line"><span class="lineno">  305</span>    )</div>
<div class="line"><span class="lineno">  306</span>    depth_history_action_mask = convert_to_jax(depth_history_action_mask)</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    max_iset_depth = [np.max(iset_action_depth[pl]) <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players)]</div>
<div class="line"><span class="lineno">  309</span>    iset_previous_action = convert_to_jax(iset_previous_action)</div>
<div class="line"><span class="lineno">  310</span>    iset_action_mask = convert_to_jax(iset_action_mask)</div>
<div class="line"><span class="lineno">  311</span>    iset_action_depth = convert_to_jax(iset_action_depth)</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    self.constants = JaxCFRConstants(</div>
<div class="line"><span class="lineno">  314</span>        players=players,</div>
<div class="line"><span class="lineno">  315</span>        max_depth=int(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(depth_history_utility[0])),</div>
<div class="line"><span class="lineno">  316</span>        max_actions=distinct_actions,</div>
<div class="line"><span class="lineno">  317</span>        max_iset_depth=max_iset_depth,</div>
<div class="line"><span class="lineno">  318</span>        isets=ids,</div>
<div class="line"><span class="lineno">  319</span>        depth_history_utility=depth_history_utility,</div>
<div class="line"><span class="lineno">  320</span>        depth_history_iset=depth_history_iset,</div>
<div class="line"><span class="lineno">  321</span>        depth_history_actions=depth_history_actions,</div>
<div class="line"><span class="lineno">  322</span>        depth_history_previous_iset=depth_history_previous_iset,</div>
<div class="line"><span class="lineno">  323</span>        depth_history_previous_action=depth_history_previous_action,</div>
<div class="line"><span class="lineno">  324</span>        depth_history_next_history=depth_history_next_history,</div>
<div class="line"><span class="lineno">  325</span>        depth_history_player=depth_history_player,</div>
<div class="line"><span class="lineno">  326</span>        depth_history_chance=depth_history_chance,</div>
<div class="line"><span class="lineno">  327</span>        depth_history_previous_history=depth_history_previous_history,</div>
<div class="line"><span class="lineno">  328</span>        depth_history_action_mask=depth_history_action_mask,</div>
<div class="line"><span class="lineno">  329</span>        depth_history_chance_probabilities=depth_history_chance_probabilities,</div>
<div class="line"><span class="lineno">  330</span>        iset_previous_action=iset_previous_action,</div>
<div class="line"><span class="lineno">  331</span>        iset_action_mask=iset_action_mask,</div>
<div class="line"><span class="lineno">  332</span>        iset_action_depth=iset_action_depth,</div>
<div class="line"><span class="lineno">  333</span>    )</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    self.regrets = [</div>
<div class="line"><span class="lineno">  336</span>        jnp.zeros((ids[pl], distinct_actions)) <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players)</div>
<div class="line"><span class="lineno">  337</span>    ]</div>
<div class="line"><span class="lineno">  338</span>    self.averages = [</div>
<div class="line"><span class="lineno">  339</span>        jnp.zeros((ids[pl], distinct_actions)) <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(players)</div>
<div class="line"><span class="lineno">  340</span>    ]</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    self.regret_matching = jax.vmap(regret_matching, 0, 0)</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">if</span> self._regret_matching_plus:</div>
<div class="line"><span class="lineno">  344</span>      self.update_regrets = jax.vmap(update_regrets_plus, 0, 0)</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  346</span>      self.update_regrets = jax.vmap(update_regrets, 0, 0)</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    self.iset_map = pl_isets</div>
<div class="line"><span class="lineno">  349</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="api__test_8py_source.html#l00115">open_spiel.integration_tests.api_test.EnforceAPIOnFullTreeBase.game</a>, <a class="el" href="api__test_8py_source.html#l00276">open_spiel.integration_tests.api_test.EnforceAPIOnPartialTreeBase.game</a>, <a class="el" href="gamut_8py_source.html#l00072">open_spiel.python.algorithms.adidas_utils.games.gamut.GAMUT.game</a>, <a class="el" href="pyspiel__tensor__game_8py_source.html#l00036">open_spiel.python.algorithms.adidas_utils.games.pyspiel_tensor_game.PyspielTensorGame.game</a>, <a class="el" href="best__response_8py_source.html#l00283">open_spiel.python.algorithms.best_response.CPPBestResponsePolicy.game</a>, <a class="el" href="mmd__dilated_8py_source.html#l00161">open_spiel.python.algorithms.mmd_dilated.MMDDilatedEnt.game</a>, <a class="el" href="noisy__policy_8py_source.html#l00052">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.game</a>, <a class="el" href="chat__game__psro__example_8py_source.html#l00262">open_spiel.python.examples.chat_game_psro_example.PSRO.game</a>, <a class="el" href="jax__cfr_8py_source.html#l00115">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.game</a>, <a class="el" href="distribution_8py_source.html#l00045">open_spiel.python.mfg.distribution.Distribution.game</a>, <a class="el" href="linear__quadratic_8py_source.html#l00143">open_spiel.python.mfg.games.linear_quadratic.MFGLinearQuadraticState.game</a>, <a class="el" href="periodic__aversion_8py_source.html#l00166">open_spiel.python.mfg.games.periodic_aversion.MFGPeriodicAversionState.game</a>, <a class="el" href="value_8py_source.html#l00055">open_spiel.python.mfg.value.ValueFunction.game</a>, <a class="el" href="policy_8py_source.html#l00117">open_spiel.python.policy.Policy.game</a>, <a class="el" href="rl__environment_8py_source.html#l00459">open_spiel.python.rl_environment.Environment.game()</a>, <a class="el" href="policy__test_8py_source.html#l00235">open_spiel.python.tests.policy_test.TabularTicTacToePolicyTest.game</a>, <a class="el" href="treeviz_8py_source.html#l00151">open_spiel.python.visualizations.treeviz.GameTree.game</a>, <a class="el" href="cfr_8h_source.html#l00371">open_spiel::algorithms::PartiallyDeserializedCFRSolver.game</a>, <a class="el" href="alpha__zero_8h_source.html#l00031">open_spiel::algorithms::torch_az::AlphaZeroConfig.game</a>, <a class="el" href="rbc_8h_source.html#l00178">open_spiel::rbc::RbcState.game()</a>, <a class="el" href="acpc__game_8h_source.html#l00146">open_spiel::universal_poker::acpc_cpp::ACPCState.game()</a>, <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01008">utils.PurePolicyResponse.game</a>, and <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="rnad_8py_source.html#l00929">open_spiel.python.algorithms.rnad.rnad.RNaDSolver.__setstate__()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,192,111"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html#a5eda9be6e375bbe3e2a741972e7c2538" title=" " alt="" coords="254,5,466,46"/>
<area shape="poly" title=" " alt="" coords="182,67,261,48,262,53,184,73"/>
<area shape="rect" href="classopen__spiel_1_1rbc_1_1_rbc_state.html#a18b4ca0d86d7b879857c41f0b32c079f" title=" " alt="" coords="274,71,446,111"/>
<area shape="poly" title=" " alt="" coords="192,88,259,88,259,94,192,94"/>
<area shape="rect" href="classopen__spiel_1_1universal__poker_1_1acpc__cpp_1_1_a_c_p_c_state.html#a9aae625ba54d15deca7a03e8857cf583" title=" " alt="" coords="240,136,481,177"/>
<area shape="poly" title=" " alt="" coords="184,109,262,129,261,134,182,115"/>
<area shape="rect" href="namespaceopen__spiel.html#a2abc2a9bf725d541a7da3b6f3c4c6ec4" title=" " alt="" coords="529,78,683,104"/>
<area shape="poly" title=" " alt="" coords="447,88,514,88,514,94,447,94"/>
<area shape="rect" href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011" title=" " alt="" coords="731,53,909,78"/>
<area shape="poly" title=" " alt="" coords="683,79,715,75,716,81,684,85"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="774,102,866,128"/>
<area shape="poly" title=" " alt="" coords="684,97,759,106,758,111,683,102"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a41c3fe9d4e6a6310b29848917e9a4f27_icgraph">
<area shape="rect" title=" " alt="" coords="306,5,492,46"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_r_na_d_solver.html#ab952b8e7473cf001be5f9448c8617855" title=" " alt="" coords="5,5,258,46"/>
<area shape="poly" title=" " alt="" coords="290,28,258,28,258,23,290,23"/>
</map>
</div>

</div>
</div>
<a id="adb6834860978cca10cacb933c376711e" name="adb6834860978cca10cacb933c376711e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6834860978cca10cacb933c376711e">&#9670;&#160;</a></span>jit_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.jit_step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>regrets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>averages</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>average_policy_update_coefficient</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Performs the CFR step.

This consists of:
1. Computes the current strategies based on regrets
2. Computes the realization plan for each action from top of the tree down
3. Compute the counterfactual regrets from bottom of the tree up
4. Updates regrets and average stretegies

Args:
  regrets: Cummulative regrets for all players, list[Float[Isets, Actions]]
  averages: Average strategies for all players, list[Float[Isets, Actions]]
  average_policy_update_coefficient: Weight of the average policy update.
    When enabled linear_averging it is equal to current iteration. Otherwise
    1, int
  player: Player for which the update should be done. When alternating
    updates are distables, it is JAX_CFR_SIMULTANEOUS_UPDATE

Returns:
  regrets: the regrets.
  averages: the averages.
</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00414">414</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  416</span>  ):</div>
<div class="line"><span class="lineno">  417</span>    <span class="stringliteral">&quot;&quot;&quot;Performs the CFR step.</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral">    This consists of:</span></div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">    1. Computes the current strategies based on regrets</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">    2. Computes the realization plan for each action from top of the tree down</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    3. Compute the counterfactual regrets from bottom of the tree up</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">    4. Updates regrets and average stretegies</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">      regrets: Cummulative regrets for all players, list[Float[Isets, Actions]]</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">      averages: Average strategies for all players, list[Float[Isets, Actions]]</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">      average_policy_update_coefficient: Weight of the average policy update.</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">        When enabled linear_averging it is equal to current iteration. Otherwise</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">        1, int</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">      player: Player for which the update should be done. When alternating</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">        updates are distables, it is JAX_CFR_SIMULTANEOUS_UPDATE</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">      regrets: the regrets.</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">      averages: the averages.</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  438</span>    current_strategies = [</div>
<div class="line"><span class="lineno">  439</span>        self.regret_matching(regrets[pl], self.constants.iset_action_mask[pl])</div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  441</span>    ]</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    realization_plans = self.propagate_strategy(current_strategies)</div>
<div class="line"><span class="lineno">  444</span>    iset_reaches = [</div>
<div class="line"><span class="lineno">  445</span>        jnp.sum(realization_plans[pl], -1)</div>
<div class="line"><span class="lineno">  446</span>        <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  447</span>    ]</div>
<div class="line"><span class="lineno">  448</span>    <span class="comment"># In last row, there are only terminal, so we start row before it</span></div>
<div class="line"><span class="lineno">  449</span>    depth_utils = [</div>
<div class="line"><span class="lineno">  450</span>        [self.constants.depth_history_utility[pl][-1]]</div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  452</span>    ]</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.constants.max_depth - 2, -1, -1):</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>      each_history_policy = self.constants.depth_history_chance_probabilities[i]</div>
<div class="line"><span class="lineno">  456</span>      <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players):</div>
<div class="line"><span class="lineno">  457</span>        each_history_policy = each_history_policy * jnp.where(</div>
<div class="line"><span class="lineno">  458</span>            self.constants.depth_history_player[i][..., jnp.newaxis] == pl,</div>
<div class="line"><span class="lineno">  459</span>            current_strategies[pl][self.constants.depth_history_iset[pl][i]],</div>
<div class="line"><span class="lineno">  460</span>            1,</div>
<div class="line"><span class="lineno">  461</span>        )</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>      <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players):</div>
<div class="line"><span class="lineno">  464</span>        action_value = jnp.where(</div>
<div class="line"><span class="lineno">  465</span>            self.constants.depth_history_player[i][..., jnp.newaxis] == -4,</div>
<div class="line"><span class="lineno">  466</span>            self.constants.depth_history_utility[pl][i][..., jnp.newaxis],</div>
<div class="line"><span class="lineno">  467</span>            depth_utils[pl][-1][self.constants.depth_history_next_history[i]],</div>
<div class="line"><span class="lineno">  468</span>        )</div>
<div class="line"><span class="lineno">  469</span>        history_value = jnp.sum(action_value * each_history_policy, -1)</div>
<div class="line"><span class="lineno">  470</span>        regret = (</div>
<div class="line"><span class="lineno">  471</span>            (action_value - history_value[..., jnp.newaxis])</div>
<div class="line"><span class="lineno">  472</span>            * self.constants.depth_history_action_mask[i]</div>
<div class="line"><span class="lineno">  473</span>            * (self.constants.depth_history_player[i][..., jnp.newaxis] == pl)</div>
<div class="line"><span class="lineno">  474</span>            * self.constants.depth_history_chance[i][..., jnp.newaxis]</div>
<div class="line"><span class="lineno">  475</span>        )</div>
<div class="line"><span class="lineno">  476</span>        <span class="keywordflow">for</span> pl2 <span class="keywordflow">in</span> range(self.constants.players):</div>
<div class="line"><span class="lineno">  477</span>          <span class="keywordflow">if</span> pl != pl2:</div>
<div class="line"><span class="lineno">  478</span>            regret = (</div>
<div class="line"><span class="lineno">  479</span>                regret</div>
<div class="line"><span class="lineno">  480</span>                * realization_plans[pl2].ravel()[</div>
<div class="line"><span class="lineno">  481</span>                    self.constants.depth_history_previous_action[pl2][i]</div>
<div class="line"><span class="lineno">  482</span>                ][..., jnp.newaxis]</div>
<div class="line"><span class="lineno">  483</span>            )</div>
<div class="line"><span class="lineno">  484</span>        bin_regrets = jnp.bincount(</div>
<div class="line"><span class="lineno">  485</span>            self.constants.depth_history_actions[pl][i].ravel(),</div>
<div class="line"><span class="lineno">  486</span>            regret.ravel(),</div>
<div class="line"><span class="lineno">  487</span>            length=self.constants.isets[pl] * self.constants.max_actions,</div>
<div class="line"><span class="lineno">  488</span>        )</div>
<div class="line"><span class="lineno">  489</span>        bin_regrets = bin_regrets.reshape(-1, self.constants.max_actions)</div>
<div class="line"><span class="lineno">  490</span>        regrets[pl] = jnp.where(</div>
<div class="line"><span class="lineno">  491</span>            jnp.logical_or(player == pl, player == JAX_CFR_SIMULTANEOUS_UPDATE),</div>
<div class="line"><span class="lineno">  492</span>            regrets[pl] + bin_regrets,</div>
<div class="line"><span class="lineno">  493</span>            regrets[pl],</div>
<div class="line"><span class="lineno">  494</span>        )</div>
<div class="line"><span class="lineno">  495</span>        depth_utils[pl].append(history_value)</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    regrets = [</div>
<div class="line"><span class="lineno">  498</span>        self.update_regrets(regrets[pl]) <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  499</span>    ]</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>    averages = [</div>
<div class="line"><span class="lineno">  502</span>        jnp.where(</div>
<div class="line"><span class="lineno">  503</span>            jnp.logical_or(player == pl, player == JAX_CFR_SIMULTANEOUS_UPDATE),</div>
<div class="line"><span class="lineno">  504</span>            averages[pl]</div>
<div class="line"><span class="lineno">  505</span>            + current_strategies[pl]</div>
<div class="line"><span class="lineno">  506</span>            * iset_reaches[pl][..., jnp.newaxis]</div>
<div class="line"><span class="lineno">  507</span>            * average_policy_update_coefficient,</div>
<div class="line"><span class="lineno">  508</span>            averages[pl],</div>
<div class="line"><span class="lineno">  509</span>        )</div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  511</span>    ]</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">return</span> regrets, averages</div>
<div class="line"><span class="lineno">  514</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="jax__cfr_8py_source.html#l00313">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.constants</a>, <a class="el" href="jax__cfr_8py_source.html#l00386">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.propagate_strategy()</a>, <a class="el" href="jax__cfr_8py_source.html#l00342">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.regret_matching</a>, and <a class="el" href="jax__cfr_8py_source.html#l00344">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.update_regrets</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,192,46"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#ad0910f3504760574539421133ff14f38" title=" " alt="" coords="240,5,450,46"/>
<area shape="poly" title=" " alt="" coords="192,23,224,23,224,28,192,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_adb6834860978cca10cacb933c376711e_icgraph">
<area shape="rect" title=" " alt="" coords="1119,294,1305,335"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a84cf0fd4888936d3f2e32e0e4b6e8e01" title=" " alt="" coords="884,294,1071,335"/>
<area shape="poly" title=" " alt="" coords="1103,317,1071,317,1071,312,1103,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="963,280,945,234,918,178,881,123,859,97,835,75,814,62,791,52,793,47,817,57,838,71,863,94,885,119,922,176,950,232,968,278"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="956,282,936,248,908,210,874,172,835,141,791,121,793,116,838,136,878,168,912,206,940,245,961,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="944,285,895,243,835,205,785,187,787,182,838,200,898,239,947,281"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="881,292,784,267,785,262,882,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="874,341,788,362,786,357,872,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="942,347,894,382,837,414,804,427,802,422,835,409,891,378,939,343"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="959,349,910,416,876,450,838,479,813,492,810,487,835,475,872,446,905,412,954,346"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="967,351,949,396,922,449,885,501,863,525,838,545,815,557,813,552,835,540,859,521,881,498,917,446,944,394,962,349"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="adb88039a6a02b4d0090a0abc5c3c5424" name="adb88039a6a02b4d0090a0abc5c3c5424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb88039a6a02b4d0090a0abc5c3c5424">&#9670;&#160;</a></span>multiple_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.multiple_steps </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>iterations</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Performs several CFR steps.

Args:
  iterations: Amount of CFR steps, the solver should do.
</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00350">350</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  350</span>  <span class="keyword">def </span>multiple_steps(self, iterations: int):</div>
<div class="line"><span class="lineno">  351</span>    <span class="stringliteral">&quot;&quot;&quot;Performs several CFR steps.</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">      iterations: Amount of CFR steps, the solver should do.</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(iterations):</div>
<div class="line"><span class="lineno">  357</span>      self.step()</div>
<div class="line"><span class="lineno">  358</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="meta__selfplay__agent_8py_source.html#l00090">meta_selfplay_agent.MetaSelfplayAgent.step</a>, <a class="el" href="nash__evolutionary__search_8py_source.html#l00100">nash_evolutionary_search.NashCMAES.step()</a>, <a class="el" href="nash__random__search_8py_source.html#l00103">nash_random_search.NashRandomSearch.step()</a>, <a class="el" href="double__oracle_8py_source.html#l00108">open_spiel.python.algorithms.double_oracle.DoubleOracleSolver.step()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00236">open_spiel.python.algorithms.eva.EVAAgent.step()</a>, <a class="el" href="algorithms_2exploitability__descent_8py_source.html#l00150">open_spiel.python.algorithms.exploitability_descent.Solver.step()</a>, <a class="el" href="ismcts_8py_source.html#l00141">open_spiel.python.algorithms.ismcts.ISMCTSBot.step()</a>, <a class="el" href="algorithms_2mcts_8py_source.html#l00289">open_spiel.python.algorithms.mcts.MCTSBot.step()</a>, <a class="el" href="mcts__agent_8py_source.html#l00035">open_spiel.python.algorithms.mcts_agent.MCTSAgent.step()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="random__agent_8py_source.html#l00029">open_spiel.python.algorithms.random_agent.RandomAgent.step()</a>, <a class="el" href="rnad_8py_source.html#l00953">open_spiel.python.algorithms.rnad.rnad.RNaDSolver.step()</a>, <a class="el" href="tabular__multiagent__qlearner_8py_source.html#l00234">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner.step()</a>, <a class="el" href="tabular__qlearner_8py_source.html#l00095">open_spiel.python.algorithms.tabular_qlearner.QLearner.step()</a>, <a class="el" href="wolf__phc_8py_source.html#l00155">open_spiel.python.algorithms.wolf_phc.WoLFPHC.step()</a>, <a class="el" href="wolf__phc_8py_source.html#l00043">open_spiel.python.algorithms.wolf_phc.WoLFSchedule.step()</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00323">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.step()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00219">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.step()</a>, <a class="el" href="gtp_8py_source.html#l00108">open_spiel.python.bots.gtp.GTPBot.step()</a>, <a class="el" href="human_8py_source.html#l00082">open_spiel.python.bots.human.HumanBot.step()</a>, <a class="el" href="bots_2policy_8py_source.html#l00070">open_spiel.python.bots.policy.PolicyBot.step()</a>, <a class="el" href="uniform__random_8py_source.html#l00066">open_spiel.python.bots.uniform_random.UniformRandomBot.step()</a>, <a class="el" href="catch_8py_source.html#l00073">open_spiel.python.environments.catch.Environment.step()</a>, <a class="el" href="cliff__walking_8py_source.html#l00083">open_spiel.python.environments.cliff_walking.Environment.step()</a>, <a class="el" href="iterated__matrix__game_8py_source.html#l00089">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame.step()</a>, <a class="el" href="nego__nbs__example_8py_source.html#l00226">open_spiel.python.examples.nego_nbs_example.MaxBot.step()</a>, <a class="el" href="rl__response_8py_source.html#l00139">open_spiel.python.examples.rl_response.FirstActionAgent.step()</a>, <a class="el" href="roshambo__population__example_8py_source.html#l00063">open_spiel.python.examples.roshambo_population_example.BotAgent.step()</a>, <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00165">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy.step()</a>, <a class="el" href="bandit__regret_8py_source.html#l00347">open_spiel.python.mfg.algorithms.bandit_regret.PolynomialWeightAlgorithm.step()</a>, <a class="el" href="bandit__regret_8py_source.html#l00234">open_spiel.python.mfg.algorithms.bandit_regret.RegretMinimizer.step()</a>, <a class="el" href="mf__psro_8py_source.html#l00092">open_spiel.python.mfg.algorithms.mf_psro.MeanFieldPSRO.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00449">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.SoftMaxMunchausenDQN.step()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00220">open_spiel.python.pytorch.eva.EVAAgent.step()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="ppo_8py_source.html#l00256">open_spiel.python.pytorch.ppo.PPO.step()</a>, <a class="el" href="rl__agent_8py_source.html#l00045">open_spiel.python.rl_agent.AbstractAgent.step()</a>, <a class="el" href="rl__environment_8py_source.html#l00282">open_spiel.python.rl_environment.Environment.step()</a>, <a class="el" href="rl__tools_8py_source.html#l00050">open_spiel.python.rl_tools.ConstantSchedule.step()</a>, <a class="el" href="rl__tools_8py_source.html#l00080">open_spiel.python.rl_tools.LinearSchedule.step()</a>, <a class="el" href="rl__tools_8py_source.html#l00028">open_spiel.python.rl_tools.ValueSchedule.step()</a>, <a class="el" href="vector__env_8py_source.html#l00040">open_spiel.python.vector_env.SyncVectorEnv.step()</a>, <a class="el" href="go__board_8cc_source.html#l00586">open_spiel::go::GoBoard::GroupIter.step()</a>, <a class="el" href="phantom__go__board_8cc_source.html#l00715">open_spiel::phantom_go::PhantomGoBoard::GroupIter.step()</a>, <a class="el" href="polynomial__weights_8py_source.html#l00108">polynomial_weights.PolynomialWeightAlgorithm.step()</a>, <a class="el" href="mfg_2algorithms_2regret_2regret__matching_8py_source.html#l00135">regret_matching.RegretMatching.step()</a>, <a class="el" href="regret__minimizer_8py_source.html#l00098">regret_minimizer.RegretMinimizer.step()</a>, and <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00142">rnn_meta_selfplay_agent.MetaSelfplayAgent.step</a>.</p>

</div>
</div>
<a id="ad0910f3504760574539421133ff14f38" name="ad0910f3504760574539421133ff14f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0910f3504760574539421133ff14f38">&#9670;&#160;</a></span>propagate_strategy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.propagate_strategy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>current_strategies</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Propagtes the strategies withing infosets.

Args:
  current_strategies: Current strategies for all players, list[Float[Isets,
    Actions]]
Returns:
  realization_plans: the realization plans.
</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00386">386</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  386</span>  <span class="keyword">def </span>propagate_strategy(self, current_strategies):</div>
<div class="line"><span class="lineno">  387</span>    <span class="stringliteral">&quot;&quot;&quot;Propagtes the strategies withing infosets.</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">      current_strategies: Current strategies for all players, list[Float[Isets,</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">        Actions]]</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">      realization_plans: the realization plans.</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  395</span>    realization_plans = [</div>
<div class="line"><span class="lineno">  396</span>        jnp.ones_like(current_strategies[pl])</div>
<div class="line"><span class="lineno">  397</span>        <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players)</div>
<div class="line"><span class="lineno">  398</span>    ]</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">for</span> pl <span class="keywordflow">in</span> range(self.constants.players):</div>
<div class="line"><span class="lineno">  401</span>      <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, self.constants.max_iset_depth[pl] + 1):</div>
<div class="line"><span class="lineno">  402</span>        realization_plans[pl] = jnp.where(</div>
<div class="line"><span class="lineno">  403</span>            self.constants.iset_action_depth[pl][..., jnp.newaxis] == i,</div>
<div class="line"><span class="lineno">  404</span>            current_strategies[pl]</div>
<div class="line"><span class="lineno">  405</span>            * realization_plans[pl].ravel()[</div>
<div class="line"><span class="lineno">  406</span>                self.constants.iset_previous_action[pl]</div>
<div class="line"><span class="lineno">  407</span>            ][..., jnp.newaxis],</div>
<div class="line"><span class="lineno">  408</span>            realization_plans[pl],</div>
<div class="line"><span class="lineno">  409</span>        )</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordflow">return</span> realization_plans</div>
<div class="line"><span class="lineno">  412</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="jax__cfr_8py_source.html#l00313">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.constants</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00416">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.jit_step()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_ad0910f3504760574539421133ff14f38_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_ad0910f3504760574539421133ff14f38_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_ad0910f3504760574539421133ff14f38_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_ad0910f3504760574539421133ff14f38_icgraph">
<area shape="rect" title=" " alt="" coords="1353,294,1563,335"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb6834860978cca10cacb933c376711e" title=" " alt="" coords="1119,294,1305,335"/>
<area shape="poly" title=" " alt="" coords="1337,317,1305,317,1305,312,1337,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a84cf0fd4888936d3f2e32e0e4b6e8e01" title=" " alt="" coords="884,294,1071,335"/>
<area shape="poly" title=" " alt="" coords="1103,317,1071,317,1071,312,1103,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="963,280,945,234,918,178,881,123,859,97,835,75,814,62,791,52,793,47,817,57,838,71,863,94,885,119,922,176,950,232,968,278"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="956,282,936,248,908,210,874,172,835,141,791,121,793,116,838,136,878,168,912,206,940,245,961,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="944,285,895,243,835,205,785,187,787,182,838,200,898,239,947,281"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="881,292,784,267,785,262,882,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="874,341,788,362,786,357,872,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="942,347,894,382,837,414,804,427,802,422,835,409,891,378,939,343"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="959,349,910,416,876,450,838,479,813,492,810,487,835,475,872,446,905,412,954,346"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="967,351,949,396,922,449,885,501,863,525,838,545,815,557,813,552,835,540,859,521,881,498,917,446,944,394,962,349"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a84cf0fd4888936d3f2e32e0e4b6e8e01" name="a84cf0fd4888936d3f2e32e0e4b6e8e01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84cf0fd4888936d3f2e32e0e4b6e8e01">&#9670;&#160;</a></span>step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Wrapper around the jitted function for performing CFR step.</pre> 
<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00367">367</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  367</span>  <span class="keyword">def </span>step(self):</div>
<div class="line"><span class="lineno">  368</span>    <span class="stringliteral">&quot;&quot;&quot;Wrapper around the jitted function for performing CFR step.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  369</span>    averaging_coefficient = self.timestep <span class="keywordflow">if</span> self._linear_averaging <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> self._alternating_updates:</div>
<div class="line"><span class="lineno">  371</span>      <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(self.constants.players):</div>
<div class="line"><span class="lineno">  372</span>        self.regrets, self.averages = self.jit_step(</div>
<div class="line"><span class="lineno">  373</span>            self.regrets, self.averages, averaging_coefficient, player</div>
<div class="line"><span class="lineno">  374</span>        )</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  377</span>      self.regrets, self.averages = self.jit_step(</div>
<div class="line"><span class="lineno">  378</span>          self.regrets,</div>
<div class="line"><span class="lineno">  379</span>          self.averages,</div>
<div class="line"><span class="lineno">  380</span>          averaging_coefficient,</div>
<div class="line"><span class="lineno">  381</span>          JAX_CFR_SIMULTANEOUS_UPDATE,</div>
<div class="line"><span class="lineno">  382</span>      )</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    self.timestep += 1</div>
<div class="line"><span class="lineno">  385</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2cfr_8py_source.html#l00421">open_spiel.python.algorithms.cfr._CFRSolver._alternating_updates</a>, <a class="el" href="algorithms_2cfr_8py_source.html#l00173">open_spiel.python.algorithms.cfr._CFRSolverBase._alternating_updates</a>, <a class="el" href="algorithms_2discounted__cfr_8py_source.html#l00193">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._alternating_updates</a>, <a class="el" href="jax__cfr_8py_source.html#l00117">open_spiel.python.jax.cfr.jax_cfr.JaxCFR._alternating_updates</a>, <a class="el" href="algorithms_2cfr_8py_source.html#l00172">open_spiel.python.algorithms.cfr._CFRSolverBase._linear_averaging</a>, <a class="el" href="algorithms_2discounted__cfr_8py_source.html#l00182">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._linear_averaging</a>, <a class="el" href="jax__cfr_8py_source.html#l00118">open_spiel.python.jax.cfr.jax_cfr.JaxCFR._linear_averaging</a>, <a class="el" href="jax__cfr_8py_source.html#l00338">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.averages</a>, <a class="el" href="jax__cfr_8py_source.html#l00313">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.constants</a>, <a class="el" href="jax__cfr_8py_source.html#l00416">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.jit_step()</a>, <a class="el" href="jax__cfr_8py_source.html#l00335">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.regrets</a>, <a class="el" href="fsicfr_8h_source.html#l00068">open_spiel::algorithms::FSICFRNode.regrets</a>, and <a class="el" href="jax__cfr_8py_source.html#l00119">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.timestep</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00359">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.evaluate_and_update_policy()</a>, <a class="el" href="jax__cfr_8py_source.html#l00350">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.multiple_steps()</a>, <a class="el" href="meta__selfplay__agent_8py_source.html#l00103">meta_selfplay_agent.MetaSelfplayAgent.next_policy()</a>, <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00156">rnn_meta_selfplay_agent.MetaSelfplayAgent.next_policy()</a>, <a class="el" href="double__oracle_8py_source.html#l00126">open_spiel.python.algorithms.double_oracle.DoubleOracleSolver.solve_yield()</a>, <a class="el" href="nash__evolutionary__search_8py_source.html#l00094">nash_evolutionary_search.NashCMAES.step_for()</a>, <a class="el" href="nash__random__search_8py_source.html#l00100">nash_random_search.NashRandomSearch.step_for()</a>, <a class="el" href="bandit__regret_8py_source.html#l00363">open_spiel.python.mfg.algorithms.bandit_regret.PolynomialWeightAlgorithm.step_for()</a>, and <a class="el" href="regret__minimizer_8py_source.html#l00107">regret_minimizer.RegretMinimizer.step_for()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,192,46"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb6834860978cca10cacb933c376711e" title=" " alt="" coords="240,5,426,46"/>
<area shape="poly" title=" " alt="" coords="192,23,224,23,224,28,192,28"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#ad0910f3504760574539421133ff14f38" title=" " alt="" coords="474,5,684,46"/>
<area shape="poly" title=" " alt="" coords="427,23,459,23,459,28,427,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_a84cf0fd4888936d3f2e32e0e4b6e8e01_icgraph">
<area shape="rect" title=" " alt="" coords="884,294,1071,335"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="963,280,945,234,918,178,881,123,859,97,835,75,814,62,791,52,793,47,817,57,838,71,863,94,885,119,922,176,950,232,968,278"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="956,282,936,248,908,210,874,172,835,141,791,121,793,116,838,136,878,168,912,206,940,245,961,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="944,285,895,243,835,205,785,187,787,182,838,200,898,239,947,281"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="881,292,784,267,785,262,882,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="874,341,788,362,786,357,872,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="942,347,894,382,837,414,804,427,802,422,835,409,891,378,939,343"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="959,349,910,416,876,450,838,479,813,492,810,487,835,475,872,446,905,412,954,346"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="967,351,949,396,922,449,885,501,863,525,838,545,815,557,813,552,835,540,859,521,881,498,917,446,944,394,962,349"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a9e21d8342d9727326d8996597ce736ed" name="a9e21d8342d9727326d8996597ce736ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e21d8342d9727326d8996597ce736ed">&#9670;&#160;</a></span>_alternating_updates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR._alternating_updates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00117">117</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>.</p>

</div>
</div>
<a id="ac1d048930a1c6a8988a053b61b231e29" name="ac1d048930a1c6a8988a053b61b231e29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1d048930a1c6a8988a053b61b231e29">&#9670;&#160;</a></span>_linear_averaging</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR._linear_averaging</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00118">118</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2cfr_8py_source.html#l00240">open_spiel.python.algorithms.cfr._CFRSolverBase._compute_counterfactual_regret_for_player()</a>, and <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>.</p>

</div>
</div>
<a id="ab0d3d1891e3780ff7c34d1d774f59cbc" name="ab0d3d1891e3780ff7c34d1d774f59cbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0d3d1891e3780ff7c34d1d774f59cbc">&#9670;&#160;</a></span>_regret_matching_plus</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR._regret_matching_plus</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00116">116</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

</div>
</div>
<a id="a03be2215701b9f2a4667cc43ec10e67c" name="a03be2215701b9f2a4667cc43ec10e67c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03be2215701b9f2a4667cc43ec10e67c">&#9670;&#160;</a></span>averages</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.averages</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00338">338</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00515">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.average_policy()</a>, and <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>.</p>

</div>
</div>
<a id="a74c875e94e88abf041abd665fdfa2503" name="a74c875e94e88abf041abd665fdfa2503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74c875e94e88abf041abd665fdfa2503">&#9670;&#160;</a></span>constants</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.constants</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00313">313</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00515">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.average_policy()</a>, <a class="el" href="jax__cfr_8py_source.html#l00416">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.jit_step()</a>, <a class="el" href="jax__cfr_8py_source.html#l00386">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.propagate_strategy()</a>, and <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>.</p>

</div>
</div>
<a id="a6e4f7aebcc313232713182d01f4611fa" name="a6e4f7aebcc313232713182d01f4611fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e4f7aebcc313232713182d01f4611fa">&#9670;&#160;</a></span>game</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.game</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00115">115</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="policy_8py_source.html#l00341">open_spiel.python.policy.TabularPolicy.__copy__()</a>, <a class="el" href="jax__cfr_8py_source.html#l00515">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.average_policy()</a>, <a class="el" href="algorithms_2distribution_8py_source.html#l00062">open_spiel.python.mfg.algorithms.distribution.DistributionPolicy.evaluate()</a>, <a class="el" href="mmd__dilated_8py_source.html#l00393">open_spiel.python.algorithms.mmd_dilated.MMDDilatedEnt.get_avg_policies()</a>, <a class="el" href="mmd__dilated_8py_source.html#l00325">open_spiel.python.algorithms.mmd_dilated.MMDDilatedEnt.get_gap()</a>, <a class="el" href="gamut_8py_source.html#l00086">open_spiel.python.algorithms.adidas_utils.games.gamut.GAMUT.get_payoffs_for_strategies()</a>, <a class="el" href="pyspiel__tensor__game_8py_source.html#l00058">open_spiel.python.algorithms.adidas_utils.games.pyspiel_tensor_game.PyspielTensorGame.get_payoffs_for_strategies()</a>, <a class="el" href="mmd__dilated_8py_source.html#l00383">open_spiel.python.algorithms.mmd_dilated.MMDDilatedEnt.get_policies()</a>, <a class="el" href="jax__cfr_8py_source.html#l00123">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.init()</a>, <a class="el" href="gamut_8py_source.html#l00074">open_spiel.python.algorithms.adidas_utils.games.gamut.GAMUT.num_players()</a>, <a class="el" href="pyspiel__tensor__game_8py_source.html#l00042">open_spiel.python.algorithms.adidas_utils.games.pyspiel_tensor_game.PyspielTensorGame.num_players()</a>, <a class="el" href="gamut_8py_source.html#l00077">open_spiel.python.algorithms.adidas_utils.games.gamut.GAMUT.num_strategies()</a>, <a class="el" href="pyspiel__tensor__game_8py_source.html#l00045">open_spiel.python.algorithms.adidas_utils.games.pyspiel_tensor_game.PyspielTensorGame.num_strategies()</a>, <a class="el" href="gamut_8py_source.html#l00080">open_spiel.python.algorithms.adidas_utils.games.gamut.GAMUT.payoff_tensor()</a>, <a class="el" href="pyspiel__tensor__game_8py_source.html#l00048">open_spiel.python.algorithms.adidas_utils.games.pyspiel_tensor_game.PyspielTensorGame.payoff_tensor()</a>, <a class="el" href="chat__game__psro__example_8py_source.html#l00285">open_spiel.python.examples.chat_game_psro_example.PSRO.run()</a>, <a class="el" href="rl__environment_8py_source.html#l00462">open_spiel.python.rl_environment.Environment.set_state()</a>, <a class="el" href="policy__test_8py_source.html#l00267">open_spiel.python.tests.policy_test.TabularTicTacToePolicyTest.test_call_for_state()</a>, <a class="el" href="api__test_8py_source.html#l00194">open_spiel.integration_tests.api_test.EnforceAPIOnFullTreeBase.test_constant_sum()</a>, <a class="el" href="api__test_8py_source.html#l00228">open_spiel.integration_tests.api_test.EnforceAPIOnFullTreeBase.test_current_player_infosets_no_overlap_between_players()</a>, <a class="el" href="api__test_8py_source.html#l00181">open_spiel.integration_tests.api_test.EnforceAPIOnFullTreeBase.test_game_is_perfect_recall()</a>, <a class="el" href="api__test_8py_source.html#l00412">open_spiel.integration_tests.api_test.EnforceAPIOnPartialTreeBase.test_no_invalid_public_observations()</a>, <a class="el" href="api__test_8py_source.html#l00304">open_spiel.integration_tests.api_test.EnforceAPIOnPartialTreeBase.test_observations_raises_error_on_invalid_player()</a>, <a class="el" href="api__test_8py_source.html#l00384">open_spiel.integration_tests.api_test.EnforceAPIOnPartialTreeBase.test_private_information_contents()</a>, <a class="el" href="api__test_8py_source.html#l00279">open_spiel.integration_tests.api_test.EnforceAPIOnPartialTreeBase.test_sequence_lengths()</a>, <a class="el" href="policy_8py_source.html#l00158">open_spiel.python.policy.Policy.to_tabular()</a>, and <a class="el" href="mmd__dilated_8py_source.html#l00262">open_spiel.python.algorithms.mmd_dilated.MMDDilatedEnt.update_sequences()</a>.</p>

</div>
</div>
<a id="a5a815167df1d241a039e4fd3e3a6da74" name="a5a815167df1d241a039e4fd3e3a6da74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a815167df1d241a039e4fd3e3a6da74">&#9670;&#160;</a></span>iset_map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.iset_map</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00348">348</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00515">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.average_policy()</a>.</p>

</div>
</div>
<a id="af316fa78abc4b7103762257f2324d980" name="af316fa78abc4b7103762257f2324d980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af316fa78abc4b7103762257f2324d980">&#9670;&#160;</a></span>regret_matching</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.regret_matching</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00342">342</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00416">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.jit_step()</a>.</p>

</div>
</div>
<a id="a8e63bb9df42af71f958c3af03b50295e" name="a8e63bb9df42af71f958c3af03b50295e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e63bb9df42af71f958c3af03b50295e">&#9670;&#160;</a></span>regrets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.regrets</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00335">335</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>.</p>

</div>
</div>
<a id="aa2335a503fc7f32599eb95bacc3fb3b6" name="aa2335a503fc7f32599eb95bacc3fb3b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2335a503fc7f32599eb95bacc3fb3b6">&#9670;&#160;</a></span>timestep</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.timestep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00119">119</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00367">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.step()</a>.</p>

</div>
</div>
<a id="ab5e6470f1cc612052583d6f617fed3d6" name="ab5e6470f1cc612052583d6f617fed3d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5e6470f1cc612052583d6f617fed3d6">&#9670;&#160;</a></span>update_regrets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.update_regrets</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="jax__cfr_8py_source.html#l00344">344</a> of file <a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00416">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.jit_step()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>open_spiel/python/jax/cfr/<a class="el" href="jax__cfr_8py_source.html">jax_cfr.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
