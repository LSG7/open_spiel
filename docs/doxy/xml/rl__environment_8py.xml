<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.11.0" xml:lang="en-US">
  <compounddef id="rl__environment_8py" kind="file" language="Python">
    <compoundname>rl_environment.py</compoundname>
    <innerclass refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step" prot="public">open_spiel::python::rl_environment::TimeStep</innerclass>
    <innerclass refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type" prot="public">open_spiel::python::rl_environment::StepType</innerclass>
    <innerclass refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler" prot="public">open_spiel::python::rl_environment::ChanceEventSampler</innerclass>
    <innerclass refid="classopen__spiel_1_1python_1_1rl__environment_1_1_observation_type" prot="public">open_spiel::python::rl_environment::ObservationType</innerclass>
    <innerclass refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment" prot="public">open_spiel::python::rl_environment::Environment</innerclass>
    <innernamespace refid="namespaceopen__spiel">open_spiel</innernamespace>
    <innernamespace refid="namespaceopen__spiel_1_1python">open_spiel::python</innernamespace>
    <innernamespace refid="namespaceopen__spiel_1_1python_1_1rl__environment">open_spiel::python::rl_environment</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespaceopen__spiel_1_1python_1_1rl__environment" refkind="compound"><highlight class="comment">#<sp/>Copyright<sp/>2019<sp/>DeepMind<sp/>Technologies<sp/>Limited</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Licensed<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the<sp/>&quot;License&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">#<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance<sp/>with<sp/>the<sp/>License.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">#<sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,<sp/>software</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">#<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">#<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">#<sp/>See<sp/>the<sp/>License<sp/>for<sp/>the<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">#<sp/>limitations<sp/>under<sp/>the<sp/>License.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;Reinforcement<sp/>Learning<sp/>(RL)<sp/>Environment<sp/>for<sp/>Open<sp/>Spiel.</highlight></codeline>
<codeline lineno="15"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="16"><highlight class="stringliteral">This<sp/>module<sp/>wraps<sp/>Open<sp/>Spiel<sp/>Python<sp/>interface<sp/>providing<sp/>an<sp/>RL-friendly<sp/>API.<sp/>It</highlight></codeline>
<codeline lineno="17"><highlight class="stringliteral">covers<sp/>both<sp/>turn-based<sp/>and<sp/>simultaneous<sp/>move<sp/>games.<sp/>Interactions<sp/>between<sp/>agents</highlight></codeline>
<codeline lineno="18"><highlight class="stringliteral">and<sp/>the<sp/>underlying<sp/>game<sp/>occur<sp/>mostly<sp/>through<sp/>the<sp/>`reset`<sp/>and<sp/>`step`<sp/>methods,</highlight></codeline>
<codeline lineno="19"><highlight class="stringliteral">which<sp/>return<sp/>a<sp/>`TimeStep`<sp/>structure<sp/>(see<sp/>its<sp/>docstrings<sp/>for<sp/>more<sp/>info).</highlight></codeline>
<codeline lineno="20"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="21"><highlight class="stringliteral">The<sp/>following<sp/>example<sp/>illustrates<sp/>the<sp/>interaction<sp/>dynamics.<sp/>Consider<sp/>a<sp/>2-player</highlight></codeline>
<codeline lineno="22"><highlight class="stringliteral">Kuhn<sp/>Poker<sp/>(turn-based<sp/>game).<sp/>Agents<sp/>have<sp/>access<sp/>to<sp/>the<sp/>`observations`<sp/>(a<sp/>dict)</highlight></codeline>
<codeline lineno="23"><highlight class="stringliteral">field<sp/>from<sp/>`TimeSpec`,<sp/>containing<sp/>the<sp/>following<sp/>members:</highlight></codeline>
<codeline lineno="24"><highlight class="stringliteral"><sp/>*<sp/>`info_state`:<sp/>list<sp/>containing<sp/>the<sp/>game<sp/>information<sp/>state<sp/>for<sp/>each<sp/>player.<sp/>The</highlight></codeline>
<codeline lineno="25"><highlight class="stringliteral"><sp/><sp/><sp/>size<sp/>of<sp/>the<sp/>list<sp/>always<sp/>correspond<sp/>to<sp/>the<sp/>number<sp/>of<sp/>players.<sp/>E.g.:</highlight></codeline>
<codeline lineno="26"><highlight class="stringliteral"><sp/><sp/><sp/>[[0,<sp/>1,<sp/>0,<sp/>0,<sp/>0,<sp/>0],<sp/>[1,<sp/>0,<sp/>0,<sp/>0,<sp/>0,<sp/>0]].</highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"><sp/>*<sp/>`legal_actions`:<sp/>list<sp/>containing<sp/>legal<sp/>action<sp/>ID<sp/>lists<sp/>(one<sp/>for<sp/>each<sp/>player).</highlight></codeline>
<codeline lineno="28"><highlight class="stringliteral"><sp/><sp/><sp/>E.g.:<sp/>[[0,<sp/>1],<sp/>[0]],<sp/>which<sp/>corresponds<sp/>to<sp/>actions<sp/>0<sp/>and<sp/>1<sp/>being<sp/>valid<sp/>for</highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"><sp/><sp/><sp/>player<sp/>0<sp/>(the<sp/>1st<sp/>player)<sp/>and<sp/>action<sp/>0<sp/>being<sp/>valid<sp/>for<sp/>player<sp/>1<sp/>(2nd<sp/>player).</highlight></codeline>
<codeline lineno="30"><highlight class="stringliteral"><sp/>*<sp/>`current_player`:<sp/>zero-based<sp/>integer<sp/>representing<sp/>the<sp/>player<sp/>to<sp/>make<sp/>a<sp/>move.</highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral">At<sp/>each<sp/>`step`<sp/>call,<sp/>the<sp/>environment<sp/>expects<sp/>a<sp/>singleton<sp/>list<sp/>with<sp/>the<sp/>action</highlight></codeline>
<codeline lineno="33"><highlight class="stringliteral">(as<sp/>it&apos;s<sp/>a<sp/>turn-based<sp/>game),<sp/>e.g.:<sp/>[1].<sp/>This<sp/>(zero-based)<sp/>action<sp/>must<sp/>correspond</highlight></codeline>
<codeline lineno="34"><highlight class="stringliteral">to<sp/>the<sp/>player<sp/>specified<sp/>at<sp/>`current_player`.<sp/>The<sp/>game<sp/>(which<sp/>is<sp/>at<sp/>decision</highlight></codeline>
<codeline lineno="35"><highlight class="stringliteral">node)<sp/>will<sp/>process<sp/>the<sp/>action<sp/>and<sp/>take<sp/>as<sp/>many<sp/>steps<sp/>necessary<sp/>to<sp/>cover<sp/>chance</highlight></codeline>
<codeline lineno="36"><highlight class="stringliteral">nodes,<sp/>halting<sp/>at<sp/>a<sp/>new<sp/>decision<sp/>or<sp/>final<sp/>node.<sp/>Finally,<sp/>a<sp/>new<sp/>`TimeStep`is</highlight></codeline>
<codeline lineno="37"><highlight class="stringliteral">returned<sp/>to<sp/>the<sp/>agent.</highlight></codeline>
<codeline lineno="38"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="39"><highlight class="stringliteral">Simultaneous-move<sp/>games<sp/>follow<sp/>analogous<sp/>dynamics.<sp/>The<sp/>only<sp/>differences<sp/>is<sp/>the</highlight></codeline>
<codeline lineno="40"><highlight class="stringliteral">environment<sp/>expects<sp/>a<sp/>list<sp/>of<sp/>actions,<sp/>one<sp/>per<sp/>player.<sp/>Note<sp/>the<sp/>`current_player`</highlight></codeline>
<codeline lineno="41"><highlight class="stringliteral">field<sp/>is<sp/>&quot;irrelevant&quot;<sp/>here,<sp/>admitting<sp/>a<sp/>constant<sp/>value<sp/>defined<sp/>in<sp/>spiel.h,<sp/>which</highlight></codeline>
<codeline lineno="42"><highlight class="stringliteral">defaults<sp/>to<sp/>-2<sp/>(module<sp/>level<sp/>constant<sp/>`SIMULTANEOUS_PLAYER_ID`).</highlight></codeline>
<codeline lineno="43"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="44"><highlight class="stringliteral">See<sp/>open_spiel/python/examples/rl_example.py<sp/>for<sp/>example<sp/>usages.</highlight></codeline>
<codeline lineno="45"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>collections</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>enum</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>absl<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>logging</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>numpy<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>np</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>pyspiel</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="namespaceopen__spiel_1_1python_1_1rl__environment_1a5bb3fae1640112ec92991402f1e0a860" refkind="member"><highlight class="normal">SIMULTANEOUS_PLAYER_ID<sp/>=<sp/>pyspiel.PlayerId.SIMULTANEOUS</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step" kindref="compound">TimeStep</ref>(</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>collections.namedtuple(</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;TimeStep&quot;</highlight><highlight class="normal">,<sp/>[</highlight><highlight class="stringliteral">&quot;observations&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;rewards&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;discounts&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;step_type&quot;</highlight><highlight class="normal">])):</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returned<sp/>with<sp/>every<sp/>call<sp/>to<sp/>`step`<sp/>and<sp/>`reset`.</highlight></codeline>
<codeline lineno="62"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="63"><highlight class="stringliteral"><sp/><sp/>A<sp/>`TimeStep`<sp/>contains<sp/>the<sp/>data<sp/>emitted<sp/>by<sp/>a<sp/>game<sp/>at<sp/>each<sp/>step<sp/>of<sp/>interaction.</highlight></codeline>
<codeline lineno="64"><highlight class="stringliteral"><sp/><sp/>A<sp/>`TimeStep`<sp/>holds<sp/>an<sp/>`observation`<sp/>(list<sp/>of<sp/>dicts,<sp/>one<sp/>per<sp/>player),</highlight></codeline>
<codeline lineno="65"><highlight class="stringliteral"><sp/><sp/>associated<sp/>lists<sp/>of<sp/>`rewards`,<sp/>`discounts`<sp/>and<sp/>a<sp/>`step_type`.</highlight></codeline>
<codeline lineno="66"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="67"><highlight class="stringliteral"><sp/><sp/>The<sp/>first<sp/>`TimeStep`<sp/>in<sp/>a<sp/>sequence<sp/>will<sp/>have<sp/>`StepType.FIRST`.<sp/>The<sp/>final</highlight></codeline>
<codeline lineno="68"><highlight class="stringliteral"><sp/><sp/>`TimeStep`<sp/>will<sp/>have<sp/>`StepType.LAST`.<sp/>All<sp/>other<sp/>`TimeStep`s<sp/>in<sp/>a<sp/>sequence<sp/>will</highlight></codeline>
<codeline lineno="69"><highlight class="stringliteral"><sp/><sp/>have<sp/>`StepType.MID.</highlight></codeline>
<codeline lineno="70"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="71"><highlight class="stringliteral"><sp/><sp/>Attributes:</highlight></codeline>
<codeline lineno="72"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>observations:<sp/>a<sp/>list<sp/>of<sp/>dicts<sp/>containing<sp/>observations<sp/>per<sp/>player.</highlight></codeline>
<codeline lineno="73"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>rewards:<sp/>A<sp/>list<sp/>of<sp/>scalars<sp/>(one<sp/>per<sp/>player),<sp/>or<sp/>`None`<sp/>if<sp/>`step_type`<sp/>is</highlight></codeline>
<codeline lineno="74"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>`StepType.FIRST`,<sp/>i.e.<sp/>at<sp/>the<sp/>start<sp/>of<sp/>a<sp/>sequence.</highlight></codeline>
<codeline lineno="75"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>discounts:<sp/>A<sp/>list<sp/>of<sp/>discount<sp/>values<sp/>in<sp/>the<sp/>range<sp/>`[0,<sp/>1]`<sp/>(one<sp/>per<sp/>player),</highlight></codeline>
<codeline lineno="76"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>`None`<sp/>if<sp/>`step_type`<sp/>is<sp/>`StepType.FIRST`.</highlight></codeline>
<codeline lineno="77"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>step_type:<sp/>A<sp/>`StepType`<sp/>enum<sp/>value.</highlight></codeline>
<codeline lineno="78"><highlight class="stringliteral"><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/>__slots__<sp/>=<sp/>()</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a2fb617268775d7414ce62e98c9163bac" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a2fb617268775d7414ce62e98c9163bac" kindref="member">first</ref>(self):</highlight></codeline>
<codeline lineno="82" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a6661d5975ff26846a3eb2a135f187eef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a6661d5975ff26846a3eb2a135f187eef" kindref="member">step_type</ref><sp/>==<sp/>StepType.FIRST</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1ae023b04d8b5cc05d3c4aa436f4dce5f5" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1ae023b04d8b5cc05d3c4aa436f4dce5f5" kindref="member">mid</ref>(self):</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a6661d5975ff26846a3eb2a135f187eef" kindref="member">step_type</ref><sp/>==<sp/>StepType.MID</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1ab478d8918f20ef99b84edbd9f9a71098" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1ab478d8918f20ef99b84edbd9f9a71098" kindref="member">last</ref>(self):</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a6661d5975ff26846a3eb2a135f187eef" kindref="member">step_type</ref><sp/>==<sp/>StepType.LAST</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a9cec31e96028c5d8c4c9bc70ae210351" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1a9cec31e96028c5d8c4c9bc70ae210351" kindref="member">is_simultaneous_move</ref>(self):</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.observations[</highlight><highlight class="stringliteral">&quot;current_player&quot;</highlight><highlight class="normal">]<sp/>==<sp/>SIMULTANEOUS_PLAYER_ID</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1ab8fd5daf0df39ee45e41e98d70327d33" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step_1ab8fd5daf0df39ee45e41e98d70327d33" kindref="member">current_player</ref>(self):</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.observations[</highlight><highlight class="stringliteral">&quot;current_player&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type" kindref="compound">StepType</ref>(enum.Enum):</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Defines<sp/>the<sp/>status<sp/>of<sp/>a<sp/>`TimeStep`<sp/>within<sp/>a<sp/>sequence.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1ab0f66d30486a712a14d3cf6fc1285751" refkind="member"><highlight class="normal"><sp/><sp/>FIRST<sp/>=<sp/>0<sp/><sp/></highlight><highlight class="comment">#<sp/>Denotes<sp/>the<sp/>first<sp/>`TimeStep`<sp/>in<sp/>a<sp/>sequence.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1a7ef99a6c19ecdd9f0066101d783695f3" refkind="member"><highlight class="normal"><sp/><sp/>MID<sp/>=<sp/>1<sp/><sp/></highlight><highlight class="comment">#<sp/>Denotes<sp/>any<sp/>`TimeStep`<sp/>in<sp/>a<sp/>sequence<sp/>that<sp/>is<sp/>not<sp/>FIRST<sp/>or<sp/>LAST.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1a2a7756d74bd87d8c565698005cf2f21c" refkind="member"><highlight class="normal"><sp/><sp/>LAST<sp/>=<sp/>2<sp/><sp/></highlight><highlight class="comment">#<sp/>Denotes<sp/>the<sp/>last<sp/>`TimeStep`<sp/>in<sp/>a<sp/>sequence.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1aa1f178816ae3f5255684da2a1ed50b13" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1aa1f178816ae3f5255684da2a1ed50b13" kindref="member">first</ref>(self):</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/>StepType.FIRST</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1a62d67657c4e18976b647c3a35de95883" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1a62d67657c4e18976b647c3a35de95883" kindref="member">mid</ref>(self):</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/>StepType.MID</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1a6502fb7d57d4301d33a0a5ee9d667b67" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_step_type_1a6502fb7d57d4301d33a0a5ee9d667b67" kindref="member">last</ref>(self):</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/>StepType.LAST</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Global<sp/>pyspiel<sp/>members</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="namespaceopen__spiel_1_1python_1_1rl__environment_1a7d8a6f2ba399844f1949c48e2848d18f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceopen__spiel_1_1python_1_1rl__environment_1a7d8a6f2ba399844f1949c48e2848d18f" kindref="member">registered_games</ref>():</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pyspiel.registered_games()</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler" kindref="compound">ChanceEventSampler</ref>(object):</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Default<sp/>sampler<sp/>for<sp/>external<sp/>chance<sp/>events.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1a0b9b87fc73788872a6dbfb35fc729da0" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1a0b9b87fc73788872a6dbfb35fc729da0" kindref="member">__init__</ref>(self,<sp/>seed=None):</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1ab75d58f8c73ffb9db37b21fffea1e618" kindref="member">seed</ref>(seed)</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1ab75d58f8c73ffb9db37b21fffea1e618" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1ab75d58f8c73ffb9db37b21fffea1e618" kindref="member">seed</ref>(self,<sp/>seed=None):</highlight></codeline>
<codeline lineno="126" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1ab89b401c56b03066aa89e71c17029caf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1ab89b401c56b03066aa89e71c17029caf" kindref="member">_rng</ref><sp/>=<sp/>np.random.RandomState(seed)</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1aa353299f0a0b04ebc431718c7100046d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1aa353299f0a0b04ebc431718c7100046d" kindref="member">__call__</ref>(self,<sp/>state):</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Sample<sp/>a<sp/>chance<sp/>event<sp/>in<sp/>the<sp/>given<sp/>state.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>actions,<sp/>probs<sp/>=<sp/>zip(*state.chance_outcomes())</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler_1ab89b401c56b03066aa89e71c17029caf" kindref="member">_rng</ref>.choice(actions,<sp/>p=probs)</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_observation_type" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_observation_type" kindref="compound">ObservationType</ref>(enum.Enum):</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Defines<sp/>what<sp/>kind<sp/>of<sp/>observation<sp/>to<sp/>use.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_observation_type_1a4cb7b4d0cc0cdd9085ffa2bf88067c23" refkind="member"><highlight class="normal"><sp/><sp/>OBSERVATION<sp/>=<sp/>0<sp/><sp/></highlight><highlight class="comment">#<sp/>Use<sp/>observation_tensor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_observation_type_1a5c6526ca579d2d4c98d1f92024c6d1d2" refkind="member"><highlight class="normal"><sp/><sp/>INFORMATION_STATE<sp/>=<sp/>1<sp/><sp/></highlight><highlight class="comment">#<sp/>Use<sp/>information_state_tensor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment" kindref="compound">Environment</ref>(object):</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Open<sp/>Spiel<sp/>reinforcement<sp/>learning<sp/>environment<sp/>class.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ac8f6f7f5afac59865a24954c7b6596d8" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ac8f6f7f5afac59865a24954c7b6596d8" kindref="member">__init__</ref>(self,</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>game,</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discount=1.0,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chance_event_sampler=None,</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observation_type=None,</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>include_full_state=False,</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mfg_distribution=None,</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mfg_population=None,</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>enable_legality_check=False,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>**kwargs):</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor.</highlight></codeline>
<codeline lineno="154"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="155"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="156"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>game:<sp/>[string,<sp/>pyspiel.Game]<sp/>Open<sp/>Spiel<sp/>game<sp/>name<sp/>or<sp/>game<sp/>instance.</highlight></codeline>
<codeline lineno="157"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>discount:<sp/>float,<sp/>discount<sp/>used<sp/>in<sp/>non-initial<sp/>steps.<sp/>Defaults<sp/>to<sp/>1.0.</highlight></codeline>
<codeline lineno="158"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>chance_event_sampler:<sp/>optional<sp/>object<sp/>with<sp/>`sample_external_events`<sp/>method</highlight></codeline>
<codeline lineno="159"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>sample<sp/>chance<sp/>events.</highlight></codeline>
<codeline lineno="160"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>observation_type:<sp/>what<sp/>kind<sp/>of<sp/>observation<sp/>to<sp/>use.<sp/>If<sp/>not<sp/>specified,<sp/>will</highlight></codeline>
<codeline lineno="161"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default<sp/>to<sp/>INFORMATION_STATE<sp/>unless<sp/>the<sp/>game<sp/>doesn&apos;t<sp/>provide<sp/>it.</highlight></codeline>
<codeline lineno="162"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>include_full_state:<sp/>whether<sp/>or<sp/>not<sp/>to<sp/>include<sp/>the<sp/>full<sp/>serialized</highlight></codeline>
<codeline lineno="163"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OpenSpiel<sp/>state<sp/>in<sp/>the<sp/>observations<sp/>(sometimes<sp/>useful<sp/>for<sp/>debugging).</highlight></codeline>
<codeline lineno="164"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>mfg_distribution:<sp/>the<sp/>distribution<sp/>over<sp/>states<sp/>if<sp/>the<sp/>game<sp/>is<sp/>a<sp/>mean<sp/>field</highlight></codeline>
<codeline lineno="165"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>game.</highlight></codeline>
<codeline lineno="166"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>mfg_population:<sp/>The<sp/>Mean<sp/>Field<sp/>Game<sp/>population<sp/>to<sp/>consider.</highlight></codeline>
<codeline lineno="167"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>enable_legality_check:<sp/>Check<sp/>the<sp/>legality<sp/>of<sp/>the<sp/>move<sp/>before<sp/>stepping.</highlight></codeline>
<codeline lineno="168"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>**kwargs:<sp/>dict,<sp/>additional<sp/>settings<sp/>passed<sp/>to<sp/>the<sp/>Open<sp/>Spiel<sp/>game.</highlight></codeline>
<codeline lineno="169"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa97a4b7812c3985634952178b803ceed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa97a4b7812c3985634952178b803ceed" kindref="member">_chance_event_sampler</ref><sp/>=<sp/>chance_event_sampler<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_chance_event_sampler" kindref="compound">ChanceEventSampler</ref>()</highlight></codeline>
<codeline lineno="171" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a580652a1e241b754ee8b7fb1ecd4ecbf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a580652a1e241b754ee8b7fb1ecd4ecbf" kindref="member">_include_full_state</ref><sp/>=<sp/>include_full_state</highlight></codeline>
<codeline lineno="172" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ae6cf3f2cf7a0c074cce9809264eecf30" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ae6cf3f2cf7a0c074cce9809264eecf30" kindref="member">_mfg_distribution</ref><sp/>=<sp/>mfg_distribution</highlight></codeline>
<codeline lineno="173" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a079292efba13501fa783bf91e1a27644" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a079292efba13501fa783bf91e1a27644" kindref="member">_mfg_population</ref><sp/>=<sp/>mfg_population</highlight></codeline>
<codeline lineno="174" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab63bd0af56bc88a2928b8fffe8b7459a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab63bd0af56bc88a2928b8fffe8b7459a" kindref="member">_enable_legality_check</ref><sp/>=<sp/>enable_legality_check</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(game,<sp/>str):</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>kwargs:</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>game_settings<sp/>=<sp/>{key:<sp/>val<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(key,<sp/>val)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>kwargs.items()}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(</highlight><highlight class="stringliteral">&quot;Using<sp/>game<sp/>settings:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>game_settings)</highlight></codeline>
<codeline lineno="180" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref><sp/>=<sp/>pyspiel.load_game(game,<sp/>game_settings)</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(</highlight><highlight class="stringliteral">&quot;Using<sp/>game<sp/>string:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>game)</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref><sp/>=<sp/>pyspiel.load_game(game)</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="comment">#<sp/>pyspiel.Game<sp/>or<sp/>API-compatible<sp/>object.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(</highlight><highlight class="stringliteral">&quot;Using<sp/>game<sp/>instance:<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>game.get_type().short_name)</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref><sp/>=<sp/>game</highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="188" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a7044754416cd1fbb1c04216045ff4506" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a7044754416cd1fbb1c04216045ff4506" kindref="member">_num_players</ref><sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a34ce4c3d0934b9ad11134510f1fb4f2b" kindref="member">num_players</ref>()</highlight></codeline>
<codeline lineno="189" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a8ad3127243e93acc3c084a8343b5088d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a8ad3127243e93acc3c084a8343b5088d" kindref="member">_should_reset</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Discount<sp/>returned<sp/>at<sp/>non-initial<sp/>steps.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1afede8e3865cf9a847bb32dd2b1b87288" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1afede8e3865cf9a847bb32dd2b1b87288" kindref="member">_discounts</ref><sp/>=<sp/>[discount]<sp/>*<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a7044754416cd1fbb1c04216045ff4506" kindref="member">_num_players</ref></highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Determine<sp/>what<sp/>observation<sp/>type<sp/>to<sp/>use.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>observation_type<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().provides_information_state_tensor:</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observation_type<sp/>=<sp/>ObservationType.INFORMATION_STATE</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observation_type<sp/>=<sp/>ObservationType.OBSERVATION</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Check<sp/>the<sp/>requested<sp/>observation<sp/>type<sp/>is<sp/>supported.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>observation_type<sp/>==<sp/>ObservationType.OBSERVATION:</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().provides_observation_tensor:</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(f</highlight><highlight class="stringliteral">&quot;observation_tensor<sp/>not<sp/>supported<sp/>by<sp/>{game}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>observation_type<sp/>==<sp/>ObservationType.INFORMATION_STATE:</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().provides_information_state_tensor:</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(f</highlight><highlight class="stringliteral">&quot;information_state_tensor<sp/>not<sp/>supported<sp/>by<sp/>{game}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="209" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a881d3b4fc40ccf0b7af5664bbd458a87" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a881d3b4fc40ccf0b7af5664bbd458a87" kindref="member">_use_observation</ref><sp/>=<sp/>(observation_type<sp/>==<sp/>ObservationType.OBSERVATION)</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().dynamics<sp/>==<sp/>pyspiel.GameType.Dynamics.MEAN_FIELD:</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>mfg_distribution<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>mfg_population<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>0<sp/>&lt;=<sp/>mfg_population<sp/>&lt;<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a7044754416cd1fbb1c04216045ff4506" kindref="member">_num_players</ref></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a327f8a1a5aaf068a28eea7849c4bec8b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a327f8a1a5aaf068a28eea7849c4bec8b" kindref="member">seed</ref>(self,<sp/>seed=None):</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa97a4b7812c3985634952178b803ceed" kindref="member">_chance_event_sampler</ref>.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a327f8a1a5aaf068a28eea7849c4bec8b" kindref="member">seed</ref>(seed)</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="219" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a375770809594b1c3dbbfeb553eaf87d2" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a375770809594b1c3dbbfeb553eaf87d2" kindref="member">get_time_step</ref>(self):</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>a<sp/>`TimeStep`<sp/>without<sp/>updating<sp/>the<sp/>environment.</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>`TimeStep`<sp/>namedtuple<sp/>containing:</highlight></codeline>
<codeline lineno="224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observation:<sp/>list<sp/>of<sp/>dicts<sp/>containing<sp/>one<sp/>observations<sp/>per<sp/>player,<sp/>each</highlight></codeline>
<codeline lineno="225"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>corresponding<sp/>to<sp/>`observation_spec()`.</highlight></codeline>
<codeline lineno="226"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reward:<sp/>list<sp/>of<sp/>rewards<sp/>at<sp/>this<sp/>timestep,<sp/>or<sp/>None<sp/>if<sp/>step_type<sp/>is</highlight></codeline>
<codeline lineno="227"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`StepType.FIRST`.</highlight></codeline>
<codeline lineno="228"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discount:<sp/>list<sp/>of<sp/>discounts<sp/>in<sp/>the<sp/>range<sp/>[0,<sp/>1],<sp/>or<sp/>None<sp/>if<sp/>step_type<sp/>is</highlight></codeline>
<codeline lineno="229"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`StepType.FIRST`.</highlight></codeline>
<codeline lineno="230"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step_type:<sp/>A<sp/>`StepType`<sp/>value.</highlight></codeline>
<codeline lineno="231"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>observations<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;info_state&quot;</highlight><highlight class="normal">:<sp/>[],</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;legal_actions&quot;</highlight><highlight class="normal">:<sp/>[],</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;current_player&quot;</highlight><highlight class="normal">:<sp/>[],</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;serialized_state&quot;</highlight><highlight class="normal">:<sp/>[]</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>rewards<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/>step_type<sp/>=<sp/>StepType.LAST<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.is_terminal()<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>StepType.MID</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a8ad3127243e93acc3c084a8343b5088d" kindref="member">_should_reset</ref><sp/>=<sp/>step_type<sp/>==<sp/>StepType.LAST</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/>cur_rewards<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.rewards()</highlight></codeline>
<codeline lineno="243" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a34ce4c3d0934b9ad11134510f1fb4f2b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>player_id<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a34ce4c3d0934b9ad11134510f1fb4f2b" kindref="member">num_players</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6e640909a93c376b52991722064a6dfe" kindref="member">num_players</ref>):</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rewards.append(cur_rewards[player_id])</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;info_state&quot;</highlight><highlight class="normal">].append(</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.observation_tensor(player_id)<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a881d3b4fc40ccf0b7af5664bbd458a87" kindref="member">_use_observation</ref></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.information_state_tensor(player_id))</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;legal_actions&quot;</highlight><highlight class="normal">].append(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.legal_actions(player_id))</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;current_player&quot;</highlight><highlight class="normal">]<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.current_player()</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>discounts<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1afede8e3865cf9a847bb32dd2b1b87288" kindref="member">_discounts</ref></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>step_type<sp/>==<sp/>StepType.LAST:</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>When<sp/>the<sp/>game<sp/>is<sp/>in<sp/>a<sp/>terminal<sp/>state<sp/>set<sp/>the<sp/>discount<sp/>to<sp/>0.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>discounts<sp/>=<sp/>[0.<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>discounts]</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a580652a1e241b754ee8b7fb1ecd4ecbf" kindref="member">_include_full_state</ref>:</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;serialized_state&quot;</highlight><highlight class="normal">]<sp/>=<sp/>pyspiel.serialize_game_and_state(</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>,<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>For<sp/>gym<sp/>environments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>,<sp/></highlight><highlight class="stringliteral">&quot;last_info&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;info&quot;</highlight><highlight class="normal">]<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.last_info</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step" kindref="compound">TimeStep</ref>(</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observations=observations,</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rewards=rewards,</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discounts=discounts,</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step_type=step_type)</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a44ded8ce513a4bd2745e420d17a5180d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a44ded8ce513a4bd2745e420d17a5180d" kindref="member">_check_legality</ref>(self,<sp/>actions):</highlight></codeline>
<codeline lineno="271" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a29f8479f52fefffb186a1e5801924001" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a29f8479f52fefffb186a1e5801924001" kindref="member">is_turn_based</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab0a1d4432531718839681174bfff7475" kindref="member">is_turn_based</ref>:</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>legal_actions<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.legal_actions()</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>actions[0]<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>legal_actions:</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(f</highlight><highlight class="stringliteral">&quot;step()<sp/>called<sp/>on<sp/>illegal<sp/>action<sp/>{actions[0]}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(actions)):</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>legal_actions<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.legal_actions(p)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>legal_actions<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>actions[p]<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>legal_actions:</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(f</highlight><highlight class="stringliteral">&quot;step()<sp/>by<sp/>player<sp/>{p}<sp/>called<sp/>on<sp/>illegal<sp/>&quot;</highlight><highlight class="normal"><sp/>+</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&quot;action:<sp/>{actions[p]}&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a58dee24a7616d6a5648d5bcd55d84a20" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a58dee24a7616d6a5648d5bcd55d84a20" kindref="member">step</ref>(self,<sp/>actions):</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Updates<sp/>the<sp/>environment<sp/>according<sp/>to<sp/>`actions`<sp/>and<sp/>returns<sp/>a<sp/>`TimeStep`.</highlight></codeline>
<codeline lineno="284"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="285"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>If<sp/>the<sp/>environment<sp/>returned<sp/>a<sp/>`TimeStep`<sp/>with<sp/>`StepType.LAST`<sp/>at<sp/>the</highlight></codeline>
<codeline lineno="286"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>previous<sp/>step,<sp/>this<sp/>call<sp/>to<sp/>`step`<sp/>will<sp/>start<sp/>a<sp/>new<sp/>sequence<sp/>and<sp/>`actions`</highlight></codeline>
<codeline lineno="287"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>will<sp/>be<sp/>ignored.</highlight></codeline>
<codeline lineno="288"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="289"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>method<sp/>will<sp/>also<sp/>start<sp/>a<sp/>new<sp/>sequence<sp/>if<sp/>called<sp/>after<sp/>the<sp/>environment</highlight></codeline>
<codeline lineno="290"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>has<sp/>been<sp/>constructed<sp/>and<sp/>`reset`<sp/>has<sp/>not<sp/>been<sp/>called.<sp/>Again,<sp/>in<sp/>this<sp/>case</highlight></codeline>
<codeline lineno="291"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>`actions`<sp/>will<sp/>be<sp/>ignored.</highlight></codeline>
<codeline lineno="292"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="293"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="294"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>actions:<sp/>a<sp/>list<sp/>containing<sp/>one<sp/>action<sp/>per<sp/>player,<sp/>following<sp/>specifications</highlight></codeline>
<codeline lineno="295"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>defined<sp/>in<sp/>`action_spec()`.</highlight></codeline>
<codeline lineno="296"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="297"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="298"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>`TimeStep`<sp/>namedtuple<sp/>containing:</highlight></codeline>
<codeline lineno="299"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observation:<sp/>list<sp/>of<sp/>dicts<sp/>containing<sp/>one<sp/>observations<sp/>per<sp/>player,<sp/>each</highlight></codeline>
<codeline lineno="300"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>corresponding<sp/>to<sp/>`observation_spec()`.</highlight></codeline>
<codeline lineno="301"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reward:<sp/>list<sp/>of<sp/>rewards<sp/>at<sp/>this<sp/>timestep,<sp/>or<sp/>None<sp/>if<sp/>step_type<sp/>is</highlight></codeline>
<codeline lineno="302"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`StepType.FIRST`.</highlight></codeline>
<codeline lineno="303"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discount:<sp/>list<sp/>of<sp/>discounts<sp/>in<sp/>the<sp/>range<sp/>[0,<sp/>1],<sp/>or<sp/>None<sp/>if<sp/>step_type<sp/>is</highlight></codeline>
<codeline lineno="304"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`StepType.FIRST`.</highlight></codeline>
<codeline lineno="305"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step_type:<sp/>A<sp/>`StepType`<sp/>value.</highlight></codeline>
<codeline lineno="306"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>len(actions)<sp/>==<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6213af09557fe87e9543bd9809ab7024" kindref="member">num_actions_per_step</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1abe0ef18a489a7cb0c9cee9dbf69394cb" kindref="member">num_actions_per_step</ref>,<sp/>(</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>number<sp/>of<sp/>actions!<sp/>Expected<sp/>{}&quot;</highlight><highlight class="normal">.format(</highlight></codeline>
<codeline lineno="309" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6213af09557fe87e9543bd9809ab7024" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6213af09557fe87e9543bd9809ab7024" kindref="member">num_actions_per_step</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1abe0ef18a489a7cb0c9cee9dbf69394cb" kindref="member">num_actions_per_step</ref>))</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a8ad3127243e93acc3c084a8343b5088d" kindref="member">_should_reset</ref>:</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a26dbd83ee35fa2014b86b34fcb5bb292" kindref="member">reset</ref>()</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab63bd0af56bc88a2928b8fffe8b7459a" kindref="member">_enable_legality_check</ref>:</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a44ded8ce513a4bd2745e420d17a5180d" kindref="member">_check_legality</ref>(actions)</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a29f8479f52fefffb186a1e5801924001" kindref="member">is_turn_based</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab0a1d4432531718839681174bfff7475" kindref="member">is_turn_based</ref>:</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.apply_action(actions[0])</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.apply_actions(actions)</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a230efd26d11086dacef783663691f316" kindref="member">_sample_external_events</ref>()</highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a375770809594b1c3dbbfeb553eaf87d2" kindref="member">get_time_step</ref>()</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a26dbd83ee35fa2014b86b34fcb5bb292" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a26dbd83ee35fa2014b86b34fcb5bb292" kindref="member">reset</ref>(self):</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Starts<sp/>a<sp/>new<sp/>sequence<sp/>and<sp/>returns<sp/>the<sp/>first<sp/>`TimeStep`<sp/>of<sp/>this<sp/>sequence.</highlight></codeline>
<codeline lineno="326"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="327"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="328"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>`TimeStep`<sp/>namedtuple<sp/>containing:</highlight></codeline>
<codeline lineno="329"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observations:<sp/>list<sp/>of<sp/>dicts<sp/>containing<sp/>one<sp/>observations<sp/>per<sp/>player,<sp/>each</highlight></codeline>
<codeline lineno="330"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>corresponding<sp/>to<sp/>`observation_spec()`.</highlight></codeline>
<codeline lineno="331"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rewards:<sp/>list<sp/>of<sp/>rewards<sp/>at<sp/>this<sp/>timestep,<sp/>or<sp/>None<sp/>if<sp/>step_type<sp/>is</highlight></codeline>
<codeline lineno="332"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`StepType.FIRST`.</highlight></codeline>
<codeline lineno="333"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discounts:<sp/>list<sp/>of<sp/>discounts<sp/>in<sp/>the<sp/>range<sp/>[0,<sp/>1],<sp/>or<sp/>None<sp/>if<sp/>step_type</highlight></codeline>
<codeline lineno="334"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>`StepType.FIRST`.</highlight></codeline>
<codeline lineno="335"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step_type:<sp/>A<sp/>`StepType`<sp/>value.</highlight></codeline>
<codeline lineno="336"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a8ad3127243e93acc3c084a8343b5088d" kindref="member">_should_reset</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type(</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>).dynamics<sp/>==<sp/>pyspiel.GameType.Dynamics.MEAN_FIELD<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a7044754416cd1fbb1c04216045ff4506" kindref="member">_num_players</ref><sp/>&gt;<sp/>1:</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref><sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.new_initial_state_for_population(</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a079292efba13501fa783bf91e1a27644" kindref="member">_mfg_population</ref>)</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref><sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.new_initial_state()</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a230efd26d11086dacef783663691f316" kindref="member">_sample_external_events</ref>()</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/>observations<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;info_state&quot;</highlight><highlight class="normal">:<sp/>[],</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;legal_actions&quot;</highlight><highlight class="normal">:<sp/>[],</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;current_player&quot;</highlight><highlight class="normal">:<sp/>[],</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;serialized_state&quot;</highlight><highlight class="normal">:<sp/>[]</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>player_id<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a34ce4c3d0934b9ad11134510f1fb4f2b" kindref="member">num_players</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6e640909a93c376b52991722064a6dfe" kindref="member">num_players</ref>):</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;info_state&quot;</highlight><highlight class="normal">].append(</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.observation_tensor(player_id)<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a881d3b4fc40ccf0b7af5664bbd458a87" kindref="member">_use_observation</ref></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.information_state_tensor(player_id))</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;legal_actions&quot;</highlight><highlight class="normal">].append(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.legal_actions(player_id))</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;current_player&quot;</highlight><highlight class="normal">]<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.current_player()</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a580652a1e241b754ee8b7fb1ecd4ecbf" kindref="member">_include_full_state</ref>:</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>observations[</highlight><highlight class="stringliteral">&quot;serialized_state&quot;</highlight><highlight class="normal">]<sp/>=<sp/>pyspiel.serialize_game_and_state(</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>,<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>)</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step" kindref="compound">TimeStep</ref>(</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>observations=observations,</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rewards=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>discounts=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step_type=StepType.FIRST)</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a230efd26d11086dacef783663691f316" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a230efd26d11086dacef783663691f316" kindref="member">_sample_external_events</ref>(self):</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Sample<sp/>chance<sp/>events<sp/>until<sp/>we<sp/>get<sp/>to<sp/>a<sp/>decision<sp/>node.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa891fe769a1ddedb0bc35ec6b0fa2292" kindref="member">is_chance_node</ref>()<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.current_player()</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>==<sp/>pyspiel.PlayerId.MEAN_FIELD):</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa891fe769a1ddedb0bc35ec6b0fa2292" kindref="member">is_chance_node</ref>():</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outcome<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa97a4b7812c3985634952178b803ceed" kindref="member">_chance_event_sampler</ref>(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>)</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.apply_action(outcome)</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.current_player()<sp/>==<sp/>pyspiel.PlayerId.MEAN_FIELD:</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dist_to_register<sp/>=<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.distribution_support()</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dist<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ae6cf3f2cf7a0c074cce9809264eecf30" kindref="member">_mfg_distribution</ref>.value_str(str_state,<sp/>default_value=0.0)</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>str_state<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dist_to_register</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.update_distribution(dist)</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab23bfab44b60da9b844ea227d9458062" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab23bfab44b60da9b844ea227d9458062" kindref="member">observation_spec</ref>(self):</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Defines<sp/>the<sp/>observation<sp/>per<sp/>player<sp/>provided<sp/>by<sp/>the<sp/>environment.</highlight></codeline>
<codeline lineno="386"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="387"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>dict<sp/>member<sp/>will<sp/>contain<sp/>its<sp/>expected<sp/>structure<sp/>and<sp/>shape.<sp/>E.g.:<sp/>for</highlight></codeline>
<codeline lineno="388"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Kuhn<sp/>Poker<sp/>{&quot;info_state&quot;:<sp/>(6,),<sp/>&quot;legal_actions&quot;:<sp/>(2,),<sp/>&quot;current_player&quot;:<sp/>(),</highlight></codeline>
<codeline lineno="389"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;serialized_state&quot;:<sp/>()}</highlight></codeline>
<codeline lineno="390"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="391"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="392"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>specification<sp/>dict<sp/>describing<sp/>the<sp/>observation<sp/>fields<sp/>and<sp/>shapes.</highlight></codeline>
<codeline lineno="393"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dict(</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>info_state=tuple([</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.observation_tensor_size()<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a881d3b4fc40ccf0b7af5664bbd458a87" kindref="member">_use_observation</ref><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.information_state_tensor_size()</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>]),</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>legal_actions=(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.num_distinct_actions(),),</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_player=(),</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>serialized_state=(),</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1adf39539769c6522554a2a8ccdc28239a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1adf39539769c6522554a2a8ccdc28239a" kindref="member">action_spec</ref>(self):</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Defines<sp/>per<sp/>player<sp/>action<sp/>specifications.</highlight></codeline>
<codeline lineno="406"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="407"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Specifications<sp/>include<sp/>action<sp/>boundaries<sp/>and<sp/>their<sp/>data<sp/>type.</highlight></codeline>
<codeline lineno="408"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>E.g.:<sp/>for<sp/>Kuhn<sp/>Poker<sp/>{&quot;num_actions&quot;:<sp/>2,<sp/>&quot;min&quot;:<sp/>0,<sp/>&quot;max&quot;:1,<sp/>&quot;dtype&quot;:<sp/>int}</highlight></codeline>
<codeline lineno="409"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="410"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="411"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>specification<sp/>dict<sp/>containing<sp/>per<sp/>player<sp/>action<sp/>properties.</highlight></codeline>
<codeline lineno="412"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dict(</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_actions=self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.num_distinct_actions(),</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min=0,</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max=self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.num_distinct_actions()<sp/>-<sp/>1,</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dtype=int,</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="419"><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>Environment<sp/>properties</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1abf762d87fdd5e9c5a87035b45d25d4d1" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1abf762d87fdd5e9c5a87035b45d25d4d1" kindref="member">use_observation</ref>(self):</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>whether<sp/>the<sp/>environment<sp/>is<sp/>using<sp/>the<sp/>game&apos;s<sp/>observation.</highlight></codeline>
<codeline lineno="424"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="425"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>If<sp/>false,<sp/>it<sp/>is<sp/>using<sp/>the<sp/>game&apos;s<sp/>information<sp/>state.</highlight></codeline>
<codeline lineno="426"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a881d3b4fc40ccf0b7af5664bbd458a87" kindref="member">_use_observation</ref></highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>Game<sp/>properties</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a1ef034430a2c9fd145fc126bc30eef27" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a1ef034430a2c9fd145fc126bc30eef27" kindref="member">name</ref>(self):</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().short_name</highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="435" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6e640909a93c376b52991722064a6dfe" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a34ce4c3d0934b9ad11134510f1fb4f2b" kindref="member">num_players</ref>(self):</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a34ce4c3d0934b9ad11134510f1fb4f2b" kindref="member">num_players</ref>()</highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="439" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1abe0ef18a489a7cb0c9cee9dbf69394cb" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6213af09557fe87e9543bd9809ab7024" kindref="member">num_actions_per_step</ref>(self):</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a29f8479f52fefffb186a1e5801924001" kindref="member">is_turn_based</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab0a1d4432531718839681174bfff7475" kindref="member">is_turn_based</ref><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a34ce4c3d0934b9ad11134510f1fb4f2b" kindref="member">num_players</ref><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a6e640909a93c376b52991722064a6dfe" kindref="member">num_players</ref></highlight></codeline>
<codeline lineno="441"><highlight class="normal"></highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">#<sp/>New<sp/>RL<sp/>calls<sp/>for<sp/>more<sp/>advanced<sp/>use<sp/>cases<sp/>(e.g.<sp/>search<sp/>+<sp/>RL).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab0a1d4432531718839681174bfff7475" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a29f8479f52fefffb186a1e5801924001" kindref="member">is_turn_based</ref>(self):</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().dynamics</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>==<sp/>pyspiel.GameType.Dynamics.SEQUENTIAL)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().dynamics</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>==<sp/>pyspiel.GameType.Dynamics.MEAN_FIELD))</highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="451" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a2e9639edb575a67238a912c738028565" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a2e9639edb575a67238a912c738028565" kindref="member">max_game_length</ref>(self):</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a2e9639edb575a67238a912c738028565" kindref="member">max_game_length</ref>()</highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="455" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa891fe769a1ddedb0bc35ec6b0fa2292" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa891fe769a1ddedb0bc35ec6b0fa2292" kindref="member">is_chance_node</ref>(self):</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref>.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aa891fe769a1ddedb0bc35ec6b0fa2292" kindref="member">is_chance_node</ref>()</highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a5eda9be6e375bbe3e2a741972e7c2538" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a5eda9be6e375bbe3e2a741972e7c2538" kindref="member">game</ref>(self):</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref></highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight></codeline>
<codeline lineno="462" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aefa496c5461824795bc9a1f274df94f8" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1aefa496c5461824795bc9a1f274df94f8" kindref="member">set_state</ref>(self,<sp/>new_state):</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Updates<sp/>the<sp/>game<sp/>state.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>new_state.get_game()<sp/>==<sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a5eda9be6e375bbe3e2a741972e7c2538" kindref="member">game</ref>,<sp/>(</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;State<sp/>must<sp/>have<sp/>been<sp/>created<sp/>by<sp/>the<sp/>same<sp/>game.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref><sp/>=<sp/>new_state</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="469" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab802656870336ea14206423aa14fb31e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ab802656870336ea14206423aa14fb31e" kindref="member">get_state</ref>(self):</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a176887d4dc595d7e3f12433b3c25b56e" kindref="member">_state</ref></highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="473" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a492f84a4c0108f2af0024b0c2e02a1cd" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1a492f84a4c0108f2af0024b0c2e02a1cd" kindref="member">mfg_distribution</ref>(self):</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ae6cf3f2cf7a0c074cce9809264eecf30" kindref="member">_mfg_distribution</ref></highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight></codeline>
<codeline lineno="476" refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1afceda495233508d0264783c55631b237" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1afceda495233508d0264783c55631b237" kindref="member">update_mfg_distribution</ref>(self,<sp/>mfg_distribution):</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Updates<sp/>the<sp/>distribution<sp/>over<sp/>the<sp/>states<sp/>of<sp/>the<sp/>mean<sp/>field<sp/>game.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1af882e535ed6f35d7c761f2940015a3b0" kindref="member">_game</ref>.get_type().dynamics<sp/>==<sp/>pyspiel.GameType.Dynamics.MEAN_FIELD)</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>self.<ref refid="classopen__spiel_1_1python_1_1rl__environment_1_1_environment_1ae6cf3f2cf7a0c074cce9809264eecf30" kindref="member">_mfg_distribution</ref><sp/>=<sp/>mfg_distribution</highlight></codeline>
    </programlisting>
    <location file="open_spiel/python/rl_environment.py"/>
  </compounddef>
</doxygen>
