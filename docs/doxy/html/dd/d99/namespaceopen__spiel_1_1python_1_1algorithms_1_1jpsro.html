<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.algorithms.jpsro Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../df/dc9/namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="../../d9/d47/namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><b>algorithms</b></li><li class="navelem"><a class="el" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html">jpsro</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.algorithms.jpsro Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aad7ae503e5047bc4f542bca363e7c6eb" id="r_aad7ae503e5047bc4f542bca363e7c6eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad7ae503e5047bc4f542bca363e7c6eb">_eliminate_dominated_payoff</a> (payoff, epsilon, action_labels=None, action_repeats=None, weakly=False)</td></tr>
<tr class="memdesc:aad7ae503e5047bc4f542bca363e7c6eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Meta Solvers.  <br /></td></tr>
<tr class="separator:aad7ae503e5047bc4f542bca363e7c6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63355927bd6084c9498e36580294fd4f" id="r_a63355927bd6084c9498e36580294fd4f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a63355927bd6084c9498e36580294fd4f">_reconstruct_dist</a> (eliminated_dist, action_labels, num_actions)</td></tr>
<tr class="separator:a63355927bd6084c9498e36580294fd4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ecffd8bee9243e1fb3aa8b805724ea2" id="r_a1ecffd8bee9243e1fb3aa8b805724ea2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ecffd8bee9243e1fb3aa8b805724ea2">_eliminate_dominated_decorator</a> (func)</td></tr>
<tr class="separator:a1ecffd8bee9243e1fb3aa8b805724ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a088f330db6fab79ba41c4c0101d13006" id="r_a088f330db6fab79ba41c4c0101d13006"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a088f330db6fab79ba41c4c0101d13006">_try_two_solvers</a> (func, *args, **kwargs)</td></tr>
<tr class="separator:a088f330db6fab79ba41c4c0101d13006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000ca7f1d77fc727efa5c341d3dd0e4f" id="r_a000ca7f1d77fc727efa5c341d3dd0e4f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a000ca7f1d77fc727efa5c341d3dd0e4f">_indices</a> (p, a, num_players)</td></tr>
<tr class="separator:a000ca7f1d77fc727efa5c341d3dd0e4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26287e34dfbe1691600a6c8c004d553b" id="r_a26287e34dfbe1691600a6c8c004d553b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26287e34dfbe1691600a6c8c004d553b">_sparse_indices_generator</a> (player, action, num_actions)</td></tr>
<tr class="separator:a26287e34dfbe1691600a6c8c004d553b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a903fb5307a89eb117898edd5a05c0404" id="r_a903fb5307a89eb117898edd5a05c0404"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a903fb5307a89eb117898edd5a05c0404">_partition_by_player</a> (val, p_vec, num_players)</td></tr>
<tr class="separator:a903fb5307a89eb117898edd5a05c0404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab483f30928c3cf4f8e98b5b229e91dac" id="r_ab483f30928c3cf4f8e98b5b229e91dac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab483f30928c3cf4f8e98b5b229e91dac">_cce_constraints</a> (payoff, epsilons, remove_null=True, zero_tolerance=1e-8)</td></tr>
<tr class="separator:ab483f30928c3cf4f8e98b5b229e91dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d665dce6154126d104d54fe591e1f1" id="r_a56d665dce6154126d104d54fe591e1f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56d665dce6154126d104d54fe591e1f1">_ace_constraints</a> (payoff, epsilons, remove_null=True, zero_tolerance=0.0)</td></tr>
<tr class="separator:a56d665dce6154126d104d54fe591e1f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0759318e8d0ae3a8bda1f98b88c6eeb" id="r_ab0759318e8d0ae3a8bda1f98b88c6eeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0759318e8d0ae3a8bda1f98b88c6eeb">_get_repeat_factor</a> (action_repeats)</td></tr>
<tr class="separator:ab0759318e8d0ae3a8bda1f98b88c6eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07dcf5203af3455327b4adca910c3798" id="r_a07dcf5203af3455327b4adca910c3798"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07dcf5203af3455327b4adca910c3798">_linear</a> (payoff, a_mat, e_vec, action_repeats=None, solver_kwargs=None, cost=None)</td></tr>
<tr class="separator:a07dcf5203af3455327b4adca910c3798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43430cdc89f420c4709947ab62b37102" id="r_a43430cdc89f420c4709947ab62b37102"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43430cdc89f420c4709947ab62b37102">_qp_cce</a> (payoff, a_mats, e_vecs, assume_full_support=False, action_repeats=None, solver_kwargs=None, min_epsilon=False)</td></tr>
<tr class="separator:a43430cdc89f420c4709947ab62b37102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a971028ec7c3bf12ceb9469ff7bb3d588" id="r_a971028ec7c3bf12ceb9469ff7bb3d588"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a971028ec7c3bf12ceb9469ff7bb3d588">_qp_ce</a> (payoff, a_mats, e_vecs, assume_full_support=False, action_repeats=None, solver_kwargs=None, min_epsilon=False)</td></tr>
<tr class="separator:a971028ec7c3bf12ceb9469ff7bb3d588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad745bbf95be8a7fa90da91184ac5e11" id="r_aad745bbf95be8a7fa90da91184ac5e11"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad745bbf95be8a7fa90da91184ac5e11">_expand_meta_game</a> (meta_game, per_player_repeats)</td></tr>
<tr class="separator:aad745bbf95be8a7fa90da91184ac5e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b86f3706cfdac7c132b5e075689011" id="r_a47b86f3706cfdac7c132b5e075689011"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47b86f3706cfdac7c132b5e075689011">_unexpand_meta_dist</a> (meta_dist, per_player_repeats)</td></tr>
<tr class="separator:a47b86f3706cfdac7c132b5e075689011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69335b08e561a814e17d419ca094148" id="r_af69335b08e561a814e17d419ca094148"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af69335b08e561a814e17d419ca094148">_uni</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:af69335b08e561a814e17d419ca094148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60297d0f82059c9b2b8d7d20cac3cc1e" id="r_a60297d0f82059c9b2b8d7d20cac3cc1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60297d0f82059c9b2b8d7d20cac3cc1e">_undominated_uni</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a60297d0f82059c9b2b8d7d20cac3cc1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d1c53c4d157fd3b77fb1aed6951b9ce" id="r_a5d1c53c4d157fd3b77fb1aed6951b9ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d1c53c4d157fd3b77fb1aed6951b9ce">_rj</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a5d1c53c4d157fd3b77fb1aed6951b9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae94c1d37dad7bdcf9f8dc20535164b9e" id="r_ae94c1d37dad7bdcf9f8dc20535164b9e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae94c1d37dad7bdcf9f8dc20535164b9e">_undominated_rj</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:ae94c1d37dad7bdcf9f8dc20535164b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad71357251fe0753aa6275d848db13126" id="r_ad71357251fe0753aa6275d848db13126"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad71357251fe0753aa6275d848db13126">_rd</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:ad71357251fe0753aa6275d848db13126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87dfaadfd194bd05d1adf17ac620f83b" id="r_a87dfaadfd194bd05d1adf17ac620f83b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87dfaadfd194bd05d1adf17ac620f83b">_undominated_rd</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a87dfaadfd194bd05d1adf17ac620f83b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d842806c8cc535737798c3da2520b51" id="r_a2d842806c8cc535737798c3da2520b51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d842806c8cc535737798c3da2520b51">_prd</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a2d842806c8cc535737798c3da2520b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb970203419c20e35949d832b141af0d" id="r_afb970203419c20e35949d832b141af0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afb970203419c20e35949d832b141af0d">_alpharank</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:afb970203419c20e35949d832b141af0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad22dbe6c241bb015a2847669c3718f4a" id="r_ad22dbe6c241bb015a2847669c3718f4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad22dbe6c241bb015a2847669c3718f4a">_mgce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:ad22dbe6c241bb015a2847669c3718f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88213c014022c5b5c252afd1bbfc580a" id="r_a88213c014022c5b5c252afd1bbfc580a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88213c014022c5b5c252afd1bbfc580a">_min_epsilon_mgce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a88213c014022c5b5c252afd1bbfc580a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f75702d8ed7ab14597c1630dd3d64d" id="r_af7f75702d8ed7ab14597c1630dd3d64d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7f75702d8ed7ab14597c1630dd3d64d">_approx_mgce</a> (meta_game, per_player_repeats, ignore_repeats=False, epsilon=0.01)</td></tr>
<tr class="separator:af7f75702d8ed7ab14597c1630dd3d64d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8495a428ade0a06e7dbb8d13e32c3e5b" id="r_a8495a428ade0a06e7dbb8d13e32c3e5b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8495a428ade0a06e7dbb8d13e32c3e5b">_rmwce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a8495a428ade0a06e7dbb8d13e32c3e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e02827728f353354c401149aa6d3ed6" id="r_a8e02827728f353354c401149aa6d3ed6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e02827728f353354c401149aa6d3ed6">_mwce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a8e02827728f353354c401149aa6d3ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed3a3a14fbbdf6ed8f536c449e33b1a9" id="r_aed3a3a14fbbdf6ed8f536c449e33b1a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed3a3a14fbbdf6ed8f536c449e33b1a9">_rvce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:aed3a3a14fbbdf6ed8f536c449e33b1a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8abe130b236a4ee05ab412a1b60d07" id="r_a5a8abe130b236a4ee05ab412a1b60d07"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a8abe130b236a4ee05ab412a1b60d07">_mgcce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:a5a8abe130b236a4ee05ab412a1b60d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1536cda76732de105718747de0dac34" id="r_af1536cda76732de105718747de0dac34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1536cda76732de105718747de0dac34">_min_epsilon_mgcce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:af1536cda76732de105718747de0dac34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eca0d93cfa2a035d239a3a78861bf04" id="r_a4eca0d93cfa2a035d239a3a78861bf04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4eca0d93cfa2a035d239a3a78861bf04">_approx_mgcce</a> (meta_game, per_player_repeats, ignore_repeats=False, epsilon=0.01)</td></tr>
<tr class="separator:a4eca0d93cfa2a035d239a3a78861bf04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa953e89ced52a2873ecbddd0433e3793" id="r_aa953e89ced52a2873ecbddd0433e3793"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa953e89ced52a2873ecbddd0433e3793">_rmwcce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:aa953e89ced52a2873ecbddd0433e3793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab121ccdb3d41d31d9aac3e730b212b29" id="r_ab121ccdb3d41d31d9aac3e730b212b29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab121ccdb3d41d31d9aac3e730b212b29">_mwcce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:ab121ccdb3d41d31d9aac3e730b212b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad018b6ef5dd537fca76c7ca246dd5a08" id="r_ad018b6ef5dd537fca76c7ca246dd5a08"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad018b6ef5dd537fca76c7ca246dd5a08">_rvcce</a> (meta_game, per_player_repeats, ignore_repeats=False)</td></tr>
<tr class="separator:ad018b6ef5dd537fca76c7ca246dd5a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10a253b3f0969595c659d2311bc70ac" id="r_ab10a253b3f0969595c659d2311bc70ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab10a253b3f0969595c659d2311bc70ac">initialize_policy</a> (game, player, policy_init)</td></tr>
<tr class="memdesc:ab10a253b3f0969595c659d2311bc70ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">PSRO Functions.  <br /></td></tr>
<tr class="separator:ab10a253b3f0969595c659d2311bc70ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9070921c5927df62cd7cb6c1b5c0123c" id="r_a9070921c5927df62cd7cb6c1b5c0123c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9070921c5927df62cd7cb6c1b5c0123c">add_new_policies</a> (per_player_new_policies, per_player_gaps, per_player_repeats, per_player_policies, joint_policies, joint_returns, game, br_selection)</td></tr>
<tr class="separator:a9070921c5927df62cd7cb6c1b5c0123c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8002f75b143a5a7eb054a20f640c5a24" id="r_a8002f75b143a5a7eb054a20f640c5a24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8002f75b143a5a7eb054a20f640c5a24">add_meta_game</a> (meta_games, per_player_policies, joint_returns)</td></tr>
<tr class="separator:a8002f75b143a5a7eb054a20f640c5a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd6365e26652a88ca2de77eab51bb00" id="r_a4bd6365e26652a88ca2de77eab51bb00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4bd6365e26652a88ca2de77eab51bb00">add_meta_dist</a> (meta_dists, meta_values, meta_solver, meta_game, per_player_repeats, ignore_repeats)</td></tr>
<tr class="separator:a4bd6365e26652a88ca2de77eab51bb00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcb700f5519bce84ab7a3d8b1dca5c36" id="r_adcb700f5519bce84ab7a3d8b1dca5c36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcb700f5519bce84ab7a3d8b1dca5c36">find_best_response</a> (game, meta_dist, meta_game, iteration, joint_policies, target_equilibrium, update_players_strategy, action_value_tolerance)</td></tr>
<tr class="separator:adcb700f5519bce84ab7a3d8b1dca5c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4623116b95368c61c3170bc2844457" id="r_a4f4623116b95368c61c3170bc2844457"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f4623116b95368c61c3170bc2844457">initialize</a> (game, train_meta_solver, eval_meta_solver, policy_init, ignore_repeats, br_selection)</td></tr>
<tr class="memdesc:a4f4623116b95368c61c3170bc2844457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main Loop.  <br /></td></tr>
<tr class="separator:a4f4623116b95368c61c3170bc2844457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5acb7ac3e7c2fc895b889d5493410574" id="r_a5acb7ac3e7c2fc895b889d5493410574"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5acb7ac3e7c2fc895b889d5493410574">initialize_callback_</a> (iteration, per_player_repeats, per_player_policies, joint_policies, joint_returns, meta_games, train_meta_dists, eval_meta_dists, train_meta_values, eval_meta_values, train_meta_gaps, eval_meta_gaps, game)</td></tr>
<tr class="separator:a5acb7ac3e7c2fc895b889d5493410574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe35dd57c6419a4bb696b603388c3cc" id="r_acbe35dd57c6419a4bb696b603388c3cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acbe35dd57c6419a4bb696b603388c3cc">callback_</a> (iteration, per_player_repeats, per_player_policies, joint_policies, joint_returns, meta_games, train_meta_dists, eval_meta_dists, train_meta_values, eval_meta_values, train_meta_gaps, eval_meta_gaps, kwargs, checkpoint)</td></tr>
<tr class="separator:acbe35dd57c6419a4bb696b603388c3cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53ee5846cf329f075c268a95c243a60a" id="r_a53ee5846cf329f075c268a95c243a60a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a53ee5846cf329f075c268a95c243a60a">run_loop</a> (game, game_name, seed=0, iterations=40, policy_init=&quot;uniform&quot;, update_players_strategy=&quot;all&quot;, target_equilibrium=&quot;cce&quot;, br_selection=&quot;largest_gap&quot;, train_meta_solver=&quot;mgcce&quot;, eval_meta_solver=&quot;mwcce&quot;, ignore_repeats=False, initialize_callback=None, action_value_tolerance=-1.0, callback=None)</td></tr>
<tr class="separator:a53ee5846cf329f075c268a95c243a60a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af992048eef9e10a8455056c99585ecb2" id="r_af992048eef9e10a8455056c99585ecb2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af992048eef9e10a8455056c99585ecb2">DEFAULT_ECOS_SOLVER_KWARGS</a></td></tr>
<tr class="separator:af992048eef9e10a8455056c99585ecb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997723cbb05a92aef5c2f29c8964c632" id="r_a997723cbb05a92aef5c2f29c8964c632"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a997723cbb05a92aef5c2f29c8964c632">DEFAULT_OSQP_SOLVER_KWARGS</a></td></tr>
<tr class="separator:a997723cbb05a92aef5c2f29c8964c632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3079dcb39e0cadfce15322fee02c1828" id="r_a3079dcb39e0cadfce15322fee02c1828"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3079dcb39e0cadfce15322fee02c1828">DEFAULT_CVXOPT_SOLVER_KWARGS</a></td></tr>
<tr class="separator:a3079dcb39e0cadfce15322fee02c1828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a6f360913a44091fbdb262a69e74f9" id="r_ad8a6f360913a44091fbdb262a69e74f9"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8a6f360913a44091fbdb262a69e74f9">INIT_POLICIES</a></td></tr>
<tr class="separator:ad8a6f360913a44091fbdb262a69e74f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc7ebf78bce2e1fff3b7c68409506c90" id="r_adc7ebf78bce2e1fff3b7c68409506c90"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc7ebf78bce2e1fff3b7c68409506c90">UPDATE_PLAYERS_STRATEGY</a></td></tr>
<tr class="separator:adc7ebf78bce2e1fff3b7c68409506c90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55e83f3cffc405f02d8a02825f6e6a2f" id="r_a55e83f3cffc405f02d8a02825f6e6a2f"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55e83f3cffc405f02d8a02825f6e6a2f">BRS</a></td></tr>
<tr class="separator:a55e83f3cffc405f02d8a02825f6e6a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abff467ea872d5da70f4b9bbd19595b05" id="r_abff467ea872d5da70f4b9bbd19595b05"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abff467ea872d5da70f4b9bbd19595b05">BR_SELECTIONS</a></td></tr>
<tr class="separator:abff467ea872d5da70f4b9bbd19595b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c4a465cb3ca5674dc5daac8dd01c06b" id="r_a7c4a465cb3ca5674dc5daac8dd01c06b"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c4a465cb3ca5674dc5daac8dd01c06b">META_SOLVERS</a></td></tr>
<tr class="separator:a7c4a465cb3ca5674dc5daac8dd01c06b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a671bb7d9cd1bb7bfec1c451856ad2f89" id="r_a671bb7d9cd1bb7bfec1c451856ad2f89"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a671bb7d9cd1bb7bfec1c451856ad2f89">LOG_STRING</a></td></tr>
<tr class="separator:a671bb7d9cd1bb7bfec1c451856ad2f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8882b396dfb4c382afefa50f9886ea8b" id="r_a8882b396dfb4c382afefa50f9886ea8b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8882b396dfb4c382afefa50f9886ea8b">DIST_TOL</a> = 1e-8</td></tr>
<tr class="separator:a8882b396dfb4c382afefa50f9886ea8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e214ec216d424e76d6032c72eac04d6" id="r_a0e214ec216d424e76d6032c72eac04d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e214ec216d424e76d6032c72eac04d6">GAP_TOL</a> = 1e-8</td></tr>
<tr class="separator:a0e214ec216d424e76d6032c72eac04d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf45729b1351395470d3e0dca72864f" id="r_a6cf45729b1351395470d3e0dca72864f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cf45729b1351395470d3e0dca72864f">RETURN_TOL</a> = 1e-12</td></tr>
<tr class="separator:a6cf45729b1351395470d3e0dca72864f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00890153016c8607057ac2d0daa53d41" id="r_a00890153016c8607057ac2d0daa53d41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00890153016c8607057ac2d0daa53d41">FLAG_TO_FUNC</a></td></tr>
<tr class="separator:a00890153016c8607057ac2d0daa53d41"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Joint Policy-Space Response Oracles.

An implementation of JSPRO, described in https://arxiv.org/abs/2106.09435.

Bibtex / Cite:

```
@misc{marris2021multiagent,
    title={Multi-Agent Training beyond Zero-Sum with Correlated Equilibrium
           Meta-Solvers},
    author={Luke Marris and Paul Muller and Marc Lanctot and Karl Tuyls and
            Thore Graepel},
    year={2021},
    eprint={2106.09435},
    archivePrefix={arXiv},
    primaryClass={cs.MA}
}
```
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a56d665dce6154126d104d54fe591e1f1" name="a56d665dce6154126d104d54fe591e1f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d665dce6154126d104d54fe591e1f1">&#9670;&#160;</a></span>_ace_constraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._ace_constraints </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>payoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epsilons</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>remove_null</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>zero_tolerance</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns sparse alternate ce constraints Ax - epsilon &lt;= 0.

Args:
  payoff: Dense payoff tensor.
  epsilons: Scalar epsilon approximation.
  remove_null: Whether to remove null row constraints.
  zero_tolerance: Smallest absolute value.

Returns:
  a_csr: Sparse gain matrix from switching from one action to another.
  e_vec: Epsilon vector.
  meta: Dictionary containing meta information.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00319">319</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  319</span><span class="keyword">def </span>_ace_constraints(payoff, epsilons, remove_null=True, zero_tolerance=0.0):</div>
<div class="line"><span class="lineno">  320</span>  <span class="stringliteral">&quot;&quot;&quot;Returns sparse alternate ce constraints Ax - epsilon &lt;= 0.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    payoff: Dense payoff tensor.</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">    epsilons: Scalar epsilon approximation.</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    remove_null: Whether to remove null row constraints.</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">    zero_tolerance: Smallest absolute value.</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    a_csr: Sparse gain matrix from switching from one action to another.</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    e_vec: Epsilon vector.</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    meta: Dictionary containing meta information.</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  333</span>  num_players = payoff.shape[0]</div>
<div class="line"><span class="lineno">  334</span>  num_actions = payoff.shape[1:]</div>
<div class="line"><span class="lineno">  335</span>  num_dists = int(np.prod(num_actions))</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>  num_cons = 0</div>
<div class="line"><span class="lineno">  338</span>  <span class="keywordflow">for</span> p <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  339</span>    num_cons += num_actions[p] * (num_actions[p] - 1)</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>  a_dok = sp.sparse.dok_matrix((num_cons, num_dists))</div>
<div class="line"><span class="lineno">  342</span>  e_vec = np.zeros([num_cons])</div>
<div class="line"><span class="lineno">  343</span>  p_vec = np.zeros([num_cons], dtype=np.int32)</div>
<div class="line"><span class="lineno">  344</span>  i_vec = np.zeros([num_cons, 2], dtype=np.int32)</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  num_null_cons = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  347</span>  num_redundant_cons = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  348</span>  num_removed_cons = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>  <span class="keywordflow">if</span> num_cons &gt; 0:</div>
<div class="line"><span class="lineno">  351</span>    con = 0</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">for</span> p <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  353</span>      generator = itertools.permutations(range(num_actions[p]), 2)</div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">for</span> a0, a1 <span class="keywordflow">in</span> generator:</div>
<div class="line"><span class="lineno">  355</span>        a0_inds = _sparse_indices_generator(p, a0, num_actions)</div>
<div class="line"><span class="lineno">  356</span>        a1_inds = _sparse_indices_generator(p, a1, num_actions)</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">for</span> a0_ind, a1_ind <span class="keywordflow">in</span> zip(a0_inds, a1_inds):</div>
<div class="line"><span class="lineno">  359</span>          a0_ind_flat = np.ravel_multi_index(a0_ind, num_actions)</div>
<div class="line"><span class="lineno">  360</span>          val = payoff[p][a1_ind] - payoff[p][a0_ind]</div>
<div class="line"><span class="lineno">  361</span>          <span class="keywordflow">if</span> abs(val) &gt; zero_tolerance:</div>
<div class="line"><span class="lineno">  362</span>            a_dok[con, a0_ind_flat] = val</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>        e_vec[con] = epsilons[p]</div>
<div class="line"><span class="lineno">  365</span>        p_vec[con] = p</div>
<div class="line"><span class="lineno">  366</span>        i_vec[con] = [a0, a1]</div>
<div class="line"><span class="lineno">  367</span>        con += 1</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>    a_csr = a_dok.tocsr()</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> remove_null:</div>
<div class="line"><span class="lineno">  371</span>      null_cons = np.logical_or(</div>
<div class="line"><span class="lineno">  372</span>          a_csr.max(axis=1).todense() != 0.0,</div>
<div class="line"><span class="lineno">  373</span>          a_csr.min(axis=1).todense() != 0.0)</div>
<div class="line"><span class="lineno">  374</span>      null_cons = np.ravel(null_cons)</div>
<div class="line"><span class="lineno">  375</span>      redundant_cons = np.ravel(a_csr.max(axis=1).todense()) &gt;= e_vec</div>
<div class="line"><span class="lineno">  376</span>      nonzero_mask = null_cons &amp; redundant_cons</div>
<div class="line"><span class="lineno">  377</span>      a_csr = a_csr[nonzero_mask, :]</div>
<div class="line"><span class="lineno">  378</span>      e_vec = e_vec[nonzero_mask].copy()</div>
<div class="line"><span class="lineno">  379</span>      p_vec = p_vec[nonzero_mask].copy()</div>
<div class="line"><span class="lineno">  380</span>      i_vec = i_vec[nonzero_mask].copy()</div>
<div class="line"><span class="lineno">  381</span>      num_null_cons = np.sum(~null_cons)</div>
<div class="line"><span class="lineno">  382</span>      num_redundant_cons = np.sum(~redundant_cons)</div>
<div class="line"><span class="lineno">  383</span>      num_removed_cons = np.sum(~nonzero_mask)</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  386</span>    a_csr = a_dok.tocsr()</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>  meta = dict(</div>
<div class="line"><span class="lineno">  389</span>      p_vec=p_vec,</div>
<div class="line"><span class="lineno">  390</span>      i_vec=i_vec,</div>
<div class="line"><span class="lineno">  391</span>      epsilons=epsilons,</div>
<div class="line"><span class="lineno">  392</span>      num_null_cons=num_null_cons,</div>
<div class="line"><span class="lineno">  393</span>      num_redundant_cons=num_redundant_cons,</div>
<div class="line"><span class="lineno">  394</span>      num_removed_cons=num_removed_cons,</div>
<div class="line"><span class="lineno">  395</span>  )</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>  <span class="keywordflow">return</span> a_csr, e_vec, meta</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00842">open_spiel.python.algorithms.jpsro._approx_mgce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00806">open_spiel.python.algorithms.jpsro._mgce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00823">open_spiel.python.algorithms.jpsro._min_epsilon_mgce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00880">open_spiel.python.algorithms.jpsro._mwce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00865">open_spiel.python.algorithms.jpsro._rmwce()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00894">open_spiel.python.algorithms.jpsro._rvce()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a56d665dce6154126d104d54fe591e1f1_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a56d665dce6154126d104d54fe591e1f1_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a56d665dce6154126d104d54fe591e1f1_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a56d665dce6154126d104d54fe591e1f1_icgraph">
<area shape="rect" title=" " alt="" coords="322,149,548,190"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#af7f75702d8ed7ab14597c1630dd3d64d" title=" " alt="" coords="26,5,253,46"/>
<area shape="poly" title=" " alt="" coords="397,141,340,99,273,60,244,49,246,44,275,55,343,95,400,137"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ad22dbe6c241bb015a2847669c3718f4a" title=" " alt="" coords="7,70,272,96"/>
<area shape="poly" title=" " alt="" coords="371,146,273,111,223,99,225,94,274,106,373,141"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a88213c014022c5b5c252afd1bbfc580a" title=" " alt="" coords="26,120,253,161"/>
<area shape="poly" title=" " alt="" coords="306,160,253,154,254,149,306,154"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8e02827728f353354c401149aa6d3ed6" title=" " alt="" coords="5,185,274,210"/>
<area shape="poly" title=" " alt="" coords="306,185,274,188,274,182,306,179"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8495a428ade0a06e7dbb8d13e32c3e5b" title=" " alt="" coords="26,235,253,275"/>
<area shape="poly" title=" " alt="" coords="361,198,274,226,233,237,232,232,273,220,360,193"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#aed3a3a14fbbdf6ed8f536c449e33b1a9" title=" " alt="" coords="10,300,269,325"/>
<area shape="poly" title=" " alt="" coords="403,202,346,248,311,271,275,289,239,301,238,296,273,285,309,266,343,244,399,198"/>
</map>
</div>

</div>
</div>
<a id="afb970203419c20e35949d832b141af0d" name="afb970203419c20e35949d832b141af0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb970203419c20e35949d832b141af0d">&#9670;&#160;</a></span>_alpharank()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._alpharank </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">AlphaRank.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00791">791</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  791</span><span class="keyword">def </span>_alpharank(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  792</span>  <span class="stringliteral">&quot;&quot;&quot;AlphaRank.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  793</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> ignore_repeats:</div>
<div class="line"><span class="lineno">  794</span>    meta_game = _expand_meta_game(meta_game, per_player_repeats)</div>
<div class="line"><span class="lineno">  795</span>  meta_dist = alpharank_lib.sweep_pi_vs_epsilon([mg <span class="keywordflow">for</span> mg <span class="keywordflow">in</span> meta_game])</div>
<div class="line"><span class="lineno">  796</span>  meta_dist[meta_dist &lt; DIST_TOL] = 0.0</div>
<div class="line"><span class="lineno">  797</span>  meta_dist /= np.sum(meta_dist)</div>
<div class="line"><span class="lineno">  798</span>  meta_dist = np.reshape(meta_dist, meta_game.shape[1:])</div>
<div class="line"><span class="lineno">  799</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> ignore_repeats:</div>
<div class="line"><span class="lineno">  800</span>    meta_dist = _unexpand_meta_dist(meta_dist, per_player_repeats)</div>
<div class="line"><span class="lineno">  801</span>  <span class="keywordflow">return</span> meta_dist, dict()</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span><span class="comment"># Meta-solvers - CEs.</span></div>
<div class="line"><span class="lineno">  805</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4eca0d93cfa2a035d239a3a78861bf04" name="a4eca0d93cfa2a035d239a3a78861bf04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eca0d93cfa2a035d239a3a78861bf04">&#9670;&#160;</a></span>_approx_mgcce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._approx_mgcce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.01</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Maximum Gini CCE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00937">937</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  938</span>                  epsilon=0.01):</div>
<div class="line"><span class="lineno">  939</span>  <span class="stringliteral">&quot;&quot;&quot;Maximum Gini CCE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  940</span>  a_mat, meta = _cce_constraints(</div>
<div class="line"><span class="lineno">  941</span>      meta_game, [0.0] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  942</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  943</span>  max_ab = 0.0</div>
<div class="line"><span class="lineno">  944</span>  <span class="keywordflow">if</span> a_mat.size:</div>
<div class="line"><span class="lineno">  945</span>    max_ab = np.max(a_mat.mean(axis=1))</div>
<div class="line"><span class="lineno">  946</span>  a_mat, meta = _cce_constraints(</div>
<div class="line"><span class="lineno">  947</span>      meta_game, [epsilon * max_ab] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  948</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  949</span>  a_mats = _partition_by_player(</div>
<div class="line"><span class="lineno">  950</span>      a_mat, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  951</span>  dist, _ = _try_two_solvers(</div>
<div class="line"><span class="lineno">  952</span>      _qp_cce,</div>
<div class="line"><span class="lineno">  953</span>      meta_game, a_mats, [0.0] * len(per_player_repeats),</div>
<div class="line"><span class="lineno">  954</span>      action_repeats=(<span class="keywordtype">None</span> <span class="keywordflow">if</span> ignore_repeats <span class="keywordflow">else</span> per_player_repeats))</div>
<div class="line"><span class="lineno">  955</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00263">open_spiel.python.algorithms.jpsro._cce_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00251">open_spiel.python.algorithms.jpsro._partition_by_player()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4eca0d93cfa2a035d239a3a78861bf04_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4eca0d93cfa2a035d239a3a78861bf04_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4eca0d93cfa2a035d239a3a78861bf04_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4eca0d93cfa2a035d239a3a78861bf04_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab483f30928c3cf4f8e98b5b229e91dac" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a903fb5307a89eb117898edd5a05c0404" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
</map>
</div>

</div>
</div>
<a id="af7f75702d8ed7ab14597c1630dd3d64d" name="af7f75702d8ed7ab14597c1630dd3d64d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f75702d8ed7ab14597c1630dd3d64d">&#9670;&#160;</a></span>_approx_mgce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._approx_mgce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.01</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Approximate Maximum Gini CE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00841">841</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  842</span>                 epsilon=0.01):</div>
<div class="line"><span class="lineno">  843</span>  <span class="stringliteral">&quot;&quot;&quot;Approximate Maximum Gini CE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  844</span>  a_mat, e_vec, meta = _ace_constraints(</div>
<div class="line"><span class="lineno">  845</span>      meta_game, [0.0] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  846</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  847</span>  max_ab = 0.0</div>
<div class="line"><span class="lineno">  848</span>  <span class="keywordflow">if</span> a_mat.size:</div>
<div class="line"><span class="lineno">  849</span>    max_ab = np.max(a_mat.mean(axis=1))</div>
<div class="line"><span class="lineno">  850</span>  a_mat, e_vec, meta = _ace_constraints(</div>
<div class="line"><span class="lineno">  851</span>      meta_game, [epsilon * max_ab] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  852</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  853</span>  a_mats = _partition_by_player(</div>
<div class="line"><span class="lineno">  854</span>      a_mat, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  855</span>  e_vecs = _partition_by_player(</div>
<div class="line"><span class="lineno">  856</span>      e_vec, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  857</span>  dist, _ = _try_two_solvers(</div>
<div class="line"><span class="lineno">  858</span>      _qp_ce,</div>
<div class="line"><span class="lineno">  859</span>      meta_game, a_mats, e_vecs,</div>
<div class="line"><span class="lineno">  860</span>      action_repeats=(<span class="keywordtype">None</span> <span class="keywordflow">if</span> ignore_repeats <span class="keywordflow">else</span> per_player_repeats))</div>
<div class="line"><span class="lineno">  861</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00319">open_spiel.python.algorithms.jpsro._ace_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00251">open_spiel.python.algorithms.jpsro._partition_by_player()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af7f75702d8ed7ab14597c1630dd3d64d_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af7f75702d8ed7ab14597c1630dd3d64d_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af7f75702d8ed7ab14597c1630dd3d64d_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af7f75702d8ed7ab14597c1630dd3d64d_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a56d665dce6154126d104d54fe591e1f1" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a903fb5307a89eb117898edd5a05c0404" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
</map>
</div>

</div>
</div>
<a id="ab483f30928c3cf4f8e98b5b229e91dac" name="ab483f30928c3cf4f8e98b5b229e91dac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab483f30928c3cf4f8e98b5b229e91dac">&#9670;&#160;</a></span>_cce_constraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._cce_constraints </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>payoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epsilons</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>remove_null</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>zero_tolerance</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1e-8</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns the coarse correlated constraints.

Args:
  payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.
  epsilons: Per player floats corresponding to the epsilon.
  remove_null: Remove null rows of the constraint matrix.
  zero_tolerance: Zero out elements with small value.

Returns:
  a_mat: The gain matrix for deviting to an action or shape [SUM(A), PROD(A)].
  meta: Dictionary containing meta information.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00263">263</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  263</span><span class="keyword">def </span>_cce_constraints(payoff, epsilons, remove_null=True, zero_tolerance=1e-8):</div>
<div class="line"><span class="lineno">  264</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the coarse correlated constraints.</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    epsilons: Per player floats corresponding to the epsilon.</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    remove_null: Remove null rows of the constraint matrix.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">    zero_tolerance: Zero out elements with small value.</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    a_mat: The gain matrix for deviting to an action or shape [SUM(A), PROD(A)].</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    meta: Dictionary containing meta information.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  276</span>  num_players = payoff.shape[0]</div>
<div class="line"><span class="lineno">  277</span>  num_actions = payoff.shape[1:]</div>
<div class="line"><span class="lineno">  278</span>  num_dists = int(np.prod(num_actions))</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>  cor_cons = int(np.sum(num_actions))</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>  a_mat = np.zeros([cor_cons] + list(num_actions))</div>
<div class="line"><span class="lineno">  283</span>  p_vec = np.zeros([cor_cons], dtype=np.int32)</div>
<div class="line"><span class="lineno">  284</span>  i_vec = np.zeros([cor_cons], dtype=np.int32)</div>
<div class="line"><span class="lineno">  285</span>  con = 0</div>
<div class="line"><span class="lineno">  286</span>  <span class="keywordflow">for</span> p <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">for</span> a1 <span class="keywordflow">in</span> range(num_actions[p]):</div>
<div class="line"><span class="lineno">  288</span>      a1_inds = tuple(_indices(p, a1, num_players))</div>
<div class="line"><span class="lineno">  289</span>      <span class="keywordflow">for</span> a0 <span class="keywordflow">in</span> range(num_actions[p]):</div>
<div class="line"><span class="lineno">  290</span>        a0_inds = tuple(_indices(p, a0, num_players))</div>
<div class="line"><span class="lineno">  291</span>        a_mat[con][a0_inds] += payoff[p][a1_inds]</div>
<div class="line"><span class="lineno">  292</span>      a_mat[con] -= payoff[p]</div>
<div class="line"><span class="lineno">  293</span>      a_mat[con] -= epsilons[p]</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>      p_vec[con] = p</div>
<div class="line"><span class="lineno">  296</span>      i_vec[con] = a0</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>      con += 1</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>  a_mat = np.reshape(a_mat, [cor_cons, num_dists])</div>
<div class="line"><span class="lineno">  301</span>  a_mat[np.abs(a_mat) &lt; zero_tolerance] = 0.0</div>
<div class="line"><span class="lineno">  302</span>  <span class="keywordflow">if</span> remove_null:</div>
<div class="line"><span class="lineno">  303</span>    null_cons = np.any(a_mat != 0.0, axis=-1)</div>
<div class="line"><span class="lineno">  304</span>    redundant_cons = np.max(a_mat, axis=1) &gt;= 0</div>
<div class="line"><span class="lineno">  305</span>    nonzero_mask = null_cons &amp; redundant_cons</div>
<div class="line"><span class="lineno">  306</span>    a_mat = a_mat[nonzero_mask, :].copy()</div>
<div class="line"><span class="lineno">  307</span>    p_vec = p_vec[nonzero_mask].copy()</div>
<div class="line"><span class="lineno">  308</span>    i_vec = i_vec[nonzero_mask].copy()</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>  meta = dict(</div>
<div class="line"><span class="lineno">  311</span>      p_vec=p_vec,</div>
<div class="line"><span class="lineno">  312</span>      i_vec=i_vec,</div>
<div class="line"><span class="lineno">  313</span>      epsilons=epsilons,</div>
<div class="line"><span class="lineno">  314</span>  )</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  <span class="keywordflow">return</span> a_mat, meta</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00938">open_spiel.python.algorithms.jpsro._approx_mgcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00908">open_spiel.python.algorithms.jpsro._mgcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00922">open_spiel.python.algorithms.jpsro._min_epsilon_mgcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00973">open_spiel.python.algorithms.jpsro._mwcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00958">open_spiel.python.algorithms.jpsro._rmwcce()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00987">open_spiel.python.algorithms.jpsro._rvcce()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab483f30928c3cf4f8e98b5b229e91dac_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab483f30928c3cf4f8e98b5b229e91dac_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab483f30928c3cf4f8e98b5b229e91dac_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab483f30928c3cf4f8e98b5b229e91dac_icgraph">
<area shape="rect" title=" " alt="" coords="280,169,506,210"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4eca0d93cfa2a035d239a3a78861bf04" title=" " alt="" coords="5,5,232,46"/>
<area shape="poly" title=" " alt="" coords="359,160,302,110,267,84,230,61,202,49,204,44,233,57,270,79,305,106,363,156"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a5a8abe130b236a4ee05ab412a1b60d07" title=" " alt="" coords="5,71,232,111"/>
<area shape="poly" title=" " alt="" coords="329,165,231,127,193,114,194,109,233,122,331,160"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#af1536cda76732de105718747de0dac34" title=" " alt="" coords="5,136,232,177"/>
<area shape="poly" title=" " alt="" coords="264,177,232,173,233,167,264,171"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab121ccdb3d41d31d9aac3e730b212b29" title=" " alt="" coords="5,201,232,242"/>
<area shape="poly" title=" " alt="" coords="264,207,233,211,232,206,264,202"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#aa953e89ced52a2873ecbddd0433e3793" title=" " alt="" coords="5,267,232,307"/>
<area shape="poly" title=" " alt="" coords="330,219,233,256,194,269,193,264,231,251,328,214"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ad018b6ef5dd537fca76c7ca246dd5a08" title=" " alt="" coords="5,332,232,373"/>
<area shape="poly" title=" " alt="" coords="362,223,305,273,270,299,233,321,204,334,202,329,230,317,267,295,302,269,359,219"/>
</map>
</div>

</div>
</div>
<a id="a1ecffd8bee9243e1fb3aa8b805724ea2" name="a1ecffd8bee9243e1fb3aa8b805724ea2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ecffd8bee9243e1fb3aa8b805724ea2">&#9670;&#160;</a></span>_eliminate_dominated_decorator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._eliminate_dominated_decorator </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>func</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Wrap eliminate dominated.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00204">204</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  204</span><span class="keyword">def </span>_eliminate_dominated_decorator(func):</div>
<div class="line"><span class="lineno">  205</span>  <span class="stringliteral">&quot;&quot;&quot;Wrap eliminate dominated.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  206</span>  <span class="keyword">def </span>wrapper(payoff, per_player_repeats, *args, eliminate_dominated=True,</div>
<div class="line"><span class="lineno">  207</span>              **kwargs):</div>
<div class="line"><span class="lineno">  208</span>    epsilon = getattr(kwargs, <span class="stringliteral">&quot;epsilon&quot;</span>, 0.0)</div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> eliminate_dominated:</div>
<div class="line"><span class="lineno">  210</span>      <span class="keywordflow">return</span> func(payoff, *args, **kwargs)</div>
<div class="line"><span class="lineno">  211</span>    num_actions = payoff.shape[1:]</div>
<div class="line"><span class="lineno">  212</span>    (eliminated_payoff, action_labels, eliminated_action_repeats) = (</div>
<div class="line"><span class="lineno">  213</span>        _eliminate_dominated_payoff(</div>
<div class="line"><span class="lineno">  214</span>            payoff, epsilon, action_repeats=per_player_repeats</div>
<div class="line"><span class="lineno">  215</span>        )</div>
<div class="line"><span class="lineno">  216</span>    )</div>
<div class="line"><span class="lineno">  217</span>    eliminated_dist, meta = func(</div>
<div class="line"><span class="lineno">  218</span>        eliminated_payoff, eliminated_action_repeats, *args, **kwargs)</div>
<div class="line"><span class="lineno">  219</span>    meta[<span class="stringliteral">&quot;eliminated_dominated_dist&quot;</span>] = eliminated_dist</div>
<div class="line"><span class="lineno">  220</span>    meta[<span class="stringliteral">&quot;eliminated_dominated_payoff&quot;</span>] = eliminated_payoff</div>
<div class="line"><span class="lineno">  221</span>    dist = _reconstruct_dist(</div>
<div class="line"><span class="lineno">  222</span>        eliminated_dist, action_labels, num_actions)</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">return</span> dist, meta</div>
<div class="line"><span class="lineno">  224</span>  <span class="keywordflow">return</span> wrapper</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span><span class="comment"># Optimization.</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00149">open_spiel.python.algorithms.jpsro._eliminate_dominated_payoff()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00186">open_spiel.python.algorithms.jpsro._reconstruct_dist()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a1ecffd8bee9243e1fb3aa8b805724ea2_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a1ecffd8bee9243e1fb3aa8b805724ea2_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a1ecffd8bee9243e1fb3aa8b805724ea2_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a1ecffd8bee9243e1fb3aa8b805724ea2_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#aad7ae503e5047bc4f542bca363e7c6eb" title="Meta Solvers." alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a63355927bd6084c9498e36580294fd4f" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
</map>
</div>

</div>
</div>
<a id="aad7ae503e5047bc4f542bca363e7c6eb" name="aad7ae503e5047bc4f542bca363e7c6eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad7ae503e5047bc4f542bca363e7c6eb">&#9670;&#160;</a></span>_eliminate_dominated_payoff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._eliminate_dominated_payoff </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>payoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_labels</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>weakly</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Meta Solvers. </p>
<pre class="fragment">Eliminate epsilon dominated strategies.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00148">148</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>    payoff, epsilon, action_labels=<span class="keywordtype">None</span>, action_repeats=<span class="keywordtype">None</span>, weakly=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  150</span>  <span class="stringliteral">&quot;&quot;&quot;Eliminate epsilon dominated strategies.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  151</span>  num_players = payoff.shape[0]</div>
<div class="line"><span class="lineno">  152</span>  eliminated = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">if</span> action_labels <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  154</span>    action_labels = [np.arange(na, dtype=np.int32) <span class="keywordflow">for</span> na <span class="keywordflow">in</span> payoff.shape[1:]]</div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordflow">if</span> action_repeats <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  156</span>    action_repeats = [ar <span class="keywordflow">for</span> ar <span class="keywordflow">in</span> action_repeats]</div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">while</span> eliminated:</div>
<div class="line"><span class="lineno">  158</span>    eliminated = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">for</span> p <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  160</span>      <span class="keywordflow">if</span> epsilon &gt; 0.0:</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  162</span>      num_actions = payoff.shape[1:]</div>
<div class="line"><span class="lineno">  163</span>      <span class="keywordflow">if</span> num_actions[p] &lt;= 1:</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  165</span>      <span class="keywordflow">for</span> a <span class="keywordflow">in</span> range(num_actions[p]):</div>
<div class="line"><span class="lineno">  166</span>        index = [slice(<span class="keywordtype">None</span>) <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno">  167</span>        index[p] = slice(a, a+1)</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">if</span> weakly:</div>
<div class="line"><span class="lineno">  169</span>          diff = payoff[p] &lt;= payoff[p][tuple(index)]</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  171</span>          diff = payoff[p] &lt; payoff[p][tuple(index)]</div>
<div class="line"><span class="lineno">  172</span>        axis = tuple(range(p)) + tuple(range(p+1, num_players))</div>
<div class="line"><span class="lineno">  173</span>        less = np.all(diff, axis=axis)</div>
<div class="line"><span class="lineno">  174</span>        less[a] = <span class="keyword">False</span>  <span class="comment"># Action cannot eliminate itself.</span></div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">if</span> np.any(less):</div>
<div class="line"><span class="lineno">  176</span>          nonzero = np.nonzero(less)</div>
<div class="line"><span class="lineno">  177</span>          payoff = np.delete(payoff, nonzero, axis=p+1)</div>
<div class="line"><span class="lineno">  178</span>          action_labels[p] = np.delete(action_labels[p], nonzero)</div>
<div class="line"><span class="lineno">  179</span>          <span class="keywordflow">if</span> action_repeats <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  180</span>            action_repeats[p] = np.delete(action_repeats[p], nonzero)</div>
<div class="line"><span class="lineno">  181</span>          eliminated = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  182</span>          <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  183</span>  <span class="keywordflow">return</span> payoff, action_labels, action_repeats</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00204">open_spiel.python.algorithms.jpsro._eliminate_dominated_decorator()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aad7ae503e5047bc4f542bca363e7c6eb_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aad7ae503e5047bc4f542bca363e7c6eb_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aad7ae503e5047bc4f542bca363e7c6eb_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aad7ae503e5047bc4f542bca363e7c6eb_icgraph">
<area shape="rect" title="Meta Solvers." alt="" coords="280,5,506,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a1ecffd8bee9243e1fb3aa8b805724ea2" title=" " alt="" coords="5,5,232,46"/>
<area shape="poly" title=" " alt="" coords="264,28,232,28,232,23,264,23"/>
</map>
</div>

</div>
</div>
<a id="aad745bbf95be8a7fa90da91184ac5e11" name="aad745bbf95be8a7fa90da91184ac5e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad745bbf95be8a7fa90da91184ac5e11">&#9670;&#160;</a></span>_expand_meta_game()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._expand_meta_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00700">700</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  700</span><span class="keyword">def </span>_expand_meta_game(meta_game, per_player_repeats):</div>
<div class="line"><span class="lineno">  701</span>  num_players = meta_game.shape[0]</div>
<div class="line"><span class="lineno">  702</span>  <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  703</span>    meta_game = np.repeat(meta_game, per_player_repeats[player], axis=player+1)</div>
<div class="line"><span class="lineno">  704</span>  <span class="keywordflow">return</span> meta_game</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0759318e8d0ae3a8bda1f98b88c6eeb" name="ab0759318e8d0ae3a8bda1f98b88c6eeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0759318e8d0ae3a8bda1f98b88c6eeb">&#9670;&#160;</a></span>_get_repeat_factor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._get_repeat_factor </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_repeats</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns the repeat factors for the game.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00400">400</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  400</span><span class="keyword">def </span>_get_repeat_factor(action_repeats):</div>
<div class="line"><span class="lineno">  401</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the repeat factors for the game.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  402</span>  num_players = len(action_repeats)</div>
<div class="line"><span class="lineno">  403</span>  out_labels = string.ascii_lowercase[:len(action_repeats)]</div>
<div class="line"><span class="lineno">  404</span>  in_labels = <span class="stringliteral">&quot;,&quot;</span>.join(out_labels)</div>
<div class="line"><span class="lineno">  405</span>  repeat_factor = np.ravel(np.einsum(</div>
<div class="line"><span class="lineno">  406</span>      <span class="stringliteral">&quot;{}-&gt;{}&quot;</span>.format(in_labels, out_labels), *action_repeats))</div>
<div class="line"><span class="lineno">  407</span>  indiv_repeat_factors = []</div>
<div class="line"><span class="lineno">  408</span>  <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  409</span>    action_repeats_ = [</div>
<div class="line"><span class="lineno">  410</span>        np.ones_like(ar) <span class="keywordflow">if</span> player == p <span class="keywordflow">else</span> ar</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">for</span> p, ar <span class="keywordflow">in</span> enumerate(action_repeats)]</div>
<div class="line"><span class="lineno">  412</span>    indiv_repeat_factor = np.ravel(np.einsum(</div>
<div class="line"><span class="lineno">  413</span>        <span class="stringliteral">&quot;{}-&gt;{}&quot;</span>.format(in_labels, out_labels), *action_repeats_))</div>
<div class="line"><span class="lineno">  414</span>    indiv_repeat_factors.append(indiv_repeat_factor)</div>
<div class="line"><span class="lineno">  415</span>  <span class="keywordflow">return</span> repeat_factor, indiv_repeat_factors</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span><span class="comment"># Solvers.</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00425">open_spiel.python.algorithms.jpsro._linear()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00512">open_spiel.python.algorithms.jpsro._qp_cce()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00609">open_spiel.python.algorithms.jpsro._qp_ce()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab0759318e8d0ae3a8bda1f98b88c6eeb_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab0759318e8d0ae3a8bda1f98b88c6eeb_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab0759318e8d0ae3a8bda1f98b88c6eeb_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab0759318e8d0ae3a8bda1f98b88c6eeb_icgraph">
<area shape="rect" title=" " alt="" coords="596,219,822,259"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a07dcf5203af3455327b4adca910c3798" title=" " alt="" coords="322,153,548,194"/>
<area shape="poly" title=" " alt="" coords="605,217,523,197,524,192,606,212"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a43430cdc89f420c4709947ab62b37102" title=" " alt="" coords="322,219,548,259"/>
<area shape="poly" title=" " alt="" coords="580,242,549,242,549,236,580,236"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a971028ec7c3bf12ceb9469ff7bb3d588" title=" " alt="" coords="322,284,548,325"/>
<area shape="poly" title=" " alt="" coords="606,266,524,286,523,281,605,261"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab121ccdb3d41d31d9aac3e730b212b29" title=" " alt="" coords="26,5,253,46"/>
<area shape="poly" title=" " alt="" coords="398,145,341,101,308,79,273,60,244,49,246,44,275,55,310,74,345,97,401,141"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8e02827728f353354c401149aa6d3ed6" title=" " alt="" coords="5,70,274,96"/>
<area shape="poly" title=" " alt="" coords="374,149,273,111,224,99,226,94,274,106,376,144"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#aa953e89ced52a2873ecbddd0433e3793" title=" " alt="" coords="26,120,253,161"/>
<area shape="poly" title=" " alt="" coords="306,162,253,156,254,150,307,157"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8495a428ade0a06e7dbb8d13e32c3e5b" title=" " alt="" coords="26,185,253,226"/>
<area shape="poly" title=" " alt="" coords="307,190,254,196,253,191,306,185"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ad018b6ef5dd537fca76c7ca246dd5a08" title=" " alt="" coords="26,251,253,291"/>
<area shape="poly" title=" " alt="" coords="340,202,323,209,299,225,275,240,241,253,239,248,272,235,296,220,320,205,338,197"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#aed3a3a14fbbdf6ed8f536c449e33b1a9" title=" " alt="" coords="10,316,269,341"/>
<area shape="poly" title=" " alt="" coords="329,204,323,209,313,220,307,232,301,256,295,281,287,294,275,305,254,317,252,313,272,301,283,290,290,279,296,255,302,230,309,217,320,205,326,200"/>
</map>
</div>

</div>
</div>
<a id="a000ca7f1d77fc727efa5c341d3dd0e4f" name="a000ca7f1d77fc727efa5c341d3dd0e4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000ca7f1d77fc727efa5c341d3dd0e4f">&#9670;&#160;</a></span>_indices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._indices </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_players</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00241">241</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  241</span><span class="keyword">def </span>_indices(p, a, num_players):</div>
<div class="line"><span class="lineno">  242</span>  <span class="keywordflow">return</span> [a <span class="keywordflow">if</span> p_ == p <span class="keywordflow">else</span> slice(<span class="keywordtype">None</span>) <span class="keywordflow">for</span> p_ <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a07dcf5203af3455327b4adca910c3798" name="a07dcf5203af3455327b4adca910c3798"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07dcf5203af3455327b4adca910c3798">&#9670;&#160;</a></span>_linear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._linear </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>payoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a_mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>e_vec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>solver_kwargs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cost</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns linear solution.

This is a linear program.

Args:
  payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.
  a_mat: Constaint matrix.
  e_vec: Epsilon vector.
  action_repeats: List of action repeat counts.
  solver_kwargs: Solver kwargs.
  cost: Cost function of same shape as payoff.

Returns:
  An epsilon-correlated equilibrium.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00419">419</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>    cost=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  426</span>  <span class="stringliteral">&quot;&quot;&quot;Returns linear solution.</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">  This is a linear program.</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">    payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">    a_mat: Constaint matrix.</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    e_vec: Epsilon vector.</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    action_repeats: List of action repeat counts.</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">    solver_kwargs: Solver kwargs.</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">    cost: Cost function of same shape as payoff.</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">    An epsilon-correlated equilibrium.</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  441</span>  num_players = payoff.shape[0]</div>
<div class="line"><span class="lineno">  442</span>  num_actions = payoff.shape[1:]</div>
<div class="line"><span class="lineno">  443</span>  num_dists = int(np.prod(num_actions))</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>  <span class="keywordflow">if</span> solver_kwargs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  446</span>    solver_kwargs = DEFAULT_ECOS_SOLVER_KWARGS</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>  <span class="keywordflow">if</span> a_mat.shape[0] &gt; 0:</div>
<div class="line"><span class="lineno">  449</span>    <span class="comment"># Variables.</span></div>
<div class="line"><span class="lineno">  450</span>    x = cp.Variable(num_dists, nonneg=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    <span class="comment"># Classifier.</span></div>
<div class="line"><span class="lineno">  453</span>    epsilon_dists = cp.matmul(a_mat, x) - e_vec</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="comment"># Constraints.</span></div>
<div class="line"><span class="lineno">  456</span>    dist_eq_con = cp.sum(x) == 1</div>
<div class="line"><span class="lineno">  457</span>    cor_lb_con = epsilon_dists &lt;= 0</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    <span class="comment"># Objective.</span></div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span> cost <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  461</span>      player_totals = [</div>
<div class="line"><span class="lineno">  462</span>          cp.sum(cp.multiply(payoff[p].flat, x)) <span class="keywordflow">for</span> p <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno">  463</span>      reward = cp.sum(player_totals)</div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  465</span>      reward = cp.sum(cp.multiply(cost.flat, x))</div>
<div class="line"><span class="lineno">  466</span>    obj = cp.Maximize(reward)</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>    prob = cp.Problem(obj, [</div>
<div class="line"><span class="lineno">  469</span>        dist_eq_con,</div>
<div class="line"><span class="lineno">  470</span>        cor_lb_con,</div>
<div class="line"><span class="lineno">  471</span>    ])</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="comment"># Solve.</span></div>
<div class="line"><span class="lineno">  474</span>    prob.solve(**solver_kwargs)</div>
<div class="line"><span class="lineno">  475</span>    status = prob.status</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <span class="comment"># Distribution.</span></div>
<div class="line"><span class="lineno">  478</span>    dist = np.reshape(x.value, num_actions)</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="comment"># Other.</span></div>
<div class="line"><span class="lineno">  481</span>    val = reward.value</div>
<div class="line"><span class="lineno">  482</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> action_repeats <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  484</span>      repeat_factor, _ = _get_repeat_factor(action_repeats)</div>
<div class="line"><span class="lineno">  485</span>      x = repeat_factor / np.sum(repeat_factor)</div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  487</span>      x = np.ones([num_dists]) / num_dists</div>
<div class="line"><span class="lineno">  488</span>    val = 0.0  <span class="comment"># Fix me.</span></div>
<div class="line"><span class="lineno">  489</span>    dist = np.reshape(x, num_actions)</div>
<div class="line"><span class="lineno">  490</span>    status = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>  meta = dict(</div>
<div class="line"><span class="lineno">  493</span>      x=x,</div>
<div class="line"><span class="lineno">  494</span>      a_mat=a_mat,</div>
<div class="line"><span class="lineno">  495</span>      val=val,</div>
<div class="line"><span class="lineno">  496</span>      status=status,</div>
<div class="line"><span class="lineno">  497</span>      payoff=payoff,</div>
<div class="line"><span class="lineno">  498</span>      consistent=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  499</span>      unique=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  500</span>  )</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>  <span class="keywordflow">return</span> dist, meta</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00400">open_spiel.python.algorithms.jpsro._get_repeat_factor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00973">open_spiel.python.algorithms.jpsro._mwcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00880">open_spiel.python.algorithms.jpsro._mwce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00958">open_spiel.python.algorithms.jpsro._rmwcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00865">open_spiel.python.algorithms.jpsro._rmwce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00987">open_spiel.python.algorithms.jpsro._rvcce()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00894">open_spiel.python.algorithms.jpsro._rvce()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,232,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,23,264,23,264,28,232,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a07dcf5203af3455327b4adca910c3798_icgraph">
<area shape="rect" title=" " alt="" coords="322,153,548,194"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab121ccdb3d41d31d9aac3e730b212b29" title=" " alt="" coords="26,5,253,46"/>
<area shape="poly" title=" " alt="" coords="398,145,341,101,308,79,273,60,244,49,246,44,275,55,310,74,345,97,401,141"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8e02827728f353354c401149aa6d3ed6" title=" " alt="" coords="5,70,274,96"/>
<area shape="poly" title=" " alt="" coords="374,149,273,111,224,99,226,94,274,106,376,144"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#aa953e89ced52a2873ecbddd0433e3793" title=" " alt="" coords="26,120,253,161"/>
<area shape="poly" title=" " alt="" coords="306,162,253,156,254,150,307,157"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8495a428ade0a06e7dbb8d13e32c3e5b" title=" " alt="" coords="26,185,253,226"/>
<area shape="poly" title=" " alt="" coords="307,190,254,196,253,191,306,185"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ad018b6ef5dd537fca76c7ca246dd5a08" title=" " alt="" coords="26,251,253,291"/>
<area shape="poly" title=" " alt="" coords="373,203,275,240,232,253,231,247,273,235,371,198"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#aed3a3a14fbbdf6ed8f536c449e33b1a9" title=" " alt="" coords="10,316,269,341"/>
<area shape="poly" title=" " alt="" coords="406,207,349,258,313,284,275,305,241,317,240,312,273,301,310,280,345,254,402,203"/>
</map>
</div>

</div>
</div>
<a id="a5a8abe130b236a4ee05ab412a1b60d07" name="a5a8abe130b236a4ee05ab412a1b60d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a8abe130b236a4ee05ab412a1b60d07">&#9670;&#160;</a></span>_mgcce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._mgcce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Maximum Gini CCE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00908">908</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  908</span><span class="keyword">def </span>_mgcce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  909</span>  <span class="stringliteral">&quot;&quot;&quot;Maximum Gini CCE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  910</span>  a_mat, meta = _cce_constraints(</div>
<div class="line"><span class="lineno">  911</span>      meta_game, [0.0] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  912</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  913</span>  a_mats = _partition_by_player(</div>
<div class="line"><span class="lineno">  914</span>      a_mat, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  915</span>  dist, _ = _try_two_solvers(</div>
<div class="line"><span class="lineno">  916</span>      _qp_cce,</div>
<div class="line"><span class="lineno">  917</span>      meta_game, a_mats, [0.0] * len(per_player_repeats),</div>
<div class="line"><span class="lineno">  918</span>      action_repeats=(<span class="keywordtype">None</span> <span class="keywordflow">if</span> ignore_repeats <span class="keywordflow">else</span> per_player_repeats))</div>
<div class="line"><span class="lineno">  919</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00263">open_spiel.python.algorithms.jpsro._cce_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00251">open_spiel.python.algorithms.jpsro._partition_by_player()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5a8abe130b236a4ee05ab412a1b60d07_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5a8abe130b236a4ee05ab412a1b60d07_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5a8abe130b236a4ee05ab412a1b60d07_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5a8abe130b236a4ee05ab412a1b60d07_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab483f30928c3cf4f8e98b5b229e91dac" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a903fb5307a89eb117898edd5a05c0404" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
</map>
</div>

</div>
</div>
<a id="ad22dbe6c241bb015a2847669c3718f4a" name="ad22dbe6c241bb015a2847669c3718f4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad22dbe6c241bb015a2847669c3718f4a">&#9670;&#160;</a></span>_mgce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._mgce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Maximum Gini CE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00806">806</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  806</span><span class="keyword">def </span>_mgce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  807</span>  <span class="stringliteral">&quot;&quot;&quot;Maximum Gini CE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  808</span>  a_mat, e_vec, meta = _ace_constraints(</div>
<div class="line"><span class="lineno">  809</span>      meta_game, [0.0] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  810</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  811</span>  a_mats = _partition_by_player(</div>
<div class="line"><span class="lineno">  812</span>      a_mat, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  813</span>  e_vecs = _partition_by_player(</div>
<div class="line"><span class="lineno">  814</span>      e_vec, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  815</span>  dist, _ = _try_two_solvers(</div>
<div class="line"><span class="lineno">  816</span>      _qp_ce,</div>
<div class="line"><span class="lineno">  817</span>      meta_game, a_mats, e_vecs,</div>
<div class="line"><span class="lineno">  818</span>      action_repeats=(<span class="keywordtype">None</span> <span class="keywordflow">if</span> ignore_repeats <span class="keywordflow">else</span> per_player_repeats))</div>
<div class="line"><span class="lineno">  819</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00319">open_spiel.python.algorithms.jpsro._ace_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00251">open_spiel.python.algorithms.jpsro._partition_by_player()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad22dbe6c241bb015a2847669c3718f4a_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad22dbe6c241bb015a2847669c3718f4a_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad22dbe6c241bb015a2847669c3718f4a_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad22dbe6c241bb015a2847669c3718f4a_cgraph">
<area shape="rect" title=" " alt="" coords="5,46,271,72"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a56d665dce6154126d104d54fe591e1f1" title=" " alt="" coords="319,5,545,46"/>
<area shape="poly" title=" " alt="" coords="257,43,303,38,303,43,257,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a903fb5307a89eb117898edd5a05c0404" title=" " alt="" coords="319,71,545,111"/>
<area shape="poly" title=" " alt="" coords="262,70,303,74,303,80,262,75"/>
</map>
</div>

</div>
</div>
<a id="af1536cda76732de105718747de0dac34" name="af1536cda76732de105718747de0dac34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1536cda76732de105718747de0dac34">&#9670;&#160;</a></span>_min_epsilon_mgcce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._min_epsilon_mgcce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Min Epsilon Maximum Gini CCE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00922">922</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  922</span><span class="keyword">def </span>_min_epsilon_mgcce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  923</span>  <span class="stringliteral">&quot;&quot;&quot;Min Epsilon Maximum Gini CCE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  924</span>  a_mat, meta = _cce_constraints(</div>
<div class="line"><span class="lineno">  925</span>      meta_game, [0.0] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  926</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  927</span>  a_mats = _partition_by_player(</div>
<div class="line"><span class="lineno">  928</span>      a_mat, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  929</span>  dist, _ = _try_two_solvers(</div>
<div class="line"><span class="lineno">  930</span>      _qp_cce,</div>
<div class="line"><span class="lineno">  931</span>      meta_game, a_mats, [0.0] * len(per_player_repeats),</div>
<div class="line"><span class="lineno">  932</span>      action_repeats=(<span class="keywordtype">None</span> <span class="keywordflow">if</span> ignore_repeats <span class="keywordflow">else</span> per_player_repeats),</div>
<div class="line"><span class="lineno">  933</span>      min_epsilon=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  934</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00263">open_spiel.python.algorithms.jpsro._cce_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00251">open_spiel.python.algorithms.jpsro._partition_by_player()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af1536cda76732de105718747de0dac34_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af1536cda76732de105718747de0dac34_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af1536cda76732de105718747de0dac34_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af1536cda76732de105718747de0dac34_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab483f30928c3cf4f8e98b5b229e91dac" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a903fb5307a89eb117898edd5a05c0404" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
</map>
</div>

</div>
</div>
<a id="a88213c014022c5b5c252afd1bbfc580a" name="a88213c014022c5b5c252afd1bbfc580a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88213c014022c5b5c252afd1bbfc580a">&#9670;&#160;</a></span>_min_epsilon_mgce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._min_epsilon_mgce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Min Epsilon Maximum Gini CE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00823">823</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  823</span><span class="keyword">def </span>_min_epsilon_mgce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  824</span>  <span class="stringliteral">&quot;&quot;&quot;Min Epsilon Maximum Gini CE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  825</span>  a_mat, e_vec, meta = _ace_constraints(</div>
<div class="line"><span class="lineno">  826</span>      meta_game, [0.0] * len(per_player_repeats), remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  827</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  828</span>  a_mats = _partition_by_player(</div>
<div class="line"><span class="lineno">  829</span>      a_mat, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  830</span>  e_vecs = _partition_by_player(</div>
<div class="line"><span class="lineno">  831</span>      e_vec, meta[<span class="stringliteral">&quot;p_vec&quot;</span>], len(per_player_repeats))</div>
<div class="line"><span class="lineno">  832</span>  dist, _ = _try_two_solvers(</div>
<div class="line"><span class="lineno">  833</span>      _qp_ce,</div>
<div class="line"><span class="lineno">  834</span>      meta_game, a_mats, e_vecs,</div>
<div class="line"><span class="lineno">  835</span>      action_repeats=(<span class="keywordtype">None</span> <span class="keywordflow">if</span> ignore_repeats <span class="keywordflow">else</span> per_player_repeats),</div>
<div class="line"><span class="lineno">  836</span>      min_epsilon=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  837</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00319">open_spiel.python.algorithms.jpsro._ace_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00251">open_spiel.python.algorithms.jpsro._partition_by_player()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a88213c014022c5b5c252afd1bbfc580a_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a88213c014022c5b5c252afd1bbfc580a_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a88213c014022c5b5c252afd1bbfc580a_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a88213c014022c5b5c252afd1bbfc580a_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a56d665dce6154126d104d54fe591e1f1" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a903fb5307a89eb117898edd5a05c0404" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
</map>
</div>

</div>
</div>
<a id="ab121ccdb3d41d31d9aac3e730b212b29" name="ab121ccdb3d41d31d9aac3e730b212b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab121ccdb3d41d31d9aac3e730b212b29">&#9670;&#160;</a></span>_mwcce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._mwcce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Maximum welfare CCE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00973">973</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  973</span><span class="keyword">def </span>_mwcce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  974</span>  <span class="stringliteral">&quot;&quot;&quot;Maximum welfare CCE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  975</span>  del ignore_repeats</div>
<div class="line"><span class="lineno">  976</span>  num_players = len(per_player_repeats)</div>
<div class="line"><span class="lineno">  977</span>  cost = np.ravel(np.sum(meta_game, axis=0))</div>
<div class="line"><span class="lineno">  978</span>  a_mat, _ = _cce_constraints(</div>
<div class="line"><span class="lineno">  979</span>      meta_game, [0.0] * num_players, remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  980</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  981</span>  e_vec = np.zeros([a_mat.shape[0]])</div>
<div class="line"><span class="lineno">  982</span>  x, _ = _linear(meta_game, a_mat, e_vec, cost=cost)</div>
<div class="line"><span class="lineno">  983</span>  dist = np.reshape(x, meta_game.shape[1:])</div>
<div class="line"><span class="lineno">  984</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00263">open_spiel.python.algorithms.jpsro._cce_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00425">open_spiel.python.algorithms.jpsro._linear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab121ccdb3d41d31d9aac3e730b212b29_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab121ccdb3d41d31d9aac3e730b212b29_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab121ccdb3d41d31d9aac3e730b212b29_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab121ccdb3d41d31d9aac3e730b212b29_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab483f30928c3cf4f8e98b5b229e91dac" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a07dcf5203af3455327b4adca910c3798" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="554,71,780,111"/>
<area shape="poly" title=" " alt="" coords="507,88,538,88,538,94,507,94"/>
</map>
</div>

</div>
</div>
<a id="a8e02827728f353354c401149aa6d3ed6" name="a8e02827728f353354c401149aa6d3ed6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e02827728f353354c401149aa6d3ed6">&#9670;&#160;</a></span>_mwce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._mwce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Maximum welfare CE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00880">880</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  880</span><span class="keyword">def </span>_mwce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  881</span>  <span class="stringliteral">&quot;&quot;&quot;Maximum welfare CE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  882</span>  del ignore_repeats</div>
<div class="line"><span class="lineno">  883</span>  num_players = len(per_player_repeats)</div>
<div class="line"><span class="lineno">  884</span>  cost = np.ravel(np.sum(meta_game, axis=0))</div>
<div class="line"><span class="lineno">  885</span>  a_mat, e_vec, _ = _ace_constraints(</div>
<div class="line"><span class="lineno">  886</span>      meta_game, [0.0] * num_players, remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  887</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  888</span>  x, _ = _linear(meta_game, a_mat, e_vec, cost=cost)</div>
<div class="line"><span class="lineno">  889</span>  dist = np.reshape(x, meta_game.shape[1:])</div>
<div class="line"><span class="lineno">  890</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00319">open_spiel.python.algorithms.jpsro._ace_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00425">open_spiel.python.algorithms.jpsro._linear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8e02827728f353354c401149aa6d3ed6_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8e02827728f353354c401149aa6d3ed6_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8e02827728f353354c401149aa6d3ed6_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8e02827728f353354c401149aa6d3ed6_cgraph">
<area shape="rect" title=" " alt="" coords="5,46,274,72"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a56d665dce6154126d104d54fe591e1f1" title=" " alt="" coords="322,5,548,46"/>
<area shape="poly" title=" " alt="" coords="259,43,306,38,306,43,259,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a07dcf5203af3455327b4adca910c3798" title=" " alt="" coords="322,71,548,111"/>
<area shape="poly" title=" " alt="" coords="264,70,306,74,306,80,264,75"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="596,71,822,111"/>
<area shape="poly" title=" " alt="" coords="549,88,580,88,580,94,549,94"/>
</map>
</div>

</div>
</div>
<a id="a903fb5307a89eb117898edd5a05c0404" name="a903fb5307a89eb117898edd5a05c0404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a903fb5307a89eb117898edd5a05c0404">&#9670;&#160;</a></span>_partition_by_player()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._partition_by_player </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>p_vec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_players</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Partitions a value by the players vector.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00251">251</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span><span class="keyword">def </span>_partition_by_player(val, p_vec, num_players):</div>
<div class="line"><span class="lineno">  252</span>  <span class="stringliteral">&quot;&quot;&quot;Partitions a value by the players vector.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  253</span>  parts = []</div>
<div class="line"><span class="lineno">  254</span>  <span class="keywordflow">for</span> p <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  255</span>    inds = p_vec == p</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> inds.size &gt; 0:</div>
<div class="line"><span class="lineno">  257</span>      parts.append(val[inds])</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  259</span>      parts.append(<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  260</span>  <span class="keywordflow">return</span> parts</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00938">open_spiel.python.algorithms.jpsro._approx_mgcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00842">open_spiel.python.algorithms.jpsro._approx_mgce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00908">open_spiel.python.algorithms.jpsro._mgcce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00806">open_spiel.python.algorithms.jpsro._mgce()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00922">open_spiel.python.algorithms.jpsro._min_epsilon_mgcce()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00823">open_spiel.python.algorithms.jpsro._min_epsilon_mgce()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a903fb5307a89eb117898edd5a05c0404_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a903fb5307a89eb117898edd5a05c0404_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a903fb5307a89eb117898edd5a05c0404_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a903fb5307a89eb117898edd5a05c0404_icgraph">
<area shape="rect" title=" " alt="" coords="319,165,545,206"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4eca0d93cfa2a035d239a3a78861bf04" title=" " alt="" coords="25,5,251,46"/>
<area shape="poly" title=" " alt="" coords="398,157,341,107,306,83,269,61,239,49,241,44,272,57,309,78,344,103,401,152"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#af7f75702d8ed7ab14597c1630dd3d64d" title=" " alt="" coords="25,71,251,111"/>
<area shape="poly" title=" " alt="" coords="366,162,270,127,227,115,229,109,271,122,367,157"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a5a8abe130b236a4ee05ab412a1b60d07" title=" " alt="" coords="25,136,251,177"/>
<area shape="poly" title=" " alt="" coords="303,176,251,170,252,165,304,170"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ad22dbe6c241bb015a2847669c3718f4a" title=" " alt="" coords="5,201,271,226"/>
<area shape="poly" title=" " alt="" coords="304,201,271,204,271,198,303,195"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#af1536cda76732de105718747de0dac34" title=" " alt="" coords="25,251,251,291"/>
<area shape="poly" title=" " alt="" coords="358,214,271,242,230,253,229,247,270,236,357,209"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a88213c014022c5b5c252afd1bbfc580a" title=" " alt="" coords="25,316,251,357"/>
<area shape="poly" title=" " alt="" coords="398,219,341,264,272,305,240,318,238,313,269,301,338,259,395,214"/>
</map>
</div>

</div>
</div>
<a id="a2d842806c8cc535737798c3da2520b51" name="a2d842806c8cc535737798c3da2520b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d842806c8cc535737798c3da2520b51">&#9670;&#160;</a></span>_prd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._prd </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Projected replicator dynamics.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00775">775</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  775</span><span class="keyword">def </span>_prd(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  776</span>  <span class="stringliteral">&quot;&quot;&quot;Projected replicator dynamics.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  777</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> ignore_repeats:</div>
<div class="line"><span class="lineno">  778</span>    meta_game = _expand_meta_game(meta_game, per_player_repeats)</div>
<div class="line"><span class="lineno">  779</span>  meta_dist = projected_replicator_dynamics.projected_replicator_dynamics(</div>
<div class="line"><span class="lineno">  780</span>      meta_game)</div>
<div class="line"><span class="lineno">  781</span>  labels = string.ascii_lowercase[:len(meta_dist)]</div>
<div class="line"><span class="lineno">  782</span>  comma_labels = <span class="stringliteral">&quot;,&quot;</span>.join(labels)</div>
<div class="line"><span class="lineno">  783</span>  meta_dist = np.einsum(<span class="stringliteral">&quot;{}-&gt;{}&quot;</span>.format(comma_labels, labels), *meta_dist)</div>
<div class="line"><span class="lineno">  784</span>  meta_dist[meta_dist &lt; DIST_TOL] = 0.0</div>
<div class="line"><span class="lineno">  785</span>  meta_dist /= np.sum(meta_dist)</div>
<div class="line"><span class="lineno">  786</span>  meta_dist = _unexpand_meta_dist(meta_dist, per_player_repeats)</div>
<div class="line"><span class="lineno">  787</span>  <span class="keywordflow">return</span> meta_dist, dict()</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43430cdc89f420c4709947ab62b37102" name="a43430cdc89f420c4709947ab62b37102"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43430cdc89f420c4709947ab62b37102">&#9670;&#160;</a></span>_qp_cce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._qp_cce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>payoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a_mats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>e_vecs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>assume_full_support</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>solver_kwargs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>min_epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns the correlated equilibrium with maximum Gini impurity.

Args:
  payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.
  a_mats: A [NUM_CON, PROD(A)] shape gain tensor.
  e_vecs: Epsilon vector.
  assume_full_support: Whether to ignore beta values.
  action_repeats: Vector of action repeats for each player.
  solver_kwargs: Additional kwargs for solver.
  min_epsilon: Whether to minimize epsilon.

Returns:
  An epsilon-correlated equilibrium.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00505">505</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  512</span>    min_epsilon=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  513</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the correlated equilibrium with maximum Gini impurity.</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">    payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">    a_mats: A [NUM_CON, PROD(A)] shape gain tensor.</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">    e_vecs: Epsilon vector.</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">    assume_full_support: Whether to ignore beta values.</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">    action_repeats: Vector of action repeats for each player.</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">    solver_kwargs: Additional kwargs for solver.</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">    min_epsilon: Whether to minimize epsilon.</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">    An epsilon-correlated equilibrium.</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  527</span>  num_players = payoff.shape[0]</div>
<div class="line"><span class="lineno">  528</span>  num_actions = payoff.shape[1:]</div>
<div class="line"><span class="lineno">  529</span>  num_dists = int(np.prod(num_actions))</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>  <span class="keywordflow">if</span> solver_kwargs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  532</span>    solver_kwargs = DEFAULT_OSQP_SOLVER_KWARGS</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>  epsilon = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  535</span>  nonzero_cons = [a_mat.shape[0] &gt; 0 <span class="keywordflow">for</span> a_mat <span class="keywordflow">in</span> a_mats <span class="keywordflow">if</span> a_mat <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  536</span>  <span class="keywordflow">if</span> any(nonzero_cons):</div>
<div class="line"><span class="lineno">  537</span>    x = cp.Variable(num_dists, nonneg=(<span class="keywordflow">not</span> assume_full_support))</div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordflow">if</span> min_epsilon:</div>
<div class="line"><span class="lineno">  539</span>      epsilon = cp.Variable(nonpos=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  540</span>      e_vecs = [epsilon] * num_players</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">if</span> action_repeats <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  543</span>      repeat_factor, _ = _get_repeat_factor(action_repeats)</div>
<div class="line"><span class="lineno">  544</span>      x_repeated = cp.multiply(x, repeat_factor)</div>
<div class="line"><span class="lineno">  545</span>      dist_eq_con = cp.sum(x_repeated) == 1</div>
<div class="line"><span class="lineno">  546</span>      cor_lb_cons = [</div>
<div class="line"><span class="lineno">  547</span>          cp.matmul(a_mat, cp.multiply(x, repeat_factor)) &lt;= e_vec</div>
<div class="line"><span class="lineno">  548</span>          <span class="keywordflow">for</span> a_mat, e_vec <span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">  549</span>          zip(a_mats, e_vecs) <span class="keywordflow">if</span> a_mat.size &gt; 0]</div>
<div class="line"><span class="lineno">  550</span>      eye = sp.sparse.diags(repeat_factor)</div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  552</span>      repeat_factor = 1</div>
<div class="line"><span class="lineno">  553</span>      x_repeated = x</div>
<div class="line"><span class="lineno">  554</span>      dist_eq_con = cp.sum(x_repeated) == 1</div>
<div class="line"><span class="lineno">  555</span>      cor_lb_cons = [</div>
<div class="line"><span class="lineno">  556</span>          cp.matmul(a_mat, x) &lt;= e_vec <span class="keywordflow">for</span> a_mat, e_vec <span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">  557</span>          zip(a_mats, e_vecs) <span class="keywordflow">if</span> a_mat.size &gt; 0]</div>
<div class="line"><span class="lineno">  558</span>      eye = sp.sparse.eye(num_dists)</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>    <span class="comment"># This is more memory efficient than using cp.sum_squares.</span></div>
<div class="line"><span class="lineno">  561</span>    cost = 1 - cp.quad_form(x, eye)</div>
<div class="line"><span class="lineno">  562</span>    <span class="keywordflow">if</span> min_epsilon:</div>
<div class="line"><span class="lineno">  563</span>      cost -= cp.multiply(2, epsilon)</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    obj = cp.Maximize(cost)</div>
<div class="line"><span class="lineno">  566</span>    prob = cp.Problem(obj, [dist_eq_con] + cor_lb_cons)</div>
<div class="line"><span class="lineno">  567</span>    cost_value = prob.solve(**solver_kwargs)</div>
<div class="line"><span class="lineno">  568</span>    status = prob.status</div>
<div class="line"><span class="lineno">  569</span>    alphas = [cor_lb_con.dual_value <span class="keywordflow">for</span> cor_lb_con <span class="keywordflow">in</span> cor_lb_cons]</div>
<div class="line"><span class="lineno">  570</span>    lamb = dist_eq_con.dual_value</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>    val = cost.value</div>
<div class="line"><span class="lineno">  573</span>    x = x_repeated.value</div>
<div class="line"><span class="lineno">  574</span>    dist = np.reshape(x, num_actions)</div>
<div class="line"><span class="lineno">  575</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  576</span>    cost_value = 0.0</div>
<div class="line"><span class="lineno">  577</span>    val = 1 - 1 / num_dists</div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">if</span> action_repeats <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  579</span>      repeat_factor, _ = _get_repeat_factor(action_repeats)</div>
<div class="line"><span class="lineno">  580</span>      x = repeat_factor / np.sum(repeat_factor)</div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  582</span>      x = np.ones([num_dists]) / num_dists</div>
<div class="line"><span class="lineno">  583</span>    dist = np.reshape(x, num_actions)</div>
<div class="line"><span class="lineno">  584</span>    status = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  585</span>    alphas = [np.zeros([])]</div>
<div class="line"><span class="lineno">  586</span>    lamb = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>  meta = dict(</div>
<div class="line"><span class="lineno">  589</span>      x=x,</div>
<div class="line"><span class="lineno">  590</span>      a_mats=a_mats,</div>
<div class="line"><span class="lineno">  591</span>      status=status,</div>
<div class="line"><span class="lineno">  592</span>      cost=cost_value,</div>
<div class="line"><span class="lineno">  593</span>      val=val,</div>
<div class="line"><span class="lineno">  594</span>      alphas=alphas,</div>
<div class="line"><span class="lineno">  595</span>      lamb=lamb,</div>
<div class="line"><span class="lineno">  596</span>      unique=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  597</span>      min_epsilon=<span class="keywordtype">None</span> <span class="keywordflow">if</span> epsilon <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> epsilon.value,</div>
<div class="line"><span class="lineno">  598</span>  )</div>
<div class="line"><span class="lineno">  599</span>  <span class="keywordflow">return</span> dist, meta</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00400">open_spiel.python.algorithms.jpsro._get_repeat_factor()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a43430cdc89f420c4709947ab62b37102_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a43430cdc89f420c4709947ab62b37102_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a43430cdc89f420c4709947ab62b37102_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a43430cdc89f420c4709947ab62b37102_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,232,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,23,264,23,264,28,232,28"/>
</map>
</div>

</div>
</div>
<a id="a971028ec7c3bf12ceb9469ff7bb3d588" name="a971028ec7c3bf12ceb9469ff7bb3d588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a971028ec7c3bf12ceb9469ff7bb3d588">&#9670;&#160;</a></span>_qp_ce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._qp_ce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>payoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a_mats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>e_vecs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>assume_full_support</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>solver_kwargs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>min_epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns the correlated equilibrium with maximum Gini impurity.

Args:
  payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.
  a_mats: A [NUM_CON, PROD(A)] shape gain tensor.
  e_vecs: Epsilon vector.
  assume_full_support: Whether to ignore beta values.
  action_repeats: Vector of action repeats for each player.
  solver_kwargs: Additional kwargs for solver.
  min_epsilon: Whether to minimize epsilon.

Returns:
  An epsilon-correlated equilibrium.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00602">602</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  609</span>    min_epsilon=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  610</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the correlated equilibrium with maximum Gini impurity.</span></div>
<div class="line"><span class="lineno">  611</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  612</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral">    payoff: A [NUM_PLAYER, NUM_ACT_0, NUM_ACT_1, ...] shape payoff tensor.</span></div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">    a_mats: A [NUM_CON, PROD(A)] shape gain tensor.</span></div>
<div class="line"><span class="lineno">  615</span><span class="stringliteral">    e_vecs: Epsilon vector.</span></div>
<div class="line"><span class="lineno">  616</span><span class="stringliteral">    assume_full_support: Whether to ignore beta values.</span></div>
<div class="line"><span class="lineno">  617</span><span class="stringliteral">    action_repeats: Vector of action repeats for each player.</span></div>
<div class="line"><span class="lineno">  618</span><span class="stringliteral">    solver_kwargs: Additional kwargs for solver.</span></div>
<div class="line"><span class="lineno">  619</span><span class="stringliteral">    min_epsilon: Whether to minimize epsilon.</span></div>
<div class="line"><span class="lineno">  620</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  621</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  622</span><span class="stringliteral">    An epsilon-correlated equilibrium.</span></div>
<div class="line"><span class="lineno">  623</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  624</span>  num_players = payoff.shape[0]</div>
<div class="line"><span class="lineno">  625</span>  num_actions = payoff.shape[1:]</div>
<div class="line"><span class="lineno">  626</span>  num_dists = int(np.prod(num_actions))</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>  <span class="keywordflow">if</span> solver_kwargs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  629</span>    solver_kwargs = DEFAULT_OSQP_SOLVER_KWARGS</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  epsilon = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  632</span>  nonzero_cons = [a_mat.shape[0] &gt; 0 <span class="keywordflow">for</span> a_mat <span class="keywordflow">in</span> a_mats <span class="keywordflow">if</span> a_mat <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordflow">if</span> any(nonzero_cons):</div>
<div class="line"><span class="lineno">  634</span>    x = cp.Variable(num_dists, nonneg=(<span class="keywordflow">not</span> assume_full_support))</div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">if</span> min_epsilon:</div>
<div class="line"><span class="lineno">  636</span>      epsilon = cp.Variable(nonpos=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  637</span>      e_vecs = [epsilon] * num_players</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>    <span class="keywordflow">if</span> action_repeats <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  640</span>      repeat_factor, indiv_repeat_factors = _get_repeat_factor(</div>
<div class="line"><span class="lineno">  641</span>          action_repeats)</div>
<div class="line"><span class="lineno">  642</span>      x_repeated = cp.multiply(x, repeat_factor)</div>
<div class="line"><span class="lineno">  643</span>      dist_eq_con = cp.sum(x_repeated) == 1</div>
<div class="line"><span class="lineno">  644</span>      cor_lb_cons = [</div>
<div class="line"><span class="lineno">  645</span>          cp.matmul(a_mat, cp.multiply(x, rf)) &lt;= e_vec <span class="keywordflow">for</span> a_mat, e_vec, rf <span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">  646</span>          zip(a_mats, e_vecs, indiv_repeat_factors) <span class="keywordflow">if</span> a_mat.size &gt; 0]</div>
<div class="line"><span class="lineno">  647</span>      eye = sp.sparse.diags(repeat_factor)</div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  649</span>      repeat_factor = 1</div>
<div class="line"><span class="lineno">  650</span>      x_repeated = x</div>
<div class="line"><span class="lineno">  651</span>      dist_eq_con = cp.sum(x_repeated) == 1</div>
<div class="line"><span class="lineno">  652</span>      cor_lb_cons = [</div>
<div class="line"><span class="lineno">  653</span>          cp.matmul(a_mat, x) &lt;= e_vec <span class="keywordflow">for</span> a_mat, e_vec <span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">  654</span>          zip(a_mats, e_vecs) <span class="keywordflow">if</span> a_mat.size &gt; 0]</div>
<div class="line"><span class="lineno">  655</span>      eye = sp.sparse.eye(num_dists)</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    <span class="comment"># This is more memory efficient than using cp.sum_squares.</span></div>
<div class="line"><span class="lineno">  658</span>    cost = 1 - cp.quad_form(x, eye)</div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">if</span> min_epsilon:</div>
<div class="line"><span class="lineno">  660</span>      cost -= cp.multiply(2, epsilon)</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>    obj = cp.Maximize(cost)</div>
<div class="line"><span class="lineno">  663</span>    prob = cp.Problem(obj, [dist_eq_con] + cor_lb_cons)</div>
<div class="line"><span class="lineno">  664</span>    cost_value = prob.solve(**solver_kwargs)</div>
<div class="line"><span class="lineno">  665</span>    status = prob.status</div>
<div class="line"><span class="lineno">  666</span>    alphas = [cor_lb_con.dual_value <span class="keywordflow">for</span> cor_lb_con <span class="keywordflow">in</span> cor_lb_cons]</div>
<div class="line"><span class="lineno">  667</span>    lamb = dist_eq_con.dual_value</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    val = cost.value</div>
<div class="line"><span class="lineno">  670</span>    x = x_repeated.value</div>
<div class="line"><span class="lineno">  671</span>    dist = np.reshape(x, num_actions)</div>
<div class="line"><span class="lineno">  672</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  673</span>    cost_value = 0.0</div>
<div class="line"><span class="lineno">  674</span>    val = 1 - 1 / num_dists</div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordflow">if</span> action_repeats <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  676</span>      repeat_factor, indiv_repeat_factors = _get_repeat_factor(</div>
<div class="line"><span class="lineno">  677</span>          action_repeats)</div>
<div class="line"><span class="lineno">  678</span>      x = repeat_factor / np.sum(repeat_factor)</div>
<div class="line"><span class="lineno">  679</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  680</span>      x = np.ones([num_dists]) / num_dists</div>
<div class="line"><span class="lineno">  681</span>    dist = np.reshape(x, num_actions)</div>
<div class="line"><span class="lineno">  682</span>    status = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  683</span>    alphas = [np.zeros([])]</div>
<div class="line"><span class="lineno">  684</span>    lamb = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>  meta = dict(</div>
<div class="line"><span class="lineno">  687</span>      x=x,</div>
<div class="line"><span class="lineno">  688</span>      a_mats=a_mats,</div>
<div class="line"><span class="lineno">  689</span>      status=status,</div>
<div class="line"><span class="lineno">  690</span>      cost=cost_value,</div>
<div class="line"><span class="lineno">  691</span>      val=val,</div>
<div class="line"><span class="lineno">  692</span>      alphas=alphas,</div>
<div class="line"><span class="lineno">  693</span>      lamb=lamb,</div>
<div class="line"><span class="lineno">  694</span>      unique=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  695</span>      min_epsilon=<span class="keywordtype">None</span> <span class="keywordflow">if</span> epsilon <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> epsilon.value,</div>
<div class="line"><span class="lineno">  696</span>  )</div>
<div class="line"><span class="lineno">  697</span>  <span class="keywordflow">return</span> dist, meta</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00400">open_spiel.python.algorithms.jpsro._get_repeat_factor()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a971028ec7c3bf12ceb9469ff7bb3d588_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a971028ec7c3bf12ceb9469ff7bb3d588_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a971028ec7c3bf12ceb9469ff7bb3d588_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a971028ec7c3bf12ceb9469ff7bb3d588_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,232,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,23,264,23,264,28,232,28"/>
</map>
</div>

</div>
</div>
<a id="ad71357251fe0753aa6275d848db13126" name="ad71357251fe0753aa6275d848db13126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad71357251fe0753aa6275d848db13126">&#9670;&#160;</a></span>_rd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._rd </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Random dirichlet.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00753">753</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  753</span><span class="keyword">def </span>_rd(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  754</span>  <span class="stringliteral">&quot;&quot;&quot;Random dirichlet.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  755</span>  ignore_repeats = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  756</span>  <span class="keywordflow">if</span> ignore_repeats:</div>
<div class="line"><span class="lineno">  757</span>    num_policies = meta_game.shape[1:]</div>
<div class="line"><span class="lineno">  758</span>    alpha = np.ones(num_policies)</div>
<div class="line"><span class="lineno">  759</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  760</span>    outs = [ppr <span class="keywordflow">for</span> ppr <span class="keywordflow">in</span> per_player_repeats]</div>
<div class="line"><span class="lineno">  761</span>    labels = string.ascii_lowercase[:len(outs)]</div>
<div class="line"><span class="lineno">  762</span>    comma_labels = <span class="stringliteral">&quot;,&quot;</span>.join(labels)</div>
<div class="line"><span class="lineno">  763</span>    alpha = np.einsum(<span class="stringliteral">&quot;{}-&gt;{}&quot;</span>.format(comma_labels, labels), *outs)</div>
<div class="line"><span class="lineno">  764</span>  meta_dist = np.reshape(</div>
<div class="line"><span class="lineno">  765</span>      np.random.dirichlet(alpha.flat), alpha.shape).astype(np.float64)</div>
<div class="line"><span class="lineno">  766</span>  <span class="keywordflow">return</span> meta_dist, dict()</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00770">open_spiel.python.algorithms.jpsro._undominated_rd()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad71357251fe0753aa6275d848db13126_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad71357251fe0753aa6275d848db13126_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad71357251fe0753aa6275d848db13126_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad71357251fe0753aa6275d848db13126_icgraph">
<area shape="rect" title=" " alt="" coords="280,13,524,38"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a87dfaadfd194bd05d1adf17ac620f83b" title=" " alt="" coords="5,5,232,46"/>
<area shape="poly" title=" " alt="" coords="264,28,232,28,232,23,264,23"/>
</map>
</div>

</div>
</div>
<a id="a63355927bd6084c9498e36580294fd4f" name="a63355927bd6084c9498e36580294fd4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63355927bd6084c9498e36580294fd4f">&#9670;&#160;</a></span>_reconstruct_dist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._reconstruct_dist </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eliminated_dist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_labels</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_actions</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns reconstructed dist from eliminated_dist and action_labels.

Redundant dist elements are given values 0.

Args:
  eliminated_dist: Array of shape [A0E, A1E, ...].
  action_labels: List of length N and shapes [[A0E], [A1E], ...].
  num_actions: List of length N and values [A0, A1, ...].

Returns:
  reconstructed_dist: Array of shape [A0, A1, ...].
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00186">186</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  186</span><span class="keyword">def </span>_reconstruct_dist(eliminated_dist, action_labels, num_actions):</div>
<div class="line"><span class="lineno">  187</span>  <span class="stringliteral">&quot;&quot;&quot;Returns reconstructed dist from eliminated_dist and action_labels.</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">  Redundant dist elements are given values 0.</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    eliminated_dist: Array of shape [A0E, A1E, ...].</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    action_labels: List of length N and shapes [[A0E], [A1E], ...].</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    num_actions: List of length N and values [A0, A1, ...].</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    reconstructed_dist: Array of shape [A0, A1, ...].</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  199</span>  reconstructed_payoff = np.zeros(num_actions)</div>
<div class="line"><span class="lineno">  200</span>  reconstructed_payoff[np.ix_(*action_labels)] = eliminated_dist</div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordflow">return</span> reconstructed_payoff</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00204">open_spiel.python.algorithms.jpsro._eliminate_dominated_decorator()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a63355927bd6084c9498e36580294fd4f_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a63355927bd6084c9498e36580294fd4f_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a63355927bd6084c9498e36580294fd4f_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a63355927bd6084c9498e36580294fd4f_icgraph">
<area shape="rect" title=" " alt="" coords="280,5,506,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a1ecffd8bee9243e1fb3aa8b805724ea2" title=" " alt="" coords="5,5,232,46"/>
<area shape="poly" title=" " alt="" coords="264,28,232,28,232,23,264,23"/>
</map>
</div>

</div>
</div>
<a id="a5d1c53c4d157fd3b77fb1aed6951b9ce" name="a5d1c53c4d157fd3b77fb1aed6951b9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d1c53c4d157fd3b77fb1aed6951b9ce">&#9670;&#160;</a></span>_rj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._rj </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Random joint.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00737">737</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  737</span><span class="keyword">def </span>_rj(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  738</span>  <span class="stringliteral">&quot;&quot;&quot;Random joint.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  739</span>  ignore_repeats = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  740</span>  pvals, _ = _uni(</div>
<div class="line"><span class="lineno">  741</span>      meta_game, per_player_repeats, ignore_repeats=ignore_repeats)</div>
<div class="line"><span class="lineno">  742</span>  meta_dist = np.reshape(</div>
<div class="line"><span class="lineno">  743</span>      np.random.multinomial(1, pvals.flat), pvals.shape).astype(np.float64)</div>
<div class="line"><span class="lineno">  744</span>  <span class="keywordflow">return</span> meta_dist, dict()</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00717">open_spiel.python.algorithms.jpsro._uni()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00748">open_spiel.python.algorithms.jpsro._undominated_rj()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,246,31"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#af69335b08e561a814e17d419ca094148" title=" " alt="" coords="294,5,544,31"/>
<area shape="poly" title=" " alt="" coords="246,16,278,16,278,21,246,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a5d1c53c4d157fd3b77fb1aed6951b9ce_icgraph">
<area shape="rect" title=" " alt="" coords="280,13,520,38"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ae94c1d37dad7bdcf9f8dc20535164b9e" title=" " alt="" coords="5,5,232,46"/>
<area shape="poly" title=" " alt="" coords="264,28,232,28,232,23,264,23"/>
</map>
</div>

</div>
</div>
<a id="aa953e89ced52a2873ecbddd0433e3793" name="aa953e89ced52a2873ecbddd0433e3793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa953e89ced52a2873ecbddd0433e3793">&#9670;&#160;</a></span>_rmwcce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._rmwcce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Random maximum welfare CCE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00958">958</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  958</span><span class="keyword">def </span>_rmwcce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  959</span>  <span class="stringliteral">&quot;&quot;&quot;Random maximum welfare CCE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  960</span>  del ignore_repeats</div>
<div class="line"><span class="lineno">  961</span>  num_players = len(per_player_repeats)</div>
<div class="line"><span class="lineno">  962</span>  cost = np.ravel(np.sum(meta_game, axis=0))</div>
<div class="line"><span class="lineno">  963</span>  cost += np.ravel(np.random.normal(size=meta_game.shape[1:])) * 1e-6</div>
<div class="line"><span class="lineno">  964</span>  a_mat, _ = _cce_constraints(</div>
<div class="line"><span class="lineno">  965</span>      meta_game, [0.0] * num_players, remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  966</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  967</span>  e_vec = np.zeros([a_mat.shape[0]])</div>
<div class="line"><span class="lineno">  968</span>  x, _ = _linear(meta_game, a_mat, e_vec, cost=cost)</div>
<div class="line"><span class="lineno">  969</span>  dist = np.reshape(x, meta_game.shape[1:])</div>
<div class="line"><span class="lineno">  970</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00263">open_spiel.python.algorithms.jpsro._cce_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00425">open_spiel.python.algorithms.jpsro._linear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aa953e89ced52a2873ecbddd0433e3793_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aa953e89ced52a2873ecbddd0433e3793_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aa953e89ced52a2873ecbddd0433e3793_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aa953e89ced52a2873ecbddd0433e3793_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab483f30928c3cf4f8e98b5b229e91dac" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a07dcf5203af3455327b4adca910c3798" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="554,71,780,111"/>
<area shape="poly" title=" " alt="" coords="507,88,538,88,538,94,507,94"/>
</map>
</div>

</div>
</div>
<a id="a8495a428ade0a06e7dbb8d13e32c3e5b" name="a8495a428ade0a06e7dbb8d13e32c3e5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8495a428ade0a06e7dbb8d13e32c3e5b">&#9670;&#160;</a></span>_rmwce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._rmwce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Random maximum welfare CE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00865">865</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  865</span><span class="keyword">def </span>_rmwce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  866</span>  <span class="stringliteral">&quot;&quot;&quot;Random maximum welfare CE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  867</span>  del ignore_repeats</div>
<div class="line"><span class="lineno">  868</span>  num_players = len(per_player_repeats)</div>
<div class="line"><span class="lineno">  869</span>  cost = np.ravel(np.sum(meta_game, axis=0))</div>
<div class="line"><span class="lineno">  870</span>  cost += np.ravel(np.random.normal(size=meta_game.shape[1:])) * 1e-6</div>
<div class="line"><span class="lineno">  871</span>  a_mat, e_vec, _ = _ace_constraints(</div>
<div class="line"><span class="lineno">  872</span>      meta_game, [0.0] * num_players, remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  873</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  874</span>  x, _ = _linear(meta_game, a_mat, e_vec, cost=cost)</div>
<div class="line"><span class="lineno">  875</span>  dist = np.reshape(x, meta_game.shape[1:])</div>
<div class="line"><span class="lineno">  876</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00319">open_spiel.python.algorithms.jpsro._ace_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00425">open_spiel.python.algorithms.jpsro._linear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8495a428ade0a06e7dbb8d13e32c3e5b_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8495a428ade0a06e7dbb8d13e32c3e5b_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8495a428ade0a06e7dbb8d13e32c3e5b_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8495a428ade0a06e7dbb8d13e32c3e5b_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a56d665dce6154126d104d54fe591e1f1" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a07dcf5203af3455327b4adca910c3798" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="554,71,780,111"/>
<area shape="poly" title=" " alt="" coords="507,88,538,88,538,94,507,94"/>
</map>
</div>

</div>
</div>
<a id="ad018b6ef5dd537fca76c7ca246dd5a08" name="ad018b6ef5dd537fca76c7ca246dd5a08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad018b6ef5dd537fca76c7ca246dd5a08">&#9670;&#160;</a></span>_rvcce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._rvcce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Random vertex CCE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00987">987</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  987</span><span class="keyword">def </span>_rvcce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  988</span>  <span class="stringliteral">&quot;&quot;&quot;Random vertex CCE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  989</span>  del ignore_repeats</div>
<div class="line"><span class="lineno">  990</span>  num_players = len(per_player_repeats)</div>
<div class="line"><span class="lineno">  991</span>  cost = np.ravel(np.random.normal(size=meta_game.shape[1:]))</div>
<div class="line"><span class="lineno">  992</span>  a_mat, _ = _cce_constraints(</div>
<div class="line"><span class="lineno">  993</span>      meta_game, [0.0] * num_players, remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  994</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  995</span>  e_vec = np.zeros([a_mat.shape[0]])</div>
<div class="line"><span class="lineno">  996</span>  x, _ = _linear(meta_game, a_mat, e_vec, cost=cost)</div>
<div class="line"><span class="lineno">  997</span>  dist = np.reshape(x, meta_game.shape[1:])</div>
<div class="line"><span class="lineno">  998</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span> </div>
<div class="line"><span class="lineno"> 1001</span><span class="comment"># Flags to functions.</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00263">open_spiel.python.algorithms.jpsro._cce_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00425">open_spiel.python.algorithms.jpsro._linear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad018b6ef5dd537fca76c7ca246dd5a08_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad018b6ef5dd537fca76c7ca246dd5a08_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad018b6ef5dd537fca76c7ca246dd5a08_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ad018b6ef5dd537fca76c7ca246dd5a08_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,232,79"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab483f30928c3cf4f8e98b5b229e91dac" title=" " alt="" coords="280,5,506,46"/>
<area shape="poly" title=" " alt="" coords="232,43,264,39,264,44,233,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a07dcf5203af3455327b4adca910c3798" title=" " alt="" coords="280,71,506,111"/>
<area shape="poly" title=" " alt="" coords="233,70,264,73,264,79,232,75"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="554,71,780,111"/>
<area shape="poly" title=" " alt="" coords="507,88,538,88,538,94,507,94"/>
</map>
</div>

</div>
</div>
<a id="aed3a3a14fbbdf6ed8f536c449e33b1a9" name="aed3a3a14fbbdf6ed8f536c449e33b1a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed3a3a14fbbdf6ed8f536c449e33b1a9">&#9670;&#160;</a></span>_rvce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._rvce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Random vertex CE.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00894">894</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  894</span><span class="keyword">def </span>_rvce(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  895</span>  <span class="stringliteral">&quot;&quot;&quot;Random vertex CE.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  896</span>  del ignore_repeats</div>
<div class="line"><span class="lineno">  897</span>  num_players = len(per_player_repeats)</div>
<div class="line"><span class="lineno">  898</span>  cost = np.ravel(np.random.normal(size=meta_game.shape[1:]))</div>
<div class="line"><span class="lineno">  899</span>  a_mat, e_vec, _ = _ace_constraints(</div>
<div class="line"><span class="lineno">  900</span>      meta_game, [0.0] * num_players, remove_null=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  901</span>      zero_tolerance=1e-8)</div>
<div class="line"><span class="lineno">  902</span>  x, _ = _linear(meta_game, a_mat, e_vec, cost=cost)</div>
<div class="line"><span class="lineno">  903</span>  dist = np.reshape(x, meta_game.shape[1:])</div>
<div class="line"><span class="lineno">  904</span>  <span class="keywordflow">return</span> dist, dict()</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span><span class="comment"># Meta-solvers - CCEs.</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00319">open_spiel.python.algorithms.jpsro._ace_constraints()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00425">open_spiel.python.algorithms.jpsro._linear()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aed3a3a14fbbdf6ed8f536c449e33b1a9_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aed3a3a14fbbdf6ed8f536c449e33b1a9_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aed3a3a14fbbdf6ed8f536c449e33b1a9_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_aed3a3a14fbbdf6ed8f536c449e33b1a9_cgraph">
<area shape="rect" title=" " alt="" coords="5,46,264,72"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a56d665dce6154126d104d54fe591e1f1" title=" " alt="" coords="312,5,538,46"/>
<area shape="poly" title=" " alt="" coords="252,43,296,38,296,43,252,48"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a07dcf5203af3455327b4adca910c3798" title=" " alt="" coords="312,71,538,111"/>
<area shape="poly" title=" " alt="" coords="257,70,296,74,296,79,257,75"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab0759318e8d0ae3a8bda1f98b88c6eeb" title=" " alt="" coords="586,71,812,111"/>
<area shape="poly" title=" " alt="" coords="539,88,570,88,570,94,539,94"/>
</map>
</div>

</div>
</div>
<a id="a26287e34dfbe1691600a6c8c004d553b" name="a26287e34dfbe1691600a6c8c004d553b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26287e34dfbe1691600a6c8c004d553b">&#9670;&#160;</a></span>_sparse_indices_generator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._sparse_indices_generator </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_actions</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00245">245</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  245</span><span class="keyword">def </span>_sparse_indices_generator(player, action, num_actions):</div>
<div class="line"><span class="lineno">  246</span>  indices = [(action,) <span class="keywordflow">if</span> p == player <span class="keywordflow">else</span> range(na)</div>
<div class="line"><span class="lineno">  247</span>             <span class="keywordflow">for</span> p, na <span class="keywordflow">in</span> enumerate(num_actions)]</div>
<div class="line"><span class="lineno">  248</span>  <span class="keywordflow">return</span> itertools.product(*indices)</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a088f330db6fab79ba41c4c0101d13006" name="a088f330db6fab79ba41c4c0101d13006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a088f330db6fab79ba41c4c0101d13006">&#9670;&#160;</a></span>_try_two_solvers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._try_two_solvers </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>func</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00228">228</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  228</span><span class="keyword">def </span>_try_two_solvers(func, *args, **kwargs):</div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  230</span>    logging.debug(<span class="stringliteral">&quot;Trying CVXOPT.&quot;</span>, flush=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  231</span>    kwargs_ = {<span class="stringliteral">&quot;solver_kwargs&quot;</span>: DEFAULT_CVXOPT_SOLVER_KWARGS, **kwargs}</div>
<div class="line"><span class="lineno">  232</span>    res = func(*args, **kwargs_)</div>
<div class="line"><span class="lineno">  233</span>  <span class="keywordflow">except</span>:  <span class="comment"># pylint: disable=bare-except</span></div>
<div class="line"><span class="lineno">  234</span>    logging.debug(<span class="stringliteral">&quot;CVXOPT failed. Trying OSQP.&quot;</span>, flush=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  235</span>    kwargs_ = {<span class="stringliteral">&quot;solver_kwargs&quot;</span>: DEFAULT_OSQP_SOLVER_KWARGS, **kwargs}</div>
<div class="line"><span class="lineno">  236</span>    res = func(*args, **kwargs_)</div>
<div class="line"><span class="lineno">  237</span>  <span class="keywordflow">return</span> res</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span><span class="comment"># Helper Functions - CCEs.</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87dfaadfd194bd05d1adf17ac620f83b" name="a87dfaadfd194bd05d1adf17ac620f83b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87dfaadfd194bd05d1adf17ac620f83b">&#9670;&#160;</a></span>_undominated_rd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._undominated_rd </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Undominated random dirichlet.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00770">770</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  770</span><span class="keyword">def </span>_undominated_rd(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  771</span>  <span class="stringliteral">&quot;&quot;&quot;Undominated random dirichlet.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  772</span>  <span class="keywordflow">return</span> _rd(meta_game, per_player_repeats, ignore_repeats=ignore_repeats)</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00753">open_spiel.python.algorithms.jpsro._rd()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a87dfaadfd194bd05d1adf17ac620f83b_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a87dfaadfd194bd05d1adf17ac620f83b_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a87dfaadfd194bd05d1adf17ac620f83b_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a87dfaadfd194bd05d1adf17ac620f83b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,232,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ad71357251fe0753aa6275d848db13126" title=" " alt="" coords="280,13,524,38"/>
<area shape="poly" title=" " alt="" coords="232,23,264,23,264,28,232,28"/>
</map>
</div>

</div>
</div>
<a id="ae94c1d37dad7bdcf9f8dc20535164b9e" name="ae94c1d37dad7bdcf9f8dc20535164b9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae94c1d37dad7bdcf9f8dc20535164b9e">&#9670;&#160;</a></span>_undominated_rj()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._undominated_rj </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Undominated random joint.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00748">748</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  748</span><span class="keyword">def </span>_undominated_rj(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  749</span>  <span class="stringliteral">&quot;&quot;&quot;Undominated random joint.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  750</span>  <span class="keywordflow">return</span> _rj(meta_game, per_player_repeats, ignore_repeats=ignore_repeats)</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00737">open_spiel.python.algorithms.jpsro._rj()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ae94c1d37dad7bdcf9f8dc20535164b9e_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ae94c1d37dad7bdcf9f8dc20535164b9e_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ae94c1d37dad7bdcf9f8dc20535164b9e_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ae94c1d37dad7bdcf9f8dc20535164b9e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,232,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a5d1c53c4d157fd3b77fb1aed6951b9ce" title=" " alt="" coords="280,13,520,38"/>
<area shape="poly" title=" " alt="" coords="232,23,264,23,264,28,232,28"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#af69335b08e561a814e17d419ca094148" title=" " alt="" coords="568,13,818,38"/>
<area shape="poly" title=" " alt="" coords="521,23,553,23,553,28,521,28"/>
</map>
</div>

</div>
</div>
<a id="a60297d0f82059c9b2b8d7d20cac3cc1e" name="a60297d0f82059c9b2b8d7d20cac3cc1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60297d0f82059c9b2b8d7d20cac3cc1e">&#9670;&#160;</a></span>_undominated_uni()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._undominated_uni </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Undominated uniform.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00732">732</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  732</span><span class="keyword">def </span>_undominated_uni(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  733</span>  <span class="stringliteral">&quot;&quot;&quot;Undominated uniform.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  734</span>  <span class="keywordflow">return</span> _uni(meta_game, per_player_repeats, ignore_repeats=ignore_repeats)</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00717">open_spiel.python.algorithms.jpsro._uni()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a60297d0f82059c9b2b8d7d20cac3cc1e_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a60297d0f82059c9b2b8d7d20cac3cc1e_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a60297d0f82059c9b2b8d7d20cac3cc1e_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a60297d0f82059c9b2b8d7d20cac3cc1e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,232,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#af69335b08e561a814e17d419ca094148" title=" " alt="" coords="280,13,530,38"/>
<area shape="poly" title=" " alt="" coords="232,23,264,23,264,28,232,28"/>
</map>
</div>

</div>
</div>
<a id="a47b86f3706cfdac7c132b5e075689011" name="a47b86f3706cfdac7c132b5e075689011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b86f3706cfdac7c132b5e075689011">&#9670;&#160;</a></span>_unexpand_meta_dist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._unexpand_meta_dist </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_dist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00707">707</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  707</span><span class="keyword">def </span>_unexpand_meta_dist(meta_dist, per_player_repeats):</div>
<div class="line"><span class="lineno">  708</span>  num_players = len(meta_dist.shape)</div>
<div class="line"><span class="lineno">  709</span>  <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno">  710</span>    meta_dist = np.add.reduceat(</div>
<div class="line"><span class="lineno">  711</span>        meta_dist, [0] + np.cumsum(per_player_repeats[player]).tolist()[:-1],</div>
<div class="line"><span class="lineno">  712</span>        axis=player)</div>
<div class="line"><span class="lineno">  713</span>  <span class="keywordflow">return</span> meta_dist</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span><span class="comment"># Meta-solvers - Baselines.</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af69335b08e561a814e17d419ca094148" name="af69335b08e561a814e17d419ca094148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af69335b08e561a814e17d419ca094148">&#9670;&#160;</a></span>_uni()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro._uni </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Uniform.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00717">717</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  717</span><span class="keyword">def </span>_uni(meta_game, per_player_repeats, ignore_repeats=False):</div>
<div class="line"><span class="lineno">  718</span>  <span class="stringliteral">&quot;&quot;&quot;Uniform.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  719</span>  <span class="keywordflow">if</span> ignore_repeats:</div>
<div class="line"><span class="lineno">  720</span>    num_policies = meta_game.shape[1:]</div>
<div class="line"><span class="lineno">  721</span>    num_dists = np.prod(num_policies)</div>
<div class="line"><span class="lineno">  722</span>    meta_dist = np.full(num_policies, 1./num_dists)</div>
<div class="line"><span class="lineno">  723</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  724</span>    outs = [ppr / np.sum(ppr) <span class="keywordflow">for</span> ppr <span class="keywordflow">in</span> per_player_repeats]</div>
<div class="line"><span class="lineno">  725</span>    labels = string.ascii_lowercase[:len(outs)]</div>
<div class="line"><span class="lineno">  726</span>    comma_labels = <span class="stringliteral">&quot;,&quot;</span>.join(labels)</div>
<div class="line"><span class="lineno">  727</span>    meta_dist = np.einsum(<span class="stringliteral">&quot;{}-&gt;{}&quot;</span>.format(comma_labels, labels), *outs)</div>
<div class="line"><span class="lineno">  728</span>  <span class="keywordflow">return</span> meta_dist, dict()</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span><span class="preprocessor">@_eliminate_dominated_decorator</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00737">open_spiel.python.algorithms.jpsro._rj()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00732">open_spiel.python.algorithms.jpsro._undominated_uni()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af69335b08e561a814e17d419ca094148_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af69335b08e561a814e17d419ca094148_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af69335b08e561a814e17d419ca094148_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_af69335b08e561a814e17d419ca094148_icgraph">
<area shape="rect" title=" " alt="" coords="568,42,818,68"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a5d1c53c4d157fd3b77fb1aed6951b9ce" title=" " alt="" coords="280,13,520,38"/>
<area shape="poly" title=" " alt="" coords="552,44,520,40,521,35,553,38"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a60297d0f82059c9b2b8d7d20cac3cc1e" title=" " alt="" coords="287,63,513,103"/>
<area shape="poly" title=" " alt="" coords="553,71,514,75,513,70,553,66"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ae94c1d37dad7bdcf9f8dc20535164b9e" title=" " alt="" coords="5,5,232,46"/>
<area shape="poly" title=" " alt="" coords="264,28,232,28,232,23,264,23"/>
</map>
</div>

</div>
</div>
<a id="a4bd6365e26652a88ca2de77eab51bb00" name="a4bd6365e26652a88ca2de77eab51bb00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bd6365e26652a88ca2de77eab51bb00">&#9670;&#160;</a></span>add_meta_dist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.add_meta_dist </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_dists</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_values</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_solver</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns meta_dist.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01163">1163</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1165</span>    ignore_repeats):</div>
<div class="line"><span class="lineno"> 1166</span>  <span class="stringliteral">&quot;&quot;&quot;Returns meta_dist.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1167</span>  num_players = meta_game.shape[0]</div>
<div class="line"><span class="lineno"> 1168</span>  meta_solver_func = FLAG_TO_FUNC[meta_solver]</div>
<div class="line"><span class="lineno"> 1169</span>  meta_dist, _ = meta_solver_func(</div>
<div class="line"><span class="lineno"> 1170</span>      meta_game, per_player_repeats, ignore_repeats=ignore_repeats)</div>
<div class="line"><span class="lineno"> 1171</span>  <span class="comment"># Clean dist.</span></div>
<div class="line"><span class="lineno"> 1172</span>  meta_dist = meta_dist.astype(np.float64)</div>
<div class="line"><span class="lineno"> 1173</span>  meta_dist[meta_dist &lt; DIST_TOL] = 0.0</div>
<div class="line"><span class="lineno"> 1174</span>  meta_dist[meta_dist &gt; 1.0] = 1.0</div>
<div class="line"><span class="lineno"> 1175</span>  meta_dist /= np.sum(meta_dist)</div>
<div class="line"><span class="lineno"> 1176</span>  meta_dist[meta_dist &gt; 1.0] = 1.0</div>
<div class="line"><span class="lineno"> 1177</span>  meta_dists.append(meta_dist)</div>
<div class="line"><span class="lineno"> 1178</span>  meta_value = np.sum(</div>
<div class="line"><span class="lineno"> 1179</span>      meta_dist * meta_game, axis=tuple(range(1, num_players + 1)))</div>
<div class="line"><span class="lineno"> 1180</span>  meta_values.append(meta_value)</div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keywordflow">return</span> meta_dist</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01311">open_spiel.python.algorithms.jpsro.initialize()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01433">open_spiel.python.algorithms.jpsro.run_loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4bd6365e26652a88ca2de77eab51bb00_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4bd6365e26652a88ca2de77eab51bb00_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4bd6365e26652a88ca2de77eab51bb00_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4bd6365e26652a88ca2de77eab51bb00_icgraph">
<area shape="rect" title=" " alt="" coords="650,23,897,64"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4f4623116b95368c61c3170bc2844457" title="Main Loop." alt="" coords="329,5,602,31"/>
<area shape="poly" title=" " alt="" coords="634,35,602,32,603,27,635,29"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a53ee5846cf329f075c268a95c243a60a" title=" " alt="" coords="5,31,281,56"/>
<area shape="poly" title=" " alt="" coords="634,46,281,46,281,41,634,41"/>
<area shape="poly" title=" " alt="" coords="314,33,281,35,281,30,313,27"/>
</map>
</div>

</div>
</div>
<a id="a8002f75b143a5a7eb054a20f640c5a24" name="a8002f75b143a5a7eb054a20f640c5a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8002f75b143a5a7eb054a20f640c5a24">&#9670;&#160;</a></span>add_meta_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.add_meta_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_games</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_returns</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a meta-game tensor.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01147">1147</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1150</span>    joint_returns):</div>
<div class="line"><span class="lineno"> 1151</span>  <span class="stringliteral">&quot;&quot;&quot;Returns a meta-game tensor.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1152</span>  per_player_num_policies = [</div>
<div class="line"><span class="lineno"> 1153</span>      len(policies) <span class="keywordflow">for</span> policies <span class="keywordflow">in</span> per_player_policies]</div>
<div class="line"><span class="lineno"> 1154</span>  shape = [len(per_player_num_policies)] + per_player_num_policies</div>
<div class="line"><span class="lineno"> 1155</span>  meta_game = np.zeros(shape)</div>
<div class="line"><span class="lineno"> 1156</span>  <span class="keywordflow">for</span> pids <span class="keywordflow">in</span> itertools.product(*[</div>
<div class="line"><span class="lineno"> 1157</span>      range(np_) <span class="keywordflow">for</span> np_ <span class="keywordflow">in</span> per_player_num_policies]):</div>
<div class="line"><span class="lineno"> 1158</span>    meta_game[(slice(<span class="keywordtype">None</span>),) + pids] = joint_returns[pids]</div>
<div class="line"><span class="lineno"> 1159</span>  meta_games.append(meta_game)</div>
<div class="line"><span class="lineno"> 1160</span>  <span class="keywordflow">return</span> meta_games</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01311">open_spiel.python.algorithms.jpsro.initialize()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01433">open_spiel.python.algorithms.jpsro.run_loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8002f75b143a5a7eb054a20f640c5a24_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8002f75b143a5a7eb054a20f640c5a24_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8002f75b143a5a7eb054a20f640c5a24_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a8002f75b143a5a7eb054a20f640c5a24_icgraph">
<area shape="rect" title=" " alt="" coords="650,23,897,64"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4f4623116b95368c61c3170bc2844457" title="Main Loop." alt="" coords="329,5,602,31"/>
<area shape="poly" title=" " alt="" coords="634,35,602,32,603,27,635,29"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a53ee5846cf329f075c268a95c243a60a" title=" " alt="" coords="5,31,281,56"/>
<area shape="poly" title=" " alt="" coords="634,46,281,46,281,41,634,41"/>
<area shape="poly" title=" " alt="" coords="314,33,281,35,281,30,313,27"/>
</map>
</div>

</div>
</div>
<a id="a9070921c5927df62cd7cb6c1b5c0123c" name="a9070921c5927df62cd7cb6c1b5c0123c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9070921c5927df62cd7cb6c1b5c0123c">&#9670;&#160;</a></span>add_new_policies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.add_new_policies </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_new_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_gaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_returns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>br_selection</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Adds novel policies from new policies.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01048">1048</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1056</span>    br_selection):</div>
<div class="line"><span class="lineno"> 1057</span>  <span class="stringliteral">&quot;&quot;&quot;Adds novel policies from new policies.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1058</span>  num_players = len(per_player_new_policies)</div>
<div class="line"><span class="lineno"> 1059</span>  per_player_num_novel_policies = [0 <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>  <span class="comment"># Update policies and policy counts.</span></div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno"> 1063</span>    new_policies = per_player_new_policies[player]</div>
<div class="line"><span class="lineno"> 1064</span>    new_gaps = per_player_gaps[player]</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>    repeat_policies = []</div>
<div class="line"><span class="lineno"> 1067</span>    repeat_gaps = []</div>
<div class="line"><span class="lineno"> 1068</span>    repeat_ids = []</div>
<div class="line"><span class="lineno"> 1069</span>    novel_policies = []</div>
<div class="line"><span class="lineno"> 1070</span>    novel_gaps = []</div>
<div class="line"><span class="lineno"> 1071</span>    <span class="keywordflow">for</span> new_policy, new_gap <span class="keywordflow">in</span> zip(new_policies, new_gaps):</div>
<div class="line"><span class="lineno"> 1072</span>      <span class="keywordflow">for</span> policy_id, policy_ <span class="keywordflow">in</span> enumerate(per_player_policies[player]):</div>
<div class="line"><span class="lineno"> 1073</span>        <span class="keywordflow">if</span> np.all(  <span class="comment"># New policy is not novel.</span></div>
<div class="line"><span class="lineno"> 1074</span>            new_policy.action_probability_array ==</div>
<div class="line"><span class="lineno"> 1075</span>            policy_.action_probability_array):  <span class="comment"># pytype: disable=attribute-error  # py39-upgrade</span></div>
<div class="line"><span class="lineno"> 1076</span>          logging.debug(<span class="stringliteral">&quot;Player %d&#39;s new policy is not novel.&quot;</span>, player)</div>
<div class="line"><span class="lineno"> 1077</span>          repeat_policies.append(new_policy)</div>
<div class="line"><span class="lineno"> 1078</span>          repeat_gaps.append(new_gap)</div>
<div class="line"><span class="lineno"> 1079</span>          repeat_ids.append(policy_id)</div>
<div class="line"><span class="lineno"> 1080</span>          <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1081</span>      <span class="keywordflow">else</span>:  <span class="comment"># New policy is novel.</span></div>
<div class="line"><span class="lineno"> 1082</span>        logging.debug(<span class="stringliteral">&quot;Player %d&#39;s new policy is novel.&quot;</span>, player)</div>
<div class="line"><span class="lineno"> 1083</span>        novel_policies.append(new_policy)</div>
<div class="line"><span class="lineno"> 1084</span>        novel_gaps.append(new_gap)</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>    add_novel_policies = []</div>
<div class="line"><span class="lineno"> 1087</span>    add_repeat_ids = []</div>
<div class="line"><span class="lineno"> 1088</span>    <span class="keywordflow">if</span> (novel_policies <span class="keywordflow">or</span> repeat_policies):</div>
<div class="line"><span class="lineno"> 1089</span>      <span class="keywordflow">if</span> br_selection == <span class="stringliteral">&quot;all&quot;</span>:</div>
<div class="line"><span class="lineno"> 1090</span>        add_novel_policies.extend(novel_policies)</div>
<div class="line"><span class="lineno"> 1091</span>        add_repeat_ids.extend(repeat_ids)</div>
<div class="line"><span class="lineno"> 1092</span>      <span class="keywordflow">elif</span> br_selection == <span class="stringliteral">&quot;all_novel&quot;</span>:</div>
<div class="line"><span class="lineno"> 1093</span>        add_novel_policies.extend(novel_policies)</div>
<div class="line"><span class="lineno"> 1094</span>      <span class="keywordflow">elif</span> br_selection == <span class="stringliteral">&quot;random&quot;</span>:</div>
<div class="line"><span class="lineno"> 1095</span>        index = np.random.randint(0, len(repeat_policies) + len(novel_policies))</div>
<div class="line"><span class="lineno"> 1096</span>        <span class="keywordflow">if</span> index &lt; len(novel_policies):</div>
<div class="line"><span class="lineno"> 1097</span>          add_novel_policies.append(novel_policies[index])</div>
<div class="line"><span class="lineno"> 1098</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1099</span>          add_repeat_ids.append(repeat_ids[index - len(novel_policies)])</div>
<div class="line"><span class="lineno"> 1100</span>      <span class="keywordflow">elif</span> br_selection == <span class="stringliteral">&quot;random_novel&quot;</span>:</div>
<div class="line"><span class="lineno"> 1101</span>        <span class="keywordflow">if</span> novel_policies:</div>
<div class="line"><span class="lineno"> 1102</span>          index = np.random.randint(0, len(novel_policies))</div>
<div class="line"><span class="lineno"> 1103</span>          add_novel_policies.append(novel_policies[index])</div>
<div class="line"><span class="lineno"> 1104</span>        <span class="keywordflow">else</span>:  <span class="comment"># Fall back on random.</span></div>
<div class="line"><span class="lineno"> 1105</span>          index = np.random.randint(0, len(repeat_policies))</div>
<div class="line"><span class="lineno"> 1106</span>          add_repeat_ids.append(repeat_ids[index])</div>
<div class="line"><span class="lineno"> 1107</span>      <span class="keywordflow">elif</span> br_selection == <span class="stringliteral">&quot;largest_gap&quot;</span>:</div>
<div class="line"><span class="lineno"> 1108</span>        <span class="keywordflow">if</span> novel_policies:</div>
<div class="line"><span class="lineno"> 1109</span>          index = np.argmax(novel_gaps)</div>
<div class="line"><span class="lineno"> 1110</span>          <span class="keywordflow">if</span> novel_gaps[index] == 0.0:  <span class="comment"># Fall back to random when zero.</span></div>
<div class="line"><span class="lineno"> 1111</span>            index = np.random.randint(0, len(novel_policies))</div>
<div class="line"><span class="lineno"> 1112</span>          add_novel_policies.append(novel_policies[index])</div>
<div class="line"><span class="lineno"> 1113</span>        <span class="keywordflow">else</span>:  <span class="comment"># Fall back on random.</span></div>
<div class="line"><span class="lineno"> 1114</span>          index = np.random.randint(0, len(repeat_policies))</div>
<div class="line"><span class="lineno"> 1115</span>          add_repeat_ids.append(repeat_ids[index])</div>
<div class="line"><span class="lineno"> 1116</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1117</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unrecognized br_selection method: %s&quot;</span></div>
<div class="line"><span class="lineno"> 1118</span>                         % br_selection)</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>    <span class="keywordflow">for</span> add_repeat_id <span class="keywordflow">in</span> add_repeat_ids:</div>
<div class="line"><span class="lineno"> 1121</span>      per_player_repeats[player][add_repeat_id] += 1</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>    <span class="keywordflow">for</span> add_novel_policy <span class="keywordflow">in</span> add_novel_policies:</div>
<div class="line"><span class="lineno"> 1124</span>      per_player_policies[player].append(add_novel_policy)  <span class="comment"># Add new policy.</span></div>
<div class="line"><span class="lineno"> 1125</span>      per_player_repeats[player].append(1)  <span class="comment"># Add new count.</span></div>
<div class="line"><span class="lineno"> 1126</span>      per_player_num_novel_policies[player] += 1</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>  <span class="comment"># Add new joint policies.</span></div>
<div class="line"><span class="lineno"> 1129</span>  <span class="keywordflow">for</span> pids <span class="keywordflow">in</span> itertools.product(*[</div>
<div class="line"><span class="lineno"> 1130</span>      range(len(policies)) <span class="keywordflow">for</span> policies <span class="keywordflow">in</span> per_player_policies]):</div>
<div class="line"><span class="lineno"> 1131</span>    <span class="keywordflow">if</span> pids <span class="keywordflow">in</span> joint_policies:</div>
<div class="line"><span class="lineno"> 1132</span>      <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno"> 1133</span>    logging.debug(<span class="stringliteral">&quot;Evaluating novel joint policy: %s.&quot;</span>, pids)</div>
<div class="line"><span class="lineno"> 1134</span>    policies = [</div>
<div class="line"><span class="lineno"> 1135</span>        policies[pid] <span class="keywordflow">for</span> pid, policies <span class="keywordflow">in</span> zip(pids, per_player_policies)]</div>
<div class="line"><span class="lineno"> 1136</span>    policies = tuple(map(policy.python_policy_to_pyspiel_policy, policies))</div>
<div class="line"><span class="lineno"> 1137</span>    pyspiel_tabular_policy = pyspiel.to_joint_tabular_policy(policies, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1138</span>    joint_policies[pids] = pyspiel_tabular_policy</div>
<div class="line"><span class="lineno"> 1139</span>    joint_returns[pids] = [</div>
<div class="line"><span class="lineno"> 1140</span>        0.0 <span class="keywordflow">if</span> abs(er) &lt; RETURN_TOL <span class="keywordflow">else</span> er</div>
<div class="line"><span class="lineno"> 1141</span>        <span class="keywordflow">for</span> er <span class="keywordflow">in</span> pyspiel.expected_returns(</div>
<div class="line"><span class="lineno"> 1142</span>            game.new_initial_state(), pyspiel_tabular_policy, -1, <span class="keyword">True</span>)]</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>  <span class="keywordflow">return</span> per_player_num_novel_policies</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01311">open_spiel.python.algorithms.jpsro.initialize()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01433">open_spiel.python.algorithms.jpsro.run_loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a9070921c5927df62cd7cb6c1b5c0123c_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a9070921c5927df62cd7cb6c1b5c0123c_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a9070921c5927df62cd7cb6c1b5c0123c_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a9070921c5927df62cd7cb6c1b5c0123c_icgraph">
<area shape="rect" title=" " alt="" coords="650,23,897,64"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4f4623116b95368c61c3170bc2844457" title="Main Loop." alt="" coords="329,5,602,31"/>
<area shape="poly" title=" " alt="" coords="634,35,602,32,603,27,635,29"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a53ee5846cf329f075c268a95c243a60a" title=" " alt="" coords="5,31,281,56"/>
<area shape="poly" title=" " alt="" coords="634,46,281,46,281,41,634,41"/>
<area shape="poly" title=" " alt="" coords="314,33,281,35,281,30,313,27"/>
</map>
</div>

</div>
</div>
<a id="acbe35dd57c6419a4bb696b603388c3cc" name="acbe35dd57c6419a4bb696b603388c3cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbe35dd57c6419a4bb696b603388c3cc">&#9670;&#160;</a></span>callback_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.callback_ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>iteration</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_returns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_games</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_dists</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_dists</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_values</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_values</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_gaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_gaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>checkpoint</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Callback for updating checkpoint.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01397">1397</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1411</span>    checkpoint):</div>
<div class="line"><span class="lineno"> 1412</span>  <span class="stringliteral">&quot;&quot;&quot;Callback for updating checkpoint.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1413</span>  del iteration, per_player_repeats, per_player_policies, joint_policies</div>
<div class="line"><span class="lineno"> 1414</span>  del joint_returns, meta_games, train_meta_dists, eval_meta_dists</div>
<div class="line"><span class="lineno"> 1415</span>  del train_meta_values, eval_meta_values, train_meta_gaps, eval_meta_gaps</div>
<div class="line"><span class="lineno"> 1416</span>  del kwargs</div>
<div class="line"><span class="lineno"> 1417</span>  <span class="keywordflow">return</span> checkpoint</div>
<div class="line"><span class="lineno"> 1418</span> </div>
<div class="line"><span class="lineno"> 1419</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adcb700f5519bce84ab7a3d8b1dca5c36" name="adcb700f5519bce84ab7a3d8b1dca5c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcb700f5519bce84ab7a3d8b1dca5c36">&#9670;&#160;</a></span>find_best_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.find_best_response </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_dist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>iteration</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>target_equilibrium</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>update_players_strategy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_value_tolerance</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns new best response policies.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01184">1184</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1193</span>):</div>
<div class="line"><span class="lineno"> 1194</span>  <span class="stringliteral">&quot;&quot;&quot;Returns new best response policies.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1195</span>  num_players = meta_game.shape[0]</div>
<div class="line"><span class="lineno"> 1196</span>  per_player_num_policies = meta_dist.shape[:]</div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span>  <span class="comment"># Player update strategy.</span></div>
<div class="line"><span class="lineno"> 1199</span>  <span class="keywordflow">if</span> update_players_strategy == <span class="stringliteral">&quot;all&quot;</span>:</div>
<div class="line"><span class="lineno"> 1200</span>    players = list(range(num_players))</div>
<div class="line"><span class="lineno"> 1201</span>  <span class="keywordflow">elif</span> update_players_strategy == <span class="stringliteral">&quot;cycle&quot;</span>:</div>
<div class="line"><span class="lineno"> 1202</span>    players = [iteration % num_players]</div>
<div class="line"><span class="lineno"> 1203</span>  <span class="keywordflow">elif</span> update_players_strategy == <span class="stringliteral">&quot;random&quot;</span>:</div>
<div class="line"><span class="lineno"> 1204</span>    players = [np.random.randint(0, num_players)]</div>
<div class="line"><span class="lineno"> 1205</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1206</span>    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno"> 1207</span>        <span class="stringliteral">&quot;update_players_strategy must be a valid player update strategy: &quot;</span></div>
<div class="line"><span class="lineno"> 1208</span>        <span class="stringliteral">&quot;%s. Received: %s&quot;</span> % (UPDATE_PLAYERS_STRATEGY, update_players_strategy))</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>  <span class="comment"># Find best response.</span></div>
<div class="line"><span class="lineno"> 1211</span>  per_player_new_policies = []</div>
<div class="line"><span class="lineno"> 1212</span>  per_player_deviation_incentives = []</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>  <span class="keywordflow">if</span> target_equilibrium == <span class="stringliteral">&quot;cce&quot;</span>:</div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno"> 1216</span>      <span class="keywordflow">if</span> player <span class="keywordflow">in</span> players:</div>
<div class="line"><span class="lineno"> 1217</span>        joint_policy_ids = itertools.product(*[</div>
<div class="line"><span class="lineno"> 1218</span>            (np_-1,) <span class="keywordflow">if</span> p_ == player <span class="keywordflow">else</span> range(np_) <span class="keywordflow">for</span> p_, np_</div>
<div class="line"><span class="lineno"> 1219</span>            <span class="keywordflow">in</span> enumerate(per_player_num_policies)])</div>
<div class="line"><span class="lineno"> 1220</span>        joint_policies_slice = [</div>
<div class="line"><span class="lineno"> 1221</span>            joint_policies[jpid] <span class="keywordflow">for</span> jpid <span class="keywordflow">in</span> joint_policy_ids]</div>
<div class="line"><span class="lineno"> 1222</span>        meta_dist_slice = np.sum(meta_dist, axis=player)</div>
<div class="line"><span class="lineno"> 1223</span>        meta_dist_slice[meta_dist_slice &lt; DIST_TOL] = 0.0</div>
<div class="line"><span class="lineno"> 1224</span>        meta_dist_slice[meta_dist_slice &gt; 1.0] = 1.0</div>
<div class="line"><span class="lineno"> 1225</span>        meta_dist_slice /= np.sum(meta_dist_slice)</div>
<div class="line"><span class="lineno"> 1226</span>        meta_dist_slice = meta_dist_slice.flat</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>        mu = [(p, mp) <span class="keywordflow">for</span> mp, p <span class="keywordflow">in</span> zip(joint_policies_slice, meta_dist_slice)</div>
<div class="line"><span class="lineno"> 1229</span>              <span class="keywordflow">if</span> p &gt; 0]</div>
<div class="line"><span class="lineno"> 1230</span>        info = pyspiel.cce_dist(</div>
<div class="line"><span class="lineno"> 1231</span>            game,</div>
<div class="line"><span class="lineno"> 1232</span>            mu,</div>
<div class="line"><span class="lineno"> 1233</span>            player,</div>
<div class="line"><span class="lineno"> 1234</span>            prob_cut_threshold=0.0,</div>
<div class="line"><span class="lineno"> 1235</span>            action_value_tolerance=action_value_tolerance)</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>        new_policy = policy.pyspiel_policy_to_python_policy(</div>
<div class="line"><span class="lineno"> 1238</span>            game, info.best_response_policies[0], players=(player,))</div>
<div class="line"><span class="lineno"> 1239</span>        on_policy_value = np.sum(meta_game[player] * meta_dist)</div>
<div class="line"><span class="lineno"> 1240</span>        deviation_incentive = max(</div>
<div class="line"><span class="lineno"> 1241</span>            info.best_response_values[0] - on_policy_value, 0)</div>
<div class="line"><span class="lineno"> 1242</span>        <span class="keywordflow">if</span> deviation_incentive &lt; GAP_TOL:</div>
<div class="line"><span class="lineno"> 1243</span>          deviation_incentive = 0.0</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>        per_player_new_policies.append([new_policy])</div>
<div class="line"><span class="lineno"> 1246</span>        per_player_deviation_incentives.append([deviation_incentive])</div>
<div class="line"><span class="lineno"> 1247</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1248</span>        per_player_new_policies.append([])</div>
<div class="line"><span class="lineno"> 1249</span>        per_player_deviation_incentives.append([])</div>
<div class="line"><span class="lineno"> 1250</span> </div>
<div class="line"><span class="lineno"> 1251</span>  <span class="keywordflow">elif</span> target_equilibrium == <span class="stringliteral">&quot;ce&quot;</span>:</div>
<div class="line"><span class="lineno"> 1252</span>    <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(num_players):</div>
<div class="line"><span class="lineno"> 1253</span>      <span class="keywordflow">if</span> player <span class="keywordflow">in</span> players:</div>
<div class="line"><span class="lineno"> 1254</span>        per_player_new_policies.append([])</div>
<div class="line"><span class="lineno"> 1255</span>        per_player_deviation_incentives.append([])</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>        <span class="keywordflow">for</span> pid <span class="keywordflow">in</span> range(per_player_num_policies[player]):</div>
<div class="line"><span class="lineno"> 1258</span>          joint_policy_ids = itertools.product(*[</div>
<div class="line"><span class="lineno"> 1259</span>              (pid,) <span class="keywordflow">if</span> p_ == player <span class="keywordflow">else</span> range(np_) <span class="keywordflow">for</span> p_, np_</div>
<div class="line"><span class="lineno"> 1260</span>              <span class="keywordflow">in</span> enumerate(per_player_num_policies)])</div>
<div class="line"><span class="lineno"> 1261</span>          joint_policies_slice = [</div>
<div class="line"><span class="lineno"> 1262</span>              joint_policies[jpid] <span class="keywordflow">for</span> jpid <span class="keywordflow">in</span> joint_policy_ids]</div>
<div class="line"><span class="lineno"> 1263</span>          inds = tuple((pid,) <span class="keywordflow">if</span> player == p_ <span class="keywordflow">else</span> slice(<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1264</span>                       <span class="keywordflow">for</span> p_ <span class="keywordflow">in</span> range(num_players))</div>
<div class="line"><span class="lineno"> 1265</span>          meta_dist_slice = np.ravel(meta_dist[inds]).copy()</div>
<div class="line"><span class="lineno"> 1266</span>          meta_dist_slice[meta_dist_slice &lt; DIST_TOL] = 0.0</div>
<div class="line"><span class="lineno"> 1267</span>          meta_dist_slice[meta_dist_slice &gt; 1.0] = 1.0</div>
<div class="line"><span class="lineno"> 1268</span>          meta_dist_slice_sum = np.sum(meta_dist_slice)</div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>          <span class="keywordflow">if</span> meta_dist_slice_sum &gt; 0.0:</div>
<div class="line"><span class="lineno"> 1271</span>            meta_dist_slice /= meta_dist_slice_sum</div>
<div class="line"><span class="lineno"> 1272</span>            mu = [(p, mp) <span class="keywordflow">for</span> mp, p <span class="keywordflow">in</span></div>
<div class="line"><span class="lineno"> 1273</span>                  zip(joint_policies_slice, meta_dist_slice)</div>
<div class="line"><span class="lineno"> 1274</span>                  <span class="keywordflow">if</span> p &gt; 0]</div>
<div class="line"><span class="lineno"> 1275</span>            info = pyspiel.cce_dist(</div>
<div class="line"><span class="lineno"> 1276</span>                game,</div>
<div class="line"><span class="lineno"> 1277</span>                mu,</div>
<div class="line"><span class="lineno"> 1278</span>                player,</div>
<div class="line"><span class="lineno"> 1279</span>                prob_cut_threshold=0.0,</div>
<div class="line"><span class="lineno"> 1280</span>                action_value_tolerance=action_value_tolerance)</div>
<div class="line"><span class="lineno"> 1281</span> </div>
<div class="line"><span class="lineno"> 1282</span>            new_policy = policy.pyspiel_policy_to_python_policy(</div>
<div class="line"><span class="lineno"> 1283</span>                game, info.best_response_policies[0], players=(player,))</div>
<div class="line"><span class="lineno"> 1284</span>            on_policy_value = np.sum(</div>
<div class="line"><span class="lineno"> 1285</span>                np.ravel(meta_game[player][inds]) * meta_dist_slice)</div>
<div class="line"><span class="lineno"> 1286</span>            deviation_incentive = max(</div>
<div class="line"><span class="lineno"> 1287</span>                info.best_response_values[0] - on_policy_value, 0)</div>
<div class="line"><span class="lineno"> 1288</span>            <span class="keywordflow">if</span> deviation_incentive &lt; GAP_TOL:</div>
<div class="line"><span class="lineno"> 1289</span>              deviation_incentive = 0.0</div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span>            per_player_new_policies[-1].append(new_policy)</div>
<div class="line"><span class="lineno"> 1292</span>            per_player_deviation_incentives[-1].append(</div>
<div class="line"><span class="lineno"> 1293</span>                meta_dist_slice_sum * deviation_incentive)</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1296</span>        per_player_new_policies.append([])</div>
<div class="line"><span class="lineno"> 1297</span>        per_player_deviation_incentives.append([])</div>
<div class="line"><span class="lineno"> 1298</span> </div>
<div class="line"><span class="lineno"> 1299</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1300</span>    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno"> 1301</span>        <span class="stringliteral">&quot;target_equilibrium must be a valid best response strategy: %s. &quot;</span></div>
<div class="line"><span class="lineno"> 1302</span>        <span class="stringliteral">&quot;Received: %s&quot;</span> % (BRS, target_equilibrium))</div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>  <span class="keywordflow">return</span> per_player_new_policies, per_player_deviation_incentives</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01433">open_spiel.python.algorithms.jpsro.run_loop()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_adcb700f5519bce84ab7a3d8b1dca5c36_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_adcb700f5519bce84ab7a3d8b1dca5c36_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_adcb700f5519bce84ab7a3d8b1dca5c36_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_adcb700f5519bce84ab7a3d8b1dca5c36_icgraph">
<area shape="rect" title=" " alt="" coords="329,5,576,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a53ee5846cf329f075c268a95c243a60a" title=" " alt="" coords="5,13,281,38"/>
<area shape="poly" title=" " alt="" coords="313,28,281,28,281,23,313,23"/>
</map>
</div>

</div>
</div>
<a id="a4f4623116b95368c61c3170bc2844457" name="a4f4623116b95368c61c3170bc2844457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f4623116b95368c61c3170bc2844457">&#9670;&#160;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.initialize </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_solver</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_solver</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy_init</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>br_selection</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main Loop. </p>
<pre class="fragment">Return initialized data structures.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01310">1310</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1311</span>               ignore_repeats, br_selection):</div>
<div class="line"><span class="lineno"> 1312</span>  <span class="stringliteral">&quot;&quot;&quot;Return initialized data structures.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1313</span>  num_players = game.num_players()</div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>  <span class="comment"># Initialize.</span></div>
<div class="line"><span class="lineno"> 1316</span>  iteration = 0</div>
<div class="line"><span class="lineno"> 1317</span>  per_player_repeats = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno"> 1318</span>  per_player_policies = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno"> 1319</span>  joint_policies = {}  <span class="comment"># Eg. (1, 0): Joint policy.</span></div>
<div class="line"><span class="lineno"> 1320</span>  joint_returns = {}</div>
<div class="line"><span class="lineno"> 1321</span>  meta_games = []</div>
<div class="line"><span class="lineno"> 1322</span>  train_meta_dists = []</div>
<div class="line"><span class="lineno"> 1323</span>  eval_meta_dists = []</div>
<div class="line"><span class="lineno"> 1324</span>  train_meta_values = []</div>
<div class="line"><span class="lineno"> 1325</span>  eval_meta_values = []</div>
<div class="line"><span class="lineno"> 1326</span>  train_meta_gaps = []</div>
<div class="line"><span class="lineno"> 1327</span>  eval_meta_gaps = []</div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span>  <span class="comment"># Initialize policies.</span></div>
<div class="line"><span class="lineno"> 1330</span>  per_player_new_policies = [</div>
<div class="line"><span class="lineno"> 1331</span>      [initialize_policy(game, player, policy_init)]</div>
<div class="line"><span class="lineno"> 1332</span>      <span class="keywordflow">for</span> player <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno"> 1333</span>  per_player_gaps_train = [[1.0] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_players)]</div>
<div class="line"><span class="lineno"> 1334</span>  per_player_num_novel_policies = add_new_policies(</div>
<div class="line"><span class="lineno"> 1335</span>      per_player_new_policies, per_player_gaps_train, per_player_repeats,</div>
<div class="line"><span class="lineno"> 1336</span>      per_player_policies, joint_policies, joint_returns, game, br_selection)</div>
<div class="line"><span class="lineno"> 1337</span>  del per_player_num_novel_policies</div>
<div class="line"><span class="lineno"> 1338</span>  add_meta_game(</div>
<div class="line"><span class="lineno"> 1339</span>      meta_games,</div>
<div class="line"><span class="lineno"> 1340</span>      per_player_policies,</div>
<div class="line"><span class="lineno"> 1341</span>      joint_returns)</div>
<div class="line"><span class="lineno"> 1342</span>  add_meta_dist(</div>
<div class="line"><span class="lineno"> 1343</span>      train_meta_dists, train_meta_values, train_meta_solver,</div>
<div class="line"><span class="lineno"> 1344</span>      meta_games[-1], per_player_repeats, ignore_repeats)</div>
<div class="line"><span class="lineno"> 1345</span>  add_meta_dist(</div>
<div class="line"><span class="lineno"> 1346</span>      eval_meta_dists, eval_meta_values, eval_meta_solver,</div>
<div class="line"><span class="lineno"> 1347</span>      meta_games[-1], per_player_repeats, ignore_repeats)</div>
<div class="line"><span class="lineno"> 1348</span> </div>
<div class="line"><span class="lineno"> 1349</span>  <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno"> 1350</span>      iteration,</div>
<div class="line"><span class="lineno"> 1351</span>      per_player_repeats,</div>
<div class="line"><span class="lineno"> 1352</span>      per_player_policies,</div>
<div class="line"><span class="lineno"> 1353</span>      joint_policies,</div>
<div class="line"><span class="lineno"> 1354</span>      joint_returns,</div>
<div class="line"><span class="lineno"> 1355</span>      meta_games,</div>
<div class="line"><span class="lineno"> 1356</span>      train_meta_dists,</div>
<div class="line"><span class="lineno"> 1357</span>      eval_meta_dists,</div>
<div class="line"><span class="lineno"> 1358</span>      train_meta_values,</div>
<div class="line"><span class="lineno"> 1359</span>      eval_meta_values,</div>
<div class="line"><span class="lineno"> 1360</span>      train_meta_gaps,</div>
<div class="line"><span class="lineno"> 1361</span>      eval_meta_gaps)</div>
<div class="line"><span class="lineno"> 1362</span> </div>
<div class="line"><span class="lineno"> 1363</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01165">open_spiel.python.algorithms.jpsro.add_meta_dist()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01150">open_spiel.python.algorithms.jpsro.add_meta_game()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01056">open_spiel.python.algorithms.jpsro.add_new_policies()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01029">open_spiel.python.algorithms.jpsro.initialize_policy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01433">open_spiel.python.algorithms.jpsro.run_loop()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_cgraph">
<area shape="rect" title="Main Loop." alt="" coords="5,112,279,137"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4bd6365e26652a88ca2de77eab51bb00" title=" " alt="" coords="340,5,587,46"/>
<area shape="poly" title=" " alt="" coords="177,108,326,56,356,48,357,53,327,62,179,113"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8002f75b143a5a7eb054a20f640c5a24" title=" " alt="" coords="340,71,587,111"/>
<area shape="poly" title=" " alt="" coords="272,108,324,103,324,108,272,114"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a9070921c5927df62cd7cb6c1b5c0123c" title=" " alt="" coords="340,136,587,177"/>
<area shape="poly" title=" " alt="" coords="278,135,324,140,324,145,277,140"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab10a253b3f0969595c659d2311bc70ac" title="PSRO Functions." alt="" coords="327,201,600,242"/>
<area shape="poly" title=" " alt="" coords="179,135,327,186,358,194,356,199,326,191,178,140"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a4f4623116b95368c61c3170bc2844457_icgraph">
<area shape="rect" title="Main Loop." alt="" coords="329,5,602,31"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a53ee5846cf329f075c268a95c243a60a" title=" " alt="" coords="5,5,281,31"/>
<area shape="poly" title=" " alt="" coords="313,21,281,21,281,16,313,16"/>
</map>
</div>

</div>
</div>
<a id="a5acb7ac3e7c2fc895b889d5493410574" name="a5acb7ac3e7c2fc895b889d5493410574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5acb7ac3e7c2fc895b889d5493410574">&#9670;&#160;</a></span>initialize_callback_()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.initialize_callback_ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>iteration</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_repeats</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>per_player_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_policies</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>joint_returns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>meta_games</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_dists</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_dists</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_values</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_values</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_gaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_gaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Callback which allows initializing from checkpoint.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01364">1364</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1377</span>    game):</div>
<div class="line"><span class="lineno"> 1378</span>  <span class="stringliteral">&quot;&quot;&quot;Callback which allows initializing from checkpoint.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1379</span>  del game</div>
<div class="line"><span class="lineno"> 1380</span>  checkpoint = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1381</span>  <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno"> 1382</span>      iteration,</div>
<div class="line"><span class="lineno"> 1383</span>      per_player_repeats,</div>
<div class="line"><span class="lineno"> 1384</span>      per_player_policies,</div>
<div class="line"><span class="lineno"> 1385</span>      joint_policies,</div>
<div class="line"><span class="lineno"> 1386</span>      joint_returns,</div>
<div class="line"><span class="lineno"> 1387</span>      meta_games,</div>
<div class="line"><span class="lineno"> 1388</span>      train_meta_dists,</div>
<div class="line"><span class="lineno"> 1389</span>      eval_meta_dists,</div>
<div class="line"><span class="lineno"> 1390</span>      train_meta_values,</div>
<div class="line"><span class="lineno"> 1391</span>      eval_meta_values,</div>
<div class="line"><span class="lineno"> 1392</span>      train_meta_gaps,</div>
<div class="line"><span class="lineno"> 1393</span>      eval_meta_gaps,</div>
<div class="line"><span class="lineno"> 1394</span>      checkpoint)</div>
<div class="line"><span class="lineno"> 1395</span> </div>
<div class="line"><span class="lineno"> 1396</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab10a253b3f0969595c659d2311bc70ac" name="ab10a253b3f0969595c659d2311bc70ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab10a253b3f0969595c659d2311bc70ac">&#9670;&#160;</a></span>initialize_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.initialize_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy_init</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PSRO Functions. </p>
<pre class="fragment">Returns initial policy.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01029">1029</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1029</span><span class="keyword">def </span>initialize_policy(game, player, policy_init):</div>
<div class="line"><span class="lineno"> 1030</span>  <span class="stringliteral">&quot;&quot;&quot;Returns initial policy.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1031</span>  <span class="keywordflow">if</span> policy_init == <span class="stringliteral">&quot;uniform&quot;</span>:</div>
<div class="line"><span class="lineno"> 1032</span>    new_policy = policy.TabularPolicy(game, players=(player,))</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>  <span class="keywordflow">elif</span> policy_init == <span class="stringliteral">&quot;random_deterministic&quot;</span>:</div>
<div class="line"><span class="lineno"> 1035</span>    new_policy = policy.TabularPolicy(game, players=(player,))</div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(new_policy.action_probability_array.shape[0]):</div>
<div class="line"><span class="lineno"> 1037</span>      new_policy.action_probability_array[i] = np.random.multinomial(</div>
<div class="line"><span class="lineno"> 1038</span>          1, new_policy.action_probability_array[i]).astype(np.float64)</div>
<div class="line"><span class="lineno"> 1039</span> </div>
<div class="line"><span class="lineno"> 1040</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1041</span>    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno"> 1042</span>        <span class="stringliteral">&quot;policy_init must be a valid initialization strategy: %s. &quot;</span></div>
<div class="line"><span class="lineno"> 1043</span>        <span class="stringliteral">&quot;Received: %s&quot;</span> % (INIT_POLICIES, policy_init))</div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>  <span class="keywordflow">return</span> new_policy</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01311">open_spiel.python.algorithms.jpsro.initialize()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab10a253b3f0969595c659d2311bc70ac_icgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab10a253b3f0969595c659d2311bc70ac_icgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab10a253b3f0969595c659d2311bc70ac_icgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_ab10a253b3f0969595c659d2311bc70ac_icgraph">
<area shape="rect" title="PSRO Functions." alt="" coords="650,5,923,46"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4f4623116b95368c61c3170bc2844457" title="Main Loop." alt="" coords="329,13,602,38"/>
<area shape="poly" title=" " alt="" coords="635,28,603,28,603,23,635,23"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a53ee5846cf329f075c268a95c243a60a" title=" " alt="" coords="5,13,281,38"/>
<area shape="poly" title=" " alt="" coords="313,28,281,28,281,23,313,23"/>
</map>
</div>

</div>
</div>
<a id="a53ee5846cf329f075c268a95c243a60a" name="a53ee5846cf329f075c268a95c243a60a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53ee5846cf329f075c268a95c243a60a">&#9670;&#160;</a></span>run_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.run_loop </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seed</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>iterations</em></span><span class="paramdefsep"> = </span><span class="paramdefval">40</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy_init</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;uniform&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>update_players_strategy</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;all&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>target_equilibrium</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;cce&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>br_selection</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;largest_gap&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>train_meta_solver</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;mgcce&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>eval_meta_solver</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;mwcce&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ignore_repeats</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>initialize_callback</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>action_value_tolerance</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1.0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>callback</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Runs JPSRO.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01420">1420</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1433</span>             callback=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1434</span>  <span class="stringliteral">&quot;&quot;&quot;Runs JPSRO.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1435</span>  <span class="keywordflow">if</span> initialize_callback <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1436</span>    initialize_callback = initialize_callback_</div>
<div class="line"><span class="lineno"> 1437</span>  <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1438</span>    callback = callback_</div>
<div class="line"><span class="lineno"> 1439</span>  kwargs = dict(</div>
<div class="line"><span class="lineno"> 1440</span>      game=game,</div>
<div class="line"><span class="lineno"> 1441</span>      game_name=game_name,</div>
<div class="line"><span class="lineno"> 1442</span>      seed=seed,</div>
<div class="line"><span class="lineno"> 1443</span>      iterations=iterations,</div>
<div class="line"><span class="lineno"> 1444</span>      policy_init=policy_init,</div>
<div class="line"><span class="lineno"> 1445</span>      update_players_strategy=update_players_strategy,</div>
<div class="line"><span class="lineno"> 1446</span>      target_equilibrium=target_equilibrium,</div>
<div class="line"><span class="lineno"> 1447</span>      br_selection=br_selection,</div>
<div class="line"><span class="lineno"> 1448</span>      train_meta_solver=train_meta_solver,</div>
<div class="line"><span class="lineno"> 1449</span>      eval_meta_solver=eval_meta_solver,</div>
<div class="line"><span class="lineno"> 1450</span>      ignore_repeats=ignore_repeats,</div>
<div class="line"><span class="lineno"> 1451</span>  )</div>
<div class="line"><span class="lineno"> 1452</span> </div>
<div class="line"><span class="lineno"> 1453</span>  <span class="comment"># Set seed.</span></div>
<div class="line"><span class="lineno"> 1454</span>  np.random.seed(seed)</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>  <span class="comment"># Some statistics.</span></div>
<div class="line"><span class="lineno"> 1457</span>  num_players = game.num_players()  <span class="comment"># Look in the game.</span></div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>  <span class="comment"># Initialize.</span></div>
<div class="line"><span class="lineno"> 1460</span>  values = initialize(game, train_meta_solver, eval_meta_solver, policy_init,</div>
<div class="line"><span class="lineno"> 1461</span>                      ignore_repeats, br_selection)</div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>  <span class="comment"># Initialize Callback.</span></div>
<div class="line"><span class="lineno"> 1464</span>  (iteration,</div>
<div class="line"><span class="lineno"> 1465</span>   per_player_repeats,</div>
<div class="line"><span class="lineno"> 1466</span>   per_player_policies,</div>
<div class="line"><span class="lineno"> 1467</span>   joint_policies,</div>
<div class="line"><span class="lineno"> 1468</span>   joint_returns,</div>
<div class="line"><span class="lineno"> 1469</span>   meta_games,</div>
<div class="line"><span class="lineno"> 1470</span>   train_meta_dists,</div>
<div class="line"><span class="lineno"> 1471</span>   eval_meta_dists,</div>
<div class="line"><span class="lineno"> 1472</span>   train_meta_values,</div>
<div class="line"><span class="lineno"> 1473</span>   eval_meta_values,</div>
<div class="line"><span class="lineno"> 1474</span>   train_meta_gaps,</div>
<div class="line"><span class="lineno"> 1475</span>   eval_meta_gaps,</div>
<div class="line"><span class="lineno"> 1476</span>   checkpoint) = initialize_callback(*values, game)</div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span>  <span class="comment"># Run JPSRO.</span></div>
<div class="line"><span class="lineno"> 1479</span>  <span class="keywordflow">while</span> iteration &lt;= iterations:</div>
<div class="line"><span class="lineno"> 1480</span>    logging.debug(<span class="stringliteral">&quot;Beginning JPSRO iteration %03d&quot;</span>, iteration)</div>
<div class="line"><span class="lineno"> 1481</span>    per_player_new_policies, per_player_gaps_train = find_best_response(</div>
<div class="line"><span class="lineno"> 1482</span>        game,</div>
<div class="line"><span class="lineno"> 1483</span>        train_meta_dists[-1],</div>
<div class="line"><span class="lineno"> 1484</span>        meta_games[-1],</div>
<div class="line"><span class="lineno"> 1485</span>        iteration,</div>
<div class="line"><span class="lineno"> 1486</span>        joint_policies,</div>
<div class="line"><span class="lineno"> 1487</span>        target_equilibrium,</div>
<div class="line"><span class="lineno"> 1488</span>        update_players_strategy,</div>
<div class="line"><span class="lineno"> 1489</span>        action_value_tolerance,</div>
<div class="line"><span class="lineno"> 1490</span>    )</div>
<div class="line"><span class="lineno"> 1491</span>    train_meta_gaps.append([sum(gaps) <span class="keywordflow">for</span> gaps <span class="keywordflow">in</span> per_player_gaps_train])</div>
<div class="line"><span class="lineno"> 1492</span>    _, per_player_gaps_eval = find_best_response(</div>
<div class="line"><span class="lineno"> 1493</span>        game,</div>
<div class="line"><span class="lineno"> 1494</span>        eval_meta_dists[-1],</div>
<div class="line"><span class="lineno"> 1495</span>        meta_games[-1],</div>
<div class="line"><span class="lineno"> 1496</span>        iteration,</div>
<div class="line"><span class="lineno"> 1497</span>        joint_policies,</div>
<div class="line"><span class="lineno"> 1498</span>        target_equilibrium,</div>
<div class="line"><span class="lineno"> 1499</span>        update_players_strategy,</div>
<div class="line"><span class="lineno"> 1500</span>        action_value_tolerance,</div>
<div class="line"><span class="lineno"> 1501</span>    )</div>
<div class="line"><span class="lineno"> 1502</span>    eval_meta_gaps.append([sum(gaps) <span class="keywordflow">for</span> gaps <span class="keywordflow">in</span> per_player_gaps_eval])</div>
<div class="line"><span class="lineno"> 1503</span>    per_player_num_novel_policies = add_new_policies(</div>
<div class="line"><span class="lineno"> 1504</span>        per_player_new_policies, per_player_gaps_train, per_player_repeats,</div>
<div class="line"><span class="lineno"> 1505</span>        per_player_policies, joint_policies, joint_returns, game, br_selection)</div>
<div class="line"><span class="lineno"> 1506</span>    del per_player_num_novel_policies</div>
<div class="line"><span class="lineno"> 1507</span>    add_meta_game(</div>
<div class="line"><span class="lineno"> 1508</span>        meta_games,</div>
<div class="line"><span class="lineno"> 1509</span>        per_player_policies,</div>
<div class="line"><span class="lineno"> 1510</span>        joint_returns)</div>
<div class="line"><span class="lineno"> 1511</span>    add_meta_dist(</div>
<div class="line"><span class="lineno"> 1512</span>        train_meta_dists, train_meta_values, train_meta_solver,</div>
<div class="line"><span class="lineno"> 1513</span>        meta_games[-1], per_player_repeats, ignore_repeats)</div>
<div class="line"><span class="lineno"> 1514</span>    add_meta_dist(</div>
<div class="line"><span class="lineno"> 1515</span>        eval_meta_dists, eval_meta_values, eval_meta_solver,</div>
<div class="line"><span class="lineno"> 1516</span>        meta_games[-1], per_player_repeats, ignore_repeats)</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>    <span class="comment"># Stats.</span></div>
<div class="line"><span class="lineno"> 1519</span>    per_player_num_policies = train_meta_dists[-1].shape[:]</div>
<div class="line"><span class="lineno"> 1520</span>    log_string = LOG_STRING.format(</div>
<div class="line"><span class="lineno"> 1521</span>        iteration=iteration,</div>
<div class="line"><span class="lineno"> 1522</span>        game=game_name,</div>
<div class="line"><span class="lineno"> 1523</span>        player=(<span class="stringliteral">&quot;{: 12d}&quot;</span> * num_players).format(*list(range(num_players))),</div>
<div class="line"><span class="lineno"> 1524</span>        brs=<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno"> 1525</span>        num_policies=(<span class="stringliteral">&quot;{: 12d}&quot;</span> * num_players).format(*[</div>
<div class="line"><span class="lineno"> 1526</span>            sum(ppr) <span class="keywordflow">for</span> ppr <span class="keywordflow">in</span> per_player_repeats]),</div>
<div class="line"><span class="lineno"> 1527</span>        unique=(<span class="stringliteral">&quot;{: 12d}&quot;</span> * num_players).format(*per_player_num_policies),</div>
<div class="line"><span class="lineno"> 1528</span>        train_meta_solver=train_meta_solver,</div>
<div class="line"><span class="lineno"> 1529</span>        train_value=(<span class="stringliteral">&quot;{: 12g}&quot;</span> * num_players).format(*train_meta_values[-1]),</div>
<div class="line"><span class="lineno"> 1530</span>        train_gap=(<span class="stringliteral">&quot;{: 12g}&quot;</span> * num_players).format(*train_meta_gaps[-1]),</div>
<div class="line"><span class="lineno"> 1531</span>        eval_meta_solver=eval_meta_solver,</div>
<div class="line"><span class="lineno"> 1532</span>        eval_value=(<span class="stringliteral">&quot;{: 12g}&quot;</span> * num_players).format(*eval_meta_values[-1]),</div>
<div class="line"><span class="lineno"> 1533</span>        eval_gap=(<span class="stringliteral">&quot;{: 12g}&quot;</span> * num_players).format(*eval_meta_gaps[-1]),</div>
<div class="line"><span class="lineno"> 1534</span>    )</div>
<div class="line"><span class="lineno"> 1535</span>    logging.info(log_string)</div>
<div class="line"><span class="lineno"> 1536</span> </div>
<div class="line"><span class="lineno"> 1537</span>    <span class="comment"># Increment.</span></div>
<div class="line"><span class="lineno"> 1538</span>    iteration += 1</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>    <span class="comment"># Callback.</span></div>
<div class="line"><span class="lineno"> 1541</span>    checkpoint = callback(</div>
<div class="line"><span class="lineno"> 1542</span>        iteration,</div>
<div class="line"><span class="lineno"> 1543</span>        per_player_repeats,</div>
<div class="line"><span class="lineno"> 1544</span>        per_player_policies,</div>
<div class="line"><span class="lineno"> 1545</span>        joint_policies,</div>
<div class="line"><span class="lineno"> 1546</span>        joint_returns,</div>
<div class="line"><span class="lineno"> 1547</span>        meta_games,</div>
<div class="line"><span class="lineno"> 1548</span>        train_meta_dists,</div>
<div class="line"><span class="lineno"> 1549</span>        eval_meta_dists,</div>
<div class="line"><span class="lineno"> 1550</span>        train_meta_values,</div>
<div class="line"><span class="lineno"> 1551</span>        eval_meta_values,</div>
<div class="line"><span class="lineno"> 1552</span>        train_meta_gaps,</div>
<div class="line"><span class="lineno"> 1553</span>        eval_meta_gaps,</div>
<div class="line"><span class="lineno"> 1554</span>        kwargs,</div>
<div class="line"><span class="lineno"> 1555</span>        checkpoint)</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01165">open_spiel.python.algorithms.jpsro.add_meta_dist()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01150">open_spiel.python.algorithms.jpsro.add_meta_game()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01056">open_spiel.python.algorithms.jpsro.add_new_policies()</a>, <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01193">open_spiel.python.algorithms.jpsro.find_best_response()</a>, and <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01311">open_spiel.python.algorithms.jpsro.initialize()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a53ee5846cf329f075c268a95c243a60a_cgraph.png" border="0" usemap="#add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a53ee5846cf329f075c268a95c243a60a_cgraph" alt=""/></div>
<map name="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a53ee5846cf329f075c268a95c243a60a_cgraph" id="add/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro_a53ee5846cf329f075c268a95c243a60a_cgraph">
<area shape="rect" title=" " alt="" coords="5,129,281,154"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4bd6365e26652a88ca2de77eab51bb00" title=" " alt="" coords="663,5,910,46"/>
<area shape="poly" title=" " alt="" coords="185,126,252,106,328,87,493,58,647,37,648,43,494,63,329,92,253,111,186,131"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a8002f75b143a5a7eb054a20f640c5a24" title=" " alt="" coords="663,71,910,111"/>
<area shape="poly" title=" " alt="" coords="231,126,328,114,494,101,648,93,648,98,494,106,329,119,232,131"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a9070921c5927df62cd7cb6c1b5c0123c" title=" " alt="" coords="663,201,910,242"/>
<area shape="poly" title=" " alt="" coords="240,152,329,164,648,203,647,208,328,170,240,158"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#adcb700f5519bce84ab7a3d8b1dca5c36" title=" " alt="" coords="342,229,589,270"/>
<area shape="poly" title=" " alt="" coords="178,153,330,208,373,222,371,227,328,214,176,158"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#a4f4623116b95368c61c3170bc2844457" title="Main Loop." alt="" coords="329,129,602,154"/>
<area shape="poly" title=" " alt="" coords="281,139,313,139,313,144,281,144"/>
<area shape="poly" title=" " alt="" coords="491,126,561,92,649,56,676,48,677,53,651,62,563,97,493,131"/>
<area shape="poly" title=" " alt="" coords="551,126,647,110,648,116,552,131"/>
<area shape="poly" title=" " alt="" coords="528,153,603,171,651,186,683,194,682,199,649,191,601,176,527,158"/>
<area shape="rect" href="../../dd/d99/namespaceopen__spiel_1_1python_1_1algorithms_1_1jpsro.html#ab10a253b3f0969595c659d2311bc70ac" title="PSRO Functions." alt="" coords="650,136,923,177"/>
<area shape="poly" title=" " alt="" coords="602,145,634,147,634,152,602,151"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="abff467ea872d5da70f4b9bbd19595b05" name="abff467ea872d5da70f4b9bbd19595b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abff467ea872d5da70f4b9bbd19595b05">&#9670;&#160;</a></span>BR_SELECTIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple open_spiel.python.algorithms.jpsro.BR_SELECTIONS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&quot;all&quot;</span>,  <span class="comment"># All policies.</span></div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&quot;all_novel&quot;</span>,  <span class="comment"># All novel policies.</span></div>
<div class="line"><span class="lineno">    4</span>    <span class="stringliteral">&quot;random&quot;</span>,  <span class="comment"># Random.</span></div>
<div class="line"><span class="lineno">    5</span>    <span class="stringliteral">&quot;random_novel&quot;</span>,  <span class="comment"># Random novel BR (one that has not be considered before).</span></div>
<div class="line"><span class="lineno">    6</span>    <span class="stringliteral">&quot;largest_gap&quot;</span>,  <span class="comment"># The BR with the largest gap.</span></div>
<div class="line"><span class="lineno">    7</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00096">96</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a55e83f3cffc405f02d8a02825f6e6a2f" name="a55e83f3cffc405f02d8a02825f6e6a2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55e83f3cffc405f02d8a02825f6e6a2f">&#9670;&#160;</a></span>BRS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple open_spiel.python.algorithms.jpsro.BRS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&quot;cce&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&quot;ce&quot;</span>,</div>
<div class="line"><span class="lineno">    4</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00092">92</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a3079dcb39e0cadfce15322fee02c1828" name="a3079dcb39e0cadfce15322fee02c1828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3079dcb39e0cadfce15322fee02c1828">&#9670;&#160;</a></span>DEFAULT_CVXOPT_SOLVER_KWARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.DEFAULT_CVXOPT_SOLVER_KWARGS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  dict(</div>
<div class="line"><span class="lineno">    2</span>    solver=<span class="stringliteral">&quot;CVXOPT&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    maxiters=200000,</div>
<div class="line"><span class="lineno">    4</span>    abstol=5e-8,</div>
<div class="line"><span class="lineno">    5</span>    reltol=5e-8,</div>
<div class="line"><span class="lineno">    6</span>    feastol=5e-8,</div>
<div class="line"><span class="lineno">    7</span>    refinement=10,</div>
<div class="line"><span class="lineno">    8</span>    verbose=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">    9</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00074">74</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="af992048eef9e10a8455056c99585ecb2" name="af992048eef9e10a8455056c99585ecb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af992048eef9e10a8455056c99585ecb2">&#9670;&#160;</a></span>DEFAULT_ECOS_SOLVER_KWARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.DEFAULT_ECOS_SOLVER_KWARGS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  dict(</div>
<div class="line"><span class="lineno">    2</span>    solver=<span class="stringliteral">&quot;ECOS&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    max_iters=100000000,</div>
<div class="line"><span class="lineno">    4</span>    abstol=1e-7,</div>
<div class="line"><span class="lineno">    5</span>    reltol=1e-7,</div>
<div class="line"><span class="lineno">    6</span>    feastol=1e-7,</div>
<div class="line"><span class="lineno">    7</span>    abstol_inacc=1e-7,</div>
<div class="line"><span class="lineno">    8</span>    reltol_inacc=1e-7,</div>
<div class="line"><span class="lineno">    9</span>    feastol_inacc=1e-7,</div>
<div class="line"><span class="lineno">   10</span>    verbose=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">   11</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00050">50</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a997723cbb05a92aef5c2f29c8964c632" name="a997723cbb05a92aef5c2f29c8964c632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997723cbb05a92aef5c2f29c8964c632">&#9670;&#160;</a></span>DEFAULT_OSQP_SOLVER_KWARGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.DEFAULT_OSQP_SOLVER_KWARGS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  dict(</div>
<div class="line"><span class="lineno">    2</span>    solver=<span class="stringliteral">&quot;OSQP&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    max_iter=1000000000,</div>
<div class="line"><span class="lineno">    4</span>    eps_abs=1e-8,</div>
<div class="line"><span class="lineno">    5</span>    eps_rel=1e-8,</div>
<div class="line"><span class="lineno">    6</span>    eps_prim_inf=1e-8,</div>
<div class="line"><span class="lineno">    7</span>    eps_dual_inf=1e-8,</div>
<div class="line"><span class="lineno">    8</span>    polish_refine_iter=100,</div>
<div class="line"><span class="lineno">    9</span>    check_termination=1000,</div>
<div class="line"><span class="lineno">   10</span>    sigma=1e-7,  <span class="comment"># Default 1e-6</span></div>
<div class="line"><span class="lineno">   11</span>    delta=1e-7,  <span class="comment"># Default 1e-06</span></div>
<div class="line"><span class="lineno">   12</span>    verbose=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">   13</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00061">61</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a8882b396dfb4c382afefa50f9886ea8b" name="a8882b396dfb4c382afefa50f9886ea8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8882b396dfb4c382afefa50f9886ea8b">&#9670;&#160;</a></span>DIST_TOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int open_spiel.python.algorithms.jpsro.DIST_TOL = 1e-8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00139">139</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a00890153016c8607057ac2d0daa53d41" name="a00890153016c8607057ac2d0daa53d41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00890153016c8607057ac2d0daa53d41">&#9670;&#160;</a></span>FLAG_TO_FUNC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.jpsro.FLAG_TO_FUNC</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  dict(</div>
<div class="line"><span class="lineno">    2</span>    uni=_uni,</div>
<div class="line"><span class="lineno">    3</span>    undominated_uni=_undominated_uni,</div>
<div class="line"><span class="lineno">    4</span>    rj=_rj,</div>
<div class="line"><span class="lineno">    5</span>    undominated_rj=_undominated_rj,</div>
<div class="line"><span class="lineno">    6</span>    rd=_rd,</div>
<div class="line"><span class="lineno">    7</span>    undominated_rd=_undominated_rd,</div>
<div class="line"><span class="lineno">    8</span>    prd=_prd,</div>
<div class="line"><span class="lineno">    9</span>    alpharank=_alpharank,</div>
<div class="line"><span class="lineno">   10</span>    mgce=_mgce,</div>
<div class="line"><span class="lineno">   11</span>    min_epsilon_mgce=_min_epsilon_mgce,</div>
<div class="line"><span class="lineno">   12</span>    approx_mgce=_approx_mgce,</div>
<div class="line"><span class="lineno">   13</span>    rmwce=_rmwce,</div>
<div class="line"><span class="lineno">   14</span>    mwce=_mwce,</div>
<div class="line"><span class="lineno">   15</span>    rvce=_rvce,</div>
<div class="line"><span class="lineno">   16</span>    mgcce=_mgcce,</div>
<div class="line"><span class="lineno">   17</span>    min_epsilon_mgcce=_min_epsilon_mgcce,</div>
<div class="line"><span class="lineno">   18</span>    approx_mgcce=_approx_mgcce,</div>
<div class="line"><span class="lineno">   19</span>    rmwcce=_rmwcce,</div>
<div class="line"><span class="lineno">   20</span>    mwcce=_mwcce,</div>
<div class="line"><span class="lineno">   21</span>    rvcce=_rvcce,</div>
<div class="line"><span class="lineno">   22</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l01002">1002</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a0e214ec216d424e76d6032c72eac04d6" name="a0e214ec216d424e76d6032c72eac04d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e214ec216d424e76d6032c72eac04d6">&#9670;&#160;</a></span>GAP_TOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int open_spiel.python.algorithms.jpsro.GAP_TOL = 1e-8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00140">140</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="ad8a6f360913a44091fbdb262a69e74f9" name="ad8a6f360913a44091fbdb262a69e74f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8a6f360913a44091fbdb262a69e74f9">&#9670;&#160;</a></span>INIT_POLICIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple open_spiel.python.algorithms.jpsro.INIT_POLICIES</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&quot;uniform&quot;</span>,  <span class="comment"># Unopinionated but slower to evaluate.</span></div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&quot;random_deterministic&quot;</span>,  <span class="comment"># Faster to evaluate but requires samples.</span></div>
<div class="line"><span class="lineno">    4</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00083">83</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a671bb7d9cd1bb7bfec1c451856ad2f89" name="a671bb7d9cd1bb7bfec1c451856ad2f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a671bb7d9cd1bb7bfec1c451856ad2f89">&#9670;&#160;</a></span>LOG_STRING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str open_spiel.python.algorithms.jpsro.LOG_STRING</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">    2</span><span class="stringliteral">Iteration {iteration: 6d}</span></div>
<div class="line"><span class="lineno">    3</span><span class="stringliteral">=== ({game})</span></div>
<div class="line"><span class="lineno">    4</span><span class="stringliteral">Player            {player}</span></div>
<div class="line"><span class="lineno">    5</span><span class="stringliteral">BRs               {brs}</span></div>
<div class="line"><span class="lineno">    6</span><span class="stringliteral">Num Policies      {num_policies}</span></div>
<div class="line"><span class="lineno">    7</span><span class="stringliteral">Unique Policies   {unique}</span></div>
<div class="line"><span class="lineno">    8</span><span class="stringliteral">--- ({train_meta_solver})</span></div>
<div class="line"><span class="lineno">    9</span><span class="stringliteral">Train Value       {train_value}</span></div>
<div class="line"><span class="lineno">   10</span><span class="stringliteral">Train Gap         {train_gap}</span></div>
<div class="line"><span class="lineno">   11</span><span class="stringliteral">--- ({eval_meta_solver})</span></div>
<div class="line"><span class="lineno">   12</span><span class="stringliteral">Eval Value        {eval_value}</span></div>
<div class="line"><span class="lineno">   13</span><span class="stringliteral">Eval Gap          {eval_gap}</span></div>
<div class="line"><span class="lineno">   14</span><span class="stringliteral">&quot;&quot;&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00125">125</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a7c4a465cb3ca5674dc5daac8dd01c06b" name="a7c4a465cb3ca5674dc5daac8dd01c06b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c4a465cb3ca5674dc5daac8dd01c06b">&#9670;&#160;</a></span>META_SOLVERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple open_spiel.python.algorithms.jpsro.META_SOLVERS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&quot;uni&quot;</span>,  <span class="comment"># Uniform.</span></div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&quot;undominated_uni&quot;</span>,  <span class="comment"># Uniform over undominated strategies.</span></div>
<div class="line"><span class="lineno">    4</span>    <span class="stringliteral">&quot;rj&quot;</span>,  <span class="comment"># Random joint.</span></div>
<div class="line"><span class="lineno">    5</span>    <span class="stringliteral">&quot;undominated_rj&quot;</span>,  <span class="comment"># Random joint.</span></div>
<div class="line"><span class="lineno">    6</span>    <span class="stringliteral">&quot;rd&quot;</span>,  <span class="comment"># Random dirichlet.</span></div>
<div class="line"><span class="lineno">    7</span>    <span class="stringliteral">&quot;undominated_rd&quot;</span>,  <span class="comment"># Random dirichlet.</span></div>
<div class="line"><span class="lineno">    8</span>    <span class="stringliteral">&quot;prd&quot;</span>,  <span class="comment"># Prodected replicator dynamics.</span></div>
<div class="line"><span class="lineno">    9</span>    <span class="stringliteral">&quot;alpharank&quot;</span>,  <span class="comment"># Alpha-Rank</span></div>
<div class="line"><span class="lineno">   10</span>    <span class="stringliteral">&quot;mgce&quot;</span>,  <span class="comment"># Maximum gini CE.</span></div>
<div class="line"><span class="lineno">   11</span>    <span class="stringliteral">&quot;min_epsilon_mgce&quot;</span>,  <span class="comment"># Min Epsilon Maximum gini CE.</span></div>
<div class="line"><span class="lineno">   12</span>    <span class="stringliteral">&quot;approx_mgce&quot;</span>,  <span class="comment"># Approximate Maximum gini CE.</span></div>
<div class="line"><span class="lineno">   13</span>    <span class="stringliteral">&quot;rmwce&quot;</span>,  <span class="comment"># Random maximum welfare CE.</span></div>
<div class="line"><span class="lineno">   14</span>    <span class="stringliteral">&quot;mwce&quot;</span>,  <span class="comment"># Maximum welfare CE.</span></div>
<div class="line"><span class="lineno">   15</span>    <span class="stringliteral">&quot;rvce&quot;</span>,  <span class="comment"># Random vertex CE.</span></div>
<div class="line"><span class="lineno">   16</span>    <span class="stringliteral">&quot;mgcce&quot;</span>,  <span class="comment"># Maximum gini CCE.</span></div>
<div class="line"><span class="lineno">   17</span>    <span class="stringliteral">&quot;min_epsilon_mgcce&quot;</span>,  <span class="comment"># Min Epsilon Maximum gini CCE.</span></div>
<div class="line"><span class="lineno">   18</span>    <span class="stringliteral">&quot;approx_mgcce&quot;</span>,  <span class="comment"># Approximate Maximum gini CE.</span></div>
<div class="line"><span class="lineno">   19</span>    <span class="stringliteral">&quot;rmwcce&quot;</span>,  <span class="comment"># Random maximum welfare CCE.</span></div>
<div class="line"><span class="lineno">   20</span>    <span class="stringliteral">&quot;mwcce&quot;</span>,  <span class="comment"># Maximum welfare CCE.</span></div>
<div class="line"><span class="lineno">   21</span>    <span class="stringliteral">&quot;rvcce&quot;</span>,  <span class="comment"># Random vertex CCE.</span></div>
<div class="line"><span class="lineno">   22</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00103">103</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="a6cf45729b1351395470d3e0dca72864f" name="a6cf45729b1351395470d3e0dca72864f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf45729b1351395470d3e0dca72864f">&#9670;&#160;</a></span>RETURN_TOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int open_spiel.python.algorithms.jpsro.RETURN_TOL = 1e-12</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00141">141</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
<a id="adc7ebf78bce2e1fff3b7c68409506c90" name="adc7ebf78bce2e1fff3b7c68409506c90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc7ebf78bce2e1fff3b7c68409506c90">&#9670;&#160;</a></span>UPDATE_PLAYERS_STRATEGY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple open_spiel.python.algorithms.jpsro.UPDATE_PLAYERS_STRATEGY</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&quot;all&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&quot;cycle&quot;</span>,</div>
<div class="line"><span class="lineno">    4</span>    <span class="stringliteral">&quot;random&quot;</span>,</div>
<div class="line"><span class="lineno">    5</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html#l00087">87</a> of file <a class="el" href="../../d5/d99/algorithms_2jpsro_8py_source.html">jpsro.py</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
