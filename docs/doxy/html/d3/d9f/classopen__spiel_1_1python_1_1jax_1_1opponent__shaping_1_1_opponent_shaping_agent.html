<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.jax.opponent_shaping.OpponentShapingAgent Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../df/dc9/namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="../../d9/d47/namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><b>jax</b></li><li class="navelem"><a class="el" href="../../de/d88/namespaceopen__spiel_1_1python_1_1jax_1_1opponent__shaping.html">opponent_shaping</a></li><li class="navelem"><a class="el" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html">OpponentShapingAgent</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../dc/d65/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for open_spiel.python.jax.opponent_shaping.OpponentShapingAgent:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/dd7/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent__inherit__graph.png" border="0" usemap="#aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_inherit__map" alt="Inheritance graph"/></div>
<map name="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_inherit__map" id="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_inherit__map">
<area shape="rect" title=" " alt="" coords="5,267,211,941"/>
<area shape="rect" href="../../d2/dfa/classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html" title=" " alt="" coords="39,119,177,219"/>
<area shape="poly" title=" " alt="" coords="111,234,111,267,105,267,105,234"/>
<area shape="rect" title=" " alt="" coords="18,5,91,71"/>
<area shape="poly" title=" " alt="" coords="76,83,90,118,85,120,71,85"/>
<area shape="rect" title=" " alt="" coords="115,5,210,71"/>
<area shape="poly" title=" " alt="" coords="146,85,131,120,126,118,141,83"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for open_spiel.python.jax.opponent_shaping.OpponentShapingAgent:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d0b/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent__coll__graph.png" border="0" usemap="#aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_coll__map" alt="Collaboration graph"/></div>
<map name="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_coll__map" id="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_coll__map">
<area shape="rect" title=" " alt="" coords="5,267,211,941"/>
<area shape="rect" href="../../d2/dfa/classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html" title=" " alt="" coords="39,119,177,219"/>
<area shape="poly" title=" " alt="" coords="111,234,111,267,105,267,105,234"/>
<area shape="rect" title=" " alt="" coords="18,5,91,71"/>
<area shape="poly" title=" " alt="" coords="76,83,90,118,85,120,71,85"/>
<area shape="rect" title=" " alt="" coords="115,5,210,71"/>
<area shape="poly" title=" " alt="" coords="146,85,131,120,126,118,141,83"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a688a991bdc9042322d47fc183d7a7ab8" id="r_a688a991bdc9042322d47fc183d7a7ab8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a688a991bdc9042322d47fc183d7a7ab8">__init__</a> (self, int player_id, typing.List[int] opponent_ids, chex.Shape info_state_size, int num_actions, hk.Transformed policy, hk.Transformed critic, int batch_size=16, typing.Union[float, optax.Schedule] critic_learning_rate=0.01, typing.Union[float, optax.Schedule] pi_learning_rate=0.001, typing.Union[float, optax.Schedule] opp_policy_learning_rate=0.001, typing.Union[float, optax.Schedule] opponent_model_learning_rate=0.001, float clip_grad_norm=0.5, int policy_update_interval=8, float discount=0.99, float critic_discount=0.99, jax.random.PRNGKey seed=42, fit_opponent_model=True, str correction_type='dice', bool use_jit=False, int n_lookaheads=1, int num_critic_mini_batches=1, int num_opponent_updates=1, typing.Optional[<a class="el" href="../../d1/d1d/classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html">rl_environment.Environment</a>] env=None)</td></tr>
<tr class="separator:a688a991bdc9042322d47fc183d7a7ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a9c683dd11b09e5667692bc1ab6891" id="r_a20a9c683dd11b09e5667692bc1ab6891"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20a9c683dd11b09e5667692bc1ab6891">train_state</a> (self)</td></tr>
<tr class="separator:a20a9c683dd11b09e5667692bc1ab6891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab261d55d230e37037218f8a91c7a22b7" id="r_ab261d55d230e37037218f8a91c7a22b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab261d55d230e37037218f8a91c7a22b7">policy_network</a> (self)</td></tr>
<tr class="separator:ab261d55d230e37037218f8a91c7a22b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad55be43954fb6c325544adca41430bbd" id="r_ad55be43954fb6c325544adca41430bbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad55be43954fb6c325544adca41430bbd">critic_network</a> (self)</td></tr>
<tr class="separator:ad55be43954fb6c325544adca41430bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43b971fdf9c6cec4de895b6ae366aac" id="r_ac43b971fdf9c6cec4de895b6ae366aac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac43b971fdf9c6cec4de895b6ae366aac">metrics</a> (self, bool return_last_only=True)</td></tr>
<tr class="separator:ac43b971fdf9c6cec4de895b6ae366aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fd78be8c0cd590a8c974be8e603d2d1" id="r_a3fd78be8c0cd590a8c974be8e603d2d1"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3fd78be8c0cd590a8c974be8e603d2d1">update_params</a> (self, <a class="el" href="../../d4/d14/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_train_state.html">TrainState</a> state, int player_id)</td></tr>
<tr class="separator:a3fd78be8c0cd590a8c974be8e603d2d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad592a86c90ce19aa7b49b93823803fe6" id="r_ad592a86c90ce19aa7b49b93823803fe6"><td class="memItemLeft" align="right" valign="top">typing.Callable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad592a86c90ce19aa7b49b93823803fe6">get_value_fn</a> (self)</td></tr>
<tr class="separator:ad592a86c90ce19aa7b49b93823803fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d08a854b5449fc58a485a69e2604854" id="r_a7d08a854b5449fc58a485a69e2604854"><td class="memItemLeft" align="right" valign="top">typing.Callable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d08a854b5449fc58a485a69e2604854">get_policy</a> (self, return_probs=True)</td></tr>
<tr class="separator:a7d08a854b5449fc58a485a69e2604854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49083992dc97516ca2e134c672e2520e" id="r_a49083992dc97516ca2e134c672e2520e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49083992dc97516ca2e134c672e2520e">step</a> (self, <a class="el" href="../../de/dec/classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a> time_step, is_evaluation=False)</td></tr>
<tr class="separator:a49083992dc97516ca2e134c672e2520e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6c378bf799aa6ace4e2b54e4edf1f4bb" id="r_a6c378bf799aa6ace4e2b54e4edf1f4bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c378bf799aa6ace4e2b54e4edf1f4bb">player_id</a></td></tr>
<tr class="separator:a6c378bf799aa6ace4e2b54e4edf1f4bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8d702ba311c2a6ec2dd9c8c29749de9f" id="r_a8d702ba311c2a6ec2dd9c8c29749de9f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d702ba311c2a6ec2dd9c8c29749de9f">_init_train_state</a> (self, chex.Shape info_state_size)</td></tr>
<tr class="separator:a8d702ba311c2a6ec2dd9c8c29749de9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92fdbbc16d1a44597453d7f3bd1c6278" id="r_a92fdbbc16d1a44597453d7f3bd1c6278"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92fdbbc16d1a44597453d7f3bd1c6278">_store_time_step</a> (self, <a class="el" href="../../de/dec/classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a> time_step, np.ndarray action)</td></tr>
<tr class="separator:a92fdbbc16d1a44597453d7f3bd1c6278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0d78940728f70c85b0b8b2723ceb280" id="r_aa0d78940728f70c85b0b8b2723ceb280"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0d78940728f70c85b0b8b2723ceb280">_train_step</a> (self)</td></tr>
<tr class="separator:aa0d78940728f70c85b0b8b2723ceb280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c6e95fe51f4fcc38c46f857ff7a14fc" id="r_a4c6e95fe51f4fcc38c46f857ff7a14fc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c6e95fe51f4fcc38c46f857ff7a14fc">_should_update</a> (self)</td></tr>
<tr class="separator:a4c6e95fe51f4fcc38c46f857ff7a14fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b25c7de236284a0d59c11efddea26b1" id="r_a7b25c7de236284a0d59c11efddea26b1"><td class="memItemLeft" align="right" valign="top">typing.Dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b25c7de236284a0d59c11efddea26b1">_update_agent</a> (self, <a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:a7b25c7de236284a0d59c11efddea26b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063f8a6cc351f7d3bcf74757fabb4669" id="r_a063f8a6cc351f7d3bcf74757fabb4669"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a063f8a6cc351f7d3bcf74757fabb4669">_construct_episode_batches</a> (self, typing.List[<a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a>] transitions)</td></tr>
<tr class="separator:a063f8a6cc351f7d3bcf74757fabb4669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7744e2572fb3fa78b3ff0f99baa1a208" id="r_a7744e2572fb3fa78b3ff0f99baa1a208"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7744e2572fb3fa78b3ff0f99baa1a208">_update_policy</a> (self, <a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:a7744e2572fb3fa78b3ff0f99baa1a208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a566493380f42cdfb19e24266739ff031" id="r_a566493380f42cdfb19e24266739ff031"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a566493380f42cdfb19e24266739ff031">_update_critic</a> (self, <a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:a566493380f42cdfb19e24266739ff031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba558f18992f23fda573e138df49ac6" id="r_aaba558f18992f23fda573e138df49ac6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaba558f18992f23fda573e138df49ac6">_update_opponents</a> (self, <a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:aaba558f18992f23fda573e138df49ac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a1a3592b3656e858e405ca6974d3db1" id="r_a6a1a3592b3656e858e405ca6974d3db1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a1a3592b3656e858e405ca6974d3db1">_make_transition</a> (self, <a class="el" href="../../de/dec/classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a> time_step)</td></tr>
<tr class="separator:a6a1a3592b3656e858e405ca6974d3db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a23a99f733cb36d9942b3566feef619c9" id="r_a23a99f733cb36d9942b3566feef619c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a23a99f733cb36d9942b3566feef619c9">_num_actions</a></td></tr>
<tr class="separator:a23a99f733cb36d9942b3566feef619c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d512f8db3cd6995a357d1b1a9a29fe9" id="r_a7d512f8db3cd6995a357d1b1a9a29fe9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d512f8db3cd6995a357d1b1a9a29fe9">_batch_size</a></td></tr>
<tr class="separator:a7d512f8db3cd6995a357d1b1a9a29fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab713e153ecfb4625819c6eb0dd5dff" id="r_a7ab713e153ecfb4625819c6eb0dd5dff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ab713e153ecfb4625819c6eb0dd5dff">_policy_update_interval</a></td></tr>
<tr class="separator:a7ab713e153ecfb4625819c6eb0dd5dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c10635825968de3e335fb21cb40487" id="r_a06c10635825968de3e335fb21cb40487"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06c10635825968de3e335fb21cb40487">_discount</a></td></tr>
<tr class="separator:a06c10635825968de3e335fb21cb40487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9e9588e36469286f584a8e913603be" id="r_afc9e9588e36469286f584a8e913603be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc9e9588e36469286f584a8e913603be">_num_opponent_updates</a></td></tr>
<tr class="separator:afc9e9588e36469286f584a8e913603be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea4e95324109926c7e76c4d01dfd89b" id="r_abea4e95324109926c7e76c4d01dfd89b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abea4e95324109926c7e76c4d01dfd89b">_num_mini_batches</a></td></tr>
<tr class="separator:abea4e95324109926c7e76c4d01dfd89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e6cfee7a8d78903c3b501bf1ec57b2" id="r_a40e6cfee7a8d78903c3b501bf1ec57b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40e6cfee7a8d78903c3b501bf1ec57b2">_prev_time_step</a></td></tr>
<tr class="separator:a40e6cfee7a8d78903c3b501bf1ec57b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc3816de74383fdc79ce7c837f76ec4" id="r_aafc3816de74383fdc79ce7c837f76ec4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aafc3816de74383fdc79ce7c837f76ec4">_prev_action</a></td></tr>
<tr class="separator:aafc3816de74383fdc79ce7c837f76ec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25f34ed6d72e2dc0b30dc1ed2941f76" id="r_aa25f34ed6d72e2dc0b30dc1ed2941f76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa25f34ed6d72e2dc0b30dc1ed2941f76">_data</a></td></tr>
<tr class="separator:aa25f34ed6d72e2dc0b30dc1ed2941f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8dcd4e6158402b9eb2e531c06b0b9a0" id="r_ad8dcd4e6158402b9eb2e531c06b0b9a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8dcd4e6158402b9eb2e531c06b0b9a0">_metrics</a></td></tr>
<tr class="separator:ad8dcd4e6158402b9eb2e531c06b0b9a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac39e3b45ac16eb5b85022bd9b4977450" id="r_ac39e3b45ac16eb5b85022bd9b4977450"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac39e3b45ac16eb5b85022bd9b4977450">_fit_opponent_model</a></td></tr>
<tr class="separator:ac39e3b45ac16eb5b85022bd9b4977450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe09591c36f5e4d95fffab133c3493e8" id="r_abe09591c36f5e4d95fffab133c3493e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe09591c36f5e4d95fffab133c3493e8">_opponent_ids</a></td></tr>
<tr class="separator:abe09591c36f5e4d95fffab133c3493e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80daf71b7e3956716945f59d15d255e6" id="r_a80daf71b7e3956716945f59d15d255e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80daf71b7e3956716945f59d15d255e6">_rng</a></td></tr>
<tr class="separator:a80daf71b7e3956716945f59d15d255e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3d167ad340899d19d5308109aa38fed" id="r_ad3d167ad340899d19d5308109aa38fed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3d167ad340899d19d5308109aa38fed">_step_counter</a></td></tr>
<tr class="separator:ad3d167ad340899d19d5308109aa38fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb2cffe0b4db2762a123cf45521ac6c" id="r_a2bb2cffe0b4db2762a123cf45521ac6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2bb2cffe0b4db2762a123cf45521ac6c">_episode_counter</a></td></tr>
<tr class="separator:a2bb2cffe0b4db2762a123cf45521ac6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5100ba4834fa702cd43d6f0a564ef540" id="r_a5100ba4834fa702cd43d6f0a564ef540"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5100ba4834fa702cd43d6f0a564ef540">_num_learn_steps</a></td></tr>
<tr class="separator:a5100ba4834fa702cd43d6f0a564ef540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb5ce2288d5efa955664b2994299bbb" id="r_aedb5ce2288d5efa955664b2994299bbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aedb5ce2288d5efa955664b2994299bbb">_pi_network</a></td></tr>
<tr class="separator:aedb5ce2288d5efa955664b2994299bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be0298b8c774973728e71ee9e51350d" id="r_a1be0298b8c774973728e71ee9e51350d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1be0298b8c774973728e71ee9e51350d">_critic_network</a></td></tr>
<tr class="separator:a1be0298b8c774973728e71ee9e51350d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af418dfaf2a015727355307aecf6f29dc" id="r_af418dfaf2a015727355307aecf6f29dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af418dfaf2a015727355307aecf6f29dc">_critic_opt</a></td></tr>
<tr class="separator:af418dfaf2a015727355307aecf6f29dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae849a5f35bfd8919d9c22ea227e71d90" id="r_ae849a5f35bfd8919d9c22ea227e71d90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae849a5f35bfd8919d9c22ea227e71d90">_opponent_opt</a></td></tr>
<tr class="separator:ae849a5f35bfd8919d9c22ea227e71d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f3b10ed7573f44067bb1587355a5cc3" id="r_a1f3b10ed7573f44067bb1587355a5cc3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f3b10ed7573f44067bb1587355a5cc3">_policy_opt</a></td></tr>
<tr class="separator:a1f3b10ed7573f44067bb1587355a5cc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186d814ce717dbdd39519cfda01fd58b" id="r_a186d814ce717dbdd39519cfda01fd58b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a186d814ce717dbdd39519cfda01fd58b">_train_state</a></td></tr>
<tr class="separator:a186d814ce717dbdd39519cfda01fd58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779706e86904f179eadedece2dcf90f3" id="r_a779706e86904f179eadedece2dcf90f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a779706e86904f179eadedece2dcf90f3">_current_policy</a></td></tr>
<tr class="separator:a779706e86904f179eadedece2dcf90f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909f3ed0316016ed57f3d506abda897b" id="r_a909f3ed0316016ed57f3d506abda897b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a909f3ed0316016ed57f3d506abda897b">_policy_update_fns</a></td></tr>
<tr class="separator:a909f3ed0316016ed57f3d506abda897b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9974fd169e235555eba0df4b5c521a89" id="r_a9974fd169e235555eba0df4b5c521a89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9974fd169e235555eba0df4b5c521a89">_critic_update_fns</a></td></tr>
<tr class="separator:a9974fd169e235555eba0df4b5c521a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Opponent Shaping Agent.

This agent uses either LOLA or LOLA-DiCE to influence the parameter updates
of the opponent policies.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00598">598</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a688a991bdc9042322d47fc183d7a7ab8" name="a688a991bdc9042322d47fc183d7a7ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a688a991bdc9042322d47fc183d7a7ab8">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>player_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.List[int]</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">chex.Shape</td>          <td class="paramname"><span class="paramname"><em>observation_spec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hk.Transformed</td>          <td class="paramname"><span class="paramname"><em>agent_specific_kwargs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hk.Transformed</td>          <td class="paramname"><span class="paramname"><em>critic</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>batch_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">16</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>critic_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.01</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>pi_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.001</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>opp_policy_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.001</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>opponent_model_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.001</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float </td>          <td class="paramname"><span class="paramname"><em>clip_grad_norm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.5</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>policy_update_interval</em></span><span class="paramdefsep"> = </span><span class="paramdefval">8</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float </td>          <td class="paramname"><span class="paramname"><em>discount</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.99</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float </td>          <td class="paramname"><span class="paramname"><em>critic_discount</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.99</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">jax.random.PRNGKey </td>          <td class="paramname"><span class="paramname"><em>seed</em></span><span class="paramdefsep"> = </span><span class="paramdefval">42</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fit_opponent_model</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>correction_type</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'dice'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>use_jit</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>n_lookaheads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>num_critic_mini_batches</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>num_opponent_updates</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Optional[<a class="el" href="../../d1/d1d/classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html">rl_environment.Environment</a>] </td>          <td class="paramname"><span class="paramname"><em>env</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initializes agent.

Args:
  player_id: integer, mandatory. Corresponds to the player position in the
    game and is used to index the observation list.
  session: optional Tensorflow session.
  observation_spec: optional dict containing observation specifications.
  name: string. Must be used to scope TF variables. Defaults to `agent`.
  **agent_specific_kwargs: optional extra args.
</pre> 
<p>Reimplemented from <a class="el" href="../../d2/dfa/classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html#af17e2a06dc592b1d2bbe3d1ee40467b6">open_spiel.python.rl_agent.AbstractAgent</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00605">605</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  630</span>  ):</div>
<div class="line"><span class="lineno">  631</span>    self.player_id = player_id</div>
<div class="line"><span class="lineno">  632</span>    self._num_actions = num_actions</div>
<div class="line"><span class="lineno">  633</span>    self._batch_size = batch_size</div>
<div class="line"><span class="lineno">  634</span>    self._policy_update_interval = policy_update_interval</div>
<div class="line"><span class="lineno">  635</span>    self._discount = discount</div>
<div class="line"><span class="lineno">  636</span>    self._num_opponent_updates = num_opponent_updates</div>
<div class="line"><span class="lineno">  637</span>    self._num_mini_batches = num_critic_mini_batches</div>
<div class="line"><span class="lineno">  638</span>    self._prev_time_step = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  639</span>    self._prev_action = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  640</span>    self._data = []</div>
<div class="line"><span class="lineno">  641</span>    self._metrics = []</div>
<div class="line"><span class="lineno">  642</span>    self._fit_opponent_model = fit_opponent_model</div>
<div class="line"><span class="lineno">  643</span>    self._opponent_ids = opponent_ids</div>
<div class="line"><span class="lineno">  644</span>    self._rng = hk.PRNGSequence(seed)</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="comment"># Step counters</span></div>
<div class="line"><span class="lineno">  647</span>    self._step_counter = 0</div>
<div class="line"><span class="lineno">  648</span>    self._episode_counter = 0</div>
<div class="line"><span class="lineno">  649</span>    self._num_learn_steps = 0</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    self._pi_network = policy</div>
<div class="line"><span class="lineno">  652</span>    self._critic_network = critic</div>
<div class="line"><span class="lineno">  653</span>    self._critic_opt = optax.sgd(learning_rate=critic_learning_rate)</div>
<div class="line"><span class="lineno">  654</span>    self._opponent_opt = optax.adam(opponent_model_learning_rate)</div>
<div class="line"><span class="lineno">  655</span>    self._policy_opt = optax.chain(</div>
<div class="line"><span class="lineno">  656</span>        optax.clip_by_global_norm(clip_grad_norm)</div>
<div class="line"><span class="lineno">  657</span>        <span class="keywordflow">if</span> clip_grad_norm</div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">else</span> optax.identity(),</div>
<div class="line"><span class="lineno">  659</span>        optax.sgd(learning_rate=pi_learning_rate),</div>
<div class="line"><span class="lineno">  660</span>    )</div>
<div class="line"><span class="lineno">  661</span>    self._train_state = self._init_train_state(info_state_size=info_state_size)</div>
<div class="line"><span class="lineno">  662</span>    self._current_policy = self.get_policy(return_probs=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordflow">if</span> correction_type == <span class="stringliteral">&#39;dice&#39;</span>:</div>
<div class="line"><span class="lineno">  665</span>      policy_update_fn = get_dice_update_fn(</div>
<div class="line"><span class="lineno">  666</span>          agent_id=player_id,</div>
<div class="line"><span class="lineno">  667</span>          rng=self._rng,</div>
<div class="line"><span class="lineno">  668</span>          policy_network=policy,</div>
<div class="line"><span class="lineno">  669</span>          critic_network=critic,</div>
<div class="line"><span class="lineno">  670</span>          optimizer=self._policy_opt.update,</div>
<div class="line"><span class="lineno">  671</span>          opp_pi_lr=opp_policy_learning_rate,</div>
<div class="line"><span class="lineno">  672</span>          gamma=discount,</div>
<div class="line"><span class="lineno">  673</span>          n_lookaheads=n_lookaheads,</div>
<div class="line"><span class="lineno">  674</span>          env=env,</div>
<div class="line"><span class="lineno">  675</span>      )</div>
<div class="line"><span class="lineno">  676</span>    <span class="comment"># pylint: disable=consider-using-in</span></div>
<div class="line"><span class="lineno">  677</span>    <span class="keywordflow">elif</span> correction_type == <span class="stringliteral">&#39;lola&#39;</span> <span class="keywordflow">or</span> correction_type == <span class="stringliteral">&#39;none&#39;</span>:</div>
<div class="line"><span class="lineno">  678</span>      <span class="comment"># if correction_type is none, use policy gradient without corrections</span></div>
<div class="line"><span class="lineno">  679</span>      lola_weight = 1.0 <span class="keywordflow">if</span> correction_type == <span class="stringliteral">&#39;lola&#39;</span> <span class="keywordflow">else</span> 0.0</div>
<div class="line"><span class="lineno">  680</span>      update_fn = get_lola_update_fn(</div>
<div class="line"><span class="lineno">  681</span>          agent_id=player_id,</div>
<div class="line"><span class="lineno">  682</span>          policy_network=policy,</div>
<div class="line"><span class="lineno">  683</span>          pi_lr=pi_learning_rate,</div>
<div class="line"><span class="lineno">  684</span>          optimizer=self._policy_opt.update,</div>
<div class="line"><span class="lineno">  685</span>          lola_weight=lola_weight,</div>
<div class="line"><span class="lineno">  686</span>      )</div>
<div class="line"><span class="lineno">  687</span>      policy_update_fn = jax.jit(update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> update_fn</div>
<div class="line"><span class="lineno">  688</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  689</span>      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;Unknown correction type: {correction_type}&#39;</span>)</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    critic_update_fn = get_critic_update_fn(</div>
<div class="line"><span class="lineno">  692</span>        agent_id=player_id,</div>
<div class="line"><span class="lineno">  693</span>        critic_network=critic,</div>
<div class="line"><span class="lineno">  694</span>        optimizer=self._critic_opt.update,</div>
<div class="line"><span class="lineno">  695</span>        num_minibatches=num_critic_mini_batches,</div>
<div class="line"><span class="lineno">  696</span>        gamma=critic_discount,</div>
<div class="line"><span class="lineno">  697</span>    )</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    self._policy_update_fns = {player_id: policy_update_fn}</div>
<div class="line"><span class="lineno">  700</span>    self._critic_update_fns = {</div>
<div class="line"><span class="lineno">  701</span>        player_id: jax.jit(critic_update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> critic_update_fn</div>
<div class="line"><span class="lineno">  702</span>    }</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="keywordflow">for</span> opponent <span class="keywordflow">in</span> opponent_ids:</div>
<div class="line"><span class="lineno">  705</span>      opp_update_fn = get_opponent_update_fn(</div>
<div class="line"><span class="lineno">  706</span>          agent_id=opponent,</div>
<div class="line"><span class="lineno">  707</span>          policy_network=policy,</div>
<div class="line"><span class="lineno">  708</span>          optimizer=self._opponent_opt.update,</div>
<div class="line"><span class="lineno">  709</span>          num_minibatches=num_opponent_updates,</div>
<div class="line"><span class="lineno">  710</span>      )</div>
<div class="line"><span class="lineno">  711</span>      opp_critic_update_fn = get_critic_update_fn(</div>
<div class="line"><span class="lineno">  712</span>          agent_id=opponent,</div>
<div class="line"><span class="lineno">  713</span>          critic_network=critic,</div>
<div class="line"><span class="lineno">  714</span>          optimizer=self._critic_opt.update,</div>
<div class="line"><span class="lineno">  715</span>          num_minibatches=num_critic_mini_batches,</div>
<div class="line"><span class="lineno">  716</span>          gamma=critic_discount,</div>
<div class="line"><span class="lineno">  717</span>      )</div>
<div class="line"><span class="lineno">  718</span>      self._policy_update_fns[opponent] = (</div>
<div class="line"><span class="lineno">  719</span>          jax.jit(opp_update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> opp_update_fn</div>
<div class="line"><span class="lineno">  720</span>      )</div>
<div class="line"><span class="lineno">  721</span>      self._critic_update_fns[opponent] = (</div>
<div class="line"><span class="lineno">  722</span>          jax.jit(opp_critic_update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> opp_critic_update_fn</div>
<div class="line"><span class="lineno">  723</span>      )</div>
<div class="line"><span class="lineno">  724</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/dfe/dataset__generator_8py_source.html#l00032">dataset_generator.Dataset._batch_size</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00074">open_spiel.python.algorithms.dqn.DQN._batch_size</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00068">open_spiel.python.algorithms.nfsp.NFSP._batch_size</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00156">open_spiel.python.algorithms.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="../../d4/d52/iterated__matrix__game_8py_source.html#l00047">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame._batch_size</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00072">open_spiel.python.jax.dqn.DQN._batch_size</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00068">open_spiel.python.jax.nfsp.NFSP._batch_size</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00633">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._batch_size</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00075">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._batch_size</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00092">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._batch_size</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00145">open_spiel.python.pytorch.dqn.DQN._batch_size</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00178">open_spiel.python.pytorch.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00653">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_opt</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00700">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_update_fns</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00430">open_spiel.python.algorithms.cfr._CFRSolver._current_policy</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00165">open_spiel.python.algorithms.cfr._CFRSolverBase._current_policy</a>, <a class="el" href="../../dd/dc5/cfr__br_8py_source.html#l00134">open_spiel.python.algorithms.cfr_br.CFRBRSolver._current_policy</a>, <a class="el" href="../../d1/dd6/algorithms_2discounted__cfr_8py_source.html#l00209">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._current_policy</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00434">open_spiel.python.algorithms.efr._EFRSolver._current_policy</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00109">open_spiel.python.algorithms.efr._EFRSolverBase._current_policy</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00662">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._current_policy</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00057">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00069">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer._data</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00330">open_spiel.python.algorithms.nfsp.ReservoirBuffer._data</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00065">open_spiel.python.jax.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00640">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._data</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00151">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../d7/dfc/lru__cache_8py_source.html#l00047">open_spiel.python.utils.lru_cache.LRUCache._data</a>, <a class="el" href="../../d3/d6f/replay__buffer_8py_source.html#l00031">open_spiel.python.utils.replay_buffer.ReplayBuffer._data</a>, <a class="el" href="../../d5/d70/reservoir__buffer_8py_source.html#l00036">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer._data</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00143">open_spiel.python.algorithms.eva.EVAAgent._discount</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00635">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._discount</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00135">open_spiel.python.pytorch.eva.EVAAgent._discount</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00167">open_spiel.python.algorithms.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00648">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._episode_counter</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00255">open_spiel.python.jax.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00190">open_spiel.python.pytorch.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00642">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._fit_opponent_model</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00641">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._metrics</a>, <a class="el" href="../../dd/dc3/boltzmann__tabular__qlearner_8py_source.html#l00073">open_spiel.python.algorithms.boltzmann_tabular_qlearner.BoltzmannQLearner._num_actions</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00170">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00213">open_spiel.python.algorithms.deep_cfr_tf2.AdvantageNetwork._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00333">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00148">open_spiel.python.algorithms.deep_cfr_tf2.PolicyNetwork._num_actions</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00070">open_spiel.python.algorithms.dqn.DQN._num_actions</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00137">open_spiel.python.algorithms.eva.EVAAgent._num_actions</a>, <a class="el" href="../../d9/d7e/mcts__agent_8py_source.html#l00033">open_spiel.python.algorithms.mcts_agent.MCTSAgent._num_actions</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00066">open_spiel.python.algorithms.nfsp.NFSP._num_actions</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00154">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../d3/df2/random__agent_8py_source.html#l00027">open_spiel.python.algorithms.random_agent.RandomAgent._num_actions</a>, <a class="el" href="../../d8/d79/tabular__multiagent__qlearner_8py_source.html#l00190">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._num_actions</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00046">open_spiel.python.algorithms.tabular_qlearner.QLearner._num_actions</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00072">open_spiel.python.algorithms.wolf_phc.WoLFPHC._num_actions</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00214">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot._num_actions</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00043">open_spiel.python.environments.catch.Environment._num_actions</a>, <a class="el" href="../../d0/dd5/rl__response_8py_source.html#l00137">open_spiel.python.examples.rl_response.FirstActionAgent._num_actions</a>, <a class="el" href="../../da/db6/roshambo__population__example_8py_source.html#l00058">open_spiel.python.examples.roshambo_population_example.BotAgent._num_actions</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l01060">open_spiel.python.games.chat_games.chat_game_base.BaseChatGame._num_actions</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00121">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._num_actions</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00176">open_spiel.python.jax.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00068">open_spiel.python.jax.dqn.DQN._num_actions</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00066">open_spiel.python.jax.nfsp.NFSP._num_actions</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00632">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00037">open_spiel.python.jax.policy_gradient.NetA2C._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00054">open_spiel.python.jax.policy_gradient.NetPG._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00244">open_spiel.python.jax.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00074">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._num_actions</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00090">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._num_actions</a>, <a class="el" href="../../dd/d6d/normal__form__game_8py_source.html#l00146">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._num_actions</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00259">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00141">open_spiel.python.pytorch.dqn.DQN._num_actions</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00129">open_spiel.python.pytorch.eva.EVAAgent._num_actions</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00176">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00168">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00649">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_learn_steps</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00256">open_spiel.python.jax.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00191">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00637">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_mini_batches</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00636">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_opponent_updates</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00643">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_ids</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00654">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_opt</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00651">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00233">open_spiel.python.pytorch.policy_gradient.PolicyGradient._pi_network</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00655">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_opt</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00699">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_fns</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00634">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_interval</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00089">open_spiel.python.algorithms.dqn.DQN._prev_action</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00075">open_spiel.python.algorithms.nfsp.NFSP._prev_action</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00163">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00141">open_spiel.python.algorithms.tabular_qlearner.QLearner._prev_action</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00226">open_spiel.python.algorithms.wolf_phc.WoLFPHC._prev_action</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00088">open_spiel.python.jax.dqn.DQN._prev_action</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00075">open_spiel.python.jax.nfsp.NFSP._prev_action</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00639">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_action</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00251">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00107">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_action</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00160">open_spiel.python.pytorch.dqn.DQN._prev_action</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00186">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00162">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00638">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_time_step</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00250">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00109">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_time_step</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00185">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00295">meta_learning.MetaCFRRegretAgent._rng</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00040">open_spiel.python.bots.policy.PolicyBot._rng</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00034">open_spiel.python.bots.uniform_random.UniformRandomBot._rng</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00039">open_spiel.python.environments.catch.Environment._rng</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00644">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._rng</a>, <a class="el" href="../../dd/d06/rl__environment_8py_source.html#l00126">open_spiel.python.rl_environment.ChanceEventSampler._rng</a>, <a class="el" href="../../d2/dd3/rnn__meta__selfplay__agent_8py_source.html#l00144">rnn_meta_selfplay_agent.MetaSelfplayAgent._rng</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00092">open_spiel.python.algorithms.dqn.DQN._step_counter</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00078">open_spiel.python.algorithms.nfsp.NFSP._step_counter</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00166">open_spiel.python.algorithms.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00091">open_spiel.python.jax.dqn.DQN._step_counter</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00078">open_spiel.python.jax.nfsp.NFSP._step_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00647">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._step_counter</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00254">open_spiel.python.jax.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00115">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._step_counter</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00163">open_spiel.python.pytorch.dqn.DQN._step_counter</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00189">open_spiel.python.pytorch.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00119">open_spiel.python.jax.opponent_shaping.get_critic_update_fn()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00193">open_spiel.python.jax.opponent_shaping.get_dice_update_fn()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00363">open_spiel.python.jax.opponent_shaping.get_lola_update_fn()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00557">open_spiel.python.jax.opponent_shaping.get_opponent_update_fn()</a>, <a class="el" href="../../df/daf/ismcts_8py_source.html#l00145">open_spiel.python.algorithms.ismcts.ISMCTSBot.get_policy()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, <a class="el" href="../../d4/d98/mfg_2algorithms_2fictitious__play_8py_source.html#l00136">open_spiel.python.mfg.algorithms.fictitious_play.FictitiousPlay.get_policy()</a>, <a class="el" href="../../db/d76/fixed__point_8py_source.html#l00072">open_spiel.python.mfg.algorithms.fixed_point.FixedPoint.get_policy()</a>, <a class="el" href="../../df/d3d/mirror__descent_8py_source.html#l00166">open_spiel.python.mfg.algorithms.mirror_descent.MirrorDescent.get_policy()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="../../d6/d97/noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d5/d27/rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../d1/d9b/bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../de/d51/ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="../../d3/d26/dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="../../d9/d49/base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="../../d7/d2a/data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a688a991bdc9042322d47fc183d7a7ab8_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a688a991bdc9042322d47fc183d7a7ab8_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a688a991bdc9042322d47fc183d7a7ab8_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a688a991bdc9042322d47fc183d7a7ab8_cgraph">
<area shape="rect" title=" " alt="" coords="5,429,269,470"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a8d702ba311c2a6ec2dd9c8c29749de9f" title=" " alt="" coords="346,5,564,61"/>
<area shape="poly" title=" " alt="" coords="139,428,156,359,188,263,211,211,240,160,274,113,315,71,331,60,334,64,318,75,278,116,244,163,216,214,193,265,161,361,145,429"/>
<area shape="rect" href="../../de/d88/namespaceopen__spiel_1_1python_1_1jax_1_1opponent__shaping.html#a615294831f399d2d2ba5a5033dfbbd09" title=" " alt="" coords="353,85,558,126"/>
<area shape="poly" title=" " alt="" coords="141,427,161,369,195,290,219,248,246,207,278,169,315,136,338,123,340,128,318,141,282,173,251,210,223,251,200,292,166,371,147,429"/>
<area shape="rect" href="../../de/d88/namespaceopen__spiel_1_1python_1_1jax_1_1opponent__shaping.html#aa33ea5b99e70cdc97bb5ae2634fcb53e" title=" " alt="" coords="353,216,558,256"/>
<area shape="poly" title=" " alt="" coords="151,427,178,392,216,348,262,304,315,267,337,256,340,261,318,271,266,308,220,352,182,395,155,430"/>
<area shape="rect" href="../../de/d88/namespaceopen__spiel_1_1python_1_1jax_1_1opponent__shaping.html#a66b1f8b60735ab94eb6f92b9e1548870" title=" " alt="" coords="353,281,558,322"/>
<area shape="poly" title=" " alt="" coords="163,426,230,379,272,354,316,332,337,324,339,329,318,337,274,358,233,383,166,430"/>
<area shape="rect" href="../../de/d88/namespaceopen__spiel_1_1python_1_1jax_1_1opponent__shaping.html#ad5d23d236094e5b8ad448d1da2add836" title=" " alt="" coords="346,150,565,191"/>
<area shape="poly" title=" " alt="" coords="145,427,168,380,205,319,254,255,283,226,315,202,330,193,333,198,318,206,287,230,258,259,209,322,173,383,150,429"/>
<area shape="rect" href="../../d6/d2e/classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="337,346,574,387"/>
<area shape="poly" title=" " alt="" coords="218,426,359,389,360,394,219,431"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="317,512,594,552"/>
<area shape="poly" title=" " alt="" coords="219,468,360,505,359,510,218,473"/>
<area shape="rect" href="../../d2/d62/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="648,406,882,447"/>
<area shape="poly" title=" " alt="" coords="269,442,633,429,633,434,269,447"/>
<area shape="rect" href="../../da/d4a/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="642,471,888,526"/>
<area shape="poly" title=" " alt="" coords="269,457,627,485,627,490,269,462"/>
<area shape="rect" href="../../d1/d07/classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="668,552,863,592"/>
<area shape="poly" title=" " alt="" coords="163,468,229,518,272,543,317,561,403,580,492,588,576,588,652,584,652,589,577,594,491,593,402,585,316,566,269,547,226,522,159,472"/>
<area shape="rect" href="../../d5/dc0/classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="642,618,888,659"/>
<area shape="poly" title=" " alt="" coords="157,468,185,498,223,533,268,568,318,595,394,620,475,635,554,642,627,644,627,649,553,647,474,640,393,625,316,600,265,572,219,537,181,502,154,472"/>
<area shape="rect" href="../../d2/dff/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="321,677,590,718"/>
<area shape="poly" title=" " alt="" coords="152,469,178,509,215,559,263,612,318,656,341,668,338,673,315,661,259,616,211,563,173,512,148,471"/>
<area shape="rect" href="../../d3/d5b/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="331,742,580,783"/>
<area shape="poly" title=" " alt="" coords="148,469,169,522,204,592,254,665,284,699,318,727,326,732,323,737,315,731,281,702,250,669,200,595,164,524,143,471"/>
<area shape="rect" href="../../de/df1/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="329,808,582,848"/>
<area shape="poly" title=" " alt="" coords="145,469,163,533,196,621,219,668,247,714,280,756,318,792,325,798,322,802,315,797,276,760,242,717,214,671,191,623,158,535,140,471"/>
<area shape="rect" href="../../de/d88/namespaceopen__spiel_1_1python_1_1jax_1_1opponent__shaping.html#a74f72ad13bbb59b3e33f4844ef855de0" title=" " alt="" coords="663,118,867,159"/>
<area shape="poly" title=" " alt="" coords="558,114,648,123,647,129,558,119"/>
<area shape="poly" title=" " alt="" coords="565,157,647,148,648,153,566,162"/>
<area shape="poly" title=" " alt="" coords="504,508,641,456,664,449,665,454,643,461,506,513"/>
<area shape="poly" title=" " alt="" coords="594,514,626,511,627,516,595,520"/>
<area shape="poly" title=" " alt="" coords="595,547,652,555,652,560,594,552"/>
<area shape="poly" title=" " alt="" coords="508,550,643,601,672,611,671,616,641,606,506,555"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a063f8a6cc351f7d3bcf74757fabb4669" name="a063f8a6cc351f7d3bcf74757fabb4669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a063f8a6cc351f7d3bcf74757fabb4669">&#9670;&#160;</a></span>_construct_episode_batches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> <a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.List[<a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a>]
  </td>          <td class="paramname"><span class="paramname"><em>transitions</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Constructs a list of transitions into a single transition batch instance.

The fields 'info_state', 'rewards', 'legal_action_mask' and 'actions' of the
produced transition batch have shape (num_agents, batch_size,
sequence_length, *shape). The fields 'discount' and 'terminal' have shape
(batch_size, sequence_length).

Args:
    transitions: a list of single step transitions

Returns:
    A transition batch instance with items of according shape.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00985">985</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  987</span>  ) -&gt; TransitionBatch:</div>
<div class="line"><span class="lineno">  988</span>    <span class="stringliteral">&quot;&quot;&quot;Constructs a list of transitions into a single transition batch instance.</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">    The fields &#39;info_state&#39;, &#39;rewards&#39;, &#39;legal_action_mask&#39; and &#39;actions&#39; of the</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">    produced transition batch have shape (num_agents, batch_size,</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">    sequence_length, *shape). The fields &#39;discount&#39; and &#39;terminal&#39; have shape</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">    (batch_size, sequence_length).</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">        transitions: a list of single step transitions</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">        A transition batch instance with items of according shape.</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1001</span>    episode, batches = [], []</div>
<div class="line"><span class="lineno"> 1002</span>    max_episode_length = 0</div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">for</span> transition <span class="keywordflow">in</span> transitions:</div>
<div class="line"><span class="lineno"> 1004</span>      episode.append(transition)</div>
<div class="line"><span class="lineno"> 1005</span>      <span class="keywordflow">if</span> transition.terminal.any():</div>
<div class="line"><span class="lineno"> 1006</span>        max_episode_length = max(max_episode_length, len(episode))</div>
<div class="line"><span class="lineno"> 1007</span>        <span class="comment"># pylint: disable=no-value-for-parameter</span></div>
<div class="line"><span class="lineno"> 1008</span>        batch = jax.tree_util.tree_map(<span class="keyword">lambda</span> *xs: jnp.stack(xs), *episode)</div>
<div class="line"><span class="lineno"> 1009</span>        batch = batch.replace(</div>
<div class="line"><span class="lineno"> 1010</span>            info_state=batch.info_state.transpose(1, 2, 0, 3),</div>
<div class="line"><span class="lineno"> 1011</span>            action=batch.action.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1012</span>            legal_actions_mask=batch.legal_actions_mask.T,</div>
<div class="line"><span class="lineno"> 1013</span>            reward=batch.reward.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1014</span>            values=batch.values.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1015</span>            discount=batch.discount.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1016</span>            terminal=batch.terminal.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1017</span>        )</div>
<div class="line"><span class="lineno"> 1018</span>        batches.append(batch)</div>
<div class="line"><span class="lineno"> 1019</span>        episode.clear()</div>
<div class="line"><span class="lineno"> 1020</span>    <span class="keywordflow">return</span> batches[0]</div>
<div class="line"><span class="lineno"> 1021</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/dfe/dataset__generator_8py_source.html#l00032">dataset_generator.Dataset._batch_size</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00074">open_spiel.python.algorithms.dqn.DQN._batch_size</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00068">open_spiel.python.algorithms.nfsp.NFSP._batch_size</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00156">open_spiel.python.algorithms.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="../../d4/d52/iterated__matrix__game_8py_source.html#l00047">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame._batch_size</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00072">open_spiel.python.jax.dqn.DQN._batch_size</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00068">open_spiel.python.jax.nfsp.NFSP._batch_size</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00633">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._batch_size</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00075">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._batch_size</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00092">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._batch_size</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00145">open_spiel.python.pytorch.dqn.DQN._batch_size</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00178">open_spiel.python.pytorch.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00700">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_update_fns</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00430">open_spiel.python.algorithms.cfr._CFRSolver._current_policy</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00165">open_spiel.python.algorithms.cfr._CFRSolverBase._current_policy</a>, <a class="el" href="../../dd/dc5/cfr__br_8py_source.html#l00134">open_spiel.python.algorithms.cfr_br.CFRBRSolver._current_policy</a>, <a class="el" href="../../d1/dd6/algorithms_2discounted__cfr_8py_source.html#l00209">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._current_policy</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00434">open_spiel.python.algorithms.efr._EFRSolver._current_policy</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00109">open_spiel.python.algorithms.efr._EFRSolverBase._current_policy</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00662">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._current_policy</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00143">open_spiel.python.algorithms.eva.EVAAgent._discount</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00635">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._discount</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00135">open_spiel.python.pytorch.eva.EVAAgent._discount</a>, <a class="el" href="../../dd/dc3/boltzmann__tabular__qlearner_8py_source.html#l00073">open_spiel.python.algorithms.boltzmann_tabular_qlearner.BoltzmannQLearner._num_actions</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00170">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00213">open_spiel.python.algorithms.deep_cfr_tf2.AdvantageNetwork._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00333">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00148">open_spiel.python.algorithms.deep_cfr_tf2.PolicyNetwork._num_actions</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00070">open_spiel.python.algorithms.dqn.DQN._num_actions</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00137">open_spiel.python.algorithms.eva.EVAAgent._num_actions</a>, <a class="el" href="../../d9/d7e/mcts__agent_8py_source.html#l00033">open_spiel.python.algorithms.mcts_agent.MCTSAgent._num_actions</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00066">open_spiel.python.algorithms.nfsp.NFSP._num_actions</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00154">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../d3/df2/random__agent_8py_source.html#l00027">open_spiel.python.algorithms.random_agent.RandomAgent._num_actions</a>, <a class="el" href="../../d8/d79/tabular__multiagent__qlearner_8py_source.html#l00190">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._num_actions</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00046">open_spiel.python.algorithms.tabular_qlearner.QLearner._num_actions</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00072">open_spiel.python.algorithms.wolf_phc.WoLFPHC._num_actions</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00214">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot._num_actions</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00043">open_spiel.python.environments.catch.Environment._num_actions</a>, <a class="el" href="../../d0/dd5/rl__response_8py_source.html#l00137">open_spiel.python.examples.rl_response.FirstActionAgent._num_actions</a>, <a class="el" href="../../da/db6/roshambo__population__example_8py_source.html#l00058">open_spiel.python.examples.roshambo_population_example.BotAgent._num_actions</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l01060">open_spiel.python.games.chat_games.chat_game_base.BaseChatGame._num_actions</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00121">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._num_actions</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00176">open_spiel.python.jax.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00068">open_spiel.python.jax.dqn.DQN._num_actions</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00066">open_spiel.python.jax.nfsp.NFSP._num_actions</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00632">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00037">open_spiel.python.jax.policy_gradient.NetA2C._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00054">open_spiel.python.jax.policy_gradient.NetPG._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00244">open_spiel.python.jax.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00074">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._num_actions</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00090">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._num_actions</a>, <a class="el" href="../../dd/d6d/normal__form__game_8py_source.html#l00146">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._num_actions</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00259">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00141">open_spiel.python.pytorch.dqn.DQN._num_actions</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00129">open_spiel.python.pytorch.eva.EVAAgent._num_actions</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00176">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00643">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_ids</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00699">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_fns</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00162">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00638">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_time_step</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00250">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00109">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_time_step</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00185">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>, <a class="el" href="../../df/daf/ismcts_8py_source.html#l00145">open_spiel.python.algorithms.ismcts.ISMCTSBot.get_policy()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, <a class="el" href="../../d4/d98/mfg_2algorithms_2fictitious__play_8py_source.html#l00136">open_spiel.python.mfg.algorithms.fictitious_play.FictitiousPlay.get_policy()</a>, <a class="el" href="../../db/d76/fixed__point_8py_source.html#l00072">open_spiel.python.mfg.algorithms.fixed_point.FixedPoint.get_policy()</a>, <a class="el" href="../../df/d3d/mirror__descent_8py_source.html#l00166">open_spiel.python.mfg.algorithms.mirror_descent.MirrorDescent.get_policy()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="../../d6/d97/noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d5/d27/rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../d1/d9b/bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../de/d51/ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="../../d3/d26/dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="../../d9/d49/base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="../../d7/d2a/data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_cgraph">
<area shape="rect" title=" " alt="" coords="5,220,224,276"/>
<area shape="rect" href="../../d6/d2e/classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="292,5,529,46"/>
<area shape="poly" title=" " alt="" coords="130,219,153,183,185,141,225,98,270,62,292,50,295,55,273,67,228,102,189,144,158,186,134,222"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="272,171,549,211"/>
<area shape="poly" title=" " alt="" coords="224,225,287,212,288,217,225,230"/>
<area shape="rect" href="../../d2/d62/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="604,64,837,105"/>
<area shape="poly" title=" " alt="" coords="141,218,197,170,233,146,271,127,350,102,433,87,514,79,588,76,588,82,514,84,434,92,352,108,273,132,235,151,200,174,144,222"/>
<area shape="rect" href="../../da/d4a/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="597,128,843,184"/>
<area shape="poly" title=" " alt="" coords="151,218,205,184,238,168,271,156,350,141,431,134,509,133,581,137,581,142,509,138,431,139,350,146,272,162,240,173,208,188,154,222"/>
<area shape="rect" href="../../d1/d07/classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="622,209,818,250"/>
<area shape="poly" title=" " alt="" coords="224,242,607,230,607,236,224,248"/>
<area shape="rect" href="../../d5/dc0/classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="597,276,843,317"/>
<area shape="poly" title=" " alt="" coords="224,254,582,283,581,288,224,260"/>
<area shape="rect" href="../../d2/dff/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="276,336,545,377"/>
<area shape="poly" title=" " alt="" coords="175,274,273,315,314,329,312,334,271,320,173,279"/>
<area shape="rect" href="../../d3/d5b/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="286,401,534,442"/>
<area shape="poly" title=" " alt="" coords="141,275,198,332,234,361,273,386,287,393,285,398,270,391,231,366,194,336,137,278"/>
<area shape="rect" href="../../de/df1/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="284,467,537,507"/>
<area shape="poly" title=" " alt="" coords="131,275,154,315,185,363,225,411,273,451,283,457,280,462,270,456,221,415,181,366,149,318,127,278"/>
<area shape="poly" title=" " alt="" coords="458,168,596,114,618,107,620,112,598,119,460,173"/>
<area shape="poly" title=" " alt="" coords="549,173,581,169,582,174,550,178"/>
<area shape="poly" title=" " alt="" coords="550,206,607,213,607,218,549,211"/>
<area shape="poly" title=" " alt="" coords="464,209,598,259,628,269,627,274,596,264,462,214"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph">
<area shape="rect" title=" " alt="" coords="1442,208,1660,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="poly" title=" " alt="" coords="1426,238,1395,238,1395,233,1426,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a8d702ba311c2a6ec2dd9c8c29749de9f" name="a8d702ba311c2a6ec2dd9c8c29749de9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d702ba311c2a6ec2dd9c8c29749de9f">&#9670;&#160;</a></span>_init_train_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">chex.Shape</td>          <td class="paramname"><span class="paramname"><em>info_state_size</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00859">859</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  859</span>  <span class="keyword">def </span>_init_train_state(self, info_state_size: chex.Shape):</div>
<div class="line"><span class="lineno">  860</span>    init_inputs = jnp.ones(info_state_size)</div>
<div class="line"><span class="lineno">  861</span>    agent_ids = self._opponent_ids + [self.player_id]</div>
<div class="line"><span class="lineno">  862</span>    policy_params, policy_opt_states = {}, {}</div>
<div class="line"><span class="lineno">  863</span>    critic_params, critic_opt_states = {}, {}</div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">for</span> agent_id <span class="keywordflow">in</span> agent_ids:</div>
<div class="line"><span class="lineno">  865</span>      policy_params[agent_id] = self._pi_network.init(</div>
<div class="line"><span class="lineno">  866</span>          next(self._rng), init_inputs</div>
<div class="line"><span class="lineno">  867</span>      )</div>
<div class="line"><span class="lineno">  868</span>      <span class="keywordflow">if</span> agent_id == self.player_id:</div>
<div class="line"><span class="lineno">  869</span>        policy_opt_state = self._policy_opt.init(policy_params[agent_id])</div>
<div class="line"><span class="lineno">  870</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  871</span>        policy_opt_state = self._opponent_opt.init(policy_params[agent_id])</div>
<div class="line"><span class="lineno">  872</span>      policy_opt_states[agent_id] = policy_opt_state</div>
<div class="line"><span class="lineno">  873</span>      critic_params[agent_id] = self._critic_network.init(</div>
<div class="line"><span class="lineno">  874</span>          next(self._rng), init_inputs</div>
<div class="line"><span class="lineno">  875</span>      )</div>
<div class="line"><span class="lineno">  876</span>      critic_opt_states[agent_id] = self._critic_opt.init(</div>
<div class="line"><span class="lineno">  877</span>          critic_params[agent_id]</div>
<div class="line"><span class="lineno">  878</span>      )</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordflow">return</span> TrainState(</div>
<div class="line"><span class="lineno">  881</span>        policy_params=policy_params,</div>
<div class="line"><span class="lineno">  882</span>        critic_params=critic_params,</div>
<div class="line"><span class="lineno">  883</span>        policy_opt_states=policy_opt_states,</div>
<div class="line"><span class="lineno">  884</span>        critic_opt_states=critic_opt_states,</div>
<div class="line"><span class="lineno">  885</span>    )</div>
<div class="line"><span class="lineno">  886</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_icgraph">
<area shape="rect" title=" " alt="" coords="317,5,535,61"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a688a991bdc9042322d47fc183d7a7ab8" title=" " alt="" coords="5,13,269,54"/>
<area shape="poly" title=" " alt="" coords="301,36,269,36,269,30,301,30"/>
</map>
</div>

</div>
</div>
<a id="a6a1a3592b3656e858e405ca6974d3db1" name="a6a1a3592b3656e858e405ca6974d3db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a1a3592b3656e858e405ca6974d3db1">&#9670;&#160;</a></span>_make_transition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dec/classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a></td>          <td class="paramname"><span class="paramname"><em>time_step</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01052">1052</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1052</span>  <span class="keyword">def </span>_make_transition(self, time_step: TimeStep):</div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keyword">assert</span> self._prev_time_step <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1054</span>    legal_actions = self._prev_time_step.observations[<span class="stringliteral">&#39;legal_actions&#39;</span>][</div>
<div class="line"><span class="lineno"> 1055</span>        self.player_id</div>
<div class="line"><span class="lineno"> 1056</span>    ]</div>
<div class="line"><span class="lineno"> 1057</span>    legal_actions_mask = np.zeros((self._batch_size, self._num_actions))</div>
<div class="line"><span class="lineno"> 1058</span>    legal_actions_mask[..., legal_actions] = 1</div>
<div class="line"><span class="lineno"> 1059</span>    actions = np.array(time_step.observations[<span class="stringliteral">&#39;actions&#39;</span>])</div>
<div class="line"><span class="lineno"> 1060</span>    rewards = np.array(time_step.rewards)</div>
<div class="line"><span class="lineno"> 1061</span>    discounts = self._discount * (1 - time_step.last()) * np.ones_like(rewards)</div>
<div class="line"><span class="lineno"> 1062</span>    terminal = time_step.last() * np.ones_like(rewards)</div>
<div class="line"><span class="lineno"> 1063</span>    obs = np.array(self._prev_time_step.observations[<span class="stringliteral">&#39;info_state&#39;</span>])</div>
<div class="line"><span class="lineno"> 1064</span>    transition = TransitionBatch(</div>
<div class="line"><span class="lineno"> 1065</span>        info_state=obs,</div>
<div class="line"><span class="lineno"> 1066</span>        action=actions,</div>
<div class="line"><span class="lineno"> 1067</span>        reward=rewards,</div>
<div class="line"><span class="lineno"> 1068</span>        discount=discounts,</div>
<div class="line"><span class="lineno"> 1069</span>        terminal=terminal,</div>
<div class="line"><span class="lineno"> 1070</span>        legal_actions_mask=legal_actions_mask,</div>
<div class="line"><span class="lineno"> 1071</span>        values=self._prev_time_step.observations[<span class="stringliteral">&#39;values&#39;</span>],</div>
<div class="line"><span class="lineno"> 1072</span>    )</div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">if</span> len(rewards.shape) &lt; 2:  <span class="comment"># if not a batch, add a batch dimension</span></div>
<div class="line"><span class="lineno"> 1074</span>      transition = jax.tree_util.tree_map(<span class="keyword">lambda</span> x: x[<span class="keywordtype">None</span>], transition)</div>
<div class="line"><span class="lineno"> 1075</span>    <span class="keywordflow">return</span> transition</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph">
<area shape="rect" title=" " alt="" coords="1442,208,1660,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a92fdbbc16d1a44597453d7f3bd1c6278" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="poly" title=" " alt="" coords="1426,238,1395,238,1395,233,1426,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a4c6e95fe51f4fcc38c46f857ff7a14fc" name="a4c6e95fe51f4fcc38c46f857ff7a14fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c6e95fe51f4fcc38c46f857ff7a14fc">&#9670;&#160;</a></span>_should_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> bool open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Indicates whether to update or not.

Returns:
    True, if the number of episodes in the buffer is equal to the batch
    size. False otherwise.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00933">933</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  933</span>  <span class="keyword">def </span>_should_update(self) -&gt; bool:</div>
<div class="line"><span class="lineno">  934</span>    <span class="stringliteral">&quot;&quot;&quot;Indicates whether to update or not.</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">        True, if the number of episodes in the buffer is equal to the batch</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">        size. False otherwise.</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  940</span>    <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  941</span>        self._step_counter &gt;= self._batch_size * (self._num_learn_steps + 1)</div>
<div class="line"><span class="lineno">  942</span>        <span class="keywordflow">and</span> self._episode_counter &gt; 0</div>
<div class="line"><span class="lineno">  943</span>    )</div>
<div class="line"><span class="lineno">  944</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/dfe/dataset__generator_8py_source.html#l00032">dataset_generator.Dataset._batch_size</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00074">open_spiel.python.algorithms.dqn.DQN._batch_size</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00068">open_spiel.python.algorithms.nfsp.NFSP._batch_size</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00156">open_spiel.python.algorithms.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="../../d4/d52/iterated__matrix__game_8py_source.html#l00047">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame._batch_size</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00072">open_spiel.python.jax.dqn.DQN._batch_size</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00068">open_spiel.python.jax.nfsp.NFSP._batch_size</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00633">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._batch_size</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00075">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._batch_size</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00092">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._batch_size</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00145">open_spiel.python.pytorch.dqn.DQN._batch_size</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00178">open_spiel.python.pytorch.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00167">open_spiel.python.algorithms.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00648">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._episode_counter</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00255">open_spiel.python.jax.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00190">open_spiel.python.pytorch.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00168">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00649">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_learn_steps</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00256">open_spiel.python.jax.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00191">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00092">open_spiel.python.algorithms.dqn.DQN._step_counter</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00078">open_spiel.python.algorithms.nfsp.NFSP._step_counter</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00166">open_spiel.python.algorithms.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00091">open_spiel.python.jax.dqn.DQN._step_counter</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00078">open_spiel.python.jax.nfsp.NFSP._step_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00647">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._step_counter</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00254">open_spiel.python.jax.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00115">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._step_counter</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00163">open_spiel.python.pytorch.dqn.DQN._step_counter</a>, and <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00189">open_spiel.python.pytorch.policy_gradient.PolicyGradient._step_counter</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph">
<area shape="rect" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a92fdbbc16d1a44597453d7f3bd1c6278" name="a92fdbbc16d1a44597453d7f3bd1c6278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92fdbbc16d1a44597453d7f3bd1c6278">&#9670;&#160;</a></span>_store_time_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dec/classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a></td>          <td class="paramname"><span class="paramname"><em>time_step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>action</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Store the time step.

Converts the timestep and the action into a transition and steps the
counters.

Args:
    time_step: the current time step.
    action: the action that was taken before observing time_step
Returns: None
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">887</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  887</span>  <span class="keyword">def </span>_store_time_step(self, time_step: TimeStep, action: np.ndarray):</div>
<div class="line"><span class="lineno">  888</span>    <span class="stringliteral">&quot;&quot;&quot;Store the time step.</span></div>
<div class="line"><span class="lineno">  889</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">    Converts the timestep and the action into a transition and steps the</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral">    counters.</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral">        time_step: the current time step.</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">        action: the action that was taken before observing time_step</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral">    Returns: None</span></div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  898</span>    self._step_counter += (</div>
<div class="line"><span class="lineno">  899</span>        time_step.observations[<span class="stringliteral">&#39;batch_size&#39;</span>]</div>
<div class="line"><span class="lineno">  900</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;batch_size&#39;</span> <span class="keywordflow">in</span> time_step.observations</div>
<div class="line"><span class="lineno">  901</span>        <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  902</span>    )</div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordflow">if</span> self._prev_time_step:</div>
<div class="line"><span class="lineno">  904</span>      transition = self._make_transition(time_step)</div>
<div class="line"><span class="lineno">  905</span>      self._data.append(transition)</div>
<div class="line"><span class="lineno">  906</span>    <span class="keywordflow">if</span> time_step.last():</div>
<div class="line"><span class="lineno">  907</span>      self._prev_time_step = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  908</span>      self._prev_action = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  909</span>      self._episode_counter += 1</div>
<div class="line"><span class="lineno">  910</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  911</span>      obs = time_step.observations[<span class="stringliteral">&#39;info_state&#39;</span>]</div>
<div class="line"><span class="lineno">  912</span>      time_step.observations[<span class="stringliteral">&#39;values&#39;</span>] = jnp.stack(</div>
<div class="line"><span class="lineno">  913</span>          [</div>
<div class="line"><span class="lineno">  914</span>              self._critic_network.apply(</div>
<div class="line"><span class="lineno">  915</span>                  self.train_state.critic_params[id], jnp.array(obs[id])</div>
<div class="line"><span class="lineno">  916</span>              ).squeeze(-1)</div>
<div class="line"><span class="lineno">  917</span>              <span class="keywordflow">for</span> id <span class="keywordflow">in</span> sorted(self.train_state.critic_params.keys())</div>
<div class="line"><span class="lineno">  918</span>          ]</div>
<div class="line"><span class="lineno">  919</span>      )</div>
<div class="line"><span class="lineno">  920</span>      self._prev_time_step = time_step</div>
<div class="line"><span class="lineno">  921</span>      self._prev_action = action</div>
<div class="line"><span class="lineno">  922</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00057">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00069">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer._data</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00330">open_spiel.python.algorithms.nfsp.ReservoirBuffer._data</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00065">open_spiel.python.jax.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00640">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._data</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00151">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../d7/dfc/lru__cache_8py_source.html#l00047">open_spiel.python.utils.lru_cache.LRUCache._data</a>, <a class="el" href="../../d3/d6f/replay__buffer_8py_source.html#l00031">open_spiel.python.utils.replay_buffer.ReplayBuffer._data</a>, <a class="el" href="../../d5/d70/reservoir__buffer_8py_source.html#l00036">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer._data</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00167">open_spiel.python.algorithms.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00648">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._episode_counter</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00255">open_spiel.python.jax.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00190">open_spiel.python.pytorch.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01052">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00089">open_spiel.python.algorithms.dqn.DQN._prev_action</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00075">open_spiel.python.algorithms.nfsp.NFSP._prev_action</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00163">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00141">open_spiel.python.algorithms.tabular_qlearner.QLearner._prev_action</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00226">open_spiel.python.algorithms.wolf_phc.WoLFPHC._prev_action</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00088">open_spiel.python.jax.dqn.DQN._prev_action</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00075">open_spiel.python.jax.nfsp.NFSP._prev_action</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00639">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_action</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00251">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00107">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_action</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00160">open_spiel.python.pytorch.dqn.DQN._prev_action</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00186">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00162">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00638">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_time_step</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00250">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00109">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_time_step</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00185">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00092">open_spiel.python.algorithms.dqn.DQN._step_counter</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00078">open_spiel.python.algorithms.nfsp.NFSP._step_counter</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00166">open_spiel.python.algorithms.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00091">open_spiel.python.jax.dqn.DQN._step_counter</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00078">open_spiel.python.jax.nfsp.NFSP._step_counter</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00647">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._step_counter</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00254">open_spiel.python.jax.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00115">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._step_counter</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00163">open_spiel.python.pytorch.dqn.DQN._step_counter</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00189">open_spiel.python.pytorch.policy_gradient.PolicyGradient._step_counter</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00726">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.train_state()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph">
<area shape="rect" title=" " alt="" coords="5,41,224,97"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a6a1a3592b3656e858e405ca6974d3db1" title=" " alt="" coords="302,5,520,61"/>
<area shape="poly" title=" " alt="" coords="224,53,287,46,287,51,224,59"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a20a9c683dd11b09e5667692bc1ab6891" title=" " alt="" coords="272,85,551,126"/>
<area shape="poly" title=" " alt="" coords="224,80,257,84,256,89,224,85"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph">
<area shape="rect" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="aa0d78940728f70c85b0b8b2723ceb280" name="aa0d78940728f70c85b0b8b2723ceb280"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0d78940728f70c85b0b8b2723ceb280">&#9670;&#160;</a></span>_train_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Updates the critic and the policy parameters.

After the update, the data buffer is cleared. Returns: None
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00923">923</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  923</span>  <span class="keyword">def </span>_train_step(self):</div>
<div class="line"><span class="lineno">  924</span>    <span class="stringliteral">&quot;&quot;&quot;Updates the critic and the policy parameters.</span></div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    After the update, the data buffer is cleared. Returns: None</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  928</span>    batch = self._construct_episode_batches(self._data)</div>
<div class="line"><span class="lineno">  929</span>    update_metrics = self._update_agent(batch)</div>
<div class="line"><span class="lineno">  930</span>    self._metrics.append(update_metrics)</div>
<div class="line"><span class="lineno">  931</span>    self._data.clear()</div>
<div class="line"><span class="lineno">  932</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00057">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00069">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer._data</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00330">open_spiel.python.algorithms.nfsp.ReservoirBuffer._data</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00065">open_spiel.python.jax.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00640">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._data</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00151">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="../../d7/dfc/lru__cache_8py_source.html#l00047">open_spiel.python.utils.lru_cache.LRUCache._data</a>, <a class="el" href="../../d3/d6f/replay__buffer_8py_source.html#l00031">open_spiel.python.utils.replay_buffer.ReplayBuffer._data</a>, <a class="el" href="../../d5/d70/reservoir__buffer_8py_source.html#l00036">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer._data</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00641">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._metrics</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph">
<area shape="rect" title=" " alt="" coords="5,442,224,498"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a063f8a6cc351f7d3bcf74757fabb4669" title=" " alt="" coords="272,246,490,302"/>
<area shape="poly" title=" " alt="" coords="152,439,328,309,331,313,155,444"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="272,571,490,627"/>
<area shape="poly" title=" " alt="" coords="175,496,310,562,307,567,173,500"/>
<area shape="rect" href="../../d6/d2e/classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="558,5,795,46"/>
<area shape="poly" title=" " alt="" coords="393,244,415,203,447,154,488,104,536,62,557,50,560,55,540,67,492,108,452,157,420,206,398,247"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="538,171,815,211"/>
<area shape="poly" title=" " alt="" coords="482,243,537,227,586,213,587,219,539,232,483,248"/>
<area shape="rect" href="../../d2/d62/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="870,64,1103,105"/>
<area shape="poly" title=" " alt="" coords="401,243,457,181,495,150,537,125,616,97,698,81,780,73,854,72,854,78,780,79,699,86,617,102,539,129,498,154,460,185,405,247"/>
<area shape="rect" href="../../da/d4a/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="863,128,1110,184"/>
<area shape="poly" title=" " alt="" coords="407,244,463,196,499,173,537,156,615,138,696,129,776,128,848,133,848,138,775,134,697,134,616,143,539,162,501,178,466,200,411,248"/>
<area shape="rect" href="../../d1/d07/classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="889,209,1084,250"/>
<area shape="poly" title=" " alt="" coords="490,263,873,235,874,240,491,268"/>
<area shape="rect" href="../../d5/dc0/classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="863,276,1110,317"/>
<area shape="poly" title=" " alt="" coords="490,275,848,289,848,294,490,280"/>
<area shape="rect" href="../../d2/dff/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="542,336,811,377"/>
<area shape="poly" title=" " alt="" coords="483,300,539,315,587,329,586,334,537,320,482,305"/>
<area shape="rect" href="../../d3/d5b/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="552,401,801,442"/>
<area shape="poly" title=" " alt="" coords="414,300,470,344,504,367,539,386,557,393,555,398,537,391,501,371,467,349,411,304"/>
<area shape="rect" href="../../de/df1/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="550,467,803,507"/>
<area shape="poly" title=" " alt="" coords="401,300,424,336,456,377,495,417,539,451,551,458,548,462,537,456,491,421,452,380,420,339,396,303"/>
<area shape="poly" title=" " alt="" coords="724,168,862,114,885,107,886,112,864,119,726,173"/>
<area shape="poly" title=" " alt="" coords="816,173,848,169,848,174,816,178"/>
<area shape="poly" title=" " alt="" coords="816,206,874,213,873,218,816,211"/>
<area shape="poly" title=" " alt="" coords="730,209,864,259,894,269,893,274,862,264,728,214"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a566493380f42cdfb19e24266739ff031" title=" " alt="" coords="568,531,786,587"/>
<area shape="poly" title=" " alt="" coords="490,582,552,573,553,578,491,587"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aaba558f18992f23fda573e138df49ac6" title=" " alt="" coords="568,611,786,667"/>
<area shape="poly" title=" " alt="" coords="491,611,553,620,552,625,490,616"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7744e2572fb3fa78b3ff0f99baa1a208" title=" " alt="" coords="568,691,786,747"/>
<area shape="poly" title=" " alt="" coords="433,625,483,652,539,677,557,683,555,688,537,681,481,656,430,630"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph">
<area shape="rect" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a7b25c7de236284a0d59c11efddea26b1" name="a7b25c7de236284a0d59c11efddea26b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b25c7de236284a0d59c11efddea26b1">&#9670;&#160;</a></span>_update_agent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Dict open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Updates the critic and policy parameters of the agent.

Args:
    batch: A batch of training episodes.
    
Dimensions (N=player, B=batch_size, T=timesteps, S=state_dim):
  action: (N, B, T),
  discount: (B, T),
  info_state: (N, B, T, *S),
  legal_actions_mask: (N, B, T),
  reward: (N, B, T),
  terminal: (B, T),
  values: (N, B, T)

Returns:
    A dictionary that contains relevant training metrics.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">945</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  945</span>  <span class="keyword">def </span>_update_agent(self, batch: TransitionBatch) -&gt; typing.Dict:</div>
<div class="line"><span class="lineno">  946</span>    <span class="stringliteral">&quot;&quot;&quot;Updates the critic and policy parameters of the agent.</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">        batch: A batch of training episodes.</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">        </span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    Dimensions (N=player, B=batch_size, T=timesteps, S=state_dim):</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">      action: (N, B, T),</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">      discount: (B, T),</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">      info_state: (N, B, T, *S),</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">      legal_actions_mask: (N, B, T),</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">      reward: (N, B, T),</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">      terminal: (B, T),</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">      values: (N, B, T)</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">        A dictionary that contains relevant training metrics.</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  963</span>    metrics = {}</div>
<div class="line"><span class="lineno">  964</span>    self._num_learn_steps += 1</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>    <span class="comment"># if we do opponent modelling, we update the opponents first</span></div>
<div class="line"><span class="lineno">  967</span>    <span class="keywordflow">if</span> self._fit_opponent_model:</div>
<div class="line"><span class="lineno">  968</span>      opponent_update_metrics = self._update_opponents(batch)</div>
<div class="line"><span class="lineno">  969</span>      metrics.update(</div>
<div class="line"><span class="lineno">  970</span>          (f<span class="stringliteral">&#39;opp_models/{k}&#39;</span>, v) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> opponent_update_metrics.items()</div>
<div class="line"><span class="lineno">  971</span>      )</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>    <span class="comment"># then we update the critic</span></div>
<div class="line"><span class="lineno">  974</span>    critic_update_metrics = self._update_critic(batch)</div>
<div class="line"><span class="lineno">  975</span>    metrics.update((f<span class="stringliteral">&#39;critic/{k}&#39;</span>, v) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> critic_update_metrics.items())</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <span class="comment"># and finally we update the policy</span></div>
<div class="line"><span class="lineno">  978</span>    <span class="keywordflow">if</span> self._num_learn_steps % self._policy_update_interval == 0:</div>
<div class="line"><span class="lineno">  979</span>      policy_update_metrics = self._update_policy(batch)</div>
<div class="line"><span class="lineno">  980</span>      metrics.update(</div>
<div class="line"><span class="lineno">  981</span>          (f<span class="stringliteral">&#39;policy/{k}&#39;</span>, v) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> policy_update_metrics.items()</div>
<div class="line"><span class="lineno">  982</span>      )</div>
<div class="line"><span class="lineno">  983</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno">  984</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00642">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._fit_opponent_model</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00168">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00649">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_learn_steps</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00256">open_spiel.python.jax.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00191">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00634">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_interval</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01029">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_critic()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01035">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01022">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph">
<area shape="rect" title=" " alt="" coords="5,85,224,141"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a566493380f42cdfb19e24266739ff031" title=" " alt="" coords="272,5,490,61"/>
<area shape="poly" title=" " alt="" coords="209,82,270,64,272,69,210,87"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aaba558f18992f23fda573e138df49ac6" title=" " alt="" coords="272,85,490,141"/>
<area shape="poly" title=" " alt="" coords="224,110,256,110,256,116,224,116"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7744e2572fb3fa78b3ff0f99baa1a208" title=" " alt="" coords="272,165,490,221"/>
<area shape="poly" title=" " alt="" coords="210,139,272,158,270,163,209,144"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph">
<area shape="rect" title=" " alt="" coords="1442,208,1660,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="poly" title=" " alt="" coords="1426,238,1395,238,1395,233,1426,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a566493380f42cdfb19e24266739ff031" name="a566493380f42cdfb19e24266739ff031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a566493380f42cdfb19e24266739ff031">&#9670;&#160;</a></span>_update_critic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_critic </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01029">1029</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1029</span>  <span class="keyword">def </span>_update_critic(self, batch: TransitionBatch):</div>
<div class="line"><span class="lineno"> 1030</span>    self._train_state, metrics = self._critic_update_fns[self.player_id](</div>
<div class="line"><span class="lineno"> 1031</span>        self._train_state, batch</div>
<div class="line"><span class="lineno"> 1032</span>    )</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno"> 1034</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph">
<area shape="rect" title=" " alt="" coords="1708,208,1927,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="1442,208,1660,264"/>
<area shape="poly" title=" " alt="" coords="1693,238,1661,238,1661,233,1693,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="poly" title=" " alt="" coords="1426,238,1395,238,1395,233,1426,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="aaba558f18992f23fda573e138df49ac6" name="aaba558f18992f23fda573e138df49ac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaba558f18992f23fda573e138df49ac6">&#9670;&#160;</a></span>_update_opponents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01035">1035</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1035</span>  <span class="keyword">def </span>_update_opponents(self, batch: TransitionBatch):</div>
<div class="line"><span class="lineno"> 1036</span>    update_metrics = {}</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">for</span> opponent <span class="keywordflow">in</span> self._opponent_ids:</div>
<div class="line"><span class="lineno"> 1038</span>      self._train_state, metrics = self._critic_update_fns[opponent](</div>
<div class="line"><span class="lineno"> 1039</span>          self._train_state, batch</div>
<div class="line"><span class="lineno"> 1040</span>      )</div>
<div class="line"><span class="lineno"> 1041</span>      update_metrics.update(</div>
<div class="line"><span class="lineno"> 1042</span>          {f<span class="stringliteral">&#39;agent_{opponent}/critic/{k}&#39;</span>: v <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> metrics.items()}</div>
<div class="line"><span class="lineno"> 1043</span>      )</div>
<div class="line"><span class="lineno"> 1044</span>      self._train_state, metrics = self._policy_update_fns[opponent](</div>
<div class="line"><span class="lineno"> 1045</span>          self._train_state, batch</div>
<div class="line"><span class="lineno"> 1046</span>      )</div>
<div class="line"><span class="lineno"> 1047</span>      update_metrics.update(</div>
<div class="line"><span class="lineno"> 1048</span>          {f<span class="stringliteral">&#39;agent_{opponent}/policy/{k}&#39;</span>: v <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> metrics.items()}</div>
<div class="line"><span class="lineno"> 1049</span>      )</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">return</span> update_metrics</div>
<div class="line"><span class="lineno"> 1051</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph">
<area shape="rect" title=" " alt="" coords="1708,208,1927,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="1442,208,1660,264"/>
<area shape="poly" title=" " alt="" coords="1693,238,1661,238,1661,233,1693,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="poly" title=" " alt="" coords="1426,238,1395,238,1395,233,1426,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a7744e2572fb3fa78b3ff0f99baa1a208" name="a7744e2572fb3fa78b3ff0f99baa1a208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7744e2572fb3fa78b3ff0f99baa1a208">&#9670;&#160;</a></span>_update_policy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/deb/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l01022">1022</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1022</span>  <span class="keyword">def </span>_update_policy(self, batch: TransitionBatch):</div>
<div class="line"><span class="lineno"> 1023</span>    self._train_state, metrics = self._policy_update_fns[self.player_id](</div>
<div class="line"><span class="lineno"> 1024</span>        self._train_state, batch</div>
<div class="line"><span class="lineno"> 1025</span>    )</div>
<div class="line"><span class="lineno"> 1026</span>    self._current_policy = self.get_policy(return_probs=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno"> 1028</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph">
<area shape="rect" title=" " alt="" coords="1708,208,1927,264"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="1442,208,1660,264"/>
<area shape="poly" title=" " alt="" coords="1693,238,1661,238,1661,233,1693,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="poly" title=" " alt="" coords="1426,238,1395,238,1395,233,1426,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="ad55be43954fb6c325544adca41430bbd" name="ad55be43954fb6c325544adca41430bbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad55be43954fb6c325544adca41430bbd">&#9670;&#160;</a></span>critic_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.critic_network </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00734">734</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  734</span>  <span class="keyword">def </span>critic_network(self):</div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordflow">return</span> self._critic_network</div>
<div class="line"><span class="lineno">  736</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d08a854b5449fc58a485a69e2604854" name="a7d08a854b5449fc58a485a69e2604854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d08a854b5449fc58a485a69e2604854">&#9670;&#160;</a></span>get_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Callable open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>return_probs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the policy.

Returns a function that takes a random key, an observation and
optionally an action mask. The function produces actions which are
sampled from the current policy. Additionally, if eturn_probs is true,
it also returns the action probabilities.

Args:
    return_probs: if true, the policy returns a tuple (action,
      action_probs).

Returns:
    A function that maps observations to actions
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00768">768</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  768</span>  <span class="keyword">def </span>get_policy(self, return_probs=True) -&gt; typing.Callable:</div>
<div class="line"><span class="lineno">  769</span>    <span class="stringliteral">&quot;&quot;&quot;Get the policy.</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">    Returns a function that takes a random key, an observation and</span></div>
<div class="line"><span class="lineno">  772</span><span class="stringliteral">    optionally an action mask. The function produces actions which are</span></div>
<div class="line"><span class="lineno">  773</span><span class="stringliteral">    sampled from the current policy. Additionally, if eturn_probs is true,</span></div>
<div class="line"><span class="lineno">  774</span><span class="stringliteral">    it also returns the action probabilities.</span></div>
<div class="line"><span class="lineno">  775</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  776</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  777</span><span class="stringliteral">        return_probs: if true, the policy returns a tuple (action,</span></div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral">          action_probs).</span></div>
<div class="line"><span class="lineno">  779</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  780</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  781</span><span class="stringliteral">        A function that maps observations to actions</span></div>
<div class="line"><span class="lineno">  782</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="keyword">def </span>_policy(key: jax.random.PRNGKey, obs: jnp.ndarray, action_mask=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  785</span>      <span class="stringliteral">&quot;&quot;&quot;The actual policy function.</span></div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral">      </span></div>
<div class="line"><span class="lineno">  787</span><span class="stringliteral">      Takes a random key, the current observation and optionally an action</span></div>
<div class="line"><span class="lineno">  788</span><span class="stringliteral">      mask.</span></div>
<div class="line"><span class="lineno">  789</span><span class="stringliteral">      </span></div>
<div class="line"><span class="lineno">  790</span><span class="stringliteral">      Args:</span></div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral">          key: a random key for sampling</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral">          obs: numpy array of observations</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">          action_mask: optional numpy array to mask out illegal actions</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">      Returns:</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">        Either the sampled actions or, if return_probs is true, a tuple</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">        (actions, action_probs).</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral">      &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  799</span>      params = self._train_state.policy_params[self.player_id]</div>
<div class="line"><span class="lineno">  800</span>      pi = self._pi_network.apply(params, obs)</div>
<div class="line"><span class="lineno">  801</span>      <span class="keywordflow">if</span> action_mask <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  802</span>        probs = pi.probs * action_mask</div>
<div class="line"><span class="lineno">  803</span>        probs = probs / probs.sum()</div>
<div class="line"><span class="lineno">  804</span>        pi = distrax.Categorical(probs=probs)</div>
<div class="line"><span class="lineno">  805</span>      actions = pi.sample(seed=key)</div>
<div class="line"><span class="lineno">  806</span>      <span class="keywordflow">if</span> return_probs:</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordflow">return</span> actions, pi.prob(actions)</div>
<div class="line"><span class="lineno">  808</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  809</span>        <span class="keywordflow">return</span> actions</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">return</span> jax.jit(_policy)</div>
<div class="line"><span class="lineno">  812</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00651">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00233">open_spiel.python.pytorch.policy_gradient.PolicyGradient._pi_network</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="../../d6/d97/noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d5/d27/rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../d1/d9b/bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../de/d51/ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="../../d3/d26/dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="../../d9/d49/base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="../../d7/d2a/data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph">
<area shape="rect" title=" " alt="" coords="5,113,283,154"/>
<area shape="rect" href="../../d2/d62/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="337,5,570,46"/>
<area shape="poly" title=" " alt="" coords="190,110,256,83,330,55,352,48,353,53,332,60,258,88,193,115"/>
<area shape="rect" href="../../da/d4a/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="331,70,577,126"/>
<area shape="poly" title=" " alt="" coords="283,115,315,111,315,116,284,120"/>
<area shape="rect" href="../../d1/d07/classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="356,149,552,190"/>
<area shape="poly" title=" " alt="" coords="284,147,341,154,340,159,283,152"/>
<area shape="rect" href="../../d5/dc0/classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="331,215,577,255"/>
<area shape="poly" title=" " alt="" coords="200,152,332,199,359,207,357,212,330,204,198,157"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph">
<area shape="rect" title=" " alt="" coords="1753,180,2031,220"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a688a991bdc9042322d47fc183d7a7ab8" title=" " alt="" coords="1442,144,1705,184"/>
<area shape="poly" title=" " alt="" coords="1737,185,1705,181,1706,176,1738,180"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a063f8a6cc351f7d3bcf74757fabb4669" title=" " alt="" coords="1464,208,1683,264"/>
<area shape="poly" title=" " alt="" coords="1738,220,1684,226,1683,221,1738,215"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,208,1394,264"/>
<area shape="poly" title=" " alt="" coords="1449,238,1395,238,1395,233,1449,233"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1160,238,1128,238,1128,233,1160,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="ad592a86c90ce19aa7b49b93823803fe6" name="ad592a86c90ce19aa7b49b93823803fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad592a86c90ce19aa7b49b93823803fe6">&#9670;&#160;</a></span>get_value_fn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Callable open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_value_fn </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00759">759</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  759</span>  <span class="keyword">def </span>get_value_fn(self) -&gt; typing.Callable:</div>
<div class="line"><span class="lineno">  760</span>    <span class="keyword">def </span>value_fn(obs: jnp.ndarray):</div>
<div class="line"><span class="lineno">  761</span>      obs = jnp.array(obs)</div>
<div class="line"><span class="lineno">  762</span>      <span class="keywordflow">return</span> self._critic_network.apply(</div>
<div class="line"><span class="lineno">  763</span>          self.train_state.critic_params[self.player_id], obs</div>
<div class="line"><span class="lineno">  764</span>      ).squeeze(-1)</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordflow">return</span> jax.jit(value_fn)</div>
<div class="line"><span class="lineno">  767</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac43b971fdf9c6cec4de895b6ae366aac" name="ac43b971fdf9c6cec4de895b6ae366aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac43b971fdf9c6cec4de895b6ae366aac">&#9670;&#160;</a></span>metrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.metrics </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>return_last_only</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00737">737</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  737</span>  <span class="keyword">def </span>metrics(self, return_last_only: bool = <span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  738</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> self._metrics:</div>
<div class="line"><span class="lineno">  739</span>      <span class="keywordflow">return</span> {}</div>
<div class="line"><span class="lineno">  740</span>    metrics = self._metrics[-1] <span class="keywordflow">if</span> return_last_only <span class="keywordflow">else</span> self._metrics</div>
<div class="line"><span class="lineno">  741</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno">  742</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab261d55d230e37037218f8a91c7a22b7" name="ab261d55d230e37037218f8a91c7a22b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab261d55d230e37037218f8a91c7a22b7">&#9670;&#160;</a></span>policy_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.policy_network </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00730">730</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  730</span>  <span class="keyword">def </span>policy_network(self):</div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">return</span> self._pi_network</div>
<div class="line"><span class="lineno">  732</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a49083992dc97516ca2e134c672e2520e" name="a49083992dc97516ca2e134c672e2520e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49083992dc97516ca2e134c672e2520e">&#9670;&#160;</a></span>step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dec/classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a></td>          <td class="paramname"><span class="paramname"><em>time_step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>is_evaluation</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Produces an action and possibly triggers a parameter update.

LOLA agents depend on having access to previous actions made by the
opponent. Assumes that the field 'observations' of time_step contains a
field 'actions' and its first axis is indexed by the player id. Similar, the
fields 'rewards' and 'legal_actions' are assumed to be of shape
(num_players,).

Args:
    time_step: a TimeStep instance which has a field 'actions' in the
      observations dict.
    is_evaluation: if true, the agent will not update.

Returns:
    A tuple containing the action that was taken and its probability
    under the current policy.
</pre> 
<p>Reimplemented from <a class="el" href="../../d2/dfa/classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html#ab97b9d892ae3a1232f3adce55203efea">open_spiel.python.rl_agent.AbstractAgent</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">813</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  813</span>  <span class="keyword">def </span>step(self, time_step: TimeStep, is_evaluation=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  814</span>    <span class="stringliteral">&quot;&quot;&quot;Produces an action and possibly triggers a parameter update.</span></div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">    LOLA agents depend on having access to previous actions made by the</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral">    opponent. Assumes that the field &#39;observations&#39; of time_step contains a</span></div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">    field &#39;actions&#39; and its first axis is indexed by the player id. Similar, the</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">    fields &#39;rewards&#39; and &#39;legal_actions&#39; are assumed to be of shape</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">    (num_players,).</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">        time_step: a TimeStep instance which has a field &#39;actions&#39; in the</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">          observations dict.</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">        is_evaluation: if true, the agent will not update.</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">        A tuple containing the action that was taken and its probability</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">        under the current policy.</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  831</span>    do_step = (</div>
<div class="line"><span class="lineno">  832</span>        time_step.is_simultaneous_move()</div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">or</span> self.player_id == time_step.current_player()</div>
<div class="line"><span class="lineno">  834</span>    )</div>
<div class="line"><span class="lineno">  835</span>    action, probs = <span class="keywordtype">None</span>, []</div>
<div class="line"><span class="lineno">  836</span>    batch_policy = vmap(self._current_policy, in_axes=(0, 0, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> time_step.last() <span class="keywordflow">and</span> do_step:</div>
<div class="line"><span class="lineno">  838</span>      info_state = time_step.observations[<span class="stringliteral">&#39;info_state&#39;</span>][self.player_id]</div>
<div class="line"><span class="lineno">  839</span>      legal_actions = time_step.observations[<span class="stringliteral">&#39;legal_actions&#39;</span>][self.player_id]</div>
<div class="line"><span class="lineno">  840</span>      action_mask = np.zeros(self._num_actions)</div>
<div class="line"><span class="lineno">  841</span>      action_mask[legal_actions] = 1</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>      <span class="comment"># If we are not in a batched environment, we need to add a batch dimension</span></div>
<div class="line"><span class="lineno">  844</span>      <span class="keywordflow">if</span> <span class="stringliteral">&#39;batch_size&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> time_step.observations:</div>
<div class="line"><span class="lineno">  845</span>        info_state = jnp.array(info_state)[<span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  846</span>        batch_size = 1</div>
<div class="line"><span class="lineno">  847</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  848</span>        batch_size = time_step.observations[<span class="stringliteral">&#39;batch_size&#39;</span>]</div>
<div class="line"><span class="lineno">  849</span>      sample_keys = jax.random.split(next(self._rng), batch_size)</div>
<div class="line"><span class="lineno">  850</span>      action, probs = batch_policy(sample_keys, info_state, action_mask)</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_evaluation:</div>
<div class="line"><span class="lineno">  853</span>      self._store_time_step(time_step=time_step, action=action)</div>
<div class="line"><span class="lineno">  854</span>      <span class="keywordflow">if</span> time_step.last() <span class="keywordflow">and</span> self._should_update():</div>
<div class="line"><span class="lineno">  855</span>        self._train_step()</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordflow">return</span> rl_agent.StepOutput(action=action, probs=probs)</div>
<div class="line"><span class="lineno">  858</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00653">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_opt</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00430">open_spiel.python.algorithms.cfr._CFRSolver._current_policy</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00165">open_spiel.python.algorithms.cfr._CFRSolverBase._current_policy</a>, <a class="el" href="../../dd/dc5/cfr__br_8py_source.html#l00134">open_spiel.python.algorithms.cfr_br.CFRBRSolver._current_policy</a>, <a class="el" href="../../d1/dd6/algorithms_2discounted__cfr_8py_source.html#l00209">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._current_policy</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00434">open_spiel.python.algorithms.efr._EFRSolver._current_policy</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00109">open_spiel.python.algorithms.efr._EFRSolverBase._current_policy</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00662">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._current_policy</a>, <a class="el" href="../../dd/dc3/boltzmann__tabular__qlearner_8py_source.html#l00073">open_spiel.python.algorithms.boltzmann_tabular_qlearner.BoltzmannQLearner._num_actions</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00170">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00213">open_spiel.python.algorithms.deep_cfr_tf2.AdvantageNetwork._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00333">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00148">open_spiel.python.algorithms.deep_cfr_tf2.PolicyNetwork._num_actions</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00070">open_spiel.python.algorithms.dqn.DQN._num_actions</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00137">open_spiel.python.algorithms.eva.EVAAgent._num_actions</a>, <a class="el" href="../../d9/d7e/mcts__agent_8py_source.html#l00033">open_spiel.python.algorithms.mcts_agent.MCTSAgent._num_actions</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00066">open_spiel.python.algorithms.nfsp.NFSP._num_actions</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00154">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../d3/df2/random__agent_8py_source.html#l00027">open_spiel.python.algorithms.random_agent.RandomAgent._num_actions</a>, <a class="el" href="../../d8/d79/tabular__multiagent__qlearner_8py_source.html#l00190">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._num_actions</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00046">open_spiel.python.algorithms.tabular_qlearner.QLearner._num_actions</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00072">open_spiel.python.algorithms.wolf_phc.WoLFPHC._num_actions</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00214">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot._num_actions</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00043">open_spiel.python.environments.catch.Environment._num_actions</a>, <a class="el" href="../../d0/dd5/rl__response_8py_source.html#l00137">open_spiel.python.examples.rl_response.FirstActionAgent._num_actions</a>, <a class="el" href="../../da/db6/roshambo__population__example_8py_source.html#l00058">open_spiel.python.examples.roshambo_population_example.BotAgent._num_actions</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l01060">open_spiel.python.games.chat_games.chat_game_base.BaseChatGame._num_actions</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00121">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._num_actions</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00176">open_spiel.python.jax.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00068">open_spiel.python.jax.dqn.DQN._num_actions</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00066">open_spiel.python.jax.nfsp.NFSP._num_actions</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00632">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00037">open_spiel.python.jax.policy_gradient.NetA2C._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00054">open_spiel.python.jax.policy_gradient.NetPG._num_actions</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00244">open_spiel.python.jax.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00074">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._num_actions</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00090">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._num_actions</a>, <a class="el" href="../../dd/d6d/normal__form__game_8py_source.html#l00146">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._num_actions</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00259">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00141">open_spiel.python.pytorch.dqn.DQN._num_actions</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00129">open_spiel.python.pytorch.eva.EVAAgent._num_actions</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00176">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00643">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_ids</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00654">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_opt</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00651">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00233">open_spiel.python.pytorch.policy_gradient.PolicyGradient._pi_network</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00655">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_opt</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00295">meta_learning.MetaCFRRegretAgent._rng</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00040">open_spiel.python.bots.policy.PolicyBot._rng</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00034">open_spiel.python.bots.uniform_random.UniformRandomBot._rng</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00039">open_spiel.python.environments.catch.Environment._rng</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00644">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._rng</a>, <a class="el" href="../../dd/d06/rl__environment_8py_source.html#l00126">open_spiel.python.rl_environment.ChanceEventSampler._rng</a>, <a class="el" href="../../d2/dd3/rnn__meta__selfplay__agent_8py_source.html#l00144">rnn_meta_selfplay_agent.MetaSelfplayAgent._rng</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="../../d6/d97/noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d5/d27/rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../d1/d9b/bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../de/d51/ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="../../d3/d26/dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="../../d9/d49/base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="../../d7/d2a/data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d71/jax__cfr_8py_source.html#l00359">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.evaluate_and_update_policy()</a>, <a class="el" href="../../da/d71/jax__cfr_8py_source.html#l00350">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.multiple_steps()</a>, <a class="el" href="../../d6/d11/double__oracle_8py_source.html#l00126">open_spiel.python.algorithms.double_oracle.DoubleOracleSolver.solve_yield()</a>, <a class="el" href="../../d4/d2e/nash__evolutionary__search_8py_source.html#l00094">nash_evolutionary_search.NashCMAES.step_for()</a>, <a class="el" href="../../df/dd1/nash__random__search_8py_source.html#l00100">nash_random_search.NashRandomSearch.step_for()</a>, <a class="el" href="../../d2/d0e/bandit__regret_8py_source.html#l00363">open_spiel.python.mfg.algorithms.bandit_regret.PolynomialWeightAlgorithm.step_for()</a>, and <a class="el" href="../../dd/ddd/regret__minimizer_8py_source.html#l00107">regret_minimizer.RegretMinimizer.step_for()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph">
<area shape="rect" title=" " alt="" coords="5,260,249,300"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a4c6e95fe51f4fcc38c46f857ff7a14fc" title=" " alt="" coords="297,5,515,61"/>
<area shape="poly" title=" " alt="" coords="138,258,162,219,198,169,243,117,295,71,302,67,305,71,298,75,247,120,202,172,166,222,142,261"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a92fdbbc16d1a44597453d7f3bd1c6278" title=" " alt="" coords="297,85,515,141"/>
<area shape="poly" title=" " alt="" coords="152,257,216,209,295,158,319,145,321,150,298,162,219,213,156,261"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="297,505,515,561"/>
<area shape="poly" title=" " alt="" coords="153,299,364,493,361,497,149,303"/>
<area shape="rect" href="../../d2/d62/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="1222,209,1456,250"/>
<area shape="poly" title=" " alt="" coords="249,263,296,259,549,244,800,235,1207,227,1207,233,800,240,549,249,297,264,249,268"/>
<area shape="rect" href="../../da/d4a/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="1216,563,1462,618"/>
<area shape="poly" title=" " alt="" coords="249,274,490,269,776,269,911,272,1028,278,1117,288,1148,295,1169,303,1202,326,1230,355,1255,386,1276,420,1308,488,1329,547,1324,548,1304,490,1271,423,1251,389,1226,358,1198,330,1166,308,1147,300,1116,293,1027,283,911,277,776,274,490,274,249,279"/>
<area shape="rect" href="../../d1/d07/classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="1241,678,1436,719"/>
<area shape="poly" title=" " alt="" coords="141,300,204,418,250,495,299,572,364,673,415,753,442,789,474,824,514,860,565,899,647,952,718,982,793,1001,891,1019,972,1039,1040,1057,1071,1059,1101,1055,1132,1043,1166,1019,1182,1003,1192,987,1202,954,1201,918,1194,882,1186,844,1183,806,1190,768,1200,749,1214,730,1226,719,1230,723,1218,734,1204,752,1195,769,1188,806,1191,843,1199,881,1206,918,1207,954,1197,990,1186,1007,1169,1023,1135,1047,1102,1060,1071,1065,1039,1062,971,1044,890,1024,792,1006,716,987,645,956,561,903,510,864,470,828,438,792,410,756,359,676,294,575,245,498,200,420,137,302"/>
<area shape="rect" href="../../d5/dc0/classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="1216,744,1462,784"/>
<area shape="poly" title=" " alt="" coords="131,300,138,398,147,468,162,546,183,629,212,713,250,794,299,868,329,902,357,929,385,949,414,965,480,989,564,1016,733,1080,806,1106,874,1125,941,1133,1010,1127,1084,1106,1166,1066,1201,1040,1231,1009,1257,973,1278,936,1309,861,1327,799,1332,800,1314,862,1283,938,1261,976,1235,1012,1205,1044,1169,1070,1086,1111,1011,1133,941,1138,873,1130,804,1111,731,1085,562,1021,478,994,412,970,383,954,354,933,325,906,295,871,246,797,207,715,178,631,157,547,142,468,133,398,126,301"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a6a1a3592b3656e858e405ca6974d3db1" title=" " alt="" coords="594,17,812,73"/>
<area shape="poly" title=" " alt="" coords="515,86,578,71,579,76,516,91"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a20a9c683dd11b09e5667692bc1ab6891" title=" " alt="" coords="563,97,842,138"/>
<area shape="poly" title=" " alt="" coords="515,112,547,112,547,118,515,117"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a063f8a6cc351f7d3bcf74757fabb4669" title=" " alt="" coords="594,505,812,561"/>
<area shape="poly" title=" " alt="" coords="515,530,578,530,578,536,515,536"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="594,833,812,889"/>
<area shape="poly" title=" " alt="" coords="434,559,668,820,664,823,430,563"/>
<area shape="rect" href="../../d6/d2e/classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="910,513,1148,554"/>
<area shape="poly" title=" " alt="" coords="812,530,895,530,895,536,812,536"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="890,628,1168,668"/>
<area shape="poly" title=" " alt="" coords="769,559,891,607,933,620,932,625,889,612,767,564"/>
<area shape="poly" title=" " alt="" coords="716,504,742,458,781,403,830,348,858,324,889,303,927,284,966,267,1049,244,1131,231,1207,225,1207,230,1132,236,1050,250,968,273,929,288,892,307,862,328,834,352,785,406,747,461,721,506"/>
<area shape="poly" title=" " alt="" coords="812,551,891,563,1051,576,1200,584,1200,589,1051,582,890,568,812,557"/>
<area shape="poly" title=" " alt="" coords="731,560,761,590,799,623,843,654,891,677,976,700,1064,711,1149,713,1226,710,1226,715,1149,719,1064,717,975,706,889,682,840,658,795,627,757,593,727,564"/>
<area shape="poly" title=" " alt="" coords="724,560,752,598,790,643,838,686,892,720,967,748,1047,764,1127,771,1200,772,1200,778,1126,777,1047,769,966,753,889,725,834,690,787,646,748,601,720,563"/>
<area shape="rect" href="../../d2/dff/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="894,317,1164,358"/>
<area shape="poly" title=" " alt="" coords="726,503,795,435,840,399,889,368,904,361,907,366,892,373,843,403,798,439,730,507"/>
<area shape="rect" href="../../d3/d5b/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="905,382,1153,423"/>
<area shape="poly" title=" " alt="" coords="749,503,814,467,889,433,913,425,915,430,891,438,817,472,752,507"/>
<area shape="rect" href="../../de/df1/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="902,448,1156,488"/>
<area shape="poly" title=" " alt="" coords="812,509,909,489,910,494,813,514"/>
<area shape="poly" title=" " alt="" coords="1078,625,1123,599,1166,563,1196,527,1223,487,1269,404,1303,325,1324,263,1330,265,1308,327,1274,406,1228,490,1200,530,1170,567,1126,603,1080,629"/>
<area shape="poly" title=" " alt="" coords="1142,624,1200,613,1201,619,1143,630"/>
<area shape="poly" title=" " alt="" coords="1158,666,1226,677,1225,683,1157,671"/>
<area shape="poly" title=" " alt="" coords="1073,666,1140,697,1217,728,1241,736,1239,741,1215,733,1138,702,1071,671"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a566493380f42cdfb19e24266739ff031" title=" " alt="" coords="920,793,1138,849"/>
<area shape="poly" title=" " alt="" coords="812,845,904,834,905,839,813,850"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aaba558f18992f23fda573e138df49ac6" title=" " alt="" coords="920,873,1138,929"/>
<area shape="poly" title=" " alt="" coords="813,872,905,883,904,889,812,877"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7744e2572fb3fa78b3ff0f99baa1a208" title=" " alt="" coords="920,953,1138,1009"/>
<area shape="poly" title=" " alt="" coords="766,887,891,939,911,946,910,951,889,944,764,892"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph">
<area shape="rect" title=" " alt="" coords="884,216,1128,256"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a20a9c683dd11b09e5667692bc1ab6891" name="a20a9c683dd11b09e5667692bc1ab6891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a9c683dd11b09e5667692bc1ab6891">&#9670;&#160;</a></span>train_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.train_state </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00726">726</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  726</span>  <span class="keyword">def </span>train_state(self):</div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordflow">return</span> deepcopy(self._train_state)</div>
<div class="line"><span class="lineno">  728</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00743">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.update_params()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph">
<area shape="rect" title=" " alt="" coords="1531,252,1810,292"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a92fdbbc16d1a44597453d7f3bd1c6278" title=" " alt="" coords="1220,208,1438,264"/>
<area shape="poly" title=" " alt="" coords="1515,258,1439,250,1439,245,1516,253"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a3fd78be8c0cd590a8c974be8e603d2d1" title=" " alt="" coords="1176,288,1483,328"/>
<area shape="poly" title=" " alt="" coords="1516,291,1484,294,1483,289,1515,286"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,216,1128,256"/>
<area shape="poly" title=" " alt="" coords="1205,238,1128,238,1128,233,1205,233"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="978,205,917,139,878,105,835,75,791,56,793,51,838,71,881,101,921,136,982,202"/>
<area shape="rect" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="961,209,903,174,835,141,792,127,793,121,837,136,905,169,964,204"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,150,824,191"/>
<area shape="poly" title=" " alt="" coords="891,214,797,194,798,189,893,209"/>
<area shape="rect" href="../../d2/dfd/classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,216,787,256"/>
<area shape="poly" title=" " alt="" coords="869,238,787,238,787,233,869,233"/>
<area shape="rect" href="../../d5/dd9/classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,281,813,322"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="rect" href="../../d1/d50/classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,346,836,387"/>
<area shape="poly" title=" " alt="" coords="964,267,905,303,837,336,801,348,799,343,835,331,903,298,961,263"/>
<area shape="rect" href="../../d5/d11/classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,411,831,437"/>
<area shape="poly" title=" " alt="" coords="983,270,922,338,882,372,838,401,808,413,806,408,835,396,879,368,918,334,979,267"/>
<area shape="rect" href="../../d7/d68/classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,150,513,191"/>
<area shape="poly" title=" " alt="" coords="557,173,514,173,514,168,557,168"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#ad1331eddb66a419f7336bc267b47d75e" title=" " alt="" coords="5,117,233,158"/>
<area shape="poly" title=" " alt="" coords="265,157,233,153,233,148,265,152"/>
<area shape="rect" href="../../d0/d7e/classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,182,233,223"/>
<area shape="poly" title=" " alt="" coords="265,188,233,192,233,187,265,183"/>
</map>
</div>

</div>
</div>
<a id="a3fd78be8c0cd590a8c974be8e603d2d1" name="a3fd78be8c0cd590a8c974be8e603d2d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fd78be8c0cd590a8c974be8e603d2d1">&#9670;&#160;</a></span>update_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.update_params </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d14/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_train_state.html">TrainState</a></td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>player_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Updates the parameters of the other agents.

Args:
    state: the train state of the other agent.
    player_id: id of the other agent

Returns:
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00743">743</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  743</span>  <span class="keyword">def </span>update_params(self, state: TrainState, player_id: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  744</span>    <span class="stringliteral">&quot;&quot;&quot;Updates the parameters of the other agents.</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral">        state: the train state of the other agent.</span></div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">        player_id: id of the other agent</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  752</span>    self._train_state.policy_params[player_id] = deepcopy(</div>
<div class="line"><span class="lineno">  753</span>        state.policy_params[player_id]</div>
<div class="line"><span class="lineno">  754</span>    )</div>
<div class="line"><span class="lineno">  755</span>    self._train_state.critic_params[player_id] = deepcopy(</div>
<div class="line"><span class="lineno">  756</span>        state.critic_params[player_id]</div>
<div class="line"><span class="lineno">  757</span>    )</div>
<div class="line"><span class="lineno">  758</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="../../d6/d97/noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d5/d27/rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../d1/d9b/bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="../../de/d51/ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="../../d3/d26/dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="../../d9/d49/base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, <a class="el" href="../../d7/d2a/data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00726">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.train_state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a3fd78be8c0cd590a8c974be8e603d2d1_cgraph.png" border="0" usemap="#ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a3fd78be8c0cd590a8c974be8e603d2d1_cgraph" alt=""/></div>
<map name="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a3fd78be8c0cd590a8c974be8e603d2d1_cgraph" id="ad3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a3fd78be8c0cd590a8c974be8e603d2d1_cgraph">
<area shape="rect" title=" " alt="" coords="5,149,313,190"/>
<area shape="rect" href="../../d2/d62/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="384,5,617,46"/>
<area shape="poly" title=" " alt="" coords="190,146,265,101,312,76,360,55,379,48,381,53,362,60,314,81,268,105,193,151"/>
<area shape="rect" href="../../da/d4a/classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="377,70,624,126"/>
<area shape="poly" title=" " alt="" coords="258,146,362,124,363,129,259,151"/>
<area shape="rect" href="../../d1/d07/classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="403,149,598,190"/>
<area shape="poly" title=" " alt="" coords="313,167,387,167,387,172,313,172"/>
<area shape="rect" href="../../d5/dc0/classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="377,215,624,255"/>
<area shape="poly" title=" " alt="" coords="269,188,376,209,375,214,268,193"/>
<area shape="rect" href="../../d3/d9f/classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a20a9c683dd11b09e5667692bc1ab6891" title=" " alt="" coords="361,280,640,321"/>
<area shape="poly" title=" " alt="" coords="199,188,273,227,362,265,387,273,385,278,360,269,270,231,196,193"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7d512f8db3cd6995a357d1b1a9a29fe9" name="a7d512f8db3cd6995a357d1b1a9a29fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d512f8db3cd6995a357d1b1a9a29fe9">&#9670;&#160;</a></span>_batch_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._batch_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00633">633</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00061">open_spiel.python.algorithms.dqn.DQN.__init__()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00062">open_spiel.python.algorithms.nfsp.NFSP.__init__()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d4/d52/iterated__matrix__game_8py_source.html#l00042">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame.__init__()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00060">open_spiel.python.jax.dqn.DQN.__init__()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00063">open_spiel.python.jax.nfsp.NFSP.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00070">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy.__init__()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00087">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.__init__()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00133">open_spiel.python.pytorch.dqn.DQN.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00244">open_spiel.python.algorithms.nfsp.NFSP._learn()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00266">open_spiel.python.jax.nfsp.NFSP._learn()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00305">open_spiel.python.algorithms.dqn.DQN.learn()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00310">open_spiel.python.jax.dqn.DQN.learn()</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00221">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy.learn()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00348">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.learn()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00301">open_spiel.python.pytorch.dqn.DQN.learn()</a>, <a class="el" href="../../d4/d52/iterated__matrix__game_8py_source.html#l00144">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame.reset()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d4/d52/iterated__matrix__game_8py_source.html#l00089">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame.step()</a>, and <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="a1be0298b8c774973728e71ee9e51350d" name="a1be0298b8c774973728e71ee9e51350d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1be0298b8c774973728e71ee9e51350d">&#9670;&#160;</a></span>_critic_network</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00652">652</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00743">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.update_params()</a>.</p>

</div>
</div>
<a id="af418dfaf2a015727355307aecf6f29dc" name="af418dfaf2a015727355307aecf6f29dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af418dfaf2a015727355307aecf6f29dc">&#9670;&#160;</a></span>_critic_opt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_opt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00653">653</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>

</div>
</div>
<a id="a9974fd169e235555eba0df4b5c521a89" name="a9974fd169e235555eba0df4b5c521a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9974fd169e235555eba0df4b5c521a89">&#9670;&#160;</a></span>_critic_update_fns</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_update_fns</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00700">700</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>.</p>

</div>
</div>
<a id="a779706e86904f179eadedece2dcf90f3" name="a779706e86904f179eadedece2dcf90f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779706e86904f179eadedece2dcf90f3">&#9670;&#160;</a></span>_current_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._current_policy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00662">662</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00131">open_spiel.python.algorithms.cfr._CFRSolverBase.__init__()</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00085">open_spiel.python.algorithms.efr._EFRSolverBase.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00339">open_spiel.python.algorithms.cfr._CFRSolverBase._get_infostate_policy()</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00413">open_spiel.python.algorithms.efr._EFRSolverBase._get_infostate_policy()</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00176">open_spiel.python.algorithms.cfr._CFRSolverBase._initialize_info_state_nodes()</a>, <a class="el" href="../../d1/dd6/algorithms_2discounted__cfr_8py_source.html#l00059">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._initialize_info_state_nodes()</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00165">open_spiel.python.algorithms.efr._EFRSolverBase._initialize_info_state_nodes()</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00208">open_spiel.python.algorithms.cfr._CFRSolverBase.current_policy()</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00134">open_spiel.python.algorithms.efr._EFRSolverBase.current_policy()</a>, <a class="el" href="../../d7/d05/algorithms_2cfr_8py_source.html#l00418">open_spiel.python.algorithms.cfr._CFRSolver.evaluate_and_update_policy()</a>, <a class="el" href="../../dd/dc5/cfr__br_8py_source.html#l00108">open_spiel.python.algorithms.cfr_br.CFRBRSolver.evaluate_and_update_policy()</a>, <a class="el" href="../../d1/dd6/algorithms_2discounted__cfr_8py_source.html#l00190">open_spiel.python.algorithms.discounted_cfr._DCFRSolver.evaluate_and_update_policy()</a>, <a class="el" href="../../d6/dee/efr_8py_source.html#l00426">open_spiel.python.algorithms.efr._EFRSolver.evaluate_and_update_policy()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>

</div>
</div>
<a id="aa25f34ed6d72e2dc0b30dc1ed2941f76" name="aa25f34ed6d72e2dc0b30dc1ed2941f76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25f34ed6d72e2dc0b30dc1ed2941f76">&#9670;&#160;</a></span>_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00640">640</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00060">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer.add()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00072">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.add()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00333">open_spiel.python.algorithms.nfsp.ReservoirBuffer.add()</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00068">open_spiel.python.jax.deep_cfr.ReservoirBuffer.add()</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00154">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer.add()</a>, <a class="el" href="../../d3/d6f/replay__buffer_8py_source.html#l00034">open_spiel.python.utils.replay_buffer.ReplayBuffer.add()</a>, <a class="el" href="../../d5/d70/reservoir__buffer_8py_source.html#l00039">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer.add()</a>, <a class="el" href="../../d7/dfc/lru__cache_8py_source.html#l00069">open_spiel.python.utils.lru_cache.LRUCache.get()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00059">open_spiel.python.algorithms.eva.QueryableFixedSizeRingBuffer.knn()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00055">open_spiel.python.pytorch.eva.QueryableFixedSizeRingBuffer.knn()</a>, <a class="el" href="../../d7/dfc/lru__cache_8py_source.html#l00056">open_spiel.python.utils.lru_cache.LRUCache.make()</a>, <a class="el" href="../../d3/d6f/replay__buffer_8py_source.html#l00066">open_spiel.python.utils.replay_buffer.ReplayBuffer.reset()</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00074">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer.sample()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00086">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.sample()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00347">open_spiel.python.algorithms.nfsp.ReservoirBuffer.sample()</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00082">open_spiel.python.jax.deep_cfr.ReservoirBuffer.sample()</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00168">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer.sample()</a>, <a class="el" href="../../d3/d6f/replay__buffer_8py_source.html#l00049">open_spiel.python.utils.replay_buffer.ReplayBuffer.sample()</a>, <a class="el" href="../../d5/d70/reservoir__buffer_8py_source.html#l00053">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer.sample()</a>, and <a class="el" href="../../d7/dfc/lru__cache_8py_source.html#l00080">open_spiel.python.utils.lru_cache.LRUCache.set()</a>.</p>

</div>
</div>
<a id="a06c10635825968de3e335fb21cb40487" name="a06c10635825968de3e335fb21cb40487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c10635825968de3e335fb21cb40487">&#9670;&#160;</a></span>_discount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._discount</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00635">635</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00106">open_spiel.python.algorithms.eva.EVAAgent.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00100">open_spiel.python.pytorch.eva.EVAAgent.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00322">open_spiel.python.algorithms.eva.EVAAgent._trajectory_centric_planning()</a>, and <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00301">open_spiel.python.pytorch.eva.EVAAgent._trajectory_centric_planning()</a>.</p>

</div>
</div>
<a id="a2bb2cffe0b4db2762a123cf45521ac6c" name="a2bb2cffe0b4db2762a123cf45521ac6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bb2cffe0b4db2762a123cf45521ac6c">&#9670;&#160;</a></span>_episode_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._episode_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00648">648</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00203">open_spiel.python.jax.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, and <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="ac39e3b45ac16eb5b85022bd9b4977450" name="ac39e3b45ac16eb5b85022bd9b4977450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac39e3b45ac16eb5b85022bd9b4977450">&#9670;&#160;</a></span>_fit_opponent_model</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._fit_opponent_model</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00642">642</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>

</div>
</div>
<a id="ad8dcd4e6158402b9eb2e531c06b0b9a0" name="ad8dcd4e6158402b9eb2e531c06b0b9a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8dcd4e6158402b9eb2e531c06b0b9a0">&#9670;&#160;</a></span>_metrics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._metrics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00641">641</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>.</p>

</div>
</div>
<a id="a23a99f733cb36d9942b3566feef619c9" name="a23a99f733cb36d9942b3566feef619c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23a99f733cb36d9942b3566feef619c9">&#9670;&#160;</a></span>_num_actions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_actions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00632">632</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00040">open_spiel.python.jax.policy_gradient.NetA2C.__call__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00057">open_spiel.python.jax.policy_gradient.NetPG.__call__()</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00129">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver.__init__()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00285">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver.__init__()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00061">open_spiel.python.algorithms.dqn.DQN.__init__()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00106">open_spiel.python.algorithms.eva.EVAAgent.__init__()</a>, <a class="el" href="../../d9/d7e/mcts__agent_8py_source.html#l00029">open_spiel.python.algorithms.mcts_agent.MCTSAgent.__init__()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00062">open_spiel.python.algorithms.nfsp.NFSP.__init__()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d3/df2/random__agent_8py_source.html#l00024">open_spiel.python.algorithms.random_agent.RandomAgent.__init__()</a>, <a class="el" href="../../d8/d79/tabular__multiagent__qlearner_8py_source.html#l00173">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner.__init__()</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00043">open_spiel.python.algorithms.tabular_qlearner.QLearner.__init__()</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00069">open_spiel.python.algorithms.wolf_phc.WoLFPHC.__init__()</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00196">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.__init__()</a>, <a class="el" href="../../d0/dd5/rl__response_8py_source.html#l00134">open_spiel.python.examples.rl_response.FirstActionAgent.__init__()</a>, <a class="el" href="../../da/db6/roshambo__population__example_8py_source.html#l00055">open_spiel.python.examples.roshambo_population_example.BotAgent.__init__()</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00106">open_spiel.python.games.chat_games.chat_game_base.ChatGameState.__init__()</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00138">open_spiel.python.jax.deep_cfr.DeepCFRSolver.__init__()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00060">open_spiel.python.jax.dqn.DQN.__init__()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00063">open_spiel.python.jax.nfsp.NFSP.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00203">open_spiel.python.jax.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00070">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy.__init__()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00087">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.__init__()</a>, <a class="el" href="../../dd/d6d/normal__form__game_8py_source.html#l00141">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState.__init__()</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00221">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver.__init__()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00133">open_spiel.python.pytorch.dqn.DQN.__init__()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00100">open_spiel.python.pytorch.eva.EVAAgent.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00145">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._act()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00226">open_spiel.python.algorithms.nfsp.NFSP._add_transition()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00233">open_spiel.python.jax.nfsp.NFSP._add_transition()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../db/d67/average__network__fictitious__play_8py_source.html#l00197">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._add_transition()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00209">open_spiel.python.algorithms.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00194">open_spiel.python.pytorch.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="../../dd/d6d/normal__form__game_8py_source.html#l00180">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._apply_action()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00414">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._create_memories()</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00315">open_spiel.python.jax.deep_cfr.DeepCFRSolver._create_memories()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00269">open_spiel.python.algorithms.dqn.DQN._epsilon_greedy()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00368">open_spiel.python.algorithms.eva.EVAAgent._epsilon_greedy()</a>, <a class="el" href="../../d8/d79/tabular__multiagent__qlearner_8py_source.html#l00210">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._epsilon_greedy()</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00056">open_spiel.python.algorithms.tabular_qlearner.QLearner._epsilon_greedy()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00233">open_spiel.python.jax.dqn.DQN._epsilon_greedy()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00266">open_spiel.python.pytorch.dqn.DQN._epsilon_greedy()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00342">open_spiel.python.pytorch.eva.EVAAgent._epsilon_greedy()</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00130">open_spiel.python.algorithms.wolf_phc.WoLFPHC._get_action_probs()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00261">open_spiel.python.jax.dqn.DQN._get_epsilon()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00600">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._get_matched_regrets()</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00236">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._legal_actions()</a>, <a class="el" href="../../dd/d6d/normal__form__game_8py_source.html#l00166">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._legal_actions()</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00830">open_spiel.python.games.chat_games.chat_game_base.BaseChatGame._load_chat_game()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00391">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._reinitialize_advantage_network()</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00294">open_spiel.python.jax.deep_cfr.DeepCFRSolver._reinitialize_advantage_network()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00381">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._reinitialize_policy_network()</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00286">open_spiel.python.jax.deep_cfr.DeepCFRSolver._reinitialize_policy_network()</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00336">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._sample_action_from_advantage()</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00393">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._sample_action_from_advantage()</a>, <a class="el" href="../../dd/dc3/boltzmann__tabular__qlearner_8py_source.html#l00054">open_spiel.python.algorithms.boltzmann_tabular_qlearner.BoltzmannQLearner._softmax()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00342">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._to_one_hot()</a>, <a class="el" href="../../d3/dc4/algorithms_2deep__cfr_8py_source.html#l00282">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="../../d9/d36/algorithms_2deep__cfr__tf2_8py_source.html#l00552">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="../../d0/d69/jax_2deep__cfr_8py_source.html#l00416">open_spiel.python.jax.deep_cfr.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="../../d7/d95/pytorch_2deep__cfr_8py_source.html#l00338">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00153">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._unravel_flat_action()</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00255">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot._update_for_state()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00405">open_spiel.python.algorithms.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00378">open_spiel.python.pytorch.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00167">open_spiel.python.environments.catch.Environment.action_spec()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00223">open_spiel.python.algorithms.dqn.DQN.add_transition()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00208">open_spiel.python.jax.dqn.DQN.add_transition()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00241">open_spiel.python.pytorch.dqn.DQN.add_transition()</a>, <a class="el" href="../../dd/d6d/normal__form__game_8py_source.html#l00204">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState.distribution_support()</a>, <a class="el" href="../../df/d6c/chat__game__base_8py_source.html#l00537">open_spiel.python.games.chat_games.chat_game_base.ChatGameState.names()</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00153">open_spiel.python.environments.catch.Environment.observation_spec()</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00225">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.restart()</a>, <a class="el" href="../../d9/d7e/mcts__agent_8py_source.html#l00035">open_spiel.python.algorithms.mcts_agent.MCTSAgent.step()</a>, <a class="el" href="../../d3/df2/random__agent_8py_source.html#l00029">open_spiel.python.algorithms.random_agent.RandomAgent.step()</a>, <a class="el" href="../../d6/d15/bluechip__bridge_8py_source.html#l00323">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.step()</a>, <a class="el" href="../../d0/dd5/rl__response_8py_source.html#l00139">open_spiel.python.examples.rl_response.FirstActionAgent.step()</a>, <a class="el" href="../../da/db6/roshambo__population__example_8py_source.html#l00063">open_spiel.python.examples.roshambo_population_example.BotAgent.step()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00138">open_spiel.python.algorithms.nfsp.NFSP.temp_mode_as()</a>, and <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00148">open_spiel.python.jax.nfsp.NFSP.temp_mode_as()</a>.</p>

</div>
</div>
<a id="a5100ba4834fa702cd43d6f0a564ef540" name="a5100ba4834fa702cd43d6f0a564ef540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5100ba4834fa702cd43d6f0a564ef540">&#9670;&#160;</a></span>_num_learn_steps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_learn_steps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00649">649</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00203">open_spiel.python.jax.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, and <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="abea4e95324109926c7e76c4d01dfd89b" name="abea4e95324109926c7e76c4d01dfd89b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea4e95324109926c7e76c4d01dfd89b">&#9670;&#160;</a></span>_num_mini_batches</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_mini_batches</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00637">637</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>.</p>

</div>
</div>
<a id="afc9e9588e36469286f584a8e913603be" name="afc9e9588e36469286f584a8e913603be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9e9588e36469286f584a8e913603be">&#9670;&#160;</a></span>_num_opponent_updates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_opponent_updates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00636">636</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>.</p>

</div>
</div>
<a id="abe09591c36f5e4d95fffab133c3493e8" name="abe09591c36f5e4d95fffab133c3493e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe09591c36f5e4d95fffab133c3493e8">&#9670;&#160;</a></span>_opponent_ids</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_ids</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00643">643</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>

</div>
</div>
<a id="ae849a5f35bfd8919d9c22ea227e71d90" name="ae849a5f35bfd8919d9c22ea227e71d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae849a5f35bfd8919d9c22ea227e71d90">&#9670;&#160;</a></span>_opponent_opt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_opt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00654">654</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>

</div>
</div>
<a id="aedb5ce2288d5efa955664b2994299bbb" name="aedb5ce2288d5efa955664b2994299bbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb5ce2288d5efa955664b2994299bbb">&#9670;&#160;</a></span>_pi_network</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00651">651</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>

</div>
</div>
<a id="a1f3b10ed7573f44067bb1587355a5cc3" name="a1f3b10ed7573f44067bb1587355a5cc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f3b10ed7573f44067bb1587355a5cc3">&#9670;&#160;</a></span>_policy_opt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_opt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00655">655</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>

</div>
</div>
<a id="a909f3ed0316016ed57f3d506abda897b" name="a909f3ed0316016ed57f3d506abda897b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909f3ed0316016ed57f3d506abda897b">&#9670;&#160;</a></span>_policy_update_fns</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_fns</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00699">699</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>.</p>

</div>
</div>
<a id="a7ab713e153ecfb4625819c6eb0dd5dff" name="a7ab713e153ecfb4625819c6eb0dd5dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ab713e153ecfb4625819c6eb0dd5dff">&#9670;&#160;</a></span>_policy_update_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_interval</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00634">634</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>

</div>
</div>
<a id="aafc3816de74383fdc79ce7c837f76ec4" name="aafc3816de74383fdc79ce7c837f76ec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc3816de74383fdc79ce7c837f76ec4">&#9670;&#160;</a></span>_prev_action</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_action</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00639">639</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00061">open_spiel.python.algorithms.dqn.DQN.__init__()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00062">open_spiel.python.algorithms.nfsp.NFSP.__init__()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00060">open_spiel.python.jax.dqn.DQN.__init__()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00063">open_spiel.python.jax.nfsp.NFSP.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00203">open_spiel.python.jax.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00087">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.__init__()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00133">open_spiel.python.pytorch.dqn.DQN.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00310">open_spiel.python.jax.dqn.DQN.learn()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00301">open_spiel.python.pytorch.dqn.DQN.learn()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00371">open_spiel.python.algorithms.dqn.DQN.restore()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d8/d92/tabular__qlearner_8py_source.html#l00095">open_spiel.python.algorithms.tabular_qlearner.QLearner.step()</a>, <a class="el" href="../../d4/d63/wolf__phc_8py_source.html#l00155">open_spiel.python.algorithms.wolf_phc.WoLFPHC.step()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, and <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="a40e6cfee7a8d78903c3b501bf1ec57b2" name="a40e6cfee7a8d78903c3b501bf1ec57b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40e6cfee7a8d78903c3b501bf1ec57b2">&#9670;&#160;</a></span>_prev_time_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_time_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00638">638</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00203">open_spiel.python.jax.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00087">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, and <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="a80daf71b7e3956716945f59d15d255e6" name="a80daf71b7e3956716945f59d15d255e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80daf71b7e3956716945f59d15d255e6">&#9670;&#160;</a></span>_rng</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._rng</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00644">644</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d06/rl__environment_8py_source.html#l00128">open_spiel.python.rl_environment.ChanceEventSampler.__call__()</a>, <a class="el" href="../../dc/d9c/bots_2policy_8py_source.html#l00028">open_spiel.python.bots.policy.PolicyBot.__init__()</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00023">open_spiel.python.bots.uniform_random.UniformRandomBot.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00339">meta_learning.MetaCFRRegretAgent.next_policy()</a>, <a class="el" href="../../dc/d9b/catch_8py_source.html#l00048">open_spiel.python.environments.catch.Environment.reset()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, <a class="el" href="../../d6/d4c/uniform__random_8py_source.html#l00045">open_spiel.python.bots.uniform_random.UniformRandomBot.step_with_policy()</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00390">meta_learning.MetaCFRRegretAgent.training_optimizer()</a>, and <a class="el" href="../../d2/dd3/rnn__meta__selfplay__agent_8py_source.html#l00167">rnn_meta_selfplay_agent.MetaSelfplayAgent.training_optimizer()</a>.</p>

</div>
</div>
<a id="ad3d167ad340899d19d5308109aa38fed" name="ad3d167ad340899d19d5308109aa38fed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3d167ad340899d19d5308109aa38fed">&#9670;&#160;</a></span>_step_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._step_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00647">647</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00061">open_spiel.python.algorithms.dqn.DQN.__init__()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00062">open_spiel.python.algorithms.nfsp.NFSP.__init__()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00060">open_spiel.python.jax.dqn.DQN.__init__()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00063">open_spiel.python.jax.nfsp.NFSP.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00203">open_spiel.python.jax.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00087">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.__init__()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00133">open_spiel.python.pytorch.dqn.DQN.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00295">open_spiel.python.algorithms.dqn.DQN._get_epsilon()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00261">open_spiel.python.jax.dqn.DQN._get_epsilon()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00404">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._get_epsilon()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00291">open_spiel.python.pytorch.dqn.DQN._get_epsilon()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00310">open_spiel.python.jax.dqn.DQN.learn()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00301">open_spiel.python.pytorch.dqn.DQN.learn()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00371">open_spiel.python.algorithms.dqn.DQN.restore()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>, and <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00138">open_spiel.python.algorithms.nfsp.NFSP.temp_mode_as()</a>.</p>

</div>
</div>
<a id="a186d814ce717dbdd39519cfda01fd58b" name="a186d814ce717dbdd39519cfda01fd58b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a186d814ce717dbdd39519cfda01fd58b">&#9670;&#160;</a></span>_train_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00661">661</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00743">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.update_params()</a>.</p>

</div>
</div>
<a id="a6c378bf799aa6ace4e2b54e4edf1f4bb" name="a6c378bf799aa6ace4e2b54e4edf1f4bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c378bf799aa6ace4e2b54e4edf1f4bb">&#9670;&#160;</a></span>player_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00631">631</a> of file <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00061">open_spiel.python.algorithms.dqn.DQN.__init__()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00106">open_spiel.python.algorithms.eva.EVAAgent.__init__()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00062">open_spiel.python.algorithms.nfsp.NFSP.__init__()</a>, <a class="el" href="../../d6/d97/noisy__policy_8py_source.html#l00039">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.__init__()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00113">open_spiel.python.algorithms.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00060">open_spiel.python.jax.dqn.DQN.__init__()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00063">open_spiel.python.jax.nfsp.NFSP.__init__()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00630">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00203">open_spiel.python.jax.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00087">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.__init__()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00133">open_spiel.python.pytorch.dqn.DQN.__init__()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00100">open_spiel.python.pytorch.eva.EVAAgent.__init__()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00138">open_spiel.python.pytorch.policy_gradient.PolicyGradient.__init__()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00226">open_spiel.python.algorithms.nfsp.NFSP._add_transition()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00233">open_spiel.python.jax.nfsp.NFSP._add_transition()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00209">open_spiel.python.algorithms.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00194">open_spiel.python.pytorch.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00244">open_spiel.python.algorithms.nfsp.NFSP._learn()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00266">open_spiel.python.jax.nfsp.NFSP._learn()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00405">open_spiel.python.algorithms.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="../../d6/d97/noisy__policy_8py_source.html#l00112">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.action_probabilities()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00378">open_spiel.python.pytorch.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00223">open_spiel.python.algorithms.dqn.DQN.add_transition()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00208">open_spiel.python.jax.dqn.DQN.add_transition()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00247">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.add_transition()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00241">open_spiel.python.pytorch.dqn.DQN.add_transition()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00305">open_spiel.python.algorithms.dqn.DQN.learn()</a>, <a class="el" href="../../d4/ddf/algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="../../dc/de1/algorithms_2eva_8py_source.html#l00236">open_spiel.python.algorithms.eva.EVAAgent.step()</a>, <a class="el" href="../../d3/d8e/algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="../../de/d2e/algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d1/d9b/bluechip__bridge__uncontested__bidding_8py_source.html#l00219">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.step()</a>, <a class="el" href="../../d4/dc6/jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="../../d0/dfd/jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, <a class="el" href="../../d8/ddd/jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="../../d6/de5/munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="../../d0/d8f/pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, <a class="el" href="../../de/d05/pytorch_2eva_8py_source.html#l00220">open_spiel.python.pytorch.eva.EVAAgent.step()</a>, <a class="el" href="../../db/d99/pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>, and <a class="el" href="../../dd/d07/opponent__shaping_8py_source.html#l00743">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.update_params()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>open_spiel/python/jax/<a class="el" href="../../dd/d07/opponent__shaping_8py_source.html">opponent_shaping.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
