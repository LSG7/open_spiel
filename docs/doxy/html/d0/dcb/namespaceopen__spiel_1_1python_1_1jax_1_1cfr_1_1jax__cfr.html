<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.jax.cfr.jax_cfr Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../df/dc9/namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="../../d9/d47/namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><b>jax</b></li><li class="navelem"><b>cfr</b></li><li class="navelem"><a class="el" href="../../d0/dcb/namespaceopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr.html">jax_cfr</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.jax.cfr.jax_cfr Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dd5/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html">JaxCFR</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d50/classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r_constants.html">JaxCFRConstants</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae6628d637e8e2a5fe15dd767be1a8d47" id="r_ae6628d637e8e2a5fe15dd767be1a8d47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6628d637e8e2a5fe15dd767be1a8d47">regret_matching</a> (regret, mask)</td></tr>
<tr class="separator:ae6628d637e8e2a5fe15dd767be1a8d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca49c9c7fef2bf4a9f63ab5f0655ee52" id="r_aca49c9c7fef2bf4a9f63ab5f0655ee52"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca49c9c7fef2bf4a9f63ab5f0655ee52">update_regrets_plus</a> (regret)</td></tr>
<tr class="separator:aca49c9c7fef2bf4a9f63ab5f0655ee52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a0f37bfabfca8296b4522641a6325b" id="r_ac5a0f37bfabfca8296b4522641a6325b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5a0f37bfabfca8296b4522641a6325b">update_regrets</a> (regret)</td></tr>
<tr class="separator:ac5a0f37bfabfca8296b4522641a6325b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a70f7844403d0807c086ab183f2d77de8" id="r_a70f7844403d0807c086ab183f2d77de8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70f7844403d0807c086ab183f2d77de8">JAX_CFR_SIMULTANEOUS_UPDATE</a> = -5</td></tr>
<tr class="separator:a70f7844403d0807c086ab183f2d77de8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">JAX implementation of the counterfactual regret minimization algorithm usable with GPU acceleration.

Uses same CFR setting as open_spiel.python.algorithms.cfr._CFRSolverBase and the
usability should be interchangable.

The results may slightly differ between these 2 versions due to rounding errors
when computing regrets (rounding regrets smaller than epsilon to zero results in
exactly the same results)

The algorithm performs well in short but wide games, with small amount of
illegal actions and poorly in long games with a lot of illegal actions.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ae6628d637e8e2a5fe15dd767be1a8d47" name="ae6628d637e8e2a5fe15dd767be1a8d47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6628d637e8e2a5fe15dd767be1a8d47">&#9670;&#160;</a></span>regret_matching()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.regret_matching </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>regret</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mask</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes current policy based on current regrets.

Args:
  regret: Current regrets in array Fkiat[Isets, Actions]
  mask: Legal action mask Bool[Isets, Actions]

Returns:
  policy: the policy.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d71/jax__cfr_8py_source.html#l00044">44</a> of file <a class="el" href="../../da/d71/jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   44</span><span class="keyword">def </span>regret_matching(regret, mask):</div>
<div class="line"><span class="lineno">   45</span>  <span class="stringliteral">&quot;&quot;&quot;Computes current policy based on current regrets.</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">    regret: Current regrets in array Fkiat[Isets, Actions]</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">    mask: Legal action mask Bool[Isets, Actions]</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    policy: the policy.</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   54</span>  regret = jnp.maximum(regret, 0) * mask</div>
<div class="line"><span class="lineno">   55</span>  total = jnp.sum(regret, axis=-1, keepdims=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">return</span> jnp.where(total &gt; 0.0, regret / total, 1.0 / jnp.sum(mask)) * mask</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5a0f37bfabfca8296b4522641a6325b" name="ac5a0f37bfabfca8296b4522641a6325b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5a0f37bfabfca8296b4522641a6325b">&#9670;&#160;</a></span>update_regrets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.update_regrets </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>regret</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Updates the regrets without CFRPlus.</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d71/jax__cfr_8py_source.html#l00065">65</a> of file <a class="el" href="../../da/d71/jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span><span class="keyword">def </span>update_regrets(regret):</div>
<div class="line"><span class="lineno">   66</span>  <span class="stringliteral">&quot;&quot;&quot;Updates the regrets without CFRPlus.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordflow">return</span> regret</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span><span class="preprocessor">@chex.dataclass(frozen=True)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca49c9c7fef2bf4a9f63ab5f0655ee52" name="aca49c9c7fef2bf4a9f63ab5f0655ee52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca49c9c7fef2bf4a9f63ab5f0655ee52">&#9670;&#160;</a></span>update_regrets_plus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.cfr.jax_cfr.update_regrets_plus </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>regret</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Clamps the regrets to be non-negative.</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d71/jax__cfr_8py_source.html#l00060">60</a> of file <a class="el" href="../../da/d71/jax__cfr_8py_source.html">jax_cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span><span class="keyword">def </span>update_regrets_plus(regret):</div>
<div class="line"><span class="lineno">   61</span>  <span class="stringliteral">&quot;&quot;&quot;Clamps the regrets to be non-negative.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">return</span> regret * (regret &gt; 0)</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a70f7844403d0807c086ab183f2d77de8" name="a70f7844403d0807c086ab183f2d77de8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70f7844403d0807c086ab183f2d77de8">&#9670;&#160;</a></span>JAX_CFR_SIMULTANEOUS_UPDATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int open_spiel.python.jax.cfr.jax_cfr.JAX_CFR_SIMULTANEOUS_UPDATE = -5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d71/jax__cfr_8py_source.html#l00041">41</a> of file <a class="el" href="../../da/d71/jax__cfr_8py_source.html">jax_cfr.py</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
