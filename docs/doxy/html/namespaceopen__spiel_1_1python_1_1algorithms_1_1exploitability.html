<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.algorithms.exploitability Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms.html">algorithms</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability.html">exploitability</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.algorithms.exploitability Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1ccd4bacf60dc008b1791d771cbef974" id="r_a1ccd4bacf60dc008b1791d771cbef974"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ccd4bacf60dc008b1791d771cbef974">_state_values</a> (<a class="el" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>, num_players, policy)</td></tr>
<tr class="separator:a1ccd4bacf60dc008b1791d771cbef974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e3033c78db3ac943c01e59111a04556" id="r_a0e3033c78db3ac943c01e59111a04556"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e3033c78db3ac943c01e59111a04556">best_response</a> (game, policy, player_id)</td></tr>
<tr class="separator:a0e3033c78db3ac943c01e59111a04556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e6b3059a4f29f15eb76ad0b775a0bf" id="r_a08e6b3059a4f29f15eb76ad0b775a0bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08e6b3059a4f29f15eb76ad0b775a0bf">exploitability</a> (game, policy)</td></tr>
<tr class="separator:a08e6b3059a4f29f15eb76ad0b775a0bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fa48a10e90706ad2faefc9ecc08c587" id="r_a0fa48a10e90706ad2faefc9ecc08c587"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fa48a10e90706ad2faefc9ecc08c587">nash_conv</a> (game, policy, return_only_nash_conv=True, use_cpp_br=False)</td></tr>
<tr class="separator:a0fa48a10e90706ad2faefc9ecc08c587"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a83a5bdd334f73609a402d6c6e50df03a" id="r_a83a5bdd334f73609a402d6c6e50df03a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83a5bdd334f73609a402d6c6e50df03a">_NashConvReturn</a></td></tr>
<tr class="separator:a83a5bdd334f73609a402d6c6e50df03a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Compute the exploitability of a bot / strategy in a 2p sequential game.

This computes the value that a policy achieves against a worst-case opponent.
The policy applies to both player 1 and player 2, and hence we have a 2-player
symmetric zero-sum game, so the game value is zero for both players, and hence
value-vs-best-response is equal to exploitability.

We construct information sets, each consisting of a list of (state, probability)
pairs where probability is a counterfactual reach probability, i.e. the
probability that the state would be reached if the best responder (the current
player) played to reach it. This is the product of the probabilities of the
necessary chance events and opponent action choices required to reach the node.

These probabilities give us the correct weighting for possible states of the
world when considering our best response for a particular information set.

The values we calculate are values of being in the specific state. Unlike in a
CFR algorithm, they are not weighted by reach probabilities. These values
take into account the whole state, so they may depend on information which is
unknown to the best-responding player.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a1ccd4bacf60dc008b1791d771cbef974" name="a1ccd4bacf60dc008b1791d771cbef974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ccd4bacf60dc008b1791d771cbef974">&#9670;&#160;</a></span>_state_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.exploitability._state_values </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_players</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Value of a state for every player given a policy.</pre> 
<p class="definition">Definition at line <a class="el" href="exploitability_8py_source.html#l00046">46</a> of file <a class="el" href="exploitability_8py_source.html">exploitability.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span><span class="keyword">def </span>_state_values(state, num_players, policy):</div>
<div class="line"><span class="lineno">   47</span>  <span class="stringliteral">&quot;&quot;&quot;Value of a state for every player given a policy.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordflow">if</span> state.is_terminal():</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">return</span> np.array(state.returns())</div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">if</span> state.is_simultaneous_node():</div>
<div class="line"><span class="lineno">   52</span>      p_action = tuple(policy_lib.joint_action_probabilities(state, policy))</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   55</span>      p_action = (</div>
<div class="line"><span class="lineno">   56</span>          state.chance_outcomes()</div>
<div class="line"><span class="lineno">   57</span>          <span class="keywordflow">if</span> state.is_chance_node()</div>
<div class="line"><span class="lineno">   58</span>          <span class="keywordflow">else</span> policy.action_probabilities(state).items()</div>
<div class="line"><span class="lineno">   59</span>      )</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">return</span> sum(</div>
<div class="line"><span class="lineno">   61</span>        prob</div>
<div class="line"><span class="lineno">   62</span>        * _state_values(policy_lib.child(state, action), num_players, policy)</div>
<div class="line"><span class="lineno">   63</span>        <span class="keywordflow">for</span> action, prob <span class="keywordflow">in</span> p_action</div>
<div class="line"><span class="lineno">   64</span>    )</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="exploitability_8py_source.html#l00046">open_spiel.python.algorithms.exploitability._state_values()</a>.</p>

<p class="reference">Referenced by <a class="el" href="exploitability_8py_source.html#l00046">open_spiel.python.algorithms.exploitability._state_values()</a>, <a class="el" href="exploitability_8py_source.html#l00067">open_spiel.python.algorithms.exploitability.best_response()</a>, and <a class="el" href="exploitability_8py_source.html#l00164">open_spiel.python.algorithms.exploitability.nash_conv()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_cgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,274,70"/>
<area shape="poly" title=" " alt="" coords="89,29,87,19,95,10,113,5,140,3,168,5,185,11,184,16,167,10,139,8,114,10,98,15,92,21,95,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_icgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a1ccd4bacf60dc008b1791d771cbef974_icgraph">
<area shape="rect" title=" " alt="" coords="385,35,653,75"/>
<area shape="poly" title=" " alt="" coords="576,22,555,16,519,13,485,15,464,20,457,26,460,33,455,35,451,25,462,15,484,10,519,8,556,10,578,16"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability.html#a0e3033c78db3ac943c01e59111a04556" title=" " alt="" coords="24,5,318,46"/>
<area shape="poly" title=" " alt="" coords="369,45,318,41,318,35,369,40"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability.html#a0fa48a10e90706ad2faefc9ecc08c587" title=" " alt="" coords="5,70,337,96"/>
<area shape="poly" title=" " alt="" coords="369,70,337,72,337,67,369,64"/>
</map>
</div>

</div>
</div>
<a id="a0e3033c78db3ac943c01e59111a04556" name="a0e3033c78db3ac943c01e59111a04556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e3033c78db3ac943c01e59111a04556">&#9670;&#160;</a></span>best_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.exploitability.best_response </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns information about the specified player's best response.

Given a game and a policy for every player, computes for a single player their
best unilateral strategy. Returns the value improvement that player would
get, the action they should take in each information state, and the value
of each state when following their unilateral policy.

Args:
  game: An open_spiel game, e.g. kuhn_poker
  policy: A `policy.Policy` object. This policy should depend only on the
    information state available to the current player, but this is not
    enforced.
  player_id: The integer id of a player in the game for whom the best response
    will be computed.

Returns:
  A dictionary of values, with keys:
    best_response_action: The best unilateral strategy for `player_id` as a
      map from infostatekey to action_id.
    best_response_state_value: The value obtained for `player_id` when
      unilaterally switching strategy, for each state.
    best_response_value: The value obtained for `player_id` when unilaterally
      switching strategy.
    info_sets: A dict of info sets, mapping info state key to a list of
      `(state, counterfactual_reach_prob)` pairs.
    nash_conv: `best_response_value - on_policy_value`
    on_policy_value: The value for `player_id` when all players follow the
      policy
    on_policy_values: The value for each player when all players follow the
      policy
</pre> 
<p class="definition">Definition at line <a class="el" href="exploitability_8py_source.html#l00067">67</a> of file <a class="el" href="exploitability_8py_source.html">exploitability.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span><span class="keyword">def </span>best_response(game, policy, player_id):</div>
<div class="line"><span class="lineno">   68</span>  <span class="stringliteral">&quot;&quot;&quot;Returns information about the specified player&#39;s best response.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">  Given a game and a policy for every player, computes for a single player their</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">  best unilateral strategy. Returns the value improvement that player would</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">  get, the action they should take in each information state, and the value</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">  of each state when following their unilateral policy.</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">    game: An open_spiel game, e.g. kuhn_poker</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    policy: A `policy.Policy` object. This policy should depend only on the</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">      information state available to the current player, but this is not</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">      enforced.</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    player_id: The integer id of a player in the game for whom the best response</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">      will be computed.</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    A dictionary of values, with keys:</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">      best_response_action: The best unilateral strategy for `player_id` as a</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        map from infostatekey to action_id.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">      best_response_state_value: The value obtained for `player_id` when</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        unilaterally switching strategy, for each state.</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">      best_response_value: The value obtained for `player_id` when unilaterally</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">        switching strategy.</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">      info_sets: A dict of info sets, mapping info state key to a list of</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">        `(state, counterfactual_reach_prob)` pairs.</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">      nash_conv: `best_response_value - on_policy_value`</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">      on_policy_value: The value for `player_id` when all players follow the</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">        policy</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">      on_policy_values: The value for each player when all players follow the</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">        policy</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   99</span>  root_state = game.new_initial_state()</div>
<div class="line"><span class="lineno">  100</span>  br = pyspiel_best_response.BestResponsePolicy(game, player_id, policy,</div>
<div class="line"><span class="lineno">  101</span>                                                root_state)</div>
<div class="line"><span class="lineno">  102</span>  on_policy_values = _state_values(root_state, game.num_players(), policy)</div>
<div class="line"><span class="lineno">  103</span>  best_response_value = br.value(root_state)</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  <span class="comment"># Get best response action for unvisited states</span></div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordflow">for</span> infostate <span class="keywordflow">in</span> set(br.infosets) - set(br.cache_best_response_action):</div>
<div class="line"><span class="lineno">  107</span>    br.best_response_action(infostate)</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <span class="keywordflow">return</span> {</div>
<div class="line"><span class="lineno">  110</span>      <span class="stringliteral">&quot;best_response_action&quot;</span>: br.cache_best_response_action,</div>
<div class="line"><span class="lineno">  111</span>      <span class="stringliteral">&quot;best_response_state_value&quot;</span>: br.cache_value,</div>
<div class="line"><span class="lineno">  112</span>      <span class="stringliteral">&quot;best_response_value&quot;</span>: best_response_value,</div>
<div class="line"><span class="lineno">  113</span>      <span class="stringliteral">&quot;info_sets&quot;</span>: br.infosets,</div>
<div class="line"><span class="lineno">  114</span>      <span class="stringliteral">&quot;nash_conv&quot;</span>: best_response_value - on_policy_values[player_id],</div>
<div class="line"><span class="lineno">  115</span>      <span class="stringliteral">&quot;on_policy_value&quot;</span>: on_policy_values[player_id],</div>
<div class="line"><span class="lineno">  116</span>      <span class="stringliteral">&quot;on_policy_values&quot;</span>: on_policy_values,</div>
<div class="line"><span class="lineno">  117</span>  }</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="exploitability_8py_source.html#l00046">open_spiel.python.algorithms.exploitability._state_values()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0e3033c78db3ac943c01e59111a04556_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0e3033c78db3ac943c01e59111a04556_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0e3033c78db3ac943c01e59111a04556_cgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0e3033c78db3ac943c01e59111a04556_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,299,70"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability.html#a1ccd4bacf60dc008b1791d771cbef974" title=" " alt="" coords="347,29,615,70"/>
<area shape="poly" title=" " alt="" coords="299,47,331,47,331,52,299,52"/>
<area shape="poly" title=" " alt="" coords="420,30,417,19,427,10,448,5,481,3,516,5,537,11,535,16,515,10,481,8,449,10,429,15,422,21,425,28"/>
</map>
</div>

</div>
</div>
<a id="a08e6b3059a4f29f15eb76ad0b775a0bf" name="a08e6b3059a4f29f15eb76ad0b775a0bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08e6b3059a4f29f15eb76ad0b775a0bf">&#9670;&#160;</a></span>exploitability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.exploitability.exploitability </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the exploitability of the policy in the game.

This is implemented only for 2 players constant-sum games, and is equivalent
to NashConv / num_players in that case. Prefer using `nash_conv`.

Args:
  game: An open_spiel game, e.g. kuhn_poker
  policy: A `policy.Policy` object. This policy should depend only on the
    information state available to the current player, but this is not
    enforced.

Returns:
  The value that this policy achieves when playing against the worst-case
  non-cheating opponent, averaged across both starting positions. It has a
  minimum of zero (assuming the supplied policy is non-cheating) and
  this bound is achievable in a 2p game.

Raises:
  ValueError if the game is not a two-player constant-sum turn-based game.
</pre> 
<p class="definition">Definition at line <a class="el" href="exploitability_8py_source.html#l00120">120</a> of file <a class="el" href="exploitability_8py_source.html">exploitability.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  120</span><span class="keyword">def </span>exploitability(game, policy):</div>
<div class="line"><span class="lineno">  121</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the exploitability of the policy in the game.</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">  This is implemented only for 2 players constant-sum games, and is equivalent</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">  to NashConv / num_players in that case. Prefer using `nash_conv`.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    game: An open_spiel game, e.g. kuhn_poker</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    policy: A `policy.Policy` object. This policy should depend only on the</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">      information state available to the current player, but this is not</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">      enforced.</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    The value that this policy achieves when playing against the worst-case</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    non-cheating opponent, averaged across both starting positions. It has a</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    minimum of zero (assuming the supplied policy is non-cheating) and</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    this bound is achievable in a 2p game.</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">  Raises:</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    ValueError if the game is not a two-player constant-sum turn-based game.</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  141</span>  <span class="keywordflow">if</span> game.num_players() != 2:</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Game must be a 2-player game&quot;</span>)</div>
<div class="line"><span class="lineno">  143</span>  game_info = game.get_type()</div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">if</span> game_info.dynamics != pyspiel.GameType.Dynamics.SEQUENTIAL:</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The game must be turn-based, not {}&quot;</span>.format(</div>
<div class="line"><span class="lineno">  146</span>        game_info.dynamics))</div>
<div class="line"><span class="lineno">  147</span>  <span class="keywordflow">if</span> game_info.utility <span class="keywordflow">not</span> <span class="keywordflow">in</span> (pyspiel.GameType.Utility.ZERO_SUM,</div>
<div class="line"><span class="lineno">  148</span>                               pyspiel.GameType.Utility.CONSTANT_SUM):</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;The game must be constant- or zero-sum, not {}&quot;</span>.format(</div>
<div class="line"><span class="lineno">  150</span>        game_info.utility))</div>
<div class="line"><span class="lineno">  151</span>  root_state = game.new_initial_state()</div>
<div class="line"><span class="lineno">  152</span>  nash_conv_value = (</div>
<div class="line"><span class="lineno">  153</span>      sum(</div>
<div class="line"><span class="lineno">  154</span>          pyspiel_best_response.CPPBestResponsePolicy(</div>
<div class="line"><span class="lineno">  155</span>              game, best_responder, policy).value(root_state)</div>
<div class="line"><span class="lineno">  156</span>          <span class="keywordflow">for</span> best_responder <span class="keywordflow">in</span> range(game.num_players())) - game.utility_sum())</div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">return</span> nash_conv_value / game.num_players()</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0fa48a10e90706ad2faefc9ecc08c587" name="a0fa48a10e90706ad2faefc9ecc08c587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fa48a10e90706ad2faefc9ecc08c587">&#9670;&#160;</a></span>nash_conv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.exploitability.nash_conv </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>return_only_nash_conv</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>use_cpp_br</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a measure of closeness to Nash for a policy in the game.

See https://arxiv.org/pdf/1711.00832.pdf for the NashConv definition.

Args:
  game: An open_spiel game, e.g. kuhn_poker
  policy: A `policy.Policy` object. This policy should depend only on the
    information state available to the current player, but this is not
    enforced.
  return_only_nash_conv: Whether to only return the NashConv value, or a
    namedtuple containing additional statistics. Prefer using `False`, as we
    hope to change the default to that value.
  use_cpp_br: if True, compute the best response in c++

Returns:
  Returns a object with the following attributes:
  - player_improvements: A `[num_players]` numpy array of the improvement
    for players (i.e. value_player_p_versus_BR - value_player_p).
  - nash_conv: The sum over all players of the improvements in value that each
    player could obtain by unilaterally changing their strategy, i.e.
    sum(player_improvements).
</pre> 
<p class="definition">Definition at line <a class="el" href="exploitability_8py_source.html#l00164">164</a> of file <a class="el" href="exploitability_8py_source.html">exploitability.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  164</span><span class="keyword">def </span>nash_conv(game, policy, return_only_nash_conv=True, use_cpp_br=False):</div>
<div class="line"><span class="lineno">  165</span>  <span class="stringliteral">r&quot;&quot;&quot;Returns a measure of closeness to Nash for a policy in the game.</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">  See https://arxiv.org/pdf/1711.00832.pdf for the NashConv definition.</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    game: An open_spiel game, e.g. kuhn_poker</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    policy: A `policy.Policy` object. This policy should depend only on the</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">      information state available to the current player, but this is not</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral">      enforced.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">    return_only_nash_conv: Whether to only return the NashConv value, or a</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">      namedtuple containing additional statistics. Prefer using `False`, as we</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">      hope to change the default to that value.</span></div>
<div class="line"><span class="lineno">  177</span><span class="stringliteral">    use_cpp_br: if True, compute the best response in c++</span></div>
<div class="line"><span class="lineno">  178</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  179</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  180</span><span class="stringliteral">    Returns a object with the following attributes:</span></div>
<div class="line"><span class="lineno">  181</span><span class="stringliteral">    - player_improvements: A `[num_players]` numpy array of the improvement</span></div>
<div class="line"><span class="lineno">  182</span><span class="stringliteral">      for players (i.e. value_player_p_versus_BR - value_player_p).</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral">    - nash_conv: The sum over all players of the improvements in value that each</span></div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">      player could obtain by unilaterally changing their strategy, i.e.</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">      sum(player_improvements).</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  187</span>  root_state = game.new_initial_state()</div>
<div class="line"><span class="lineno">  188</span>  <span class="keywordflow">if</span> use_cpp_br:</div>
<div class="line"><span class="lineno">  189</span>    best_response_values = np.array([</div>
<div class="line"><span class="lineno">  190</span>        pyspiel_best_response.CPPBestResponsePolicy(</div>
<div class="line"><span class="lineno">  191</span>            game, best_responder, policy).value(root_state)</div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordflow">for</span> best_responder <span class="keywordflow">in</span> range(game.num_players())</div>
<div class="line"><span class="lineno">  193</span>    ])</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  195</span>    best_response_values = np.array([</div>
<div class="line"><span class="lineno">  196</span>        pyspiel_best_response.BestResponsePolicy(</div>
<div class="line"><span class="lineno">  197</span>            game, best_responder, policy).value(root_state)</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">for</span> best_responder <span class="keywordflow">in</span> range(game.num_players())</div>
<div class="line"><span class="lineno">  199</span>    ])</div>
<div class="line"><span class="lineno">  200</span>  on_policy_values = _state_values(root_state, game.num_players(), policy)</div>
<div class="line"><span class="lineno">  201</span>  player_improvements = best_response_values - on_policy_values</div>
<div class="line"><span class="lineno">  202</span>  nash_conv_ = sum(player_improvements)</div>
<div class="line"><span class="lineno">  203</span>  <span class="keywordflow">if</span> return_only_nash_conv:</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">return</span> nash_conv_</div>
<div class="line"><span class="lineno">  205</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">return</span> _NashConvReturn(</div>
<div class="line"><span class="lineno">  207</span>        nash_conv=nash_conv_, player_improvements=player_improvements)</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="exploitability_8py_source.html#l00160">open_spiel.python.algorithms.exploitability._NashConvReturn</a>, and <a class="el" href="exploitability_8py_source.html#l00046">open_spiel.python.algorithms.exploitability._state_values()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0fa48a10e90706ad2faefc9ecc08c587_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0fa48a10e90706ad2faefc9ecc08c587_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0fa48a10e90706ad2faefc9ecc08c587_cgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability_a0fa48a10e90706ad2faefc9ecc08c587_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,337,62"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1exploitability.html#a1ccd4bacf60dc008b1791d771cbef974" title=" " alt="" coords="385,29,653,70"/>
<area shape="poly" title=" " alt="" coords="337,47,369,47,369,52,337,52"/>
<area shape="poly" title=" " alt="" coords="455,30,451,19,462,10,484,5,519,3,556,5,578,11,576,16,555,10,519,8,485,10,464,15,457,21,460,28"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a83a5bdd334f73609a402d6c6e50df03a" name="a83a5bdd334f73609a402d6c6e50df03a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a5bdd334f73609a402d6c6e50df03a">&#9670;&#160;</a></span>_NashConvReturn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.exploitability._NashConvReturn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  collections.namedtuple(<span class="stringliteral">&quot;_NashConvReturn&quot;</span>,</div>
<div class="line"><span class="lineno">    2</span>                                         [<span class="stringliteral">&quot;nash_conv&quot;</span>, <span class="stringliteral">&quot;player_improvements&quot;</span>])</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="exploitability_8py_source.html#l00160">160</a> of file <a class="el" href="exploitability_8py_source.html">exploitability.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="exploitability_8py_source.html#l00164">open_spiel.python.algorithms.exploitability.nash_conv()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
