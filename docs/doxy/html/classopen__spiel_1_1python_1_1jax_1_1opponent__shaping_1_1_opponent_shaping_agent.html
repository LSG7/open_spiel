<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.jax.opponent_shaping.OpponentShapingAgent Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1jax.html">jax</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1jax_1_1opponent__shaping.html">opponent_shaping</a></li><li class="navelem"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html">OpponentShapingAgent</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for open_spiel.python.jax.opponent_shaping.OpponentShapingAgent:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent__inherit__graph.png" border="0" usemap="#aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_inherit__map" alt="Inheritance graph"/></div>
<map name="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_inherit__map" id="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_inherit__map">
<area shape="rect" title=" " alt="" coords="5,267,211,941"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html" title=" " alt="" coords="39,119,177,219"/>
<area shape="poly" title=" " alt="" coords="111,234,111,267,105,267,105,234"/>
<area shape="rect" title=" " alt="" coords="18,5,91,71"/>
<area shape="poly" title=" " alt="" coords="76,83,90,118,85,120,71,85"/>
<area shape="rect" title=" " alt="" coords="115,5,210,71"/>
<area shape="poly" title=" " alt="" coords="146,85,131,120,126,118,141,83"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for open_spiel.python.jax.opponent_shaping.OpponentShapingAgent:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent__coll__graph.png" border="0" usemap="#aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_coll__map" alt="Collaboration graph"/></div>
<map name="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_coll__map" id="aopen__spiel_8python_8jax_8opponent__shaping_8_opponent_shaping_agent_coll__map">
<area shape="rect" title=" " alt="" coords="5,267,211,941"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html" title=" " alt="" coords="39,119,177,219"/>
<area shape="poly" title=" " alt="" coords="111,234,111,267,105,267,105,234"/>
<area shape="rect" title=" " alt="" coords="18,5,91,71"/>
<area shape="poly" title=" " alt="" coords="76,83,90,118,85,120,71,85"/>
<area shape="rect" title=" " alt="" coords="115,5,210,71"/>
<area shape="poly" title=" " alt="" coords="146,85,131,120,126,118,141,83"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a688a991bdc9042322d47fc183d7a7ab8" id="r_a688a991bdc9042322d47fc183d7a7ab8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a688a991bdc9042322d47fc183d7a7ab8">__init__</a> (self, int <a class="el" href="#a6c378bf799aa6ace4e2b54e4edf1f4bb">player_id</a>, typing.List[int] opponent_ids, chex.Shape info_state_size, int num_actions, hk.Transformed policy, hk.Transformed critic, int batch_size=16, typing.Union[float, optax.Schedule] critic_learning_rate=0.01, typing.Union[float, optax.Schedule] pi_learning_rate=0.001, typing.Union[float, optax.Schedule] opp_policy_learning_rate=0.001, typing.Union[float, optax.Schedule] opponent_model_learning_rate=0.001, float clip_grad_norm=0.5, int policy_update_interval=8, float discount=0.99, float critic_discount=0.99, jax.random.PRNGKey seed=42, fit_opponent_model=True, str correction_type='dice', bool use_jit=False, int n_lookaheads=1, int num_critic_mini_batches=1, int num_opponent_updates=1, typing.Optional[<a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html">rl_environment.Environment</a>] env=None)</td></tr>
<tr class="separator:a688a991bdc9042322d47fc183d7a7ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a9c683dd11b09e5667692bc1ab6891" id="r_a20a9c683dd11b09e5667692bc1ab6891"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20a9c683dd11b09e5667692bc1ab6891">train_state</a> (self)</td></tr>
<tr class="separator:a20a9c683dd11b09e5667692bc1ab6891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab261d55d230e37037218f8a91c7a22b7" id="r_ab261d55d230e37037218f8a91c7a22b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab261d55d230e37037218f8a91c7a22b7">policy_network</a> (self)</td></tr>
<tr class="separator:ab261d55d230e37037218f8a91c7a22b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad55be43954fb6c325544adca41430bbd" id="r_ad55be43954fb6c325544adca41430bbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad55be43954fb6c325544adca41430bbd">critic_network</a> (self)</td></tr>
<tr class="separator:ad55be43954fb6c325544adca41430bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43b971fdf9c6cec4de895b6ae366aac" id="r_ac43b971fdf9c6cec4de895b6ae366aac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac43b971fdf9c6cec4de895b6ae366aac">metrics</a> (self, bool return_last_only=True)</td></tr>
<tr class="separator:ac43b971fdf9c6cec4de895b6ae366aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fd78be8c0cd590a8c974be8e603d2d1" id="r_a3fd78be8c0cd590a8c974be8e603d2d1"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3fd78be8c0cd590a8c974be8e603d2d1">update_params</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_train_state.html">TrainState</a> <a class="el" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>, int <a class="el" href="#a6c378bf799aa6ace4e2b54e4edf1f4bb">player_id</a>)</td></tr>
<tr class="separator:a3fd78be8c0cd590a8c974be8e603d2d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad592a86c90ce19aa7b49b93823803fe6" id="r_ad592a86c90ce19aa7b49b93823803fe6"><td class="memItemLeft" align="right" valign="top">typing.Callable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad592a86c90ce19aa7b49b93823803fe6">get_value_fn</a> (self)</td></tr>
<tr class="separator:ad592a86c90ce19aa7b49b93823803fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d08a854b5449fc58a485a69e2604854" id="r_a7d08a854b5449fc58a485a69e2604854"><td class="memItemLeft" align="right" valign="top">typing.Callable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d08a854b5449fc58a485a69e2604854">get_policy</a> (self, return_probs=True)</td></tr>
<tr class="separator:a7d08a854b5449fc58a485a69e2604854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49083992dc97516ca2e134c672e2520e" id="r_a49083992dc97516ca2e134c672e2520e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49083992dc97516ca2e134c672e2520e">step</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a> time_step, is_evaluation=False)</td></tr>
<tr class="separator:a49083992dc97516ca2e134c672e2520e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6c378bf799aa6ace4e2b54e4edf1f4bb" id="r_a6c378bf799aa6ace4e2b54e4edf1f4bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c378bf799aa6ace4e2b54e4edf1f4bb">player_id</a></td></tr>
<tr class="separator:a6c378bf799aa6ace4e2b54e4edf1f4bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8d702ba311c2a6ec2dd9c8c29749de9f" id="r_a8d702ba311c2a6ec2dd9c8c29749de9f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d702ba311c2a6ec2dd9c8c29749de9f">_init_train_state</a> (self, chex.Shape info_state_size)</td></tr>
<tr class="separator:a8d702ba311c2a6ec2dd9c8c29749de9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92fdbbc16d1a44597453d7f3bd1c6278" id="r_a92fdbbc16d1a44597453d7f3bd1c6278"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92fdbbc16d1a44597453d7f3bd1c6278">_store_time_step</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a> time_step, np.ndarray <a class="el" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a>)</td></tr>
<tr class="separator:a92fdbbc16d1a44597453d7f3bd1c6278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0d78940728f70c85b0b8b2723ceb280" id="r_aa0d78940728f70c85b0b8b2723ceb280"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0d78940728f70c85b0b8b2723ceb280">_train_step</a> (self)</td></tr>
<tr class="separator:aa0d78940728f70c85b0b8b2723ceb280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c6e95fe51f4fcc38c46f857ff7a14fc" id="r_a4c6e95fe51f4fcc38c46f857ff7a14fc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c6e95fe51f4fcc38c46f857ff7a14fc">_should_update</a> (self)</td></tr>
<tr class="separator:a4c6e95fe51f4fcc38c46f857ff7a14fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b25c7de236284a0d59c11efddea26b1" id="r_a7b25c7de236284a0d59c11efddea26b1"><td class="memItemLeft" align="right" valign="top">typing.Dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b25c7de236284a0d59c11efddea26b1">_update_agent</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:a7b25c7de236284a0d59c11efddea26b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063f8a6cc351f7d3bcf74757fabb4669" id="r_a063f8a6cc351f7d3bcf74757fabb4669"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a063f8a6cc351f7d3bcf74757fabb4669">_construct_episode_batches</a> (self, typing.List[<a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a>] <a class="el" href="policy__iteration_8cc.html#ac4dd603044dd755d56bfe08fb7d15103">transitions</a>)</td></tr>
<tr class="separator:a063f8a6cc351f7d3bcf74757fabb4669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7744e2572fb3fa78b3ff0f99baa1a208" id="r_a7744e2572fb3fa78b3ff0f99baa1a208"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7744e2572fb3fa78b3ff0f99baa1a208">_update_policy</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:a7744e2572fb3fa78b3ff0f99baa1a208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a566493380f42cdfb19e24266739ff031" id="r_a566493380f42cdfb19e24266739ff031"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a566493380f42cdfb19e24266739ff031">_update_critic</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:a566493380f42cdfb19e24266739ff031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba558f18992f23fda573e138df49ac6" id="r_aaba558f18992f23fda573e138df49ac6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaba558f18992f23fda573e138df49ac6">_update_opponents</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> batch)</td></tr>
<tr class="separator:aaba558f18992f23fda573e138df49ac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a1a3592b3656e858e405ca6974d3db1" id="r_a6a1a3592b3656e858e405ca6974d3db1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a1a3592b3656e858e405ca6974d3db1">_make_transition</a> (self, <a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a> time_step)</td></tr>
<tr class="separator:a6a1a3592b3656e858e405ca6974d3db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a23a99f733cb36d9942b3566feef619c9" id="r_a23a99f733cb36d9942b3566feef619c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a23a99f733cb36d9942b3566feef619c9">_num_actions</a></td></tr>
<tr class="separator:a23a99f733cb36d9942b3566feef619c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d512f8db3cd6995a357d1b1a9a29fe9" id="r_a7d512f8db3cd6995a357d1b1a9a29fe9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d512f8db3cd6995a357d1b1a9a29fe9">_batch_size</a></td></tr>
<tr class="separator:a7d512f8db3cd6995a357d1b1a9a29fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab713e153ecfb4625819c6eb0dd5dff" id="r_a7ab713e153ecfb4625819c6eb0dd5dff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ab713e153ecfb4625819c6eb0dd5dff">_policy_update_interval</a></td></tr>
<tr class="separator:a7ab713e153ecfb4625819c6eb0dd5dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c10635825968de3e335fb21cb40487" id="r_a06c10635825968de3e335fb21cb40487"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06c10635825968de3e335fb21cb40487">_discount</a></td></tr>
<tr class="separator:a06c10635825968de3e335fb21cb40487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9e9588e36469286f584a8e913603be" id="r_afc9e9588e36469286f584a8e913603be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc9e9588e36469286f584a8e913603be">_num_opponent_updates</a></td></tr>
<tr class="separator:afc9e9588e36469286f584a8e913603be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea4e95324109926c7e76c4d01dfd89b" id="r_abea4e95324109926c7e76c4d01dfd89b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abea4e95324109926c7e76c4d01dfd89b">_num_mini_batches</a></td></tr>
<tr class="separator:abea4e95324109926c7e76c4d01dfd89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e6cfee7a8d78903c3b501bf1ec57b2" id="r_a40e6cfee7a8d78903c3b501bf1ec57b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40e6cfee7a8d78903c3b501bf1ec57b2">_prev_time_step</a></td></tr>
<tr class="separator:a40e6cfee7a8d78903c3b501bf1ec57b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc3816de74383fdc79ce7c837f76ec4" id="r_aafc3816de74383fdc79ce7c837f76ec4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aafc3816de74383fdc79ce7c837f76ec4">_prev_action</a></td></tr>
<tr class="separator:aafc3816de74383fdc79ce7c837f76ec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25f34ed6d72e2dc0b30dc1ed2941f76" id="r_aa25f34ed6d72e2dc0b30dc1ed2941f76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa25f34ed6d72e2dc0b30dc1ed2941f76">_data</a></td></tr>
<tr class="separator:aa25f34ed6d72e2dc0b30dc1ed2941f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8dcd4e6158402b9eb2e531c06b0b9a0" id="r_ad8dcd4e6158402b9eb2e531c06b0b9a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8dcd4e6158402b9eb2e531c06b0b9a0">_metrics</a></td></tr>
<tr class="separator:ad8dcd4e6158402b9eb2e531c06b0b9a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac39e3b45ac16eb5b85022bd9b4977450" id="r_ac39e3b45ac16eb5b85022bd9b4977450"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac39e3b45ac16eb5b85022bd9b4977450">_fit_opponent_model</a></td></tr>
<tr class="separator:ac39e3b45ac16eb5b85022bd9b4977450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe09591c36f5e4d95fffab133c3493e8" id="r_abe09591c36f5e4d95fffab133c3493e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe09591c36f5e4d95fffab133c3493e8">_opponent_ids</a></td></tr>
<tr class="separator:abe09591c36f5e4d95fffab133c3493e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80daf71b7e3956716945f59d15d255e6" id="r_a80daf71b7e3956716945f59d15d255e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80daf71b7e3956716945f59d15d255e6">_rng</a></td></tr>
<tr class="separator:a80daf71b7e3956716945f59d15d255e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3d167ad340899d19d5308109aa38fed" id="r_ad3d167ad340899d19d5308109aa38fed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3d167ad340899d19d5308109aa38fed">_step_counter</a></td></tr>
<tr class="separator:ad3d167ad340899d19d5308109aa38fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb2cffe0b4db2762a123cf45521ac6c" id="r_a2bb2cffe0b4db2762a123cf45521ac6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2bb2cffe0b4db2762a123cf45521ac6c">_episode_counter</a></td></tr>
<tr class="separator:a2bb2cffe0b4db2762a123cf45521ac6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5100ba4834fa702cd43d6f0a564ef540" id="r_a5100ba4834fa702cd43d6f0a564ef540"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5100ba4834fa702cd43d6f0a564ef540">_num_learn_steps</a></td></tr>
<tr class="separator:a5100ba4834fa702cd43d6f0a564ef540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb5ce2288d5efa955664b2994299bbb" id="r_aedb5ce2288d5efa955664b2994299bbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aedb5ce2288d5efa955664b2994299bbb">_pi_network</a></td></tr>
<tr class="separator:aedb5ce2288d5efa955664b2994299bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be0298b8c774973728e71ee9e51350d" id="r_a1be0298b8c774973728e71ee9e51350d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1be0298b8c774973728e71ee9e51350d">_critic_network</a></td></tr>
<tr class="separator:a1be0298b8c774973728e71ee9e51350d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af418dfaf2a015727355307aecf6f29dc" id="r_af418dfaf2a015727355307aecf6f29dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af418dfaf2a015727355307aecf6f29dc">_critic_opt</a></td></tr>
<tr class="separator:af418dfaf2a015727355307aecf6f29dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae849a5f35bfd8919d9c22ea227e71d90" id="r_ae849a5f35bfd8919d9c22ea227e71d90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae849a5f35bfd8919d9c22ea227e71d90">_opponent_opt</a></td></tr>
<tr class="separator:ae849a5f35bfd8919d9c22ea227e71d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f3b10ed7573f44067bb1587355a5cc3" id="r_a1f3b10ed7573f44067bb1587355a5cc3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f3b10ed7573f44067bb1587355a5cc3">_policy_opt</a></td></tr>
<tr class="separator:a1f3b10ed7573f44067bb1587355a5cc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186d814ce717dbdd39519cfda01fd58b" id="r_a186d814ce717dbdd39519cfda01fd58b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a186d814ce717dbdd39519cfda01fd58b">_train_state</a></td></tr>
<tr class="separator:a186d814ce717dbdd39519cfda01fd58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779706e86904f179eadedece2dcf90f3" id="r_a779706e86904f179eadedece2dcf90f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a779706e86904f179eadedece2dcf90f3">_current_policy</a></td></tr>
<tr class="separator:a779706e86904f179eadedece2dcf90f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909f3ed0316016ed57f3d506abda897b" id="r_a909f3ed0316016ed57f3d506abda897b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a909f3ed0316016ed57f3d506abda897b">_policy_update_fns</a></td></tr>
<tr class="separator:a909f3ed0316016ed57f3d506abda897b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9974fd169e235555eba0df4b5c521a89" id="r_a9974fd169e235555eba0df4b5c521a89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9974fd169e235555eba0df4b5c521a89">_critic_update_fns</a></td></tr>
<tr class="separator:a9974fd169e235555eba0df4b5c521a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Opponent Shaping Agent.

This agent uses either LOLA or LOLA-DiCE to influence the parameter updates
of the opponent policies.
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00598">598</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a688a991bdc9042322d47fc183d7a7ab8" name="a688a991bdc9042322d47fc183d7a7ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a688a991bdc9042322d47fc183d7a7ab8">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>player_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.List[int]</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">chex.Shape</td>          <td class="paramname"><span class="paramname"><em>observation_spec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hk.Transformed</td>          <td class="paramname"><span class="paramname"><em>agent_specific_kwargs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hk.Transformed</td>          <td class="paramname"><span class="paramname"><em>critic</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>batch_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">16</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>critic_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.01</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>pi_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.001</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>opp_policy_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.001</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Union[float, optax.Schedule] </td>          <td class="paramname"><span class="paramname"><em>opponent_model_learning_rate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.001</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float </td>          <td class="paramname"><span class="paramname"><em>clip_grad_norm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.5</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>policy_update_interval</em></span><span class="paramdefsep"> = </span><span class="paramdefval">8</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float </td>          <td class="paramname"><span class="paramname"><em>discount</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.99</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float </td>          <td class="paramname"><span class="paramname"><em>critic_discount</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.99</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">jax.random.PRNGKey </td>          <td class="paramname"><span class="paramname"><em>seed</em></span><span class="paramdefsep"> = </span><span class="paramdefval">42</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fit_opponent_model</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>correction_type</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'dice'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>use_jit</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>n_lookaheads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>num_critic_mini_batches</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>num_opponent_updates</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Optional[<a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html">rl_environment.Environment</a>] </td>          <td class="paramname"><span class="paramname"><em>env</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initializes agent.

Args:
  player_id: integer, mandatory. Corresponds to the player position in the
    game and is used to index the observation list.
  session: optional Tensorflow session.
  observation_spec: optional dict containing observation specifications.
  name: string. Must be used to scope TF variables. Defaults to `agent`.
  **agent_specific_kwargs: optional extra args.
</pre> 
<p>Reimplemented from <a class="el" href="classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html#af17e2a06dc592b1d2bbe3d1ee40467b6">open_spiel.python.rl_agent.AbstractAgent</a>.</p>

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00605">605</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  630</span>  ):</div>
<div class="line"><span class="lineno">  631</span>    self.player_id = player_id</div>
<div class="line"><span class="lineno">  632</span>    self._num_actions = num_actions</div>
<div class="line"><span class="lineno">  633</span>    self._batch_size = batch_size</div>
<div class="line"><span class="lineno">  634</span>    self._policy_update_interval = policy_update_interval</div>
<div class="line"><span class="lineno">  635</span>    self._discount = discount</div>
<div class="line"><span class="lineno">  636</span>    self._num_opponent_updates = num_opponent_updates</div>
<div class="line"><span class="lineno">  637</span>    self._num_mini_batches = num_critic_mini_batches</div>
<div class="line"><span class="lineno">  638</span>    self._prev_time_step = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  639</span>    self._prev_action = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  640</span>    self._data = []</div>
<div class="line"><span class="lineno">  641</span>    self._metrics = []</div>
<div class="line"><span class="lineno">  642</span>    self._fit_opponent_model = fit_opponent_model</div>
<div class="line"><span class="lineno">  643</span>    self._opponent_ids = opponent_ids</div>
<div class="line"><span class="lineno">  644</span>    self._rng = hk.PRNGSequence(seed)</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="comment"># Step counters</span></div>
<div class="line"><span class="lineno">  647</span>    self._step_counter = 0</div>
<div class="line"><span class="lineno">  648</span>    self._episode_counter = 0</div>
<div class="line"><span class="lineno">  649</span>    self._num_learn_steps = 0</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    self._pi_network = policy</div>
<div class="line"><span class="lineno">  652</span>    self._critic_network = critic</div>
<div class="line"><span class="lineno">  653</span>    self._critic_opt = optax.sgd(learning_rate=critic_learning_rate)</div>
<div class="line"><span class="lineno">  654</span>    self._opponent_opt = optax.adam(opponent_model_learning_rate)</div>
<div class="line"><span class="lineno">  655</span>    self._policy_opt = optax.chain(</div>
<div class="line"><span class="lineno">  656</span>        optax.clip_by_global_norm(clip_grad_norm)</div>
<div class="line"><span class="lineno">  657</span>        <span class="keywordflow">if</span> clip_grad_norm</div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">else</span> optax.identity(),</div>
<div class="line"><span class="lineno">  659</span>        optax.sgd(learning_rate=pi_learning_rate),</div>
<div class="line"><span class="lineno">  660</span>    )</div>
<div class="line"><span class="lineno">  661</span>    self._train_state = self._init_train_state(info_state_size=info_state_size)</div>
<div class="line"><span class="lineno">  662</span>    self._current_policy = self.get_policy(return_probs=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordflow">if</span> correction_type == <span class="stringliteral">&#39;dice&#39;</span>:</div>
<div class="line"><span class="lineno">  665</span>      policy_update_fn = get_dice_update_fn(</div>
<div class="line"><span class="lineno">  666</span>          agent_id=player_id,</div>
<div class="line"><span class="lineno">  667</span>          rng=self._rng,</div>
<div class="line"><span class="lineno">  668</span>          policy_network=policy,</div>
<div class="line"><span class="lineno">  669</span>          critic_network=critic,</div>
<div class="line"><span class="lineno">  670</span>          optimizer=self._policy_opt.update,</div>
<div class="line"><span class="lineno">  671</span>          opp_pi_lr=opp_policy_learning_rate,</div>
<div class="line"><span class="lineno">  672</span>          gamma=discount,</div>
<div class="line"><span class="lineno">  673</span>          n_lookaheads=n_lookaheads,</div>
<div class="line"><span class="lineno">  674</span>          env=env,</div>
<div class="line"><span class="lineno">  675</span>      )</div>
<div class="line"><span class="lineno">  676</span>    <span class="comment"># pylint: disable=consider-using-in</span></div>
<div class="line"><span class="lineno">  677</span>    <span class="keywordflow">elif</span> correction_type == <span class="stringliteral">&#39;lola&#39;</span> <span class="keywordflow">or</span> correction_type == <span class="stringliteral">&#39;none&#39;</span>:</div>
<div class="line"><span class="lineno">  678</span>      <span class="comment"># if correction_type is none, use policy gradient without corrections</span></div>
<div class="line"><span class="lineno">  679</span>      lola_weight = 1.0 <span class="keywordflow">if</span> correction_type == <span class="stringliteral">&#39;lola&#39;</span> <span class="keywordflow">else</span> 0.0</div>
<div class="line"><span class="lineno">  680</span>      update_fn = get_lola_update_fn(</div>
<div class="line"><span class="lineno">  681</span>          agent_id=player_id,</div>
<div class="line"><span class="lineno">  682</span>          policy_network=policy,</div>
<div class="line"><span class="lineno">  683</span>          pi_lr=pi_learning_rate,</div>
<div class="line"><span class="lineno">  684</span>          optimizer=self._policy_opt.update,</div>
<div class="line"><span class="lineno">  685</span>          lola_weight=lola_weight,</div>
<div class="line"><span class="lineno">  686</span>      )</div>
<div class="line"><span class="lineno">  687</span>      policy_update_fn = jax.jit(update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> update_fn</div>
<div class="line"><span class="lineno">  688</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  689</span>      <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;Unknown correction type: {correction_type}&#39;</span>)</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    critic_update_fn = get_critic_update_fn(</div>
<div class="line"><span class="lineno">  692</span>        agent_id=player_id,</div>
<div class="line"><span class="lineno">  693</span>        critic_network=critic,</div>
<div class="line"><span class="lineno">  694</span>        optimizer=self._critic_opt.update,</div>
<div class="line"><span class="lineno">  695</span>        num_minibatches=num_critic_mini_batches,</div>
<div class="line"><span class="lineno">  696</span>        gamma=critic_discount,</div>
<div class="line"><span class="lineno">  697</span>    )</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    self._policy_update_fns = {player_id: policy_update_fn}</div>
<div class="line"><span class="lineno">  700</span>    self._critic_update_fns = {</div>
<div class="line"><span class="lineno">  701</span>        player_id: jax.jit(critic_update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> critic_update_fn</div>
<div class="line"><span class="lineno">  702</span>    }</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="keywordflow">for</span> opponent <span class="keywordflow">in</span> opponent_ids:</div>
<div class="line"><span class="lineno">  705</span>      opp_update_fn = get_opponent_update_fn(</div>
<div class="line"><span class="lineno">  706</span>          agent_id=opponent,</div>
<div class="line"><span class="lineno">  707</span>          policy_network=policy,</div>
<div class="line"><span class="lineno">  708</span>          optimizer=self._opponent_opt.update,</div>
<div class="line"><span class="lineno">  709</span>          num_minibatches=num_opponent_updates,</div>
<div class="line"><span class="lineno">  710</span>      )</div>
<div class="line"><span class="lineno">  711</span>      opp_critic_update_fn = get_critic_update_fn(</div>
<div class="line"><span class="lineno">  712</span>          agent_id=opponent,</div>
<div class="line"><span class="lineno">  713</span>          critic_network=critic,</div>
<div class="line"><span class="lineno">  714</span>          optimizer=self._critic_opt.update,</div>
<div class="line"><span class="lineno">  715</span>          num_minibatches=num_critic_mini_batches,</div>
<div class="line"><span class="lineno">  716</span>          gamma=critic_discount,</div>
<div class="line"><span class="lineno">  717</span>      )</div>
<div class="line"><span class="lineno">  718</span>      self._policy_update_fns[opponent] = (</div>
<div class="line"><span class="lineno">  719</span>          jax.jit(opp_update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> opp_update_fn</div>
<div class="line"><span class="lineno">  720</span>      )</div>
<div class="line"><span class="lineno">  721</span>      self._critic_update_fns[opponent] = (</div>
<div class="line"><span class="lineno">  722</span>          jax.jit(opp_critic_update_fn) <span class="keywordflow">if</span> use_jit <span class="keywordflow">else</span> opp_critic_update_fn</div>
<div class="line"><span class="lineno">  723</span>      )</div>
<div class="line"><span class="lineno">  724</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a063f8a6cc351f7d3bcf74757fabb4669" name="a063f8a6cc351f7d3bcf74757fabb4669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a063f8a6cc351f7d3bcf74757fabb4669">&#9670;&#160;</a></span>_construct_episode_batches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> <a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a> open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.List[<a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a>]
  </td>          <td class="paramname"><span class="paramname"><em>transitions</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Constructs a list of transitions into a single transition batch instance.

The fields 'info_state', 'rewards', 'legal_action_mask' and 'actions' of the
produced transition batch have shape (num_agents, batch_size,
sequence_length, *shape). The fields 'discount' and 'terminal' have shape
(batch_size, sequence_length).

Args:
    transitions: a list of single step transitions

Returns:
    A transition batch instance with items of according shape.
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00985">985</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  987</span>  ) -&gt; TransitionBatch:</div>
<div class="line"><span class="lineno">  988</span>    <span class="stringliteral">&quot;&quot;&quot;Constructs a list of transitions into a single transition batch instance.</span></div>
<div class="line"><span class="lineno">  989</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  990</span><span class="stringliteral">    The fields &#39;info_state&#39;, &#39;rewards&#39;, &#39;legal_action_mask&#39; and &#39;actions&#39; of the</span></div>
<div class="line"><span class="lineno">  991</span><span class="stringliteral">    produced transition batch have shape (num_agents, batch_size,</span></div>
<div class="line"><span class="lineno">  992</span><span class="stringliteral">    sequence_length, *shape). The fields &#39;discount&#39; and &#39;terminal&#39; have shape</span></div>
<div class="line"><span class="lineno">  993</span><span class="stringliteral">    (batch_size, sequence_length).</span></div>
<div class="line"><span class="lineno">  994</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  995</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  996</span><span class="stringliteral">        transitions: a list of single step transitions</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  999</span><span class="stringliteral">        A transition batch instance with items of according shape.</span></div>
<div class="line"><span class="lineno"> 1000</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1001</span>    episode, batches = [], []</div>
<div class="line"><span class="lineno"> 1002</span>    max_episode_length = 0</div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">for</span> transition <span class="keywordflow">in</span> transitions:</div>
<div class="line"><span class="lineno"> 1004</span>      episode.append(transition)</div>
<div class="line"><span class="lineno"> 1005</span>      <span class="keywordflow">if</span> transition.terminal.any():</div>
<div class="line"><span class="lineno"> 1006</span>        max_episode_length = max(max_episode_length, <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(episode))</div>
<div class="line"><span class="lineno"> 1007</span>        <span class="comment"># pylint: disable=no-value-for-parameter</span></div>
<div class="line"><span class="lineno"> 1008</span>        batch = jax.tree_util.tree_map(<span class="keyword">lambda</span> *xs: jnp.stack(xs), *episode)</div>
<div class="line"><span class="lineno"> 1009</span>        batch = batch.replace(</div>
<div class="line"><span class="lineno"> 1010</span>            info_state=batch.info_state.transpose(1, 2, 0, 3),</div>
<div class="line"><span class="lineno"> 1011</span>            action=batch.action.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1012</span>            legal_actions_mask=batch.legal_actions_mask.T,</div>
<div class="line"><span class="lineno"> 1013</span>            reward=batch.reward.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1014</span>            values=batch.values.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1015</span>            discount=batch.discount.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1016</span>            terminal=batch.terminal.transpose(1, 2, 0),</div>
<div class="line"><span class="lineno"> 1017</span>        )</div>
<div class="line"><span class="lineno"> 1018</span>        batches.append(batch)</div>
<div class="line"><span class="lineno"> 1019</span>        episode.clear()</div>
<div class="line"><span class="lineno"> 1020</span>    <span class="keywordflow">return</span> batches[0]</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="ttc" id="alow__level__alloc__test_8cc_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc__test_8cc_source.html#l00046">low_level_alloc_test.cc:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a063f8a6cc351f7d3bcf74757fabb4669_icgraph">
<area shape="rect" title=" " alt="" coords="1442,287,1660,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="poly" title=" " alt="" coords="1426,317,1395,317,1395,312,1426,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a8d702ba311c2a6ec2dd9c8c29749de9f" name="a8d702ba311c2a6ec2dd9c8c29749de9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d702ba311c2a6ec2dd9c8c29749de9f">&#9670;&#160;</a></span>_init_train_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">chex.Shape</td>          <td class="paramname"><span class="paramname"><em>info_state_size</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00859">859</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  859</span>  <span class="keyword">def </span>_init_train_state(self, info_state_size: chex.Shape):</div>
<div class="line"><span class="lineno">  860</span>    init_inputs = jnp.ones(info_state_size)</div>
<div class="line"><span class="lineno">  861</span>    agent_ids = self._opponent_ids + [self.player_id]</div>
<div class="line"><span class="lineno">  862</span>    policy_params, policy_opt_states = {}, {}</div>
<div class="line"><span class="lineno">  863</span>    critic_params, critic_opt_states = {}, {}</div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">for</span> agent_id <span class="keywordflow">in</span> agent_ids:</div>
<div class="line"><span class="lineno">  865</span>      policy_params[agent_id] = self._pi_network.init(</div>
<div class="line"><span class="lineno">  866</span>          <a class="code hl_variable" href="low__level__alloc_8cc.html#a99b32867fd662c5f37b4c76816edc19e">next</a>(self._rng), init_inputs</div>
<div class="line"><span class="lineno">  867</span>      )</div>
<div class="line"><span class="lineno">  868</span>      <span class="keywordflow">if</span> agent_id == self.player_id:</div>
<div class="line"><span class="lineno">  869</span>        policy_opt_state = self._policy_opt.init(policy_params[agent_id])</div>
<div class="line"><span class="lineno">  870</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  871</span>        policy_opt_state = self._opponent_opt.init(policy_params[agent_id])</div>
<div class="line"><span class="lineno">  872</span>      policy_opt_states[agent_id] = policy_opt_state</div>
<div class="line"><span class="lineno">  873</span>      critic_params[agent_id] = self._critic_network.init(</div>
<div class="line"><span class="lineno">  874</span>          <a class="code hl_variable" href="low__level__alloc_8cc.html#a99b32867fd662c5f37b4c76816edc19e">next</a>(self._rng), init_inputs</div>
<div class="line"><span class="lineno">  875</span>      )</div>
<div class="line"><span class="lineno">  876</span>      critic_opt_states[agent_id] = self._critic_opt.init(</div>
<div class="line"><span class="lineno">  877</span>          critic_params[agent_id]</div>
<div class="line"><span class="lineno">  878</span>      )</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordflow">return</span> TrainState(</div>
<div class="line"><span class="lineno">  881</span>        policy_params=policy_params,</div>
<div class="line"><span class="lineno">  882</span>        critic_params=critic_params,</div>
<div class="line"><span class="lineno">  883</span>        policy_opt_states=policy_opt_states,</div>
<div class="line"><span class="lineno">  884</span>        critic_opt_states=critic_opt_states,</div>
<div class="line"><span class="lineno">  885</span>    )</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="ttc" id="alow__level__alloc_8cc_html_a99b32867fd662c5f37b4c76816edc19e"><div class="ttname"><a href="low__level__alloc_8cc.html#a99b32867fd662c5f37b4c76816edc19e">next</a></div><div class="ttdeci">AllocList * next[kMaxLevel]</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc_8cc_source.html#l00100">low_level_alloc.cc:100</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>, <a class="el" href="opponent__shaping_8py_source.html#l00653">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_opt</a>, <a class="el" href="opponent__shaping_8py_source.html#l00643">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_ids</a>, <a class="el" href="opponent__shaping_8py_source.html#l00654">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_opt</a>, <a class="el" href="opponent__shaping_8py_source.html#l00651">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00233">open_spiel.python.pytorch.policy_gradient.PolicyGradient._pi_network</a>, <a class="el" href="opponent__shaping_8py_source.html#l00655">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_opt</a>, <a class="el" href="meta__learning_8py_source.html#l00295">meta_learning.MetaCFRRegretAgent._rng</a>, <a class="el" href="bots_2policy_8py_source.html#l00040">open_spiel.python.bots.policy.PolicyBot._rng</a>, <a class="el" href="uniform__random_8py_source.html#l00034">open_spiel.python.bots.uniform_random.UniformRandomBot._rng</a>, <a class="el" href="catch_8py_source.html#l00039">open_spiel.python.environments.catch.Environment._rng</a>, <a class="el" href="opponent__shaping_8py_source.html#l00644">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._rng</a>, <a class="el" href="rl__environment_8py_source.html#l00126">open_spiel.python.rl_environment.ChanceEventSampler._rng</a>, <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00144">rnn_meta_selfplay_agent.MetaSelfplayAgent._rng</a>, <a class="el" href="low__level__alloc_8cc_source.html#l00100">next</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a8d702ba311c2a6ec2dd9c8c29749de9f_cgraph">
<area shape="rect" title=" " alt="" coords="5,106,224,162"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="278,5,512,46"/>
<area shape="poly" title=" " alt="" coords="167,103,216,78,271,55,290,48,292,54,273,60,219,83,169,108"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="272,70,518,126"/>
<area shape="poly" title=" " alt="" coords="224,117,256,113,257,118,224,122"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="297,149,492,190"/>
<area shape="poly" title=" " alt="" coords="224,145,282,152,281,158,224,150"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="272,215,518,255"/>
<area shape="poly" title=" " alt="" coords="176,160,273,199,297,207,295,212,271,204,174,165"/>
</map>
</div>

</div>
</div>
<a id="a6a1a3592b3656e858e405ca6974d3db1" name="a6a1a3592b3656e858e405ca6974d3db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a1a3592b3656e858e405ca6974d3db1">&#9670;&#160;</a></span>_make_transition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a></td>          <td class="paramname"><span class="paramname"><em>time_step</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l01052">1052</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1052</span>  <span class="keyword">def </span>_make_transition(self, time_step: TimeStep):</div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keyword">assert</span> self._prev_time_step <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1054</span>    legal_actions = self._prev_time_step.observations[<span class="stringliteral">&#39;legal_actions&#39;</span>][</div>
<div class="line"><span class="lineno"> 1055</span>        self.player_id</div>
<div class="line"><span class="lineno"> 1056</span>    ]</div>
<div class="line"><span class="lineno"> 1057</span>    legal_actions_mask = np.zeros((self._batch_size, self._num_actions))</div>
<div class="line"><span class="lineno"> 1058</span>    legal_actions_mask[..., legal_actions] = 1</div>
<div class="line"><span class="lineno"> 1059</span>    actions = np.array(time_step.observations[<span class="stringliteral">&#39;actions&#39;</span>])</div>
<div class="line"><span class="lineno"> 1060</span>    rewards = np.array(time_step.rewards)</div>
<div class="line"><span class="lineno"> 1061</span>    discounts = self._discount * (1 - time_step.last()) * np.ones_like(rewards)</div>
<div class="line"><span class="lineno"> 1062</span>    terminal = time_step.last() * np.ones_like(rewards)</div>
<div class="line"><span class="lineno"> 1063</span>    obs = np.array(self._prev_time_step.observations[<span class="stringliteral">&#39;info_state&#39;</span>])</div>
<div class="line"><span class="lineno"> 1064</span>    transition = TransitionBatch(</div>
<div class="line"><span class="lineno"> 1065</span>        info_state=obs,</div>
<div class="line"><span class="lineno"> 1066</span>        action=actions,</div>
<div class="line"><span class="lineno"> 1067</span>        reward=rewards,</div>
<div class="line"><span class="lineno"> 1068</span>        discount=discounts,</div>
<div class="line"><span class="lineno"> 1069</span>        terminal=terminal,</div>
<div class="line"><span class="lineno"> 1070</span>        legal_actions_mask=legal_actions_mask,</div>
<div class="line"><span class="lineno"> 1071</span>        values=self._prev_time_step.observations[<span class="stringliteral">&#39;values&#39;</span>],</div>
<div class="line"><span class="lineno"> 1072</span>    )</div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">if</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(rewards.shape) &lt; 2:  <span class="comment"># if not a batch, add a batch dimension</span></div>
<div class="line"><span class="lineno"> 1074</span>      transition = jax.tree_util.tree_map(<span class="keyword">lambda</span> x: x[<span class="keywordtype">None</span>], transition)</div>
<div class="line"><span class="lineno"> 1075</span>    <span class="keywordflow">return</span> transition</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dataset__generator_8py_source.html#l00032">dataset_generator.Dataset._batch_size</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00074">open_spiel.python.algorithms.dqn.DQN._batch_size</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00068">open_spiel.python.algorithms.nfsp.NFSP._batch_size</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00156">open_spiel.python.algorithms.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="iterated__matrix__game_8py_source.html#l00047">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame._batch_size</a>, <a class="el" href="jax_2dqn_8py_source.html#l00072">open_spiel.python.jax.dqn.DQN._batch_size</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00068">open_spiel.python.jax.nfsp.NFSP._batch_size</a>, <a class="el" href="opponent__shaping_8py_source.html#l00633">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._batch_size</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00075">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._batch_size</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00092">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._batch_size</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00145">open_spiel.python.pytorch.dqn.DQN._batch_size</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00178">open_spiel.python.pytorch.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00143">open_spiel.python.algorithms.eva.EVAAgent._discount</a>, <a class="el" href="opponent__shaping_8py_source.html#l00635">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._discount</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00135">open_spiel.python.pytorch.eva.EVAAgent._discount</a>, <a class="el" href="boltzmann__tabular__qlearner_8py_source.html#l00073">open_spiel.python.algorithms.boltzmann_tabular_qlearner.BoltzmannQLearner._num_actions</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00170">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00213">open_spiel.python.algorithms.deep_cfr_tf2.AdvantageNetwork._num_actions</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00333">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._num_actions</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00148">open_spiel.python.algorithms.deep_cfr_tf2.PolicyNetwork._num_actions</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00070">open_spiel.python.algorithms.dqn.DQN._num_actions</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00137">open_spiel.python.algorithms.eva.EVAAgent._num_actions</a>, <a class="el" href="mcts__agent_8py_source.html#l00033">open_spiel.python.algorithms.mcts_agent.MCTSAgent._num_actions</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00066">open_spiel.python.algorithms.nfsp.NFSP._num_actions</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00154">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="random__agent_8py_source.html#l00027">open_spiel.python.algorithms.random_agent.RandomAgent._num_actions</a>, <a class="el" href="tabular__multiagent__qlearner_8py_source.html#l00190">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._num_actions</a>, <a class="el" href="tabular__qlearner_8py_source.html#l00046">open_spiel.python.algorithms.tabular_qlearner.QLearner._num_actions</a>, <a class="el" href="wolf__phc_8py_source.html#l00072">open_spiel.python.algorithms.wolf_phc.WoLFPHC._num_actions</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00214">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot._num_actions</a>, <a class="el" href="catch_8py_source.html#l00043">open_spiel.python.environments.catch.Environment._num_actions</a>, <a class="el" href="rl__response_8py_source.html#l00137">open_spiel.python.examples.rl_response.FirstActionAgent._num_actions</a>, <a class="el" href="roshambo__population__example_8py_source.html#l00058">open_spiel.python.examples.roshambo_population_example.BotAgent._num_actions</a>, <a class="el" href="chat__game__base_8py_source.html#l01060">open_spiel.python.games.chat_games.chat_game_base.BaseChatGame._num_actions</a>, <a class="el" href="chat__game__base_8py_source.html#l00121">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._num_actions</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00176">open_spiel.python.jax.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="jax_2dqn_8py_source.html#l00068">open_spiel.python.jax.dqn.DQN._num_actions</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00066">open_spiel.python.jax.nfsp.NFSP._num_actions</a>, <a class="el" href="opponent__shaping_8py_source.html#l00632">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_actions</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00037">open_spiel.python.jax.policy_gradient.NetA2C._num_actions</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00054">open_spiel.python.jax.policy_gradient.NetPG._num_actions</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00244">open_spiel.python.jax.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00074">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._num_actions</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00090">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._num_actions</a>, <a class="el" href="normal__form__game_8py_source.html#l00146">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._num_actions</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00259">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00141">open_spiel.python.pytorch.dqn.DQN._num_actions</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00129">open_spiel.python.pytorch.eva.EVAAgent._num_actions</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00176">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00162">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="opponent__shaping_8py_source.html#l00638">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_time_step</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00250">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00109">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_time_step</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00185">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_cgraph">
<area shape="rect" title=" " alt="" coords="5,106,224,162"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="278,5,512,46"/>
<area shape="poly" title=" " alt="" coords="167,103,216,78,271,55,290,48,292,54,273,60,219,83,169,108"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="272,70,518,126"/>
<area shape="poly" title=" " alt="" coords="224,117,256,113,257,118,224,122"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="297,149,492,190"/>
<area shape="poly" title=" " alt="" coords="224,145,282,152,281,158,224,150"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="272,215,518,255"/>
<area shape="poly" title=" " alt="" coords="176,160,273,199,297,207,295,212,271,204,174,165"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a6a1a3592b3656e858e405ca6974d3db1_icgraph">
<area shape="rect" title=" " alt="" coords="1442,287,1660,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a92fdbbc16d1a44597453d7f3bd1c6278" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="poly" title=" " alt="" coords="1426,317,1395,317,1395,312,1426,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a4c6e95fe51f4fcc38c46f857ff7a14fc" name="a4c6e95fe51f4fcc38c46f857ff7a14fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c6e95fe51f4fcc38c46f857ff7a14fc">&#9670;&#160;</a></span>_should_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> bool open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Indicates whether to update or not.

Returns:
    True, if the number of episodes in the buffer is equal to the batch
    size. False otherwise.
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00933">933</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  933</span>  <span class="keyword">def </span>_should_update(self) -&gt; bool:</div>
<div class="line"><span class="lineno">  934</span>    <span class="stringliteral">&quot;&quot;&quot;Indicates whether to update or not.</span></div>
<div class="line"><span class="lineno">  935</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  936</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  937</span><span class="stringliteral">        True, if the number of episodes in the buffer is equal to the batch</span></div>
<div class="line"><span class="lineno">  938</span><span class="stringliteral">        size. False otherwise.</span></div>
<div class="line"><span class="lineno">  939</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  940</span>    <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  941</span>        self._step_counter &gt;= self._batch_size * (self._num_learn_steps + 1)</div>
<div class="line"><span class="lineno">  942</span>        <span class="keywordflow">and</span> self._episode_counter &gt; 0</div>
<div class="line"><span class="lineno">  943</span>    )</div>
<div class="line"><span class="lineno">  944</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dataset__generator_8py_source.html#l00032">dataset_generator.Dataset._batch_size</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00074">open_spiel.python.algorithms.dqn.DQN._batch_size</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00068">open_spiel.python.algorithms.nfsp.NFSP._batch_size</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00156">open_spiel.python.algorithms.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="iterated__matrix__game_8py_source.html#l00047">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame._batch_size</a>, <a class="el" href="jax_2dqn_8py_source.html#l00072">open_spiel.python.jax.dqn.DQN._batch_size</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00068">open_spiel.python.jax.nfsp.NFSP._batch_size</a>, <a class="el" href="opponent__shaping_8py_source.html#l00633">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._batch_size</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00075">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._batch_size</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00092">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._batch_size</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00145">open_spiel.python.pytorch.dqn.DQN._batch_size</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00178">open_spiel.python.pytorch.policy_gradient.PolicyGradient._batch_size</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00167">open_spiel.python.algorithms.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="opponent__shaping_8py_source.html#l00648">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._episode_counter</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00255">open_spiel.python.jax.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00190">open_spiel.python.pytorch.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00168">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="opponent__shaping_8py_source.html#l00649">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_learn_steps</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00256">open_spiel.python.jax.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00191">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00092">open_spiel.python.algorithms.dqn.DQN._step_counter</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00078">open_spiel.python.algorithms.nfsp.NFSP._step_counter</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00166">open_spiel.python.algorithms.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="jax_2dqn_8py_source.html#l00091">open_spiel.python.jax.dqn.DQN._step_counter</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00078">open_spiel.python.jax.nfsp.NFSP._step_counter</a>, <a class="el" href="opponent__shaping_8py_source.html#l00647">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._step_counter</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00254">open_spiel.python.jax.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00115">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._step_counter</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00163">open_spiel.python.pytorch.dqn.DQN._step_counter</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00189">open_spiel.python.pytorch.policy_gradient.PolicyGradient._step_counter</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a4c6e95fe51f4fcc38c46f857ff7a14fc_icgraph">
<area shape="rect" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a92fdbbc16d1a44597453d7f3bd1c6278" name="a92fdbbc16d1a44597453d7f3bd1c6278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92fdbbc16d1a44597453d7f3bd1c6278">&#9670;&#160;</a></span>_store_time_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a></td>          <td class="paramname"><span class="paramname"><em>time_step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>action</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Store the time step.

Converts the timestep and the action into a transition and steps the
counters.

Args:
    time_step: the current time step.
    action: the action that was taken before observing time_step
Returns: None
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00887">887</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  887</span>  <span class="keyword">def </span>_store_time_step(self, time_step: TimeStep, action: np.ndarray):</div>
<div class="line"><span class="lineno">  888</span>    <span class="stringliteral">&quot;&quot;&quot;Store the time step.</span></div>
<div class="line"><span class="lineno">  889</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  890</span><span class="stringliteral">    Converts the timestep and the action into a transition and steps the</span></div>
<div class="line"><span class="lineno">  891</span><span class="stringliteral">    counters.</span></div>
<div class="line"><span class="lineno">  892</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  893</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  894</span><span class="stringliteral">        time_step: the current time step.</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral">        action: the action that was taken before observing time_step</span></div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral">    Returns: None</span></div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  898</span>    self._step_counter += (</div>
<div class="line"><span class="lineno">  899</span>        time_step.observations[<span class="stringliteral">&#39;batch_size&#39;</span>]</div>
<div class="line"><span class="lineno">  900</span>        <span class="keywordflow">if</span> <span class="stringliteral">&#39;batch_size&#39;</span> <span class="keywordflow">in</span> time_step.observations</div>
<div class="line"><span class="lineno">  901</span>        <span class="keywordflow">else</span> 1</div>
<div class="line"><span class="lineno">  902</span>    )</div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordflow">if</span> self._prev_time_step:</div>
<div class="line"><span class="lineno">  904</span>      transition = self._make_transition(time_step)</div>
<div class="line"><span class="lineno">  905</span>      self._data.append(transition)</div>
<div class="line"><span class="lineno">  906</span>    <span class="keywordflow">if</span> time_step.last():</div>
<div class="line"><span class="lineno">  907</span>      self._prev_time_step = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  908</span>      self._prev_action = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  909</span>      self._episode_counter += 1</div>
<div class="line"><span class="lineno">  910</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  911</span>      obs = time_step.observations[<span class="stringliteral">&#39;info_state&#39;</span>]</div>
<div class="line"><span class="lineno">  912</span>      time_step.observations[<span class="stringliteral">&#39;values&#39;</span>] = jnp.stack(</div>
<div class="line"><span class="lineno">  913</span>          [</div>
<div class="line"><span class="lineno">  914</span>              self._critic_network.<a class="code hl_variable" href="hash__policy__traits__test_8cc.html#ae678cc9e768190695b10aa9f37166c73">apply</a>(</div>
<div class="line"><span class="lineno">  915</span>                  self.train_state.critic_params[id], jnp.array(obs[id])</div>
<div class="line"><span class="lineno">  916</span>              ).squeeze(-1)</div>
<div class="line"><span class="lineno">  917</span>              <span class="keywordflow">for</span> id <span class="keywordflow">in</span> sorted(self.train_state.critic_params.keys())</div>
<div class="line"><span class="lineno">  918</span>          ]</div>
<div class="line"><span class="lineno">  919</span>      )</div>
<div class="line"><span class="lineno">  920</span>      self._prev_time_step = time_step</div>
<div class="line"><span class="lineno">  921</span>      self._prev_action = action</div>
<div class="line"><span class="lineno">  922</span> </div>
<div class="ttc" id="ahash__policy__traits__test_8cc_html_ae678cc9e768190695b10aa9f37166c73"><div class="ttname"><a href="hash__policy__traits__test_8cc.html#ae678cc9e768190695b10aa9f37166c73">apply</a></div><div class="ttdeci">MockFunction&lt; int(int)&gt; apply</div><div class="ttdef"><b>Definition</b> <a href="hash__policy__traits__test_8cc_source.html#l00062">hash_policy_traits_test.cc:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00057">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00069">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer._data</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00330">open_spiel.python.algorithms.nfsp.ReservoirBuffer._data</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00065">open_spiel.python.jax.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="opponent__shaping_8py_source.html#l00640">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._data</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00151">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="lru__cache_8py_source.html#l00047">open_spiel.python.utils.lru_cache.LRUCache._data</a>, <a class="el" href="replay__buffer_8py_source.html#l00031">open_spiel.python.utils.replay_buffer.ReplayBuffer._data</a>, <a class="el" href="reservoir__buffer_8py_source.html#l00036">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer._data</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00167">open_spiel.python.algorithms.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="opponent__shaping_8py_source.html#l00648">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._episode_counter</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00255">open_spiel.python.jax.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00190">open_spiel.python.pytorch.policy_gradient.PolicyGradient._episode_counter</a>, <a class="el" href="opponent__shaping_8py_source.html#l01052">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00089">open_spiel.python.algorithms.dqn.DQN._prev_action</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00075">open_spiel.python.algorithms.nfsp.NFSP._prev_action</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00163">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="tabular__qlearner_8py_source.html#l00141">open_spiel.python.algorithms.tabular_qlearner.QLearner._prev_action</a>, <a class="el" href="wolf__phc_8py_source.html#l00226">open_spiel.python.algorithms.wolf_phc.WoLFPHC._prev_action</a>, <a class="el" href="jax_2dqn_8py_source.html#l00088">open_spiel.python.jax.dqn.DQN._prev_action</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00075">open_spiel.python.jax.nfsp.NFSP._prev_action</a>, <a class="el" href="opponent__shaping_8py_source.html#l00639">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_action</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00251">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00107">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_action</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00160">open_spiel.python.pytorch.dqn.DQN._prev_action</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00186">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_action</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00162">open_spiel.python.algorithms.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="opponent__shaping_8py_source.html#l00638">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_time_step</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00250">open_spiel.python.jax.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00109">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._prev_time_step</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00185">open_spiel.python.pytorch.policy_gradient.PolicyGradient._prev_time_step</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00092">open_spiel.python.algorithms.dqn.DQN._step_counter</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00078">open_spiel.python.algorithms.nfsp.NFSP._step_counter</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00166">open_spiel.python.algorithms.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="jax_2dqn_8py_source.html#l00091">open_spiel.python.jax.dqn.DQN._step_counter</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00078">open_spiel.python.jax.nfsp.NFSP._step_counter</a>, <a class="el" href="opponent__shaping_8py_source.html#l00647">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._step_counter</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00254">open_spiel.python.jax.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00115">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._step_counter</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00163">open_spiel.python.pytorch.dqn.DQN._step_counter</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00189">open_spiel.python.pytorch.policy_gradient.PolicyGradient._step_counter</a>, <a class="el" href="hash__policy__traits__test_8cc_source.html#l00062">apply</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00726">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.train_state()</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_cgraph">
<area shape="rect" title=" " alt="" coords="5,142,224,198"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a6a1a3592b3656e858e405ca6974d3db1" title=" " alt="" coords="302,106,520,162"/>
<area shape="poly" title=" " alt="" coords="224,154,287,146,287,151,224,159"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a20a9c683dd11b09e5667692bc1ab6891" title=" " alt="" coords="272,185,551,226"/>
<area shape="poly" title=" " alt="" coords="224,180,257,184,256,190,224,186"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="606,5,839,46"/>
<area shape="poly" title=" " alt="" coords="476,103,598,55,620,48,622,53,600,60,478,108"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="599,70,845,126"/>
<area shape="poly" title=" " alt="" coords="521,118,583,111,584,116,521,124"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="624,149,820,190"/>
<area shape="poly" title=" " alt="" coords="521,144,610,154,609,159,521,149"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="599,215,845,255"/>
<area shape="poly" title=" " alt="" coords="522,160,552,171,576,185,600,199,620,207,618,212,598,204,574,190,550,176,520,165"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a92fdbbc16d1a44597453d7f3bd1c6278_icgraph">
<area shape="rect" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="aa0d78940728f70c85b0b8b2723ceb280" name="aa0d78940728f70c85b0b8b2723ceb280"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0d78940728f70c85b0b8b2723ceb280">&#9670;&#160;</a></span>_train_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Updates the critic and the policy parameters.

After the update, the data buffer is cleared. Returns: None
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00923">923</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  923</span>  <span class="keyword">def </span>_train_step(self):</div>
<div class="line"><span class="lineno">  924</span>    <span class="stringliteral">&quot;&quot;&quot;Updates the critic and the policy parameters.</span></div>
<div class="line"><span class="lineno">  925</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  926</span><span class="stringliteral">    After the update, the data buffer is cleared. Returns: None</span></div>
<div class="line"><span class="lineno">  927</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  928</span>    batch = self._construct_episode_batches(self._data)</div>
<div class="line"><span class="lineno">  929</span>    update_metrics = self._update_agent(batch)</div>
<div class="line"><span class="lineno">  930</span>    self._metrics.append(update_metrics)</div>
<div class="line"><span class="lineno">  931</span>    self._data.clear()</div>
<div class="line"><span class="lineno">  932</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00987">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._construct_episode_batches()</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00057">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00069">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer._data</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00330">open_spiel.python.algorithms.nfsp.ReservoirBuffer._data</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00065">open_spiel.python.jax.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="opponent__shaping_8py_source.html#l00640">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._data</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00151">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer._data</a>, <a class="el" href="lru__cache_8py_source.html#l00047">open_spiel.python.utils.lru_cache.LRUCache._data</a>, <a class="el" href="replay__buffer_8py_source.html#l00031">open_spiel.python.utils.replay_buffer.ReplayBuffer._data</a>, <a class="el" href="reservoir__buffer_8py_source.html#l00036">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer._data</a>, <a class="el" href="opponent__shaping_8py_source.html#l00641">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._metrics</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_cgraph">
<area shape="rect" title=" " alt="" coords="5,1068,224,1123"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a063f8a6cc351f7d3bcf74757fabb4669" title=" " alt="" coords="272,1028,490,1083"/>
<area shape="poly" title=" " alt="" coords="224,1076,256,1072,257,1077,225,1082"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="272,1108,490,1163"/>
<area shape="poly" title=" " alt="" coords="225,1109,257,1114,256,1119,224,1115"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a566493380f42cdfb19e24266739ff031" title=" " alt="" coords="834,1169,1052,1225"/>
<area shape="poly" title=" " alt="" coords="491,1137,618,1144,757,1158,819,1168,818,1173,756,1163,618,1150,490,1142"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aaba558f18992f23fda573e138df49ac6" title=" " alt="" coords="538,1173,756,1229"/>
<area shape="poly" title=" " alt="" coords="491,1160,523,1168,522,1173,490,1165"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7744e2572fb3fa78b3ff0f99baa1a208" title=" " alt="" coords="538,949,756,1005"/>
<area shape="poly" title=" " alt="" coords="465,1105,489,1093,549,1054,601,1013,605,1017,552,1058,491,1098,467,1109"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="1136,887,1370,928"/>
<area shape="poly" title=" " alt="" coords="1005,1166,1045,1140,1080,1105,1092,1082,1098,1061,1099,1020,1103,979,1111,958,1128,938,1130,935,1134,939,1132,941,1116,961,1108,980,1105,1020,1103,1062,1097,1084,1084,1108,1048,1144,1008,1171"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="1130,952,1376,1007"/>
<area shape="poly" title=" " alt="" coords="987,1166,1080,1104,1201,1015,1205,1019,1083,1108,990,1171"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="1155,1111,1350,1152"/>
<area shape="poly" title=" " alt="" coords="1052,1171,1140,1153,1141,1158,1053,1176"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="1130,1176,1376,1217"/>
<area shape="poly" title=" " alt="" coords="1053,1194,1115,1194,1115,1200,1053,1200"/>
<area shape="poly" title=" " alt="" coords="662,947,685,912,717,872,756,834,803,805,878,779,910,775,941,774,1005,784,1082,805,1120,818,1156,836,1216,875,1213,880,1153,841,1118,823,1081,810,1003,789,941,779,911,780,879,785,805,810,760,838,721,876,689,915,666,950"/>
<area shape="poly" title=" " alt="" coords="669,947,725,891,762,864,803,844,881,817,915,808,947,804,979,804,1011,811,1045,824,1083,844,1096,854,1103,866,1110,890,1115,915,1121,926,1132,938,1135,941,1132,945,1128,941,1117,929,1110,916,1105,891,1099,868,1092,858,1080,848,1043,828,1010,816,978,809,947,809,916,813,883,822,805,849,765,869,729,895,673,951"/>
<area shape="poly" title=" " alt="" coords="674,1003,730,1057,766,1083,805,1104,890,1128,978,1141,1063,1144,1140,1141,1140,1147,1063,1149,977,1146,889,1133,803,1109,763,1088,726,1061,670,1007"/>
<area shape="poly" title=" " alt="" coords="667,1004,749,1143,806,1235,853,1255,904,1266,956,1269,1009,1266,1060,1258,1108,1247,1189,1221,1191,1226,1110,1252,1061,1264,1010,1272,956,1275,903,1271,852,1260,803,1239,745,1146,663,1007"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="824,692,1062,733"/>
<area shape="poly" title=" " alt="" coords="658,947,679,904,711,850,752,796,776,771,803,749,822,738,825,742,806,754,780,775,756,799,715,853,684,906,663,950"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="804,923,1082,964"/>
<area shape="poly" title=" " alt="" coords="757,962,788,958,789,964,757,967"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="808,1054,1078,1094"/>
<area shape="poly" title=" " alt="" coords="712,1003,805,1038,833,1047,832,1052,803,1043,710,1008"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="819,858,1067,898"/>
<area shape="poly" title=" " alt="" coords="709,946,803,909,832,900,833,906,805,914,711,951"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="816,988,1070,1029"/>
<area shape="poly" title=" " alt="" coords="757,986,801,991,801,996,757,991"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a034e9845c4b368946f9336a4a029b568" title=" " alt="" coords="1134,692,1372,733"/>
<area shape="poly" title=" " alt="" coords="1062,710,1119,710,1119,716,1062,716"/>
<area shape="rect" href="classabsl_1_1any.html#ac0db0b7b1d417778376dbca6f5604ae5" title=" " alt="" coords="1497,5,1608,31"/>
<area shape="poly" title=" " alt="" coords="1254,692,1271,560,1305,364,1328,262,1355,169,1387,93,1404,64,1422,41,1450,24,1481,16,1482,21,1452,29,1426,46,1408,67,1391,95,1360,171,1333,263,1310,365,1276,561,1259,692"/>
<area shape="rect" href="classabsl_1_1bernoulli__distribution.html#a2ab61e1795ae631e6a0d598b3b450a08" title=" " alt="" coords="1467,55,1638,96"/>
<area shape="poly" title=" " alt="" coords="1255,692,1274,572,1311,396,1334,305,1361,222,1390,153,1406,127,1422,107,1451,88,1454,92,1426,111,1410,130,1395,156,1366,224,1339,307,1316,397,1280,573,1260,693"/>
<area shape="rect" href="classabsl_1_1beta__distribution.html#aab4ba94645bb1320e5626edbd622e3ae" title=" " alt="" coords="1478,120,1627,161"/>
<area shape="poly" title=" " alt="" coords="1251,692,1256,598,1264,532,1278,458,1299,381,1329,305,1370,234,1394,202,1422,172,1441,158,1462,149,1465,154,1444,163,1426,176,1398,205,1374,237,1334,308,1304,383,1283,460,1270,533,1262,599,1257,692"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1node__handle__base.html#ac5bd468dbb0966e41568556bfb267ade" title=" " alt="" coords="1466,186,1640,226"/>
<area shape="poly" title=" " alt="" coords="1252,692,1261,608,1271,550,1286,485,1308,419,1337,353,1375,291,1422,237,1450,220,1453,224,1426,242,1379,294,1342,355,1313,420,1291,487,1276,551,1266,609,1258,692"/>
<area shape="rect" href="classabsl_1_1discrete__distribution.html#a283404b8b036394800e2b7aa508a584c" title=" " alt="" coords="1468,251,1637,292"/>
<area shape="poly" title=" " alt="" coords="1254,692,1266,618,1294,513,1316,456,1344,400,1379,348,1422,303,1452,285,1455,289,1426,307,1384,351,1349,403,1321,458,1299,515,1271,619,1259,693"/>
<area shape="rect" href="classabsl_1_1exponential__distribution.html#a9d46c5f69b2115771ccd679dabe84c8d" title=" " alt="" coords="1458,316,1647,357"/>
<area shape="poly" title=" " alt="" coords="1256,691,1272,628,1303,541,1325,494,1352,448,1384,405,1422,368,1442,355,1445,360,1426,372,1388,409,1356,451,1330,496,1308,543,1277,630,1261,693"/>
<area shape="rect" href="classabsl_1_1gaussian__distribution.html#a0eeca27ee347bed1e27672bf8ef66b92" title=" " alt="" coords="1465,382,1640,422"/>
<area shape="poly" title=" " alt="" coords="1258,691,1278,639,1312,569,1360,496,1389,462,1422,433,1449,418,1452,423,1426,438,1393,466,1364,499,1317,571,1283,641,1263,693"/>
<area shape="rect" href="classabsl_1_1log__uniform__int__distribution.html#a2ce353d92e45b1111fc30cac43274c14" title=" " alt="" coords="1482,447,1623,488"/>
<area shape="poly" title=" " alt="" coords="1262,691,1286,650,1321,597,1367,543,1394,518,1423,497,1466,478,1468,483,1425,502,1397,523,1371,547,1326,600,1290,652,1267,693"/>
<area shape="rect" href="classabsl_1_1optional.html#a8dfe8f9b4f502b6e94ca9fc3cc75a15f" title=" " alt="" coords="1485,512,1620,538"/>
<area shape="poly" title=" " alt="" coords="1257,733,1263,765,1273,778,1288,779,1308,770,1360,733,1423,692,1461,676,1500,656,1517,640,1531,619,1541,591,1548,553,1553,554,1547,592,1536,622,1521,644,1503,660,1464,680,1425,697,1363,737,1311,775,1289,785,1271,783,1258,767,1252,734"/>
<area shape="poly" title=" " alt="" coords="1258,733,1264,756,1274,763,1289,760,1309,748,1361,709,1423,668,1461,652,1499,635,1516,622,1530,605,1541,582,1547,552,1552,553,1546,584,1534,608,1519,626,1502,639,1463,657,1425,673,1364,713,1312,753,1291,765,1273,768,1259,759,1253,734"/>
<area shape="poly" title=" " alt="" coords="1355,690,1388,665,1423,644,1497,614,1514,604,1528,591,1539,574,1546,552,1551,554,1544,577,1532,595,1517,608,1499,619,1425,649,1391,670,1358,694"/>
<area shape="poly" title=" " alt="" coords="1327,690,1372,653,1423,620,1458,606,1494,593,1525,577,1536,566,1544,551,1549,554,1540,569,1528,581,1496,598,1460,610,1425,625,1375,657,1330,694"/>
<area shape="poly" title=" " alt="" coords="1302,690,1356,641,1388,617,1423,596,1455,583,1488,573,1518,562,1540,548,1543,552,1520,567,1490,578,1457,588,1425,601,1391,621,1360,645,1306,694"/>
<area shape="poly" title=" " alt="" coords="1282,690,1342,631,1380,599,1423,572,1476,553,1525,541,1527,546,1478,558,1425,577,1383,603,1345,635,1285,694"/>
<area shape="poly" title=" " alt="" coords="1267,690,1293,658,1329,619,1373,580,1423,548,1469,531,1471,536,1425,553,1377,584,1333,623,1297,662,1271,694"/>
<area shape="poly" title=" " alt="" coords="1259,691,1283,652,1320,606,1368,561,1423,524,1449,513,1476,507,1525,505,1525,510,1477,512,1450,518,1425,529,1371,565,1324,610,1287,655,1264,693"/>
<area shape="poly" title=" " alt="" coords="1255,691,1277,644,1314,591,1364,540,1393,518,1423,500,1455,487,1489,482,1519,485,1542,497,1539,501,1518,490,1489,488,1456,493,1425,505,1396,522,1368,544,1318,594,1281,647,1260,693"/>
<area shape="poly" title=" " alt="" coords="1253,691,1261,663,1273,633,1311,573,1362,518,1392,495,1423,476,1458,463,1495,460,1512,463,1528,470,1540,481,1549,496,1544,498,1536,484,1525,475,1511,468,1495,465,1460,468,1425,481,1395,499,1366,522,1315,576,1278,636,1266,665,1259,693"/>
<area shape="poly" title=" " alt="" coords="1253,692,1259,657,1271,622,1288,587,1309,554,1333,523,1361,496,1391,471,1423,452,1460,439,1499,438,1516,445,1532,456,1544,473,1551,496,1546,497,1539,475,1528,460,1514,449,1498,444,1461,444,1425,457,1394,476,1364,499,1337,527,1313,557,1293,590,1276,624,1264,658,1258,693"/>
<area shape="poly" title=" " alt="" coords="1252,692,1258,650,1270,609,1287,571,1308,535,1332,502,1360,473,1390,448,1423,428,1461,415,1482,414,1501,417,1519,427,1534,443,1546,466,1552,496,1547,498,1541,468,1530,446,1516,431,1499,422,1481,419,1462,420,1425,433,1394,452,1364,476,1336,505,1312,538,1291,573,1275,611,1264,651,1258,693"/>
<area shape="poly" title=" " alt="" coords="1252,692,1258,643,1269,596,1286,554,1307,515,1331,480,1360,449,1390,424,1423,404,1462,391,1483,391,1502,396,1520,409,1535,429,1547,458,1553,496,1548,497,1541,459,1531,431,1517,412,1500,401,1482,396,1463,396,1425,409,1393,428,1363,453,1336,483,1311,517,1291,556,1274,598,1263,644,1257,692"/>
<area shape="rect" href="classabsl_1_1poisson__distribution.html#ab0710bb9dabd8b673663d6721aed099a" title=" " alt="" coords="1468,562,1637,602"/>
<area shape="poly" title=" " alt="" coords="1283,690,1346,651,1423,613,1453,602,1455,607,1425,618,1349,656,1286,694"/>
<area shape="rect" href="classabsl_1_1random__internal_1_1sequence__urbg.html#a99fa9a5c36e514966a1d0e637768f204" title=" " alt="" coords="1476,627,1630,668"/>
<area shape="poly" title=" " alt="" coords="1349,689,1460,665,1461,670,1350,694"/>
<area shape="rect" href="classabsl_1_1uniform__int__distribution.html#a17e835faa5e38003db98c77e3278d4a9" title=" " alt="" coords="1459,692,1646,733"/>
<area shape="poly" title=" " alt="" coords="1372,710,1443,710,1443,716,1372,716"/>
<area shape="rect" href="classabsl_1_1uniform__real__distribution.html#abe4e75a5e009149340657b70d378fb0c" title=" " alt="" coords="1488,758,1617,798"/>
<area shape="poly" title=" " alt="" coords="1316,731,1474,766,1473,772,1315,736"/>
<area shape="poly" title=" " alt="" coords="1373,727,1476,751,1475,756,1371,733"/>
<area shape="rect" href="classabsl_1_1zipf__distribution.html#a88595f1f987de7cfcef5d81328d088e5" title=" " alt="" coords="1480,823,1625,864"/>
<area shape="poly" title=" " alt="" coords="1286,731,1349,770,1425,808,1466,822,1465,827,1423,813,1346,775,1283,736"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#ade6fd5284ee62f16e86c96b5f7ab344d" title=" " alt="" coords="1464,888,1641,929"/>
<area shape="poly" title=" " alt="" coords="1272,732,1334,802,1377,840,1425,873,1451,885,1449,890,1423,878,1374,845,1330,806,1268,736"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a1f008db92b4d0d747746b74c52640545" title=" " alt="" coords="1438,954,1667,994"/>
<area shape="poly" title=" " alt="" coords="1272,732,1378,874,1399,910,1409,924,1426,939,1435,945,1432,949,1422,943,1405,928,1395,913,1374,877,1267,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#aebc4c2690cbd5350976c463c39794650" title=" " alt="" coords="1434,1019,1671,1060"/>
<area shape="poly" title=" " alt="" coords="1275,732,1325,793,1353,833,1378,874,1392,912,1397,945,1404,975,1412,989,1426,1004,1430,1008,1427,1012,1422,1008,1408,992,1399,977,1391,946,1387,914,1374,877,1349,836,1321,797,1271,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1catch_1_1_environment.html#a0d19f39c580c7fbb77f691a3b85d696d" title=" " alt="" coords="1428,1084,1677,1125"/>
<area shape="poly" title=" " alt="" coords="1276,732,1327,793,1355,832,1378,874,1389,904,1393,931,1393,980,1394,1003,1398,1025,1408,1047,1426,1070,1430,1074,1426,1077,1422,1073,1403,1049,1393,1026,1389,1003,1388,980,1388,932,1384,905,1374,877,1350,835,1323,796,1272,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1cliff__walking_1_1_environment.html#af48d9954f8071a2d7209bc191d5d9aa4" title=" " alt="" coords="1436,1150,1669,1190"/>
<area shape="poly" title=" " alt="" coords="1277,732,1328,792,1356,832,1378,874,1391,914,1395,950,1390,1014,1389,1045,1392,1074,1403,1104,1426,1135,1429,1138,1426,1142,1422,1139,1398,1106,1387,1075,1383,1045,1385,1014,1389,950,1386,915,1374,877,1351,835,1324,796,1273,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1iterated__matrix__game_1_1_iterated_matrix_game.html#a7c617ff68dbece5f2f407453544db0ac" title=" " alt="" coords="1425,1215,1680,1256"/>
<area shape="poly" title=" " alt="" coords="1277,732,1329,792,1356,832,1378,875,1393,923,1396,968,1393,1010,1387,1049,1383,1087,1386,1124,1399,1161,1426,1200,1429,1203,1425,1207,1422,1204,1394,1164,1381,1125,1378,1086,1382,1048,1388,1009,1391,968,1388,924,1374,876,1352,835,1325,796,1273,736"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1atari_1_1_noop_reset_env.html#ac02beff549203ee5de49b1b30a0b2607" title=" " alt="" coords="1452,1304,1654,1345"/>
<area shape="poly" title=" " alt="" coords="1278,732,1330,792,1357,832,1378,875,1395,933,1399,986,1395,1034,1388,1080,1383,1124,1384,1169,1397,1216,1426,1266,1441,1282,1460,1295,1457,1299,1438,1286,1422,1269,1392,1218,1379,1170,1378,1124,1383,1079,1390,1034,1394,986,1390,934,1374,876,1352,834,1326,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1chat__games_1_1utils_1_1logging__utils_1_1_color_text.html#a6ecef6232f846a4641a2a52f6b645d45" title=" " alt="" coords="1450,1369,1656,1425"/>
<area shape="poly" title=" " alt="" coords="1278,732,1330,792,1357,832,1379,875,1389,921,1393,981,1392,1122,1392,1194,1396,1260,1407,1316,1415,1338,1426,1355,1438,1367,1434,1371,1422,1359,1410,1340,1401,1317,1391,1261,1387,1194,1387,1122,1388,981,1384,922,1373,876,1353,834,1326,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a893f29582436b18cf75acab03bf9a0f6" title=" " alt="" coords="1424,1448,1681,1489"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1357,832,1379,875,1390,929,1394,999,1389,1164,1388,1248,1391,1325,1403,1389,1413,1415,1426,1435,1427,1436,1423,1439,1422,1438,1408,1417,1398,1391,1386,1326,1382,1248,1384,1164,1388,999,1385,930,1373,876,1353,834,1326,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_regret_minimizer.html#a5e7d042c062cd5060dbc72e3e209a019" title=" " alt="" coords="1425,1514,1680,1554"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,832,1378,875,1386,902,1391,935,1394,1013,1388,1197,1385,1290,1388,1376,1401,1448,1412,1476,1426,1499,1428,1502,1424,1505,1422,1502,1407,1479,1396,1449,1383,1377,1380,1290,1382,1197,1389,1013,1386,936,1381,903,1374,876,1353,834,1326,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_m_l_p.html#ae91f4f3690f3b77d4e81a07f2459e7b0" title=" " alt="" coords="1450,1579,1655,1620"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1378,875,1387,905,1392,941,1395,1028,1386,1231,1382,1334,1385,1428,1390,1470,1399,1508,1410,1539,1426,1564,1438,1576,1435,1580,1422,1568,1405,1542,1393,1509,1385,1471,1380,1429,1377,1334,1381,1230,1390,1028,1387,942,1382,906,1374,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_sonnet_linear.html#a93a986c411cf799e0bce4ac540bb2f8d" title=" " alt="" coords="1450,1644,1655,1685"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1378,875,1388,908,1393,948,1396,1042,1384,1264,1380,1377,1382,1481,1387,1527,1396,1567,1409,1602,1426,1630,1438,1641,1435,1645,1422,1633,1404,1605,1391,1569,1382,1527,1377,1481,1374,1377,1379,1264,1390,1042,1388,948,1382,909,1374,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html#a26dbd83ee35fa2014b86b34fcb5bb292" title=" " alt="" coords="1448,1710,1657,1750"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1387,932,1391,1030,1393,1292,1394,1428,1399,1551,1409,1644,1417,1676,1426,1695,1437,1706,1433,1709,1422,1698,1412,1678,1404,1645,1394,1551,1389,1429,1387,1292,1386,1030,1382,933,1373,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1replay__buffer_1_1_replay_buffer.html#aff43350cf33a3bd8a628b204947eea23" title=" " alt="" coords="1456,1775,1649,1816"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1388,937,1392,1042,1392,1325,1393,1472,1398,1604,1408,1705,1416,1740,1426,1761,1444,1776,1441,1780,1422,1764,1411,1742,1403,1706,1392,1605,1388,1473,1387,1325,1386,1042,1383,937,1373,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_basic_stats.html#a2d62de15dda65996427a13c750917ef1" title=" " alt="" coords="1457,1840,1648,1881"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1388,941,1392,1055,1391,1358,1392,1516,1396,1658,1407,1767,1415,1803,1426,1826,1445,1842,1441,1846,1422,1829,1410,1805,1402,1768,1391,1658,1386,1516,1386,1358,1387,1055,1383,942,1373,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_histogram_named.html#a196d986bfd256a0483346e7c9bc3570d" title=" " alt="" coords="1457,1906,1648,1946"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1385,903,1389,946,1392,1067,1390,1391,1390,1560,1394,1712,1406,1828,1415,1867,1426,1891,1445,1907,1441,1911,1422,1894,1410,1869,1400,1829,1389,1712,1385,1560,1385,1391,1387,1067,1383,946,1379,904,1373,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_histogram_numbered.html#a40c772fe8abdf0bf861aed012967ad1d" title=" " alt="" coords="1457,1971,1648,2012"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1385,905,1389,951,1393,1079,1390,1424,1389,1604,1393,1765,1405,1889,1414,1931,1426,1957,1445,1973,1441,1977,1422,1960,1409,1933,1399,1890,1388,1766,1384,1604,1384,1424,1387,1079,1384,951,1380,906,1373,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1vector__env_1_1_sync_vector_env.html#ab77b6f9ba60cebde2df6744d93041d01" title=" " alt="" coords="1466,2060,1639,2101"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1385,907,1390,955,1394,1091,1392,1455,1391,1645,1395,1816,1406,1948,1415,1994,1426,2022,1440,2038,1458,2051,1455,2055,1437,2042,1422,2025,1410,1995,1401,1949,1390,1817,1386,1646,1387,1455,1389,1091,1385,955,1380,907,1373,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="structopen__spiel_1_1go_1_1_go_board_1_1_chain.html#a6908f66d9880b5877c13b64c62f81b39" title=" " alt="" coords="1470,2126,1635,2166"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1386,909,1390,961,1393,1108,1388,1503,1386,1708,1389,1892,1394,1970,1402,2034,1412,2082,1426,2111,1440,2124,1457,2134,1455,2138,1437,2129,1422,2114,1407,2084,1396,2035,1389,1970,1384,1893,1380,1708,1382,1503,1388,1108,1385,962,1381,910,1373,876,1353,834,1327,795,1274,735"/>
<area shape="rect" href="structopen__spiel_1_1phantom__go_1_1_phantom_go_board_1_1_chain.html#aa49a6bb32fa96aad95910ff1f5dc4368" title=" " alt="" coords="1476,2190,1629,2246"/>
<area shape="poly" title=" " alt="" coords="1278,732,1331,792,1358,831,1379,875,1386,911,1391,966,1394,1120,1388,1535,1386,1751,1389,1945,1394,2027,1401,2094,1412,2145,1426,2177,1442,2192,1463,2203,1460,2208,1439,2196,1422,2180,1407,2147,1396,2095,1388,2027,1384,1945,1380,1751,1382,1535,1389,1120,1386,966,1381,912,1373,876,1353,834,1327,795,1274,735"/>
<area shape="poly" title=" " alt="" coords="1497,1305,1494,1294,1503,1285,1523,1280,1553,1278,1585,1280,1604,1286,1602,1291,1584,1285,1553,1283,1524,1285,1506,1290,1499,1296,1502,1303"/>
<area shape="poly" title=" " alt="" coords="1497,2061,1494,2050,1503,2041,1523,2036,1553,2034,1585,2036,1604,2042,1602,2047,1584,2041,1553,2039,1524,2041,1506,2046,1499,2052,1502,2059"/>
<area shape="poly" title=" " alt="" coords="1082,925,1120,920,1121,925,1083,930"/>
<area shape="poly" title=" " alt="" coords="1083,957,1114,961,1114,966,1082,962"/>
<area shape="poly" title=" " alt="" coords="1054,962,1083,975,1220,1099,1216,1103,1080,979,1052,967"/>
<area shape="poly" title=" " alt="" coords="1067,962,1084,975,1101,998,1109,1022,1110,1046,1109,1070,1107,1094,1108,1117,1115,1139,1132,1162,1135,1165,1132,1169,1128,1165,1110,1142,1103,1118,1101,1093,1103,1070,1105,1046,1104,1023,1096,1001,1080,979,1064,966"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aa0d78940728f70c85b0b8b2723ceb280_icgraph">
<area shape="rect" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a7b25c7de236284a0d59c11efddea26b1" name="a7b25c7de236284a0d59c11efddea26b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b25c7de236284a0d59c11efddea26b1">&#9670;&#160;</a></span>_update_agent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Dict open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Updates the critic and policy parameters of the agent.

Args:
    batch: A batch of training episodes.
    
Dimensions (N=player, B=batch_size, T=timesteps, S=state_dim):
  action: (N, B, T),
  discount: (B, T),
  info_state: (N, B, T, *S),
  legal_actions_mask: (N, B, T),
  reward: (N, B, T),
  terminal: (B, T),
  values: (N, B, T)

Returns:
    A dictionary that contains relevant training metrics.
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00945">945</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  945</span>  <span class="keyword">def </span>_update_agent(self, batch: TransitionBatch) -&gt; typing.Dict:</div>
<div class="line"><span class="lineno">  946</span>    <span class="stringliteral">&quot;&quot;&quot;Updates the critic and policy parameters of the agent.</span></div>
<div class="line"><span class="lineno">  947</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  948</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  949</span><span class="stringliteral">        batch: A batch of training episodes.</span></div>
<div class="line"><span class="lineno">  950</span><span class="stringliteral">        </span></div>
<div class="line"><span class="lineno">  951</span><span class="stringliteral">    Dimensions (N=player, B=batch_size, T=timesteps, S=state_dim):</span></div>
<div class="line"><span class="lineno">  952</span><span class="stringliteral">      action: (N, B, T),</span></div>
<div class="line"><span class="lineno">  953</span><span class="stringliteral">      discount: (B, T),</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">      info_state: (N, B, T, *S),</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral">      legal_actions_mask: (N, B, T),</span></div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">      reward: (N, B, T),</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">      terminal: (B, T),</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral">      values: (N, B, T)</span></div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">        A dictionary that contains relevant training metrics.</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  963</span>    metrics = {}</div>
<div class="line"><span class="lineno">  964</span>    self._num_learn_steps += 1</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>    <span class="comment"># if we do opponent modelling, we update the opponents first</span></div>
<div class="line"><span class="lineno">  967</span>    <span class="keywordflow">if</span> self._fit_opponent_model:</div>
<div class="line"><span class="lineno">  968</span>      opponent_update_metrics = self._update_opponents(batch)</div>
<div class="line"><span class="lineno">  969</span>      metrics.update(</div>
<div class="line"><span class="lineno">  970</span>          (f<span class="stringliteral">&#39;opp_models/{k}&#39;</span>, v) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> opponent_update_metrics.items()</div>
<div class="line"><span class="lineno">  971</span>      )</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>    <span class="comment"># then we update the critic</span></div>
<div class="line"><span class="lineno">  974</span>    critic_update_metrics = self._update_critic(batch)</div>
<div class="line"><span class="lineno">  975</span>    metrics.update((f<span class="stringliteral">&#39;critic/{k}&#39;</span>, v) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> critic_update_metrics.items())</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <span class="comment"># and finally we update the policy</span></div>
<div class="line"><span class="lineno">  978</span>    <span class="keywordflow">if</span> self._num_learn_steps % self._policy_update_interval == 0:</div>
<div class="line"><span class="lineno">  979</span>      policy_update_metrics = self._update_policy(batch)</div>
<div class="line"><span class="lineno">  980</span>      metrics.update(</div>
<div class="line"><span class="lineno">  981</span>          (f<span class="stringliteral">&#39;policy/{k}&#39;</span>, v) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> policy_update_metrics.items()</div>
<div class="line"><span class="lineno">  982</span>      )</div>
<div class="line"><span class="lineno">  983</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno">  984</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00642">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._fit_opponent_model</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00168">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="opponent__shaping_8py_source.html#l00649">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_learn_steps</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00256">open_spiel.python.jax.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00191">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_learn_steps</a>, <a class="el" href="opponent__shaping_8py_source.html#l00634">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_interval</a>, <a class="el" href="opponent__shaping_8py_source.html#l01029">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_critic()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01035">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l01022">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_cgraph">
<area shape="rect" title=" " alt="" coords="5,1173,224,1229"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a566493380f42cdfb19e24266739ff031" title=" " alt="" coords="568,1234,786,1290"/>
<area shape="poly" title=" " alt="" coords="224,1202,352,1210,490,1224,552,1233,552,1239,490,1229,352,1215,224,1207"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aaba558f18992f23fda573e138df49ac6" title=" " alt="" coords="272,1238,490,1294"/>
<area shape="poly" title=" " alt="" coords="225,1225,257,1233,256,1238,224,1230"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7744e2572fb3fa78b3ff0f99baa1a208" title=" " alt="" coords="272,1014,490,1070"/>
<area shape="poly" title=" " alt="" coords="162,1170,318,1076,321,1081,164,1175"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="870,952,1103,993"/>
<area shape="poly" title=" " alt="" coords="738,1232,779,1205,813,1170,826,1148,832,1126,833,1085,836,1044,845,1024,861,1003,864,1001,868,1004,865,1007,850,1026,842,1045,838,1085,837,1127,831,1150,817,1173,782,1209,741,1236"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="863,1017,1110,1073"/>
<area shape="poly" title=" " alt="" coords="721,1232,814,1169,935,1080,938,1084,817,1174,724,1236"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="889,1176,1084,1217"/>
<area shape="poly" title=" " alt="" coords="786,1237,873,1218,874,1223,787,1242"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="863,1242,1110,1282"/>
<area shape="poly" title=" " alt="" coords="786,1260,848,1260,848,1265,786,1265"/>
<area shape="poly" title=" " alt="" coords="396,1012,418,977,450,937,490,899,537,870,612,845,644,840,675,839,738,850,816,870,854,884,889,902,949,941,947,945,887,906,851,889,815,875,737,855,674,845,644,845,613,850,539,875,493,904,454,941,423,981,400,1015"/>
<area shape="poly" title=" " alt="" coords="403,1012,459,957,496,929,537,909,615,882,648,873,680,869,712,870,745,876,779,889,817,909,829,919,837,931,844,955,849,980,855,992,865,1003,869,1006,866,1010,861,1007,851,995,844,982,838,957,832,933,825,923,814,914,777,894,743,881,712,875,681,874,649,879,616,887,539,914,499,934,462,961,406,1016"/>
<area shape="poly" title=" " alt="" coords="408,1068,464,1123,500,1149,539,1169,624,1194,712,1206,797,1209,873,1207,874,1212,797,1215,711,1211,622,1199,537,1174,497,1153,460,1127,404,1072"/>
<area shape="poly" title=" " alt="" coords="401,1069,483,1209,540,1300,587,1320,638,1332,690,1335,743,1332,794,1324,842,1312,923,1286,925,1291,843,1318,795,1329,743,1337,690,1340,637,1337,585,1325,536,1304,478,1212,396,1072"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="558,758,795,798"/>
<area shape="poly" title=" " alt="" coords="392,1013,413,969,444,915,486,861,510,836,536,815,556,803,558,808,540,819,514,840,490,865,449,918,418,971,396,1015"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="538,988,815,1029"/>
<area shape="poly" title=" " alt="" coords="490,1027,522,1024,523,1029,491,1032"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="542,1119,811,1160"/>
<area shape="poly" title=" " alt="" coords="446,1068,539,1104,567,1112,565,1117,537,1109,444,1073"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="552,923,801,964"/>
<area shape="poly" title=" " alt="" coords="443,1011,537,974,565,966,567,971,539,979,444,1016"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="550,1054,803,1094"/>
<area shape="poly" title=" " alt="" coords="491,1051,535,1056,534,1061,490,1057"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a034e9845c4b368946f9336a4a029b568" title=" " alt="" coords="868,758,1105,798"/>
<area shape="poly" title=" " alt="" coords="796,776,853,776,853,781,796,781"/>
<area shape="rect" href="classabsl_1_1any.html#ac0db0b7b1d417778376dbca6f5604ae5" title=" " alt="" coords="1231,5,1342,31"/>
<area shape="poly" title=" " alt="" coords="987,757,1002,614,1035,398,1057,286,1085,183,1118,98,1136,66,1156,42,1183,24,1215,15,1216,21,1186,29,1159,45,1140,69,1123,101,1090,184,1063,287,1040,399,1008,615,992,758"/>
<area shape="rect" href="classabsl_1_1bernoulli__distribution.html#a2ab61e1795ae631e6a0d598b3b450a08" title=" " alt="" coords="1201,55,1372,96"/>
<area shape="poly" title=" " alt="" coords="988,757,1006,626,1040,430,1063,329,1090,236,1121,159,1138,129,1156,107,1185,88,1188,92,1159,111,1142,132,1126,161,1095,237,1069,330,1045,431,1011,627,993,758"/>
<area shape="rect" href="classabsl_1_1beta__distribution.html#aab4ba94645bb1320e5626edbd622e3ae" title=" " alt="" coords="1212,120,1360,161"/>
<area shape="poly" title=" " alt="" coords="988,757,1008,637,1044,461,1068,370,1094,287,1124,219,1139,192,1156,172,1175,158,1196,149,1198,153,1177,163,1160,176,1144,195,1128,221,1099,289,1073,372,1049,463,1013,638,993,758"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1node__handle__base.html#ac5bd468dbb0966e41568556bfb267ade" title=" " alt="" coords="1199,186,1374,226"/>
<area shape="poly" title=" " alt="" coords="985,757,990,664,998,597,1012,524,1033,447,1063,371,1103,300,1128,267,1156,237,1183,220,1186,224,1159,242,1132,271,1108,303,1068,373,1038,448,1017,525,1003,598,995,664,990,758"/>
<area shape="rect" href="classabsl_1_1discrete__distribution.html#a283404b8b036394800e2b7aa508a584c" title=" " alt="" coords="1202,251,1371,292"/>
<area shape="poly" title=" " alt="" coords="986,757,995,673,1005,615,1020,551,1041,484,1071,418,1108,356,1156,303,1185,284,1188,289,1159,307,1113,360,1075,420,1046,486,1025,552,1010,616,1000,674,991,758"/>
<area shape="rect" href="classabsl_1_1exponential__distribution.html#a9d46c5f69b2115771ccd679dabe84c8d" title=" " alt="" coords="1192,316,1381,357"/>
<area shape="poly" title=" " alt="" coords="987,757,1000,683,1028,578,1050,521,1078,465,1113,413,1156,368,1177,354,1180,359,1159,372,1117,417,1083,468,1055,524,1033,580,1005,685,993,758"/>
<area shape="rect" href="classabsl_1_1gaussian__distribution.html#a0eeca27ee347bed1e27672bf8ef66b92" title=" " alt="" coords="1199,382,1374,422"/>
<area shape="poly" title=" " alt="" coords="989,757,1005,694,1036,606,1059,559,1086,513,1118,470,1156,433,1183,417,1185,422,1159,438,1122,474,1090,516,1063,562,1041,608,1010,695,994,758"/>
<area shape="rect" href="classabsl_1_1log__uniform__int__distribution.html#a2ce353d92e45b1111fc30cac43274c14" title=" " alt="" coords="1216,447,1357,488"/>
<area shape="poly" title=" " alt="" coords="992,756,1012,704,1045,633,1093,560,1123,526,1156,497,1177,485,1200,476,1202,481,1179,490,1159,502,1126,530,1097,563,1050,636,1017,706,997,758"/>
<area shape="rect" href="classabsl_1_1optional.html#a8dfe8f9b4f502b6e94ca9fc3cc75a15f" title=" " alt="" coords="1219,512,1354,538"/>
<area shape="poly" title=" " alt="" coords="991,799,996,827,999,832,1003,834,1017,827,1036,808,1088,751,1120,719,1156,692,1194,674,1233,654,1250,639,1264,619,1275,590,1281,553,1286,554,1280,592,1269,621,1254,643,1236,658,1196,679,1159,696,1123,723,1091,754,1040,812,1020,831,1003,839,996,836,991,829,986,800"/>
<area shape="poly" title=" " alt="" coords="1062,756,1105,709,1156,668,1193,650,1232,633,1248,621,1263,604,1274,582,1281,553,1286,554,1279,584,1267,607,1252,625,1234,638,1196,655,1159,672,1108,713,1066,759"/>
<area shape="poly" title=" " alt="" coords="1043,756,1093,698,1123,669,1156,644,1192,627,1230,612,1247,603,1261,590,1272,574,1280,552,1285,554,1277,576,1265,594,1250,607,1232,617,1195,632,1159,648,1126,673,1097,701,1047,759"/>
<area shape="poly" title=" " alt="" coords="1027,756,1081,686,1116,651,1156,620,1191,604,1227,591,1258,576,1269,565,1278,551,1282,554,1273,569,1261,580,1229,596,1193,609,1159,624,1120,655,1085,690,1031,759"/>
<area shape="poly" title=" " alt="" coords="1013,756,1070,676,1110,633,1156,596,1187,581,1220,571,1250,561,1273,548,1275,553,1252,566,1222,576,1189,586,1159,600,1114,637,1075,679,1017,759"/>
<area shape="poly" title=" " alt="" coords="1002,756,1026,716,1060,666,1104,615,1129,592,1156,572,1181,560,1208,551,1257,540,1258,545,1209,556,1183,565,1159,576,1132,596,1108,618,1065,669,1031,719,1007,759"/>
<area shape="poly" title=" " alt="" coords="994,756,1017,712,1052,655,1098,597,1126,570,1156,548,1179,537,1203,529,1204,534,1181,542,1159,552,1129,574,1102,600,1056,658,1021,715,999,759"/>
<area shape="poly" title=" " alt="" coords="990,756,1010,706,1045,642,1094,577,1124,548,1156,524,1182,512,1209,505,1236,502,1259,504,1259,510,1236,508,1210,510,1184,517,1159,528,1127,552,1098,581,1050,645,1015,709,995,758"/>
<area shape="poly" title=" " alt="" coords="988,757,1006,698,1041,627,1064,591,1091,557,1122,526,1156,500,1188,486,1222,480,1253,484,1276,497,1273,502,1251,489,1222,486,1190,491,1159,504,1126,530,1095,560,1069,594,1046,630,1011,700,993,758"/>
<area shape="poly" title=" " alt="" coords="987,757,1004,688,1038,610,1062,571,1090,535,1121,503,1156,476,1191,461,1228,458,1245,462,1261,469,1273,480,1282,495,1278,498,1269,484,1258,474,1244,467,1227,464,1192,466,1159,480,1125,507,1094,538,1066,574,1043,613,1009,690,992,758"/>
<area shape="poly" title=" " alt="" coords="986,757,992,719,1002,677,1017,635,1036,592,1060,551,1088,513,1120,479,1156,452,1193,437,1212,435,1232,437,1249,443,1265,455,1277,473,1285,495,1280,497,1272,475,1261,459,1247,448,1230,442,1212,440,1194,442,1159,456,1124,483,1092,516,1065,554,1041,594,1022,637,1007,679,997,720,991,758"/>
<area shape="poly" title=" " alt="" coords="986,757,991,712,1001,665,1016,618,1035,573,1059,529,1088,490,1120,456,1156,428,1194,413,1214,412,1234,416,1252,425,1267,442,1279,465,1286,496,1281,498,1274,467,1263,445,1249,430,1232,421,1214,417,1195,418,1159,432,1124,460,1092,493,1064,532,1040,575,1021,620,1006,667,996,713,991,758"/>
<area shape="poly" title=" " alt="" coords="986,757,990,705,1000,653,1015,602,1035,553,1059,508,1087,467,1120,432,1156,404,1175,395,1195,389,1215,389,1235,395,1253,407,1269,428,1280,457,1286,496,1281,497,1275,459,1264,430,1250,411,1233,399,1215,394,1195,394,1177,400,1159,408,1123,436,1091,470,1063,510,1039,555,1020,603,1005,654,996,706,991,758"/>
<area shape="rect" href="classabsl_1_1poisson__distribution.html#ab0710bb9dabd8b673663d6721aed099a" title=" " alt="" coords="1202,562,1370,602"/>
<area shape="poly" title=" " alt="" coords="1002,755,1064,685,1108,646,1156,613,1186,600,1189,605,1159,618,1111,651,1068,689,1006,759"/>
<area shape="rect" href="classabsl_1_1random__internal_1_1sequence__urbg.html#a99fa9a5c36e514966a1d0e637768f204" title=" " alt="" coords="1209,627,1364,668"/>
<area shape="poly" title=" " alt="" coords="1017,755,1080,716,1157,678,1193,666,1195,671,1159,683,1083,721,1020,760"/>
<area shape="rect" href="classabsl_1_1uniform__int__distribution.html#a17e835faa5e38003db98c77e3278d4a9" title=" " alt="" coords="1193,692,1380,733"/>
<area shape="poly" title=" " alt="" coords="1083,755,1177,734,1178,739,1084,760"/>
<area shape="rect" href="classabsl_1_1uniform__real__distribution.html#abe4e75a5e009149340657b70d378fb0c" title=" " alt="" coords="1222,758,1350,798"/>
<area shape="poly" title=" " alt="" coords="1106,784,1206,784,1206,789,1106,790"/>
<area shape="poly" title=" " alt="" coords="1106,767,1206,767,1206,773,1106,772"/>
<area shape="rect" href="classabsl_1_1zipf__distribution.html#a88595f1f987de7cfcef5d81328d088e5" title=" " alt="" coords="1214,823,1358,864"/>
<area shape="poly" title=" " alt="" coords="1084,797,1200,822,1199,827,1083,802"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#ade6fd5284ee62f16e86c96b5f7ab344d" title=" " alt="" coords="1198,888,1374,929"/>
<area shape="poly" title=" " alt="" coords="1020,797,1083,835,1159,873,1184,882,1182,887,1157,878,1080,840,1017,801"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a1f008db92b4d0d747746b74c52640545" title=" " alt="" coords="1172,954,1401,994"/>
<area shape="poly" title=" " alt="" coords="1006,797,1068,867,1111,906,1159,939,1172,945,1170,950,1156,943,1108,910,1064,871,1002,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#aebc4c2690cbd5350976c463c39794650" title=" " alt="" coords="1168,1019,1405,1060"/>
<area shape="poly" title=" " alt="" coords="1005,797,1112,939,1133,975,1143,990,1159,1004,1169,1010,1166,1014,1156,1008,1139,993,1128,978,1107,942,1001,800"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1catch_1_1_environment.html#a0d19f39c580c7fbb77f691a3b85d696d" title=" " alt="" coords="1162,1084,1410,1125"/>
<area shape="poly" title=" " alt="" coords="1009,797,1059,859,1087,898,1112,940,1126,978,1130,1010,1137,1040,1146,1055,1160,1070,1164,1073,1161,1077,1156,1073,1142,1058,1133,1042,1125,1011,1121,979,1107,942,1082,901,1054,862,1004,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1cliff__walking_1_1_environment.html#af48d9954f8071a2d7209bc191d5d9aa4" title=" " alt="" coords="1170,1150,1403,1190"/>
<area shape="poly" title=" " alt="" coords="1010,797,1061,858,1089,898,1112,940,1123,969,1127,996,1127,1045,1128,1068,1132,1090,1141,1112,1160,1135,1164,1139,1160,1143,1156,1139,1137,1115,1126,1091,1122,1068,1122,1045,1122,997,1118,971,1107,942,1084,900,1057,861,1006,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1iterated__matrix__game_1_1_iterated_matrix_game.html#a7c617ff68dbece5f2f407453544db0ac" title=" " alt="" coords="1159,1215,1414,1256"/>
<area shape="poly" title=" " alt="" coords="1010,797,1062,858,1089,897,1112,940,1125,979,1128,1015,1124,1080,1122,1110,1126,1139,1137,1169,1160,1200,1163,1204,1159,1208,1156,1204,1132,1172,1120,1141,1117,1110,1119,1079,1123,1015,1119,980,1107,942,1085,900,1058,861,1006,800"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1atari_1_1_noop_reset_env.html#ac02beff549203ee5de49b1b30a0b2607" title=" " alt="" coords="1185,1304,1388,1345"/>
<area shape="poly" title=" " alt="" coords="1011,797,1063,858,1090,897,1112,940,1127,988,1131,1033,1124,1111,1121,1148,1123,1186,1135,1224,1160,1266,1175,1282,1195,1295,1192,1299,1172,1286,1156,1269,1130,1226,1118,1187,1116,1148,1119,1111,1126,1033,1122,989,1107,942,1086,900,1059,861,1007,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1chat__games_1_1utils_1_1logging__utils_1_1_color_text.html#a6ecef6232f846a4641a2a52f6b645d45" title=" " alt="" coords="1183,1369,1390,1425"/>
<area shape="poly" title=" " alt="" coords="1011,797,1064,857,1091,897,1112,940,1122,980,1126,1032,1127,1154,1128,1216,1133,1273,1143,1321,1160,1355,1172,1367,1168,1371,1156,1358,1137,1323,1127,1274,1123,1217,1122,1154,1121,1032,1117,981,1107,942,1086,900,1059,861,1007,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a893f29582436b18cf75acab03bf9a0f6" title=" " alt="" coords="1158,1448,1415,1489"/>
<area shape="poly" title=" " alt="" coords="1012,797,1064,857,1091,897,1112,940,1123,988,1127,1050,1124,1196,1124,1270,1128,1338,1139,1395,1148,1417,1160,1435,1160,1436,1156,1439,1156,1438,1143,1420,1134,1396,1123,1339,1119,1270,1119,1196,1121,1050,1118,989,1107,942,1086,900,1060,861,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_regret_minimizer.html#a5e7d042c062cd5060dbc72e3e209a019" title=" " alt="" coords="1159,1514,1414,1554"/>
<area shape="poly" title=" " alt="" coords="1012,797,1064,857,1091,897,1112,940,1124,994,1127,1064,1123,1229,1122,1312,1125,1389,1137,1453,1147,1479,1160,1499,1162,1502,1158,1505,1156,1502,1142,1481,1132,1455,1120,1390,1116,1312,1118,1229,1122,1064,1119,995,1107,942,1086,900,1060,861,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_m_l_p.html#ae91f4f3690f3b77d4e81a07f2459e7b0" title=" " alt="" coords="1184,1579,1389,1620"/>
<area shape="poly" title=" " alt="" coords="1012,797,1064,857,1091,897,1112,940,1120,968,1125,1001,1128,1079,1121,1262,1119,1356,1122,1441,1135,1513,1145,1542,1160,1564,1172,1576,1168,1580,1156,1568,1141,1544,1129,1515,1117,1442,1113,1356,1116,1262,1123,1079,1119,1001,1115,969,1107,942,1087,900,1060,860,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_sonnet_linear.html#a93a986c411cf799e0bce4ac540bb2f8d" title=" " alt="" coords="1184,1644,1389,1685"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1091,897,1112,940,1121,971,1126,1007,1129,1093,1120,1296,1116,1399,1119,1494,1124,1536,1132,1573,1144,1605,1160,1630,1172,1641,1168,1645,1156,1633,1139,1607,1127,1574,1119,1537,1114,1494,1111,1399,1114,1296,1123,1093,1120,1007,1115,972,1107,942,1087,899,1060,860,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html#a26dbd83ee35fa2014b86b34fcb5bb292" title=" " alt="" coords="1182,1710,1391,1750"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1091,897,1112,940,1121,973,1127,1013,1129,1107,1118,1329,1113,1442,1116,1546,1121,1592,1130,1633,1143,1667,1160,1695,1170,1706,1167,1709,1156,1699,1138,1670,1125,1634,1116,1593,1111,1546,1108,1442,1113,1329,1124,1107,1121,1014,1116,974,1107,942,1087,899,1060,860,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1replay__buffer_1_1_replay_buffer.html#aff43350cf33a3bd8a628b204947eea23" title=" " alt="" coords="1190,1775,1383,1816"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1091,897,1112,940,1121,998,1125,1095,1126,1357,1128,1494,1133,1616,1143,1710,1150,1741,1160,1761,1178,1776,1174,1780,1156,1764,1145,1743,1138,1711,1127,1616,1123,1494,1121,1357,1120,1096,1116,998,1107,942,1087,899,1060,860,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_basic_stats.html#a2d62de15dda65996427a13c750917ef1" title=" " alt="" coords="1191,1840,1382,1881"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1121,1002,1125,1108,1126,1390,1127,1538,1131,1670,1142,1771,1150,1805,1160,1826,1179,1842,1175,1846,1156,1829,1145,1807,1136,1772,1126,1670,1121,1538,1120,1390,1120,1108,1116,1003,1107,942,1087,899,1061,860,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_histogram_named.html#a196d986bfd256a0483346e7c9bc3570d" title=" " alt="" coords="1191,1906,1382,1946"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1122,1007,1126,1120,1125,1423,1125,1582,1130,1723,1141,1832,1149,1869,1160,1891,1179,1907,1175,1911,1156,1894,1144,1871,1135,1833,1124,1724,1120,1582,1119,1423,1120,1120,1117,1007,1107,942,1087,899,1061,860,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_histogram_numbered.html#a40c772fe8abdf0bf861aed012967ad1d" title=" " alt="" coords="1191,1971,1382,2012"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1118,968,1122,1011,1126,1132,1124,1456,1124,1626,1128,1777,1139,1893,1148,1933,1160,1957,1179,1973,1175,1977,1156,1960,1143,1934,1134,1894,1123,1777,1119,1626,1119,1456,1121,1132,1117,1012,1113,969,1107,942,1087,899,1061,860,1008,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1vector__env_1_1_sync_vector_env.html#ab77b6f9ba60cebde2df6744d93041d01" title=" " alt="" coords="1200,2060,1373,2101"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1119,970,1123,1016,1127,1144,1126,1487,1126,1667,1130,1828,1141,1953,1149,1995,1160,2022,1174,2038,1191,2051,1188,2055,1170,2042,1155,2025,1144,1997,1135,1953,1125,1828,1121,1667,1121,1487,1122,1144,1118,1016,1114,971,1107,942,1087,899,1061,860,1008,801"/>
<area shape="rect" href="structopen__spiel_1_1go_1_1_go_board_1_1_chain.html#a6908f66d9880b5877c13b64c62f81b39" title=" " alt="" coords="1204,2126,1368,2166"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1119,973,1124,1022,1127,1161,1122,1535,1121,1730,1124,1904,1137,2038,1147,2083,1160,2111,1174,2124,1191,2134,1188,2138,1171,2129,1156,2114,1142,2085,1131,2039,1119,1904,1115,1730,1117,1535,1121,1161,1118,1022,1114,974,1107,942,1087,899,1061,860,1008,801"/>
<area shape="rect" href="structopen__spiel_1_1phantom__go_1_1_phantom_go_board_1_1_chain.html#aa49a6bb32fa96aad95910ff1f5dc4368" title=" " alt="" coords="1210,2190,1363,2246"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1120,975,1124,1027,1127,1173,1122,1567,1121,1773,1124,1957,1136,2099,1146,2147,1160,2177,1176,2192,1196,2203,1194,2208,1173,2196,1155,2180,1141,2149,1131,2099,1119,1957,1115,1773,1117,1567,1122,1174,1119,1027,1114,975,1107,942,1087,899,1061,860,1008,801"/>
<area shape="rect" href="classpolynomial__weights_1_1_polynomial_weight_algorithm.html#a4e4380fac08b696bd90ded379986bef7" title=" " alt="" coords="1185,2270,1388,2310"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1120,977,1125,1032,1127,1189,1120,1609,1118,1828,1121,2024,1126,2106,1134,2174,1145,2225,1160,2257,1173,2269,1169,2273,1156,2260,1140,2227,1129,2175,1121,2106,1115,2024,1112,1828,1115,1609,1122,1189,1119,1033,1115,978,1107,942,1087,899,1061,860,1008,801"/>
<area shape="rect" href="classregret__matching_1_1_regret_matching.html#ae6a44161aec5eaa1c79a10f4285ff509" title=" " alt="" coords="1165,2335,1408,2360"/>
<area shape="poly" title=" " alt="" coords="1012,797,1065,857,1092,897,1112,940,1120,979,1125,1037,1127,1201,1118,1642,1115,1872,1118,2077,1123,2163,1132,2235,1144,2288,1160,2321,1162,2323,1158,2326,1155,2324,1139,2290,1127,2236,1118,2164,1113,2077,1110,1872,1113,1642,1122,1201,1120,1037,1115,979,1107,942,1087,899,1061,860,1008,801"/>
<area shape="poly" title=" " alt="" coords="1231,1305,1228,1294,1237,1285,1257,1280,1286,1278,1318,1280,1337,1286,1336,1291,1317,1285,1286,1283,1257,1285,1240,1290,1233,1296,1236,1303"/>
<area shape="poly" title=" " alt="" coords="1231,2061,1228,2050,1237,2041,1257,2036,1286,2034,1318,2036,1337,2042,1336,2047,1317,2041,1286,2039,1257,2041,1240,2046,1233,2052,1236,2059"/>
<area shape="poly" title=" " alt="" coords="816,990,854,986,855,991,816,995"/>
<area shape="poly" title=" " alt="" coords="816,1022,848,1026,848,1031,816,1028"/>
<area shape="poly" title=" " alt="" coords="788,1027,817,1040,954,1164,950,1168,814,1044,786,1032"/>
<area shape="poly" title=" " alt="" coords="801,1027,817,1040,835,1064,843,1088,844,1112,842,1135,840,1159,842,1182,849,1205,865,1227,869,1230,865,1234,861,1231,844,1207,836,1183,835,1159,837,1135,839,1112,837,1089,830,1066,813,1044,797,1032"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7b25c7de236284a0d59c11efddea26b1_icgraph">
<area shape="rect" title=" " alt="" coords="1442,287,1660,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="poly" title=" " alt="" coords="1426,317,1395,317,1395,312,1426,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a566493380f42cdfb19e24266739ff031" name="a566493380f42cdfb19e24266739ff031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a566493380f42cdfb19e24266739ff031">&#9670;&#160;</a></span>_update_critic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_critic </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l01029">1029</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1029</span>  <span class="keyword">def </span>_update_critic(self, batch: TransitionBatch):</div>
<div class="line"><span class="lineno"> 1030</span>    self._train_state, metrics = self._critic_update_fns[self.player_id](</div>
<div class="line"><span class="lineno"> 1031</span>        self._train_state, batch</div>
<div class="line"><span class="lineno"> 1032</span>    )</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno"> 1034</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00700">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_update_fns</a>, <a class="el" href="opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_cgraph">
<area shape="rect" title=" " alt="" coords="5,106,224,162"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="278,5,512,46"/>
<area shape="poly" title=" " alt="" coords="167,103,216,78,271,55,290,48,292,54,273,60,219,83,169,108"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="272,70,518,126"/>
<area shape="poly" title=" " alt="" coords="224,117,256,113,257,118,224,122"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="297,149,492,190"/>
<area shape="poly" title=" " alt="" coords="224,145,282,152,281,158,224,150"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="272,215,518,255"/>
<area shape="poly" title=" " alt="" coords="176,160,273,199,297,207,295,212,271,204,174,165"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a566493380f42cdfb19e24266739ff031_icgraph">
<area shape="rect" title=" " alt="" coords="1708,287,1927,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="1442,287,1660,342"/>
<area shape="poly" title=" " alt="" coords="1693,317,1661,317,1661,312,1693,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="poly" title=" " alt="" coords="1426,317,1395,317,1395,312,1426,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="aaba558f18992f23fda573e138df49ac6" name="aaba558f18992f23fda573e138df49ac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaba558f18992f23fda573e138df49ac6">&#9670;&#160;</a></span>_update_opponents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l01035">1035</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1035</span>  <span class="keyword">def </span>_update_opponents(self, batch: TransitionBatch):</div>
<div class="line"><span class="lineno"> 1036</span>    update_metrics = {}</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">for</span> opponent <span class="keywordflow">in</span> self._opponent_ids:</div>
<div class="line"><span class="lineno"> 1038</span>      self._train_state, metrics = self._critic_update_fns[opponent](</div>
<div class="line"><span class="lineno"> 1039</span>          self._train_state, batch</div>
<div class="line"><span class="lineno"> 1040</span>      )</div>
<div class="line"><span class="lineno"> 1041</span>      update_metrics.update(</div>
<div class="line"><span class="lineno"> 1042</span>          {f<span class="stringliteral">&#39;agent_{opponent}/critic/{k}&#39;</span>: v <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> metrics.items()}</div>
<div class="line"><span class="lineno"> 1043</span>      )</div>
<div class="line"><span class="lineno"> 1044</span>      self._train_state, metrics = self._policy_update_fns[opponent](</div>
<div class="line"><span class="lineno"> 1045</span>          self._train_state, batch</div>
<div class="line"><span class="lineno"> 1046</span>      )</div>
<div class="line"><span class="lineno"> 1047</span>      update_metrics.update(</div>
<div class="line"><span class="lineno"> 1048</span>          {f<span class="stringliteral">&#39;agent_{opponent}/policy/{k}&#39;</span>: v <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> metrics.items()}</div>
<div class="line"><span class="lineno"> 1049</span>      )</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">return</span> update_metrics</div>
<div class="line"><span class="lineno"> 1051</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00700">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_update_fns</a>, <a class="el" href="opponent__shaping_8py_source.html#l00643">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_ids</a>, <a class="el" href="opponent__shaping_8py_source.html#l00699">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_fns</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_aaba558f18992f23fda573e138df49ac6_icgraph">
<area shape="rect" title=" " alt="" coords="1708,287,1927,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="1442,287,1660,342"/>
<area shape="poly" title=" " alt="" coords="1693,317,1661,317,1661,312,1693,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="poly" title=" " alt="" coords="1426,317,1395,317,1395,312,1426,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a7744e2572fb3fa78b3ff0f99baa1a208" name="a7744e2572fb3fa78b3ff0f99baa1a208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7744e2572fb3fa78b3ff0f99baa1a208">&#9670;&#160;</a></span>_update_policy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_transition_batch.html">TransitionBatch</a></td>          <td class="paramname"><span class="paramname"><em>batch</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l01022">1022</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1022</span>  <span class="keyword">def </span>_update_policy(self, batch: TransitionBatch):</div>
<div class="line"><span class="lineno"> 1023</span>    self._train_state, metrics = self._policy_update_fns[self.player_id](</div>
<div class="line"><span class="lineno"> 1024</span>        self._train_state, batch</div>
<div class="line"><span class="lineno"> 1025</span>    )</div>
<div class="line"><span class="lineno"> 1026</span>    self._current_policy = self.get_policy(return_probs=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno"> 1028</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2cfr_8py_source.html#l00430">open_spiel.python.algorithms.cfr._CFRSolver._current_policy</a>, <a class="el" href="algorithms_2cfr_8py_source.html#l00165">open_spiel.python.algorithms.cfr._CFRSolverBase._current_policy</a>, <a class="el" href="cfr__br_8py_source.html#l00134">open_spiel.python.algorithms.cfr_br.CFRBRSolver._current_policy</a>, <a class="el" href="algorithms_2discounted__cfr_8py_source.html#l00209">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._current_policy</a>, <a class="el" href="efr_8py_source.html#l00434">open_spiel.python.algorithms.efr._EFRSolver._current_policy</a>, <a class="el" href="efr_8py_source.html#l00109">open_spiel.python.algorithms.efr._EFRSolverBase._current_policy</a>, <a class="el" href="opponent__shaping_8py_source.html#l00662">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._current_policy</a>, <a class="el" href="opponent__shaping_8py_source.html#l00699">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_fns</a>, <a class="el" href="opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>, <a class="el" href="ismcts_8py_source.html#l00145">open_spiel.python.algorithms.ismcts.ISMCTSBot.get_policy()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, <a class="el" href="mfg_2algorithms_2fictitious__play_8py_source.html#l00136">open_spiel.python.mfg.algorithms.fictitious_play.FictitiousPlay.get_policy()</a>, <a class="el" href="fixed__point_8py_source.html#l00072">open_spiel.python.mfg.algorithms.fixed_point.FixedPoint.get_policy()</a>, <a class="el" href="mirror__descent_8py_source.html#l00166">open_spiel.python.mfg.algorithms.mirror_descent.MirrorDescent.get_policy()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_cgraph">
<area shape="rect" title=" " alt="" coords="5,974,224,1030"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="292,758,529,798"/>
<area shape="poly" title=" " alt="" coords="130,973,153,937,186,895,225,852,270,816,295,802,298,807,273,820,229,856,190,898,158,940,134,975"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="272,924,549,965"/>
<area shape="poly" title=" " alt="" coords="224,978,287,966,288,971,225,984"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="604,823,837,864"/>
<area shape="poly" title=" " alt="" coords="141,972,197,923,233,900,271,881,350,857,433,842,514,835,588,834,588,839,515,841,434,848,352,862,273,886,235,904,200,928,144,976"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="597,888,843,943"/>
<area shape="poly" title=" " alt="" coords="151,972,205,937,238,922,271,910,350,895,431,889,509,889,582,894,581,899,509,894,431,894,351,900,272,915,240,927,208,942,154,976"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="622,967,818,1008"/>
<area shape="poly" title=" " alt="" coords="224,997,607,988,607,993,224,1002"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="597,1032,843,1073"/>
<area shape="poly" title=" " alt="" coords="224,1009,582,1039,581,1044,224,1014"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="276,1090,545,1130"/>
<area shape="poly" title=" " alt="" coords="175,1028,273,1069,314,1082,312,1087,271,1074,173,1033"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="286,1155,534,1196"/>
<area shape="poly" title=" " alt="" coords="141,1028,198,1086,234,1115,273,1140,287,1147,285,1151,270,1145,231,1119,194,1090,137,1032"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="284,1220,537,1261"/>
<area shape="poly" title=" " alt="" coords="131,1029,154,1069,185,1117,225,1165,273,1205,283,1211,280,1216,270,1210,221,1169,181,1120,149,1072,127,1032"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a034e9845c4b368946f9336a4a029b568" title=" " alt="" coords="602,758,839,798"/>
<area shape="poly" title=" " alt="" coords="530,776,586,776,586,781,530,781"/>
<area shape="rect" href="classabsl_1_1any.html#ac0db0b7b1d417778376dbca6f5604ae5" title=" " alt="" coords="964,5,1076,31"/>
<area shape="poly" title=" " alt="" coords="721,757,736,614,768,398,791,286,819,183,851,98,870,66,890,42,917,24,948,15,950,21,919,29,893,45,874,69,856,101,824,184,796,287,773,399,741,615,726,758"/>
<area shape="rect" href="classabsl_1_1bernoulli__distribution.html#a2ab61e1795ae631e6a0d598b3b450a08" title=" " alt="" coords="934,55,1106,96"/>
<area shape="poly" title=" " alt="" coords="721,757,739,626,774,430,797,329,824,236,855,159,872,129,890,107,918,88,921,92,893,111,876,132,860,161,829,237,802,330,779,431,745,627,727,758"/>
<area shape="rect" href="classabsl_1_1beta__distribution.html#aab4ba94645bb1320e5626edbd622e3ae" title=" " alt="" coords="946,120,1094,161"/>
<area shape="poly" title=" " alt="" coords="722,757,742,637,778,461,801,370,828,287,857,219,873,192,889,172,908,158,930,149,932,153,911,163,893,176,877,195,862,221,833,289,807,372,783,463,747,638,727,758"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1node__handle__base.html#ac5bd468dbb0966e41568556bfb267ade" title=" " alt="" coords="933,186,1107,226"/>
<area shape="poly" title=" " alt="" coords="719,757,724,664,732,597,746,524,767,447,797,371,837,300,862,267,890,237,917,220,920,224,893,242,866,271,842,303,802,373,772,448,751,525,737,598,729,664,724,758"/>
<area shape="rect" href="classabsl_1_1discrete__distribution.html#a283404b8b036394800e2b7aa508a584c" title=" " alt="" coords="935,251,1105,292"/>
<area shape="poly" title=" " alt="" coords="720,757,728,673,738,615,754,551,775,484,804,418,842,356,890,303,919,284,922,289,893,307,846,360,809,420,780,486,759,552,744,616,734,674,725,758"/>
<area shape="rect" href="classabsl_1_1exponential__distribution.html#a9d46c5f69b2115771ccd679dabe84c8d" title=" " alt="" coords="925,316,1115,357"/>
<area shape="poly" title=" " alt="" coords="721,757,733,683,762,578,784,521,812,465,847,413,890,368,910,354,913,359,893,372,851,417,816,468,788,524,767,580,739,685,726,758"/>
<area shape="rect" href="classabsl_1_1gaussian__distribution.html#a0eeca27ee347bed1e27672bf8ef66b92" title=" " alt="" coords="932,382,1108,422"/>
<area shape="poly" title=" " alt="" coords="723,757,739,694,770,606,792,559,819,513,852,470,890,433,916,417,919,422,893,438,856,474,824,516,797,562,775,608,744,695,728,758"/>
<area shape="rect" href="classabsl_1_1log__uniform__int__distribution.html#a2ce353d92e45b1111fc30cac43274c14" title=" " alt="" coords="949,447,1091,488"/>
<area shape="poly" title=" " alt="" coords="726,756,745,704,779,633,827,560,856,526,890,497,911,485,933,476,935,481,913,490,893,502,860,530,831,563,784,636,750,706,731,758"/>
<area shape="rect" href="classabsl_1_1optional.html#a8dfe8f9b4f502b6e94ca9fc3cc75a15f" title=" " alt="" coords="952,512,1088,538"/>
<area shape="poly" title=" " alt="" coords="725,799,730,827,733,832,737,834,750,827,769,808,821,751,854,719,890,692,928,674,966,654,983,639,998,619,1009,590,1015,553,1020,554,1014,592,1002,621,987,643,969,658,930,679,893,696,857,723,825,754,773,812,753,831,737,839,730,836,725,829,719,800"/>
<area shape="poly" title=" " alt="" coords="796,756,838,709,890,668,927,650,965,633,982,621,997,604,1008,582,1014,553,1020,554,1013,584,1001,607,986,625,968,638,929,655,893,672,842,713,799,759"/>
<area shape="poly" title=" " alt="" coords="777,756,827,698,857,669,890,644,926,627,963,612,980,603,995,590,1006,574,1013,552,1018,554,1011,576,999,594,983,607,966,617,928,632,893,648,860,673,830,701,781,759"/>
<area shape="poly" title=" " alt="" coords="761,756,815,686,850,651,890,620,924,604,960,591,991,576,1003,565,1011,551,1016,554,1007,569,994,580,962,596,926,609,893,624,854,655,819,690,765,759"/>
<area shape="poly" title=" " alt="" coords="747,756,804,676,844,633,890,596,921,581,954,571,984,561,1006,548,1009,553,986,566,956,576,923,586,893,600,847,637,808,679,751,759"/>
<area shape="poly" title=" " alt="" coords="736,756,760,716,794,666,838,615,863,592,890,572,915,560,942,551,991,540,992,545,943,556,917,565,893,576,866,596,841,618,798,669,764,719,740,759"/>
<area shape="poly" title=" " alt="" coords="728,756,750,712,785,655,832,597,860,570,890,548,912,537,936,529,938,534,914,542,893,552,863,574,836,600,790,658,755,715,733,759"/>
<area shape="poly" title=" " alt="" coords="724,756,744,706,779,642,828,577,857,548,890,524,916,512,943,505,970,502,993,504,993,510,970,508,944,510,917,517,893,528,861,552,832,581,783,645,749,709,729,758"/>
<area shape="poly" title=" " alt="" coords="721,757,740,698,775,627,798,591,825,557,856,526,890,500,922,486,955,480,987,484,1010,497,1007,502,985,489,956,486,923,491,893,504,859,530,829,560,802,594,779,630,745,700,727,758"/>
<area shape="poly" title=" " alt="" coords="720,757,737,688,772,610,796,571,823,535,855,503,890,476,925,461,961,458,979,462,994,469,1007,480,1016,495,1011,498,1003,484,991,474,977,467,961,464,926,466,893,480,858,507,827,538,800,574,777,613,742,690,726,758"/>
<area shape="poly" title=" " alt="" coords="720,757,725,719,736,677,751,635,770,592,794,551,822,513,854,479,890,452,926,437,946,435,965,437,983,443,999,455,1011,473,1018,495,1013,497,1006,475,995,459,980,448,964,442,946,440,928,442,893,456,858,483,826,516,798,554,775,594,756,637,741,679,730,720,725,758"/>
<area shape="poly" title=" " alt="" coords="719,757,725,712,735,665,750,618,769,573,793,529,821,490,854,456,890,428,928,413,948,412,968,416,986,425,1001,442,1013,465,1020,496,1014,498,1008,467,997,445,982,430,966,421,948,417,929,418,893,432,857,460,825,493,798,532,774,575,755,620,740,667,730,713,725,758"/>
<area shape="poly" title=" " alt="" coords="719,757,724,705,734,653,749,602,768,553,792,508,821,467,853,432,890,404,908,395,928,389,949,389,969,395,987,407,1002,428,1014,457,1020,496,1015,497,1009,459,998,430,983,411,967,399,948,394,929,394,910,400,893,408,857,436,825,470,797,510,773,555,754,603,739,654,729,706,725,758"/>
<area shape="rect" href="classabsl_1_1poisson__distribution.html#ab0710bb9dabd8b673663d6721aed099a" title=" " alt="" coords="936,562,1104,602"/>
<area shape="poly" title=" " alt="" coords="735,755,798,685,841,646,890,613,920,600,922,605,893,618,845,651,802,689,739,759"/>
<area shape="rect" href="classabsl_1_1random__internal_1_1sequence__urbg.html#a99fa9a5c36e514966a1d0e637768f204" title=" " alt="" coords="943,627,1097,668"/>
<area shape="poly" title=" " alt="" coords="751,755,814,716,890,678,927,666,929,671,892,683,816,721,754,760"/>
<area shape="rect" href="classabsl_1_1uniform__int__distribution.html#a17e835faa5e38003db98c77e3278d4a9" title=" " alt="" coords="926,692,1114,733"/>
<area shape="poly" title=" " alt="" coords="816,755,910,734,912,739,817,760"/>
<area shape="rect" href="classabsl_1_1uniform__real__distribution.html#abe4e75a5e009149340657b70d378fb0c" title=" " alt="" coords="956,758,1084,798"/>
<area shape="poly" title=" " alt="" coords="839,784,940,784,940,789,839,790"/>
<area shape="poly" title=" " alt="" coords="839,767,940,767,940,773,839,772"/>
<area shape="rect" href="classabsl_1_1zipf__distribution.html#a88595f1f987de7cfcef5d81328d088e5" title=" " alt="" coords="948,823,1092,864"/>
<area shape="poly" title=" " alt="" coords="817,797,933,822,932,827,816,802"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#ade6fd5284ee62f16e86c96b5f7ab344d" title=" " alt="" coords="932,888,1108,929"/>
<area shape="poly" title=" " alt="" coords="822,797,845,809,861,826,870,842,878,858,893,873,919,887,917,892,890,878,873,862,865,845,857,829,842,814,819,801"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a1f008db92b4d0d747746b74c52640545" title=" " alt="" coords="905,954,1135,994"/>
<area shape="poly" title=" " alt="" coords="827,797,845,810,859,826,866,843,870,876,874,908,880,924,893,939,898,943,894,947,889,943,876,927,868,910,865,877,861,844,854,829,842,813,824,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#aebc4c2690cbd5350976c463c39794650" title=" " alt="" coords="901,1019,1139,1060"/>
<area shape="poly" title=" " alt="" coords="829,797,845,810,863,834,871,859,872,884,870,909,868,934,869,957,876,981,893,1004,897,1008,894,1012,889,1008,871,983,864,958,862,933,865,909,867,884,866,860,858,837,841,813,826,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1catch_1_1_environment.html#a0d19f39c580c7fbb77f691a3b85d696d" title=" " alt="" coords="896,1084,1144,1125"/>
<area shape="poly" title=" " alt="" coords="830,797,845,810,867,843,876,876,875,909,870,942,865,974,864,1006,872,1038,893,1070,897,1073,893,1077,889,1073,867,1040,859,1007,859,974,865,941,870,909,870,877,863,845,841,813,827,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1cliff__walking_1_1_environment.html#af48d9954f8071a2d7209bc191d5d9aa4" title=" " alt="" coords="903,1150,1137,1190"/>
<area shape="poly" title=" " alt="" coords="831,797,845,810,861,831,872,852,881,893,878,934,870,975,861,1015,859,1055,868,1095,878,1115,893,1135,896,1138,892,1142,889,1139,874,1118,863,1097,854,1056,856,1015,864,974,873,933,875,893,867,853,857,833,841,813,827,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1iterated__matrix__game_1_1_iterated_matrix_game.html#a7c617ff68dbece5f2f407453544db0ac" title=" " alt="" coords="892,1215,1148,1256"/>
<area shape="poly" title=" " alt="" coords="831,797,845,810,864,835,876,860,883,885,886,910,881,959,870,1008,858,1056,854,1104,857,1128,863,1152,875,1176,893,1200,896,1203,892,1207,889,1204,871,1179,858,1154,851,1129,849,1104,853,1055,864,1006,876,958,880,910,878,886,871,862,859,838,841,813,827,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1atari_1_1_noop_reset_env.html#ac02beff549203ee5de49b1b30a0b2607" title=" " alt="" coords="919,1304,1121,1345"/>
<area shape="poly" title=" " alt="" coords="831,797,845,810,867,839,881,868,889,897,892,925,888,981,875,1036,861,1092,855,1148,856,1177,863,1206,875,1236,893,1266,909,1282,927,1295,924,1299,905,1286,889,1269,870,1238,858,1208,851,1178,849,1148,856,1091,869,1035,882,980,887,925,884,898,876,870,862,842,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1chat__games_1_1utils_1_1logging__utils_1_1_color_text.html#a6ecef6232f846a4641a2a52f6b645d45" title=" " alt="" coords="917,1369,1123,1425"/>
<area shape="poly" title=" " alt="" coords="831,797,845,810,858,831,867,857,876,923,875,1000,871,1084,866,1167,865,1245,873,1309,882,1335,893,1355,905,1367,902,1371,889,1358,877,1337,868,1311,860,1245,861,1167,865,1083,870,1000,870,923,862,858,853,833,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a893f29582436b18cf75acab03bf9a0f6" title=" " alt="" coords="891,1448,1149,1489"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,860,834,870,864,878,939,876,1029,870,1125,863,1221,861,1309,870,1383,879,1412,893,1435,894,1436,890,1439,889,1438,875,1415,865,1384,856,1309,857,1220,864,1124,871,1028,873,940,865,865,855,836,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_regret_minimizer.html#a5e7d042c062cd5060dbc72e3e209a019" title=" " alt="" coords="892,1514,1148,1554"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,861,836,872,870,878,909,881,953,878,1051,870,1157,861,1262,859,1360,862,1403,868,1442,878,1474,893,1499,896,1502,892,1505,889,1502,873,1476,863,1443,856,1404,854,1360,856,1262,864,1156,873,1050,875,953,873,909,867,871,856,839,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_m_l_p.html#ae91f4f3690f3b77d4e81a07f2459e7b0" title=" " alt="" coords="917,1579,1123,1620"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,863,839,874,875,881,918,883,966,880,1073,870,1189,860,1305,856,1412,859,1459,866,1501,877,1537,893,1564,906,1576,902,1580,889,1568,872,1539,860,1502,854,1460,851,1412,855,1305,864,1189,874,1073,878,966,875,919,869,877,858,841,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_sonnet_linear.html#a93a986c411cf799e0bce4ac540bb2f8d" title=" " alt="" coords="917,1644,1123,1685"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,864,841,876,881,883,927,886,980,881,1096,870,1222,858,1348,854,1464,856,1515,863,1561,875,1599,893,1630,906,1641,902,1645,889,1633,871,1602,858,1562,851,1516,849,1464,853,1347,864,1221,876,1096,880,980,878,928,871,882,859,844,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html#a26dbd83ee35fa2014b86b34fcb5bb292" title=" " alt="" coords="915,1710,1125,1750"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,865,844,878,887,886,937,888,993,883,1119,870,1255,857,1390,851,1516,854,1571,861,1621,874,1662,893,1695,904,1706,900,1709,889,1698,869,1664,856,1622,849,1572,846,1516,851,1390,864,1254,877,1119,883,993,880,937,873,888,860,846,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1replay__buffer_1_1_replay_buffer.html#aff43350cf33a3bd8a628b204947eea23" title=" " alt="" coords="923,1775,1117,1816"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,867,846,881,892,888,946,891,1007,884,1142,870,1287,855,1433,849,1568,851,1627,859,1680,873,1725,893,1760,912,1776,908,1780,889,1764,868,1727,854,1682,846,1628,844,1568,850,1433,864,1287,879,1141,885,1007,883,947,875,894,862,849,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_basic_stats.html#a2d62de15dda65996427a13c750917ef1" title=" " alt="" coords="924,1840,1116,1881"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,868,849,883,898,891,955,893,1020,886,1164,870,1320,854,1476,846,1619,849,1683,857,1740,871,1788,893,1826,912,1842,909,1846,889,1829,866,1790,852,1741,844,1684,841,1619,848,1475,864,1320,880,1164,888,1020,885,956,878,899,863,851,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_histogram_named.html#a196d986bfd256a0483346e7c9bc3570d" title=" " alt="" coords="924,1906,1116,1946"/>
<area shape="poly" title=" " alt="" coords="832,797,846,810,858,837,866,881,875,1007,874,1170,870,1352,865,1534,865,1698,873,1823,882,1865,893,1891,912,1907,909,1911,889,1894,877,1867,868,1824,860,1698,860,1534,864,1352,869,1170,869,1007,861,881,853,839,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_histogram_numbered.html#a40c772fe8abdf0bf861aed012967ad1d" title=" " alt="" coords="924,1971,1116,2012"/>
<area shape="poly" title=" " alt="" coords="832,797,846,810,859,839,868,885,876,1019,875,1192,870,1385,865,1578,864,1751,872,1884,881,1929,893,1957,912,1973,909,1977,889,1960,876,1931,867,1885,859,1751,859,1578,864,1385,870,1192,870,1019,862,886,854,841,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1vector__env_1_1_sync_vector_env.html#ab77b6f9ba60cebde2df6744d93041d01" title=" " alt="" coords="933,2060,1107,2101"/>
<area shape="poly" title=" " alt="" coords="832,797,846,810,859,840,869,889,878,1030,878,1212,873,1415,868,1619,866,1802,874,1943,882,1992,894,2022,908,2038,925,2051,922,2055,904,2042,889,2025,877,1993,868,1944,861,1802,862,1619,868,1415,873,1212,873,1030,864,890,854,842,841,813,828,801"/>
<area shape="rect" href="structopen__spiel_1_1go_1_1_go_board_1_1_chain.html#a6908f66d9880b5877c13b64c62f81b39" title=" " alt="" coords="938,2126,1102,2166"/>
<area shape="poly" title=" " alt="" coords="832,797,846,810,860,843,870,895,876,964,879,1047,877,1243,870,1462,863,1681,861,1878,864,1960,870,2029,879,2080,893,2111,907,2124,925,2134,922,2138,904,2129,889,2114,874,2082,864,2030,858,1961,856,1878,857,1681,864,1462,871,1243,873,1047,871,964,865,896,855,844,841,813,828,801"/>
<area shape="rect" href="structopen__spiel_1_1phantom__go_1_1_phantom_go_board_1_1_chain.html#aa49a6bb32fa96aad95910ff1f5dc4368" title=" " alt="" coords="943,2190,1097,2246"/>
<area shape="poly" title=" " alt="" coords="832,797,846,810,861,844,871,899,878,971,880,1058,878,1264,871,1494,863,1724,861,1930,863,2017,869,2089,879,2143,894,2177,910,2192,930,2203,927,2208,907,2196,889,2180,874,2145,864,2090,858,2018,856,1930,858,1724,866,1494,873,1264,875,1058,872,972,866,900,856,846,841,813,828,801"/>
<area shape="rect" href="classpolynomial__weights_1_1_polynomial_weight_algorithm.html#a4e4380fac08b696bd90ded379986bef7" title=" " alt="" coords="918,2270,1122,2310"/>
<area shape="poly" title=" " alt="" coords="832,797,846,810,862,846,873,904,879,981,881,1073,878,1292,870,1535,861,1779,858,1997,861,2089,867,2165,878,2222,894,2257,907,2269,903,2273,889,2260,873,2223,862,2166,855,2089,853,1997,855,1779,864,1535,873,1292,876,1073,873,981,867,905,857,848,841,813,828,801"/>
<area shape="rect" href="classregret__matching_1_1_regret_matching.html#ae6a44161aec5eaa1c79a10f4285ff509" title=" " alt="" coords="898,2335,1142,2360"/>
<area shape="poly" title=" " alt="" coords="832,797,846,810,862,848,873,909,880,989,882,1085,878,1314,868,1568,859,1823,855,2051,858,2146,865,2226,877,2285,884,2306,893,2321,895,2323,891,2326,889,2324,880,2308,871,2286,860,2226,853,2147,850,2051,853,1823,863,1568,873,1314,877,1085,874,989,868,909,857,850,841,813,828,801"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#a97059cdbf63da09df472e9bef11d401a" title=" " alt="" coords="896,2384,1144,2410"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,855,826,863,849,874,912,881,995,883,1094,879,1331,868,1594,858,1857,854,2092,857,2191,864,2273,876,2334,884,2356,893,2371,894,2372,890,2375,889,2374,879,2358,871,2336,859,2274,852,2192,849,2092,852,1857,863,1594,873,1331,878,1094,875,995,869,913,858,851,850,829,841,813,828,801"/>
<area shape="rect" href="class_test_timer.html#ad971c25d3ac54fcd5c2e4b407c6737aa" title=" " alt="" coords="962,2433,1078,2459"/>
<area shape="poly" title=" " alt="" coords="832,797,845,810,855,827,863,851,875,915,882,1001,884,1103,879,1347,868,1619,857,1890,853,2133,856,2235,863,2319,875,2382,884,2405,893,2420,917,2438,947,2446,946,2451,915,2443,889,2424,879,2407,870,2384,858,2320,851,2235,848,2133,852,1890,863,1618,874,1347,879,1103,876,1001,870,916,858,852,850,829,841,813,828,801"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1iterated__matrix__game_1_1_iterated_matrix_game.html#a5c0e23abb5c558bc69cb455fcf2db6b1" title=" " alt="" coords="1197,1208,1452,1263"/>
<area shape="poly" title=" " alt="" coords="1148,1233,1181,1233,1181,1238,1148,1238"/>
<area shape="poly" title=" " alt="" coords="964,1305,962,1294,971,1285,990,1280,1020,1278,1052,1280,1071,1286,1069,1291,1051,1285,1020,1283,991,1285,973,1290,967,1296,969,1303"/>
<area shape="poly" title=" " alt="" coords="964,2061,962,2050,971,2041,990,2036,1020,2034,1052,2036,1071,2042,1069,2047,1051,2041,1020,2039,991,2041,973,2046,967,2052,969,2059"/>
<area shape="poly" title=" " alt="" coords="463,921,596,873,620,866,621,871,598,878,464,926"/>
<area shape="poly" title=" " alt="" coords="549,929,581,926,582,931,550,934"/>
<area shape="poly" title=" " alt="" coords="550,961,607,969,607,975,549,967"/>
<area shape="poly" title=" " alt="" coords="460,963,598,1017,623,1025,622,1030,596,1022,458,968"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7744e2572fb3fa78b3ff0f99baa1a208_icgraph">
<area shape="rect" title=" " alt="" coords="1708,287,1927,342"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="1442,287,1660,342"/>
<area shape="poly" title=" " alt="" coords="1693,317,1661,317,1661,312,1693,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1176,287,1394,342"/>
<area shape="poly" title=" " alt="" coords="1426,317,1395,317,1395,312,1426,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1160,317,1128,317,1128,312,1160,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="ad55be43954fb6c325544adca41430bbd" name="ad55be43954fb6c325544adca41430bbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad55be43954fb6c325544adca41430bbd">&#9670;&#160;</a></span>critic_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.critic_network </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00734">734</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  734</span>  <span class="keyword">def </span>critic_network(self):</div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordflow">return</span> self._critic_network</div>
<div class="line"><span class="lineno">  736</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>.</p>

</div>
</div>
<a id="a7d08a854b5449fc58a485a69e2604854" name="a7d08a854b5449fc58a485a69e2604854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d08a854b5449fc58a485a69e2604854">&#9670;&#160;</a></span>get_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Callable open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>return_probs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the policy.

Returns a function that takes a random key, an observation and
optionally an action mask. The function produces actions which are
sampled from the current policy. Additionally, if eturn_probs is true,
it also returns the action probabilities.

Args:
    return_probs: if true, the policy returns a tuple (action,
      action_probs).

Returns:
    A function that maps observations to actions
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00768">768</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  768</span>  <span class="keyword">def </span>get_policy(self, return_probs=True) -&gt; typing.Callable:</div>
<div class="line"><span class="lineno">  769</span>    <span class="stringliteral">&quot;&quot;&quot;Get the policy.</span></div>
<div class="line"><span class="lineno">  770</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  771</span><span class="stringliteral">    Returns a function that takes a random key, an observation and</span></div>
<div class="line"><span class="lineno">  772</span><span class="stringliteral">    optionally an action mask. The function produces actions which are</span></div>
<div class="line"><span class="lineno">  773</span><span class="stringliteral">    sampled from the current policy. Additionally, if eturn_probs is true,</span></div>
<div class="line"><span class="lineno">  774</span><span class="stringliteral">    it also returns the action probabilities.</span></div>
<div class="line"><span class="lineno">  775</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno">  776</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  777</span><span class="stringliteral">        return_probs: if true, the policy returns a tuple (action,</span></div>
<div class="line"><span class="lineno">  778</span><span class="stringliteral">          action_probs).</span></div>
<div class="line"><span class="lineno">  779</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  780</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  781</span><span class="stringliteral">        A function that maps observations to actions</span></div>
<div class="line"><span class="lineno">  782</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="keyword">def </span>_policy(key: jax.random.PRNGKey, obs: jnp.ndarray, action_mask=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  785</span>      <span class="stringliteral">&quot;&quot;&quot;The actual policy function.</span></div>
<div class="line"><span class="lineno">  786</span><span class="stringliteral">      </span></div>
<div class="line"><span class="lineno">  787</span><span class="stringliteral">      Takes a random key, the current observation and optionally an action</span></div>
<div class="line"><span class="lineno">  788</span><span class="stringliteral">      mask.</span></div>
<div class="line"><span class="lineno">  789</span><span class="stringliteral">      </span></div>
<div class="line"><span class="lineno">  790</span><span class="stringliteral">      Args:</span></div>
<div class="line"><span class="lineno">  791</span><span class="stringliteral">          key: a random key for sampling</span></div>
<div class="line"><span class="lineno">  792</span><span class="stringliteral">          obs: numpy array of observations</span></div>
<div class="line"><span class="lineno">  793</span><span class="stringliteral">          action_mask: optional numpy array to mask out illegal actions</span></div>
<div class="line"><span class="lineno">  794</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  795</span><span class="stringliteral">      Returns:</span></div>
<div class="line"><span class="lineno">  796</span><span class="stringliteral">        Either the sampled actions or, if return_probs is true, a tuple</span></div>
<div class="line"><span class="lineno">  797</span><span class="stringliteral">        (actions, action_probs).</span></div>
<div class="line"><span class="lineno">  798</span><span class="stringliteral">      &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  799</span>      params = self._train_state.policy_params[self.player_id]</div>
<div class="line"><span class="lineno">  800</span>      pi = self._pi_network.<a class="code hl_variable" href="hash__policy__traits__test_8cc.html#ae678cc9e768190695b10aa9f37166c73">apply</a>(params, obs)</div>
<div class="line"><span class="lineno">  801</span>      <span class="keywordflow">if</span> action_mask <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  802</span>        probs = pi.probs * action_mask</div>
<div class="line"><span class="lineno">  803</span>        probs = probs / probs.sum()</div>
<div class="line"><span class="lineno">  804</span>        pi = distrax.Categorical(probs=probs)</div>
<div class="line"><span class="lineno">  805</span>      actions = pi.sample(seed=key)</div>
<div class="line"><span class="lineno">  806</span>      <span class="keywordflow">if</span> return_probs:</div>
<div class="line"><span class="lineno">  807</span>        <span class="keywordflow">return</span> actions, pi.prob(actions)</div>
<div class="line"><span class="lineno">  808</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  809</span>        <span class="keywordflow">return</span> actions</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">return</span> jax.jit(_policy)</div>
<div class="line"><span class="lineno">  812</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00651">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00233">open_spiel.python.pytorch.policy_gradient.PolicyGradient._pi_network</a>, <a class="el" href="opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>, <a class="el" href="hash__policy__traits__test_8cc_source.html#l00062">apply</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l01022">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy()</a>, and <a class="el" href="ismcts_8py_source.html#l00148">open_spiel.python.algorithms.ismcts.ISMCTSBot.step_with_policy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_cgraph">
<area shape="rect" title=" " alt="" coords="5,113,283,154"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="337,5,570,46"/>
<area shape="poly" title=" " alt="" coords="190,110,256,83,330,55,352,48,353,53,332,60,258,88,193,115"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="331,70,577,126"/>
<area shape="poly" title=" " alt="" coords="283,115,315,111,315,116,284,120"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="356,149,552,190"/>
<area shape="poly" title=" " alt="" coords="284,147,341,154,340,159,283,152"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="331,215,577,255"/>
<area shape="poly" title=" " alt="" coords="200,152,332,199,359,207,357,212,330,204,198,157"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a7d08a854b5449fc58a485a69e2604854_icgraph">
<area shape="rect" title=" " alt="" coords="1994,246,2271,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7744e2572fb3fa78b3ff0f99baa1a208" title=" " alt="" coords="1727,205,1946,261"/>
<area shape="poly" title=" " alt="" coords="1978,252,1946,248,1946,243,1978,246"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#ae7d7d799250a40bb795d00008a607d82" title=" " alt="" coords="1176,281,1413,322"/>
<area shape="poly" title=" " alt="" coords="1978,276,1414,299,1413,294,1978,270"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="1461,189,1679,245"/>
<area shape="poly" title=" " alt="" coords="1712,228,1680,226,1680,221,1712,223"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="1185,172,1404,228"/>
<area shape="poly" title=" " alt="" coords="1445,212,1404,209,1404,204,1446,207"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,150,1128,191"/>
<area shape="poly" title=" " alt="" coords="1169,190,1128,186,1128,180,1170,185"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,396,792,452"/>
<area shape="poly" title=" " alt="" coords="890,202,886,206,870,227,863,249,863,294,863,339,855,363,838,386,817,402,793,413,791,408,815,397,834,382,850,360,857,339,857,294,858,248,866,225,882,202,886,198"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,476,792,516"/>
<area shape="poly" title=" " alt="" coords="889,203,886,206,865,237,857,269,858,301,864,334,869,367,870,400,861,433,838,466,817,482,793,492,791,487,815,477,834,462,856,431,864,399,864,367,858,335,853,302,852,269,860,235,882,202,885,199"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,541,786,582"/>
<area shape="poly" title=" " alt="" coords="889,203,886,206,871,226,861,246,853,286,855,326,864,366,872,406,874,447,865,488,854,509,838,530,815,548,787,558,785,553,812,543,834,526,850,506,860,487,869,447,867,407,858,367,850,326,847,285,856,244,867,223,882,202,885,199"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,5,784,61"/>
<area shape="poly" title=" " alt="" coords="960,144,902,109,835,76,783,57,785,52,837,71,904,104,963,139"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,85,824,126"/>
<area shape="poly" title=" " alt="" coords="891,149,797,129,798,123,893,144"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,150,787,191"/>
<area shape="poly" title=" " alt="" coords="869,173,787,173,787,168,869,168"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,216,813,256"/>
<area shape="poly" title=" " alt="" coords="893,197,798,218,797,212,891,192"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,281,836,322"/>
<area shape="poly" title=" " alt="" coords="895,200,886,206,871,221,863,237,854,254,838,270,814,283,812,278,835,266,850,251,858,235,866,218,883,202,892,196"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,346,831,371"/>
<area shape="poly" title=" " alt="" coords="891,202,886,206,874,221,867,237,864,270,860,303,852,319,838,335,820,347,817,343,835,331,848,317,855,301,858,269,862,235,869,218,882,202,888,197"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,85,513,126"/>
<area shape="poly" title=" " alt="" coords="557,108,514,108,514,102,557,102"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,85,233,126"/>
<area shape="poly" title=" " alt="" coords="265,108,233,108,233,102,265,102"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a24f5eb8c4097316c91ba77654ade2871" title=" " alt="" coords="892,281,1120,322"/>
<area shape="poly" title=" " alt="" coords="1160,304,1120,304,1120,298,1160,298"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1human_1_1_human_bot.html#a64aa4e2ac02f3e716a2e20c80f1d60ea" title=" " alt="" coords="905,346,1107,387"/>
<area shape="poly" title=" " alt="" coords="1187,328,1099,348,1098,343,1186,323"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#a16d996a9d2dad60c663ea1377ab309a5" title=" " alt="" coords="908,412,1104,452"/>
<area shape="poly" title=" " alt="" coords="1252,333,1195,368,1129,401,1095,413,1093,408,1127,396,1192,363,1249,328"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#a0a0f0f63fe3d0c9b67f1a13b199a4f78" title=" " alt="" coords="896,216,1116,256"/>
<area shape="poly" title=" " alt="" coords="1186,279,1098,259,1099,254,1187,274"/>
<area shape="poly" title=" " alt="" coords="897,331,886,337,871,348,862,361,853,373,838,386,793,406,791,401,835,382,849,370,858,358,867,345,883,332,895,326"/>
<area shape="poly" title=" " alt="" coords="891,332,886,336,873,352,867,367,863,400,859,433,852,450,838,466,817,480,793,490,791,485,814,475,835,462,847,447,854,432,858,399,862,366,869,349,882,333,888,328"/>
<area shape="poly" title=" " alt="" coords="890,333,886,336,869,360,862,383,861,407,863,431,865,456,864,481,856,505,838,530,814,547,787,557,785,552,812,542,834,526,851,503,859,480,860,456,858,432,856,407,857,382,865,357,882,333,886,329"/>
<area shape="poly" title=" " alt="" coords="886,273,882,270,865,245,857,220,855,195,857,170,860,146,858,122,851,99,834,75,811,57,783,46,785,41,814,53,838,71,856,96,864,121,865,146,863,171,861,195,862,219,869,243,886,266,890,269"/>
<area shape="poly" title=" " alt="" coords="888,274,882,270,869,253,862,237,858,203,854,171,847,155,835,140,817,128,820,124,838,137,852,153,859,169,863,203,867,235,873,251,886,266,891,270"/>
<area shape="poly" title=" " alt="" coords="892,276,883,270,866,254,858,237,850,221,835,206,812,194,786,185,788,180,814,189,838,202,854,218,863,234,871,251,886,266,895,271"/>
<area shape="poly" title=" " alt="" coords="891,280,797,259,798,254,893,274"/>
<area shape="poly" title=" " alt="" coords="877,304,837,304,837,298,877,298"/>
<area shape="poly" title=" " alt="" coords="880,328,837,336,773,348,772,342,836,331,880,322"/>
<area shape="poly" title=" " alt="" coords="890,391,792,409,792,404,889,385"/>
<area shape="poly" title=" " alt="" coords="895,396,886,402,871,417,863,433,854,450,838,466,793,486,791,481,835,462,850,447,858,431,866,414,883,398,892,392"/>
<area shape="poly" title=" " alt="" coords="894,396,886,402,874,417,867,432,863,464,859,497,852,514,838,530,814,546,787,556,785,551,812,541,835,526,847,511,854,496,858,464,862,431,869,414,882,398,890,391"/>
<area shape="poly" title=" " alt="" coords="890,342,882,335,860,302,852,269,852,236,857,203,863,171,863,139,855,107,834,75,811,57,783,45,785,40,814,52,838,71,860,105,869,138,868,171,863,204,858,236,857,268,865,300,886,331,894,338"/>
<area shape="poly" title=" " alt="" coords="890,342,882,335,865,310,857,285,856,260,858,235,860,211,859,187,852,164,834,140,819,128,822,124,838,137,856,161,864,186,866,211,863,236,861,260,862,284,869,308,886,331,894,338"/>
<area shape="poly" title=" " alt="" coords="890,342,882,335,869,319,862,302,858,269,854,236,847,221,835,206,812,191,786,181,788,176,815,186,838,202,852,218,859,235,863,268,867,301,873,316,886,331,894,337"/>
<area shape="poly" title=" " alt="" coords="892,341,883,335,866,319,858,302,850,286,835,271,812,259,814,254,838,267,854,283,863,300,871,316,886,331,895,337"/>
<area shape="poly" title=" " alt="" coords="891,345,797,325,798,319,893,340"/>
<area shape="poly" title=" " alt="" coords="889,366,832,365,832,359,890,361"/>
<area shape="poly" title=" " alt="" coords="893,432,792,429,792,424,893,426"/>
<area shape="poly" title=" " alt="" coords="893,458,793,479,792,474,892,453"/>
<area shape="poly" title=" " alt="" coords="963,463,905,498,837,530,787,546,785,541,835,525,902,493,960,459"/>
<area shape="poly" title=" " alt="" coords="893,411,882,400,867,379,856,358,847,317,849,276,857,236,866,195,868,155,859,115,849,95,834,75,811,56,783,45,785,40,814,52,838,71,854,92,864,113,873,155,871,196,863,237,855,277,852,317,861,357,871,377,886,397,897,407"/>
<area shape="poly" title=" " alt="" coords="894,410,882,400,860,367,852,334,853,300,858,268,863,235,864,203,856,172,834,140,820,128,823,124,838,137,861,170,869,203,869,236,863,268,858,301,857,333,865,365,886,397,897,406"/>
<area shape="poly" title=" " alt="" coords="893,410,882,400,865,376,857,350,856,325,858,301,860,276,859,252,852,229,834,206,812,190,786,180,788,175,815,185,838,202,856,226,864,251,866,276,863,301,861,325,862,350,869,373,886,397,897,406"/>
<area shape="poly" title=" " alt="" coords="893,409,882,400,869,384,862,367,858,334,854,301,847,286,835,271,812,256,815,252,838,267,852,283,859,300,863,333,867,366,873,381,886,397,897,405"/>
<area shape="poly" title=" " alt="" coords="893,407,883,401,866,384,858,367,850,350,835,335,815,324,817,320,838,331,855,347,863,364,871,381,886,396,896,402"/>
<area shape="poly" title=" " alt="" coords="913,409,884,401,836,386,780,375,781,369,837,381,885,396,914,404"/>
<area shape="poly" title=" " alt="" coords="891,267,886,271,874,285,868,298,863,327,858,356,851,371,838,386,817,401,793,411,791,406,814,396,835,382,846,368,853,355,858,326,863,296,870,282,882,267,888,263"/>
<area shape="poly" title=" " alt="" coords="890,268,886,271,869,294,862,318,861,342,863,367,866,391,864,416,856,441,838,466,817,481,793,491,791,486,815,477,834,462,852,439,859,415,860,392,858,367,856,342,857,317,865,292,882,267,886,264"/>
<area shape="poly" title=" " alt="" coords="889,268,886,271,865,303,857,334,858,366,863,399,869,431,869,464,861,497,838,530,815,547,787,558,785,553,812,543,834,526,856,495,864,463,863,432,858,399,853,367,852,334,860,300,882,267,885,264"/>
<area shape="poly" title=" " alt="" coords="888,209,882,204,869,188,862,171,858,138,854,106,847,90,835,75,811,59,783,47,785,42,813,54,838,71,852,88,859,104,863,138,867,170,873,185,886,201,891,205"/>
<area shape="poly" title=" " alt="" coords="892,210,883,205,866,188,858,172,850,156,835,141,812,129,814,124,838,136,854,152,863,169,871,185,886,200,895,206"/>
<area shape="poly" title=" " alt="" coords="892,214,787,192,788,187,893,209"/>
<area shape="poly" title=" " alt="" coords="881,238,814,238,814,233,881,233"/>
<area shape="poly" title=" " alt="" coords="893,263,798,283,797,278,891,257"/>
<area shape="poly" title=" " alt="" coords="895,266,886,271,871,287,863,303,855,320,838,335,813,347,810,343,835,331,850,316,858,300,867,283,883,267,892,261"/>
</map>
</div>

</div>
</div>
<a id="ad592a86c90ce19aa7b49b93823803fe6" name="ad592a86c90ce19aa7b49b93823803fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad592a86c90ce19aa7b49b93823803fe6">&#9670;&#160;</a></span>get_value_fn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> typing.Callable open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_value_fn </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00759">759</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  759</span>  <span class="keyword">def </span>get_value_fn(self) -&gt; typing.Callable:</div>
<div class="line"><span class="lineno">  760</span>    <span class="keyword">def </span>value_fn(obs: jnp.ndarray):</div>
<div class="line"><span class="lineno">  761</span>      obs = jnp.array(obs)</div>
<div class="line"><span class="lineno">  762</span>      <span class="keywordflow">return</span> self._critic_network.<a class="code hl_variable" href="hash__policy__traits__test_8cc.html#ae678cc9e768190695b10aa9f37166c73">apply</a>(</div>
<div class="line"><span class="lineno">  763</span>          self.train_state.critic_params[self.player_id], obs</div>
<div class="line"><span class="lineno">  764</span>      ).squeeze(-1)</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordflow">return</span> jax.jit(value_fn)</div>
<div class="line"><span class="lineno">  767</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00652">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00220">open_spiel.python.pytorch.policy_gradient.PolicyGradient._critic_network</a>, <a class="el" href="hash__policy__traits__test_8cc_source.html#l00062">apply</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00726">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.train_state()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_ad592a86c90ce19aa7b49b93823803fe6_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_ad592a86c90ce19aa7b49b93823803fe6_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_ad592a86c90ce19aa7b49b93823803fe6_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_ad592a86c90ce19aa7b49b93823803fe6_cgraph">
<area shape="rect" title=" " alt="" coords="5,142,242,198"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="313,5,546,46"/>
<area shape="poly" title=" " alt="" coords="156,139,216,96,289,55,304,49,306,54,291,60,219,100,160,144"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="306,70,552,126"/>
<area shape="poly" title=" " alt="" coords="241,139,293,127,294,132,243,144"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="332,149,527,190"/>
<area shape="poly" title=" " alt="" coords="242,167,316,167,316,172,242,172"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="306,215,552,255"/>
<area shape="poly" title=" " alt="" coords="243,192,317,208,315,213,241,198"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a20a9c683dd11b09e5667692bc1ab6891" title=" " alt="" coords="290,280,569,321"/>
<area shape="poly" title=" " alt="" coords="166,196,224,231,291,265,312,272,311,277,289,269,221,236,164,200"/>
</map>
</div>

</div>
</div>
<a id="ac43b971fdf9c6cec4de895b6ae366aac" name="ac43b971fdf9c6cec4de895b6ae366aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac43b971fdf9c6cec4de895b6ae366aac">&#9670;&#160;</a></span>metrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.metrics </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>return_last_only</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00737">737</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  737</span>  <span class="keyword">def </span>metrics(self, return_last_only: bool = <span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  738</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> self._metrics:</div>
<div class="line"><span class="lineno">  739</span>      <span class="keywordflow">return</span> {}</div>
<div class="line"><span class="lineno">  740</span>    metrics = self._metrics[-1] <span class="keywordflow">if</span> return_last_only <span class="keywordflow">else</span> self._metrics</div>
<div class="line"><span class="lineno">  741</span>    <span class="keywordflow">return</span> metrics</div>
<div class="line"><span class="lineno">  742</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00641">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._metrics</a>.</p>

</div>
</div>
<a id="ab261d55d230e37037218f8a91c7a22b7" name="ab261d55d230e37037218f8a91c7a22b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab261d55d230e37037218f8a91c7a22b7">&#9670;&#160;</a></span>policy_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.policy_network </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00730">730</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  730</span>  <span class="keyword">def </span>policy_network(self):</div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">return</span> self._pi_network</div>
<div class="line"><span class="lineno">  732</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00651">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00233">open_spiel.python.pytorch.policy_gradient.PolicyGradient._pi_network</a>.</p>

</div>
</div>
<a id="a49083992dc97516ca2e134c672e2520e" name="a49083992dc97516ca2e134c672e2520e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49083992dc97516ca2e134c672e2520e">&#9670;&#160;</a></span>step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1rl__environment_1_1_time_step.html">TimeStep</a></td>          <td class="paramname"><span class="paramname"><em>time_step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>is_evaluation</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Produces an action and possibly triggers a parameter update.

LOLA agents depend on having access to previous actions made by the
opponent. Assumes that the field 'observations' of time_step contains a
field 'actions' and its first axis is indexed by the player id. Similar, the
fields 'rewards' and 'legal_actions' are assumed to be of shape
(num_players,).

Args:
    time_step: a TimeStep instance which has a field 'actions' in the
      observations dict.
    is_evaluation: if true, the agent will not update.

Returns:
    A tuple containing the action that was taken and its probability
    under the current policy.
</pre> 
<p>Reimplemented from <a class="el" href="classopen__spiel_1_1python_1_1rl__agent_1_1_abstract_agent.html#ab97b9d892ae3a1232f3adce55203efea">open_spiel.python.rl_agent.AbstractAgent</a>.</p>

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00813">813</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  813</span>  <span class="keyword">def </span>step(self, time_step: TimeStep, is_evaluation=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  814</span>    <span class="stringliteral">&quot;&quot;&quot;Produces an action and possibly triggers a parameter update.</span></div>
<div class="line"><span class="lineno">  815</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  816</span><span class="stringliteral">    LOLA agents depend on having access to previous actions made by the</span></div>
<div class="line"><span class="lineno">  817</span><span class="stringliteral">    opponent. Assumes that the field &#39;observations&#39; of time_step contains a</span></div>
<div class="line"><span class="lineno">  818</span><span class="stringliteral">    field &#39;actions&#39; and its first axis is indexed by the player id. Similar, the</span></div>
<div class="line"><span class="lineno">  819</span><span class="stringliteral">    fields &#39;rewards&#39; and &#39;legal_actions&#39; are assumed to be of shape</span></div>
<div class="line"><span class="lineno">  820</span><span class="stringliteral">    (num_players,).</span></div>
<div class="line"><span class="lineno">  821</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  822</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  823</span><span class="stringliteral">        time_step: a TimeStep instance which has a field &#39;actions&#39; in the</span></div>
<div class="line"><span class="lineno">  824</span><span class="stringliteral">          observations dict.</span></div>
<div class="line"><span class="lineno">  825</span><span class="stringliteral">        is_evaluation: if true, the agent will not update.</span></div>
<div class="line"><span class="lineno">  826</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  827</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  828</span><span class="stringliteral">        A tuple containing the action that was taken and its probability</span></div>
<div class="line"><span class="lineno">  829</span><span class="stringliteral">        under the current policy.</span></div>
<div class="line"><span class="lineno">  830</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  831</span>    do_step = (</div>
<div class="line"><span class="lineno">  832</span>        time_step.is_simultaneous_move()</div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">or</span> self.player_id == time_step.current_player()</div>
<div class="line"><span class="lineno">  834</span>    )</div>
<div class="line"><span class="lineno">  835</span>    action, probs = <span class="keywordtype">None</span>, []</div>
<div class="line"><span class="lineno">  836</span>    batch_policy = vmap(self._current_policy, in_axes=(0, 0, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> time_step.last() <span class="keywordflow">and</span> do_step:</div>
<div class="line"><span class="lineno">  838</span>      info_state = time_step.observations[<span class="stringliteral">&#39;info_state&#39;</span>][self.player_id]</div>
<div class="line"><span class="lineno">  839</span>      legal_actions = time_step.observations[<span class="stringliteral">&#39;legal_actions&#39;</span>][self.player_id]</div>
<div class="line"><span class="lineno">  840</span>      action_mask = np.zeros(self._num_actions)</div>
<div class="line"><span class="lineno">  841</span>      action_mask[legal_actions] = 1</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>      <span class="comment"># If we are not in a batched environment, we need to add a batch dimension</span></div>
<div class="line"><span class="lineno">  844</span>      <span class="keywordflow">if</span> <span class="stringliteral">&#39;batch_size&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> time_step.observations:</div>
<div class="line"><span class="lineno">  845</span>        info_state = jnp.array(info_state)[<span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  846</span>        batch_size = 1</div>
<div class="line"><span class="lineno">  847</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  848</span>        batch_size = time_step.observations[<span class="stringliteral">&#39;batch_size&#39;</span>]</div>
<div class="line"><span class="lineno">  849</span>      sample_keys = jax.random.split(<a class="code hl_variable" href="low__level__alloc_8cc.html#a99b32867fd662c5f37b4c76816edc19e">next</a>(self._rng), batch_size)</div>
<div class="line"><span class="lineno">  850</span>      action, probs = batch_policy(sample_keys, info_state, action_mask)</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_evaluation:</div>
<div class="line"><span class="lineno">  853</span>      self._store_time_step(time_step=time_step, action=action)</div>
<div class="line"><span class="lineno">  854</span>      <span class="keywordflow">if</span> time_step.last() <span class="keywordflow">and</span> self._should_update():</div>
<div class="line"><span class="lineno">  855</span>        self._train_step()</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordflow">return</span> rl_agent.StepOutput(action=action, probs=probs)</div>
<div class="line"><span class="lineno">  858</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2cfr_8py_source.html#l00430">open_spiel.python.algorithms.cfr._CFRSolver._current_policy</a>, <a class="el" href="algorithms_2cfr_8py_source.html#l00165">open_spiel.python.algorithms.cfr._CFRSolverBase._current_policy</a>, <a class="el" href="cfr__br_8py_source.html#l00134">open_spiel.python.algorithms.cfr_br.CFRBRSolver._current_policy</a>, <a class="el" href="algorithms_2discounted__cfr_8py_source.html#l00209">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._current_policy</a>, <a class="el" href="efr_8py_source.html#l00434">open_spiel.python.algorithms.efr._EFRSolver._current_policy</a>, <a class="el" href="efr_8py_source.html#l00109">open_spiel.python.algorithms.efr._EFRSolverBase._current_policy</a>, <a class="el" href="opponent__shaping_8py_source.html#l00662">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._current_policy</a>, <a class="el" href="boltzmann__tabular__qlearner_8py_source.html#l00073">open_spiel.python.algorithms.boltzmann_tabular_qlearner.BoltzmannQLearner._num_actions</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00170">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00213">open_spiel.python.algorithms.deep_cfr_tf2.AdvantageNetwork._num_actions</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00333">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._num_actions</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00148">open_spiel.python.algorithms.deep_cfr_tf2.PolicyNetwork._num_actions</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00070">open_spiel.python.algorithms.dqn.DQN._num_actions</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00137">open_spiel.python.algorithms.eva.EVAAgent._num_actions</a>, <a class="el" href="mcts__agent_8py_source.html#l00033">open_spiel.python.algorithms.mcts_agent.MCTSAgent._num_actions</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00066">open_spiel.python.algorithms.nfsp.NFSP._num_actions</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00154">open_spiel.python.algorithms.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="random__agent_8py_source.html#l00027">open_spiel.python.algorithms.random_agent.RandomAgent._num_actions</a>, <a class="el" href="tabular__multiagent__qlearner_8py_source.html#l00190">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._num_actions</a>, <a class="el" href="tabular__qlearner_8py_source.html#l00046">open_spiel.python.algorithms.tabular_qlearner.QLearner._num_actions</a>, <a class="el" href="wolf__phc_8py_source.html#l00072">open_spiel.python.algorithms.wolf_phc.WoLFPHC._num_actions</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00214">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot._num_actions</a>, <a class="el" href="catch_8py_source.html#l00043">open_spiel.python.environments.catch.Environment._num_actions</a>, <a class="el" href="rl__response_8py_source.html#l00137">open_spiel.python.examples.rl_response.FirstActionAgent._num_actions</a>, <a class="el" href="roshambo__population__example_8py_source.html#l00058">open_spiel.python.examples.roshambo_population_example.BotAgent._num_actions</a>, <a class="el" href="chat__game__base_8py_source.html#l01060">open_spiel.python.games.chat_games.chat_game_base.BaseChatGame._num_actions</a>, <a class="el" href="chat__game__base_8py_source.html#l00121">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._num_actions</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00176">open_spiel.python.jax.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="jax_2dqn_8py_source.html#l00068">open_spiel.python.jax.dqn.DQN._num_actions</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00066">open_spiel.python.jax.nfsp.NFSP._num_actions</a>, <a class="el" href="opponent__shaping_8py_source.html#l00632">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_actions</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00037">open_spiel.python.jax.policy_gradient.NetA2C._num_actions</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00054">open_spiel.python.jax.policy_gradient.NetPG._num_actions</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00244">open_spiel.python.jax.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00074">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._num_actions</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00090">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._num_actions</a>, <a class="el" href="normal__form__game_8py_source.html#l00146">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._num_actions</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00259">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._num_actions</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00141">open_spiel.python.pytorch.dqn.DQN._num_actions</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00129">open_spiel.python.pytorch.eva.EVAAgent._num_actions</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00176">open_spiel.python.pytorch.policy_gradient.PolicyGradient._num_actions</a>, <a class="el" href="meta__learning_8py_source.html#l00295">meta_learning.MetaCFRRegretAgent._rng</a>, <a class="el" href="bots_2policy_8py_source.html#l00040">open_spiel.python.bots.policy.PolicyBot._rng</a>, <a class="el" href="uniform__random_8py_source.html#l00034">open_spiel.python.bots.uniform_random.UniformRandomBot._rng</a>, <a class="el" href="catch_8py_source.html#l00039">open_spiel.python.environments.catch.Environment._rng</a>, <a class="el" href="opponent__shaping_8py_source.html#l00644">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._rng</a>, <a class="el" href="rl__environment_8py_source.html#l00126">open_spiel.python.rl_environment.ChanceEventSampler._rng</a>, <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00144">rnn_meta_selfplay_agent.MetaSelfplayAgent._rng</a>, <a class="el" href="opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>, <a class="el" href="low__level__alloc_8cc_source.html#l00100">next</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00068">open_spiel.python.algorithms.dqn.DQN.player_id</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00135">open_spiel.python.algorithms.eva.EVAAgent.player_id</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00064">open_spiel.python.algorithms.nfsp.NFSP.player_id</a>, <a class="el" href="noisy__policy_8py_source.html#l00055">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.player_id</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00152">open_spiel.python.algorithms.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="rnad_8py_source.html#l00670">open_spiel.python.algorithms.rnad.rnad.EnvStep.player_id</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00222">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00208">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.player_id()</a>, <a class="el" href="bots_2policy_8py_source.html#l00043">open_spiel.python.bots.policy.PolicyBot.player_id()</a>, <a class="el" href="uniform__random_8py_source.html#l00039">open_spiel.python.bots.uniform_random.UniformRandomBot.player_id()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00067">open_spiel.python.jax.dqn.DQN.player_id</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00065">open_spiel.python.jax.nfsp.NFSP.player_id</a>, <a class="el" href="opponent__shaping_8py_source.html#l00631">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00243">open_spiel.python.jax.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00089">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.player_id</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00140">open_spiel.python.pytorch.dqn.DQN.player_id</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00127">open_spiel.python.pytorch.eva.EVAAgent.player_id</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00175">open_spiel.python.pytorch.policy_gradient.PolicyGradient.player_id</a>, <a class="el" href="ppo_8py_source.html#l00198">open_spiel.python.pytorch.ppo.PPO.player_id</a>, <a class="el" href="dqn_8h_source.html#l00050">open_spiel::algorithms::torch_dqn::DQNSettings.player_id</a>, <a class="el" href="base_type_8h_source.html#l00032">open_spiel::baseT::P_UnitId.player_id</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01009">utils.PurePolicyResponse.player_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax__cfr_8py_source.html#l00359">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.evaluate_and_update_policy()</a>, <a class="el" href="jax__cfr_8py_source.html#l00350">open_spiel.python.jax.cfr.jax_cfr.JaxCFR.multiple_steps()</a>, <a class="el" href="meta__selfplay__agent_8py_source.html#l00103">meta_selfplay_agent.MetaSelfplayAgent.next_policy()</a>, <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00156">rnn_meta_selfplay_agent.MetaSelfplayAgent.next_policy()</a>, <a class="el" href="double__oracle_8py_source.html#l00126">open_spiel.python.algorithms.double_oracle.DoubleOracleSolver.solve_yield()</a>, <a class="el" href="nash__evolutionary__search_8py_source.html#l00094">nash_evolutionary_search.NashCMAES.step_for()</a>, <a class="el" href="nash__random__search_8py_source.html#l00100">nash_random_search.NashRandomSearch.step_for()</a>, <a class="el" href="bandit__regret_8py_source.html#l00363">open_spiel.python.mfg.algorithms.bandit_regret.PolynomialWeightAlgorithm.step_for()</a>, and <a class="el" href="regret__minimizer_8py_source.html#l00107">regret_minimizer.RegretMinimizer.step_for()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_cgraph">
<area shape="rect" title=" " alt="" coords="5,216,249,256"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a4c6e95fe51f4fcc38c46f857ff7a14fc" title=" " alt="" coords="297,5,515,61"/>
<area shape="poly" title=" " alt="" coords="144,213,207,149,250,111,295,78,315,66,318,71,298,82,253,115,211,152,148,217"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a92fdbbc16d1a44597453d7f3bd1c6278" title=" " alt="" coords="829,208,1048,264"/>
<area shape="poly" title=" " alt="" coords="249,233,814,233,814,238,249,238"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge_1_1_blue_chip_bridge_bot.html#acaaa9d432ff433c3672a24c8a7bc0a23" title=" " alt="" coords="1430,328,1663,368"/>
<area shape="poly" title=" " alt="" coords="152,213,214,168,254,146,296,128,398,101,480,92,671,96,940,96,1007,93,1065,88,1166,78,1213,78,1263,84,1316,100,1376,128,1404,146,1430,167,1474,217,1508,268,1532,312,1527,315,1503,271,1470,220,1426,171,1401,150,1374,133,1314,105,1262,90,1213,83,1166,83,1066,93,1007,99,940,101,671,101,481,97,399,106,298,133,256,150,217,173,155,217"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1bluechip__bridge__uncontested__bidding_1_1_blue_chip_bridge_bot.html#a6b74e3d54f11b8147bd0806a1641e2b1" title=" " alt="" coords="1423,671,1669,726"/>
<area shape="poly" title=" " alt="" coords="131,257,134,359,141,432,154,514,175,601,205,687,246,770,270,808,299,843,341,889,382,924,421,951,462,971,505,984,554,992,671,997,940,997,1008,1000,1067,1007,1168,1022,1215,1024,1264,1018,1315,1002,1373,972,1400,941,1440,878,1520,739,1524,741,1444,881,1404,944,1377,977,1318,1007,1265,1023,1215,1029,1167,1027,1066,1012,1007,1005,940,1002,671,1002,553,997,504,989,460,976,419,956,378,928,338,892,295,847,266,811,241,773,200,690,170,602,149,515,136,433,129,359,125,257"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1policy_1_1_policy_bot.html#ae1967e66d77d550419acdce692703543" title=" " alt="" coords="1448,393,1644,434"/>
<area shape="poly" title=" " alt="" coords="208,212,301,191,417,170,543,153,671,147,940,147,1038,142,1166,136,1230,136,1290,142,1340,153,1377,172,1397,197,1406,222,1407,248,1404,275,1401,301,1401,327,1408,353,1425,378,1437,388,1433,392,1421,382,1403,355,1396,328,1395,301,1399,274,1402,248,1401,223,1393,199,1373,177,1338,158,1289,147,1230,142,1166,141,1038,147,940,152,671,152,544,158,417,175,302,196,209,217"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1bots_1_1uniform__random_1_1_uniform_random_bot.html#ac93a0f081d67fda75f84f09b1e6e2b0b" title=" " alt="" coords="1423,606,1669,647"/>
<area shape="poly" title=" " alt="" coords="137,256,155,315,187,401,232,503,291,611,326,664,364,714,406,760,452,801,501,834,554,860,610,877,671,883,940,883,1070,889,1125,892,1175,893,1224,887,1271,873,1320,847,1373,807,1388,790,1395,772,1397,735,1399,695,1406,676,1421,657,1424,654,1427,658,1425,660,1411,678,1404,696,1402,735,1400,774,1392,793,1377,811,1323,852,1273,878,1225,893,1176,898,1125,898,1070,894,940,888,671,888,609,882,552,865,498,839,448,805,402,764,360,717,321,667,286,614,227,506,182,403,150,316,132,258"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aa0d78940728f70c85b0b8b2723ceb280" title=" " alt="" coords="297,315,515,370"/>
<area shape="poly" title=" " alt="" coords="183,254,318,306,316,311,181,259"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a6a1a3592b3656e858e405ca6974d3db1" title=" " alt="" coords="1126,352,1344,408"/>
<area shape="poly" title=" " alt="" coords="999,262,1163,342,1161,347,997,267"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a20a9c683dd11b09e5667692bc1ab6891" title=" " alt="" coords="1096,186,1375,227"/>
<area shape="poly" title=" " alt="" coords="1048,222,1080,219,1080,224,1048,228"/>
<area shape="poly" title=" " alt="" coords="1345,366,1414,359,1414,364,1345,371"/>
<area shape="poly" title=" " alt="" coords="1347,396,1377,418,1398,449,1406,479,1406,509,1402,539,1398,569,1398,598,1406,627,1425,657,1426,658,1422,662,1421,660,1401,629,1393,599,1393,568,1397,538,1401,509,1401,480,1393,451,1373,422,1344,400"/>
<area shape="poly" title=" " alt="" coords="1345,389,1433,398,1433,404,1345,394"/>
<area shape="poly" title=" " alt="" coords="1346,402,1376,418,1426,458,1468,505,1503,551,1528,592,1524,594,1499,554,1464,508,1422,462,1374,422,1344,406"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a063f8a6cc351f7d3bcf74757fabb4669" title=" " alt="" coords="563,315,781,370"/>
<area shape="poly" title=" " alt="" coords="516,340,547,340,547,345,516,345"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7b25c7de236284a0d59c11efddea26b1" title=" " alt="" coords="563,477,781,533"/>
<area shape="poly" title=" " alt="" coords="454,369,613,467,611,471,452,373"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a566493380f42cdfb19e24266739ff031" title=" " alt="" coords="1126,432,1344,488"/>
<area shape="poly" title=" " alt="" coords="782,488,829,483,1110,463,1111,468,830,488,782,493"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#aaba558f18992f23fda573e138df49ac6" title=" " alt="" coords="829,497,1048,553"/>
<area shape="poly" title=" " alt="" coords="782,511,814,513,814,518,782,516"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7744e2572fb3fa78b3ff0f99baa1a208" title=" " alt="" coords="829,607,1048,662"/>
<area shape="poly" title=" " alt="" coords="733,531,867,597,865,602,730,536"/>
<area shape="poly" title=" " alt="" coords="1344,431,1374,417,1388,408,1397,399,1407,389,1422,379,1437,372,1439,377,1424,383,1410,393,1401,402,1391,412,1376,422,1346,435"/>
<area shape="poly" title=" " alt="" coords="1346,477,1377,498,1392,518,1400,539,1402,579,1404,618,1411,637,1425,657,1427,659,1423,662,1421,660,1406,640,1399,619,1397,579,1395,540,1388,521,1373,502,1343,481"/>
<area shape="poly" title=" " alt="" coords="1344,441,1433,427,1434,433,1345,446"/>
<area shape="poly" title=" " alt="" coords="1346,485,1376,497,1415,519,1452,545,1513,594,1510,598,1449,549,1412,524,1374,502,1344,489"/>
<area shape="poly" title=" " alt="" coords="1001,604,1025,586,1045,564,1063,527,1068,492,1065,457,1059,424,1055,391,1056,358,1068,327,1094,297,1117,280,1141,268,1193,253,1248,249,1303,254,1358,266,1409,282,1494,318,1492,323,1408,287,1357,271,1302,260,1247,254,1194,258,1143,273,1119,285,1097,300,1072,329,1061,359,1060,390,1065,423,1071,457,1073,492,1068,529,1050,567,1029,590,1004,608"/>
<area shape="poly" title=" " alt="" coords="957,662,980,697,1011,738,1050,777,1097,807,1171,833,1203,838,1233,839,1297,829,1374,807,1409,793,1443,775,1501,734,1504,739,1446,780,1412,798,1376,812,1298,834,1233,844,1202,843,1170,838,1095,812,1047,782,1007,742,975,701,953,664"/>
<area shape="poly" title=" " alt="" coords="1000,604,1025,586,1045,564,1061,533,1066,503,1065,474,1061,445,1058,417,1060,390,1071,363,1094,338,1129,313,1163,298,1195,292,1228,292,1261,298,1297,308,1376,337,1392,346,1402,357,1411,368,1424,378,1439,384,1437,389,1422,382,1407,371,1398,360,1388,350,1374,342,1295,314,1260,303,1227,297,1196,297,1164,303,1132,318,1097,342,1075,366,1065,391,1064,417,1066,445,1070,474,1071,504,1066,535,1050,567,1029,590,1003,608"/>
<area shape="poly" title=" " alt="" coords="999,660,1046,678,1096,692,1175,707,1237,715,1298,712,1374,692,1388,685,1398,676,1407,666,1422,656,1435,650,1437,655,1424,661,1411,670,1401,680,1391,689,1376,697,1299,717,1237,720,1174,712,1095,697,1044,684,997,665"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a1eae44c637529e3a1ebb0c429badac92" title=" " alt="" coords="1117,922,1354,963"/>
<area shape="poly" title=" " alt="" coords="958,662,1014,751,1053,803,1097,851,1139,885,1182,912,1179,917,1136,889,1094,855,1049,806,1010,754,953,664"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a7d08a854b5449fc58a485a69e2604854" title=" " alt="" coords="1097,642,1374,683"/>
<area shape="poly" title=" " alt="" coords="1048,642,1081,645,1081,651,1048,647"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fictitious__play_1_1_fictitious_play.html#aa70912f9e9ce65c1fb32049218e021eb" title=" " alt="" coords="1101,757,1370,798"/>
<area shape="poly" title=" " alt="" coords="977,661,1032,699,1097,736,1130,749,1128,754,1095,741,1029,704,974,665"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1fixed__point_1_1_fixed_point.html#a786a9ae52033b796140c3380d222d47b" title=" " alt="" coords="1111,512,1360,552"/>
<area shape="poly" title=" " alt="" coords="996,604,1095,563,1122,554,1123,559,1097,568,998,609"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1mirror__descent_1_1_mirror_descent.html#a3338530a140741d2a8aec5fd9df4befe" title=" " alt="" coords="1109,577,1362,618"/>
<area shape="poly" title=" " alt="" coords="1048,618,1093,612,1093,618,1048,623"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#a034e9845c4b368946f9336a4a029b568" title=" " alt="" coords="1428,922,1665,963"/>
<area shape="poly" title=" " alt="" coords="1354,940,1412,940,1412,945,1354,945"/>
<area shape="rect" href="classabsl_1_1any.html#ac0db0b7b1d417778376dbca6f5604ae5" title=" " alt="" coords="1790,394,1902,419"/>
<area shape="poly" title=" " alt="" coords="1561,920,1614,843,1643,792,1667,738,1678,692,1681,650,1672,574,1670,538,1674,503,1687,467,1716,430,1743,412,1774,403,1776,408,1745,416,1719,434,1692,470,1679,504,1675,538,1678,574,1686,650,1684,693,1672,739,1648,794,1619,846,1566,923"/>
<area shape="rect" href="classabsl_1_1bernoulli__distribution.html#a2ab61e1795ae631e6a0d598b3b450a08" title=" " alt="" coords="1760,444,1932,484"/>
<area shape="poly" title=" " alt="" coords="1561,920,1613,842,1642,791,1667,738,1677,702,1680,669,1677,609,1677,581,1681,553,1693,525,1715,495,1744,475,1747,480,1719,499,1698,528,1686,555,1682,582,1683,609,1686,669,1682,703,1672,739,1647,794,1618,845,1565,923"/>
<area shape="rect" href="classabsl_1_1beta__distribution.html#aab4ba94645bb1320e5626edbd622e3ae" title=" " alt="" coords="1772,509,1920,550"/>
<area shape="poly" title=" " alt="" coords="1560,921,1612,842,1641,791,1667,737,1676,711,1679,687,1681,644,1687,603,1698,582,1715,561,1734,546,1755,537,1758,542,1737,551,1719,564,1702,585,1693,604,1686,644,1685,688,1681,712,1672,740,1646,794,1616,845,1565,924"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1node__handle__base.html#ac5bd468dbb0966e41568556bfb267ade" title=" " alt="" coords="1759,574,1933,615"/>
<area shape="poly" title=" " alt="" coords="1559,920,1609,841,1667,737,1679,705,1685,678,1694,652,1716,626,1743,609,1746,613,1719,630,1698,654,1690,679,1684,707,1672,740,1613,844,1563,923"/>
<area shape="rect" href="classabsl_1_1discrete__distribution.html#a283404b8b036394800e2b7aa508a584c" title=" " alt="" coords="1761,640,1931,680"/>
<area shape="poly" title=" " alt="" coords="1557,920,1631,797,1676,733,1716,691,1745,675,1748,680,1719,695,1680,736,1635,800,1561,923"/>
<area shape="rect" href="classabsl_1_1exponential__distribution.html#a9d46c5f69b2115771ccd679dabe84c8d" title=" " alt="" coords="1751,705,1941,746"/>
<area shape="poly" title=" " alt="" coords="1558,920,1584,885,1620,840,1664,795,1716,756,1735,746,1738,751,1719,761,1668,799,1624,844,1588,888,1563,923"/>
<area shape="rect" href="classabsl_1_1gaussian__distribution.html#a0eeca27ee347bed1e27672bf8ef66b92" title=" " alt="" coords="1758,770,1934,811"/>
<area shape="poly" title=" " alt="" coords="1569,920,1633,871,1674,844,1716,821,1743,811,1745,816,1718,826,1676,849,1636,875,1573,924"/>
<area shape="rect" href="classabsl_1_1log__uniform__int__distribution.html#a2ce353d92e45b1111fc30cac43274c14" title=" " alt="" coords="1775,836,1917,876"/>
<area shape="poly" title=" " alt="" coords="1609,919,1717,885,1760,874,1761,879,1718,890,1610,924"/>
<area shape="rect" href="classabsl_1_1optional.html#a8dfe8f9b4f502b6e94ca9fc3cc75a15f" title=" " alt="" coords="1778,900,1914,926"/>
<area shape="poly" title=" " alt="" coords="1552,963,1559,982,1570,997,1585,1010,1602,1020,1645,1032,1692,1034,1740,1024,1783,1006,1818,977,1830,960,1838,940,1843,942,1834,963,1821,981,1786,1010,1741,1030,1692,1039,1644,1038,1600,1025,1582,1014,1566,1001,1555,984,1547,964"/>
<area shape="poly" title=" " alt="" coords="1553,962,1561,977,1572,989,1604,1007,1645,1015,1691,1016,1738,1008,1781,992,1815,969,1828,955,1837,940,1841,942,1832,958,1819,973,1783,997,1739,1013,1692,1021,1645,1021,1602,1012,1569,993,1556,980,1548,964"/>
<area shape="poly" title=" " alt="" coords="1555,961,1575,981,1607,993,1647,998,1691,998,1736,991,1777,978,1811,961,1834,938,1838,942,1814,965,1779,983,1737,996,1692,1003,1646,1004,1605,998,1572,985,1551,965"/>
<area shape="poly" title=" " alt="" coords="1560,961,1582,973,1614,979,1652,981,1694,979,1735,974,1774,964,1807,951,1830,936,1833,940,1809,956,1776,969,1736,979,1694,985,1652,987,1613,984,1580,978,1557,966"/>
<area shape="poly" title=" " alt="" coords="1584,961,1641,964,1709,960,1774,949,1824,932,1825,937,1775,954,1709,965,1641,970,1583,966"/>
<area shape="poly" title=" " alt="" coords="1665,946,1739,938,1803,928,1804,933,1740,944,1666,951"/>
<area shape="poly" title=" " alt="" coords="1665,928,1762,919,1763,924,1666,934"/>
<area shape="poly" title=" " alt="" coords="1609,919,1684,908,1762,902,1763,908,1685,914,1609,924"/>
<area shape="poly" title=" " alt="" coords="1566,919,1620,901,1691,890,1764,886,1820,892,1820,897,1764,891,1692,895,1621,906,1568,924"/>
<area shape="poly" title=" " alt="" coords="1555,919,1577,903,1609,889,1647,879,1689,872,1731,869,1771,870,1806,876,1831,887,1829,892,1804,881,1771,876,1731,874,1689,877,1648,884,1610,894,1579,907,1558,924"/>
<area shape="poly" title=" " alt="" coords="1550,920,1571,896,1603,876,1644,862,1689,854,1734,852,1777,856,1812,866,1837,884,1834,889,1810,871,1776,861,1734,857,1690,859,1645,867,1606,881,1574,900,1554,923"/>
<area shape="poly" title=" " alt="" coords="1548,921,1556,904,1568,888,1601,863,1643,846,1690,836,1738,834,1781,841,1817,858,1831,870,1841,884,1836,887,1827,873,1814,862,1780,847,1737,840,1691,841,1645,851,1603,868,1572,892,1560,906,1553,923"/>
<area shape="poly" title=" " alt="" coords="1547,921,1554,900,1566,881,1599,850,1642,829,1691,818,1740,817,1785,827,1804,837,1821,850,1834,865,1843,884,1838,886,1829,868,1817,853,1801,842,1783,832,1739,822,1691,823,1644,834,1602,854,1570,884,1559,902,1552,923"/>
<area shape="rect" href="classabsl_1_1poisson__distribution.html#ab0710bb9dabd8b673663d6721aed099a" title=" " alt="" coords="1762,950,1930,991"/>
<area shape="poly" title=" " alt="" coords="1666,951,1747,959,1746,964,1665,956"/>
<area shape="rect" href="classabsl_1_1random__internal_1_1sequence__urbg.html#a99fa9a5c36e514966a1d0e637768f204" title=" " alt="" coords="1769,1016,1923,1056"/>
<area shape="poly" title=" " alt="" coords="1604,961,1718,1000,1754,1010,1753,1016,1717,1005,1602,966"/>
<area shape="rect" href="classabsl_1_1uniform__int__distribution.html#a17e835faa5e38003db98c77e3278d4a9" title=" " alt="" coords="1752,1081,1940,1122"/>
<area shape="poly" title=" " alt="" coords="1572,961,1635,1013,1675,1041,1719,1065,1738,1074,1736,1079,1716,1070,1673,1046,1632,1018,1568,965"/>
<area shape="rect" href="classabsl_1_1uniform__real__distribution.html#abe4e75a5e009149340657b70d378fb0c" title=" " alt="" coords="1782,1146,1910,1187"/>
<area shape="poly" title=" " alt="" coords="1558,962,1582,1001,1618,1050,1665,1101,1719,1143,1742,1155,1768,1163,1766,1168,1740,1160,1716,1147,1661,1105,1614,1054,1578,1004,1554,964"/>
<area shape="poly" title=" " alt="" coords="1567,962,1628,1039,1670,1082,1719,1119,1768,1140,1766,1145,1716,1123,1667,1086,1624,1043,1563,965"/>
<area shape="rect" href="classabsl_1_1zipf__distribution.html#a88595f1f987de7cfcef5d81328d088e5" title=" " alt="" coords="1774,1212,1918,1252"/>
<area shape="poly" title=" " alt="" coords="1558,962,1579,1011,1613,1074,1660,1140,1688,1170,1719,1196,1760,1216,1757,1221,1716,1201,1684,1174,1656,1144,1608,1077,1574,1013,1553,964"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#ade6fd5284ee62f16e86c96b5f7ab344d" title=" " alt="" coords="1758,1277,1934,1318"/>
<area shape="poly" title=" " alt="" coords="1555,962,1572,1022,1604,1103,1626,1147,1652,1189,1683,1228,1719,1262,1745,1277,1742,1282,1716,1266,1679,1232,1648,1192,1621,1149,1599,1105,1567,1024,1550,964"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a1f008db92b4d0d747746b74c52640545" title=" " alt="" coords="1731,1342,1961,1383"/>
<area shape="poly" title=" " alt="" coords="1553,963,1566,1033,1596,1132,1617,1185,1645,1237,1679,1285,1719,1327,1724,1331,1721,1336,1716,1331,1674,1289,1640,1240,1613,1187,1591,1134,1561,1034,1548,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1ismcts_1_1_i_s_m_c_t_s_bot.html#aebc4c2690cbd5350976c463c39794650" title=" " alt="" coords="1727,1408,1965,1448"/>
<area shape="poly" title=" " alt="" coords="1551,963,1561,1043,1572,1099,1587,1159,1609,1223,1637,1285,1674,1342,1719,1393,1724,1396,1720,1400,1715,1396,1670,1346,1633,1287,1604,1225,1582,1161,1567,1100,1556,1044,1546,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1catch_1_1_environment.html#a0d19f39c580c7fbb77f691a3b85d696d" title=" " alt="" coords="1722,1473,1970,1514"/>
<area shape="poly" title=" " alt="" coords="1550,963,1556,1054,1565,1117,1579,1187,1601,1260,1630,1332,1669,1400,1693,1430,1719,1458,1724,1462,1720,1466,1715,1462,1689,1434,1665,1403,1625,1335,1596,1262,1574,1188,1560,1118,1551,1054,1545,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1cliff__walking_1_1_environment.html#af48d9954f8071a2d7209bc191d5d9aa4" title=" " alt="" coords="1729,1538,1963,1579"/>
<area shape="poly" title=" " alt="" coords="1549,963,1552,1063,1559,1134,1571,1214,1592,1297,1622,1379,1664,1456,1690,1491,1719,1523,1723,1527,1720,1531,1715,1527,1686,1495,1660,1459,1618,1382,1587,1299,1566,1215,1553,1135,1547,1063,1544,963"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1environments_1_1iterated__matrix__game_1_1_iterated_matrix_game.html#a7c617ff68dbece5f2f407453544db0ac" title=" " alt="" coords="1718,1604,1974,1644"/>
<area shape="poly" title=" " alt="" coords="1553,963,1571,1090,1606,1279,1630,1377,1656,1467,1686,1540,1702,1568,1719,1589,1723,1592,1720,1596,1715,1592,1698,1571,1682,1542,1651,1468,1624,1378,1601,1280,1566,1091,1547,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1atari_1_1_noop_reset_env.html#ac02beff549203ee5de49b1b30a0b2607" title=" " alt="" coords="1745,1693,1947,1734"/>
<area shape="poly" title=" " alt="" coords="1553,963,1571,1100,1607,1307,1630,1415,1657,1515,1687,1597,1703,1629,1719,1654,1737,1671,1757,1684,1754,1688,1733,1675,1715,1658,1698,1632,1682,1599,1652,1516,1625,1416,1601,1308,1566,1101,1547,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1games_1_1chat__games_1_1utils_1_1logging__utils_1_1_color_text.html#a6ecef6232f846a4641a2a52f6b645d45" title=" " alt="" coords="1743,1757,1949,1813"/>
<area shape="poly" title=" " alt="" coords="1552,963,1567,1116,1598,1351,1621,1474,1649,1587,1681,1681,1700,1716,1719,1743,1732,1754,1728,1758,1715,1747,1695,1719,1677,1683,1644,1589,1616,1475,1593,1352,1561,1117,1546,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a893f29582436b18cf75acab03bf9a0f6" title=" " alt="" coords="1717,1837,1975,1878"/>
<area shape="poly" title=" " alt="" coords="1551,963,1563,1130,1575,1254,1592,1390,1614,1526,1642,1652,1659,1707,1677,1754,1697,1794,1719,1823,1721,1825,1717,1829,1715,1827,1693,1797,1672,1757,1654,1708,1637,1653,1609,1527,1586,1391,1570,1255,1558,1130,1546,963"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_regret_minimizer.html#a5e7d042c062cd5060dbc72e3e209a019" title=" " alt="" coords="1718,1902,1974,1943"/>
<area shape="poly" title=" " alt="" coords="1551,963,1561,1141,1572,1274,1588,1420,1610,1567,1639,1702,1656,1761,1675,1813,1696,1855,1719,1887,1723,1891,1719,1895,1715,1891,1692,1858,1670,1815,1651,1763,1634,1703,1605,1568,1583,1421,1567,1275,1556,1141,1546,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_m_l_p.html#ae91f4f3690f3b77d4e81a07f2459e7b0" title=" " alt="" coords="1743,1968,1949,2008"/>
<area shape="poly" title=" " alt="" coords="1551,963,1559,1152,1569,1294,1584,1451,1606,1608,1635,1753,1653,1817,1673,1872,1695,1918,1719,1953,1732,1964,1728,1968,1715,1956,1690,1921,1668,1875,1648,1818,1630,1754,1601,1609,1579,1451,1564,1295,1554,1152,1545,964"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1deep__cfr_1_1_sonnet_linear.html#a93a986c411cf799e0bce4ac540bb2f8d" title=" " alt="" coords="1743,2033,1949,2074"/>
<area shape="poly" title=" " alt="" coords="1550,963,1557,1162,1566,1313,1581,1480,1602,1649,1631,1804,1649,1872,1670,1932,1693,1981,1719,2018,1732,2029,1728,2033,1715,2022,1689,1984,1665,1934,1644,1874,1626,1805,1597,1650,1575,1481,1561,1314,1552,1162,1545,963"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1rl__environment_1_1_environment.html#a26dbd83ee35fa2014b86b34fcb5bb292" title=" " alt="" coords="1741,2098,1951,2139"/>
<area shape="poly" title=" " alt="" coords="1550,963,1555,1173,1563,1334,1577,1511,1598,1690,1628,1856,1646,1928,1668,1992,1692,2044,1719,2083,1730,2093,1727,2097,1715,2087,1687,2047,1663,1994,1641,1930,1622,1857,1593,1691,1572,1512,1558,1334,1550,1174,1545,963"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1replay__buffer_1_1_replay_buffer.html#aff43350cf33a3bd8a628b204947eea23" title=" " alt="" coords="1749,2164,1943,2204"/>
<area shape="poly" title=" " alt="" coords="1550,963,1553,1183,1560,1353,1573,1541,1594,1731,1624,1907,1643,1984,1665,2051,1691,2107,1719,2149,1737,2163,1734,2168,1715,2152,1686,2110,1660,2053,1638,1985,1619,1908,1588,1732,1568,1542,1555,1354,1548,1184,1545,963"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1utils_1_1stats_1_1_basic_stats.html#a2d62de15dda65996427a13c750917ef1" title=" " alt="" coords="1750,2229,1942,2270"/>
<area shape="poly" title=" " alt="" coords="1550,963,1551,1194,1557,1373,1569,1572,1590,1772,1620,1958,1640,2039,1663,2111,1689,2170,1719,2214,1738,2229,1735,2233,1715,2218,1685,2172,1658,2113,1635,2041,1615,1959,1584,1773,1564,1572,1552,1374,1546,1194,1545,963"/>
<area shape="poly" title=" " alt="" coords="1790,1693,1788,1683,1797,1674,1816,1668,1846,1666,1878,1669,1897,1675,1895,1680,1877,1674,1846,1671,1817,1673,1799,1678,1793,1684,1795,1691"/>
<area shape="poly" title=" " alt="" coords="1358,640,1373,627,1394,597,1402,567,1401,537,1397,506,1392,475,1392,443,1400,411,1421,379,1424,376,1428,380,1425,383,1405,413,1397,444,1397,474,1402,505,1407,537,1407,568,1399,600,1377,631,1361,644"/>
<area shape="poly" title=" " alt="" coords="1375,676,1408,680,1407,685,1374,681"/>
<area shape="poly" title=" " alt="" coords="1350,639,1374,627,1424,586,1467,537,1501,487,1526,445,1530,448,1506,490,1471,540,1428,590,1376,631,1352,644"/>
<area shape="poly" title=" " alt="" coords="1374,644,1407,640,1408,645,1375,649"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a49083992dc97516ca2e134c672e2520e_icgraph">
<area shape="rect" title=" " alt="" coords="884,294,1128,335"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a20a9c683dd11b09e5667692bc1ab6891" name="a20a9c683dd11b09e5667692bc1ab6891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a9c683dd11b09e5667692bc1ab6891">&#9670;&#160;</a></span>train_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.train_state </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00726">726</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  726</span>  <span class="keyword">def </span>train_state(self):</div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordflow">return</span> deepcopy(self._train_state)</div>
<div class="line"><span class="lineno">  728</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00759">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_value_fn()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph" id="aclassopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent_a20a9c683dd11b09e5667692bc1ab6891_icgraph">
<area shape="rect" title=" " alt="" coords="1460,334,1739,375"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a92fdbbc16d1a44597453d7f3bd1c6278" title=" " alt="" coords="1185,287,1403,342"/>
<area shape="poly" title=" " alt="" coords="1444,337,1403,331,1404,326,1445,332"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#ad592a86c90ce19aa7b49b93823803fe6" title=" " alt="" coords="1176,367,1412,422"/>
<area shape="poly" title=" " alt="" coords="1445,377,1413,382,1412,376,1444,372"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_opponent_shaping_agent.html#a49083992dc97516ca2e134c672e2520e" title=" " alt="" coords="884,294,1128,335"/>
<area shape="poly" title=" " alt="" coords="1169,317,1128,317,1128,312,1169,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#a14d11483beff07f087b51f3a2dd71135" title=" " alt="" coords="606,5,792,61"/>
<area shape="poly" title=" " alt="" coords="987,281,964,235,930,179,887,123,862,98,835,75,791,53,794,49,838,71,866,94,891,119,935,176,969,232,992,279"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1jax_1_1cfr_1_1jax__cfr_1_1_jax_c_f_r.html#adb88039a6a02b4d0090a0abc5c3c5424" title=" " alt="" coords="606,85,792,126"/>
<area shape="poly" title=" " alt="" coords="980,283,920,210,880,173,835,141,791,123,793,118,838,136,883,168,924,207,984,280"/>
<area shape="rect" href="classmeta__selfplay__agent_1_1_meta_selfplay_agent.html#ac08a633652249ac8f88b28c93aef5781" title=" " alt="" coords="612,150,786,191"/>
<area shape="poly" title=" " alt="" coords="966,287,907,244,835,205,785,188,787,183,837,200,910,240,969,282"/>
<area shape="rect" href="classrnn__meta__selfplay__agent_1_1_meta_selfplay_agent.html#a98bd66960be5abdc4ea6d5a140ca9817" title=" " alt="" coords="614,215,784,270"/>
<area shape="poly" title=" " alt="" coords="901,293,783,265,785,260,902,287"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a7a91195b9b42b8536e06098e836b02e4" title=" " alt="" coords="573,294,824,335"/>
<area shape="poly" title=" " alt="" coords="869,317,825,317,825,312,869,312"/>
<area shape="rect" href="classnash__evolutionary__search_1_1_nash_c_m_a_e_s.html#a42b13c1091631c52988a6391fe34038a" title=" " alt="" coords="610,360,787,400"/>
<area shape="poly" title=" " alt="" coords="893,341,788,364,787,359,892,336"/>
<area shape="rect" href="classnash__random__search_1_1_nash_random_search.html#a9b9967669c24ceba55dc8ce00565a71a" title=" " alt="" coords="584,425,813,466"/>
<area shape="poly" title=" " alt="" coords="964,346,905,381,837,414,801,427,799,422,835,409,903,377,961,341"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1mfg_1_1algorithms_1_1bandit__regret_1_1_polynomial_weight_algorithm.html#a3b7ceacfd8a03895a691242d227c1ddd" title=" " alt="" coords="561,490,836,531"/>
<area shape="poly" title=" " alt="" coords="982,348,922,415,882,450,838,479,810,492,808,487,835,475,878,446,918,412,978,345"/>
<area shape="rect" href="classregret__minimizer_1_1_regret_minimizer.html#aa371edb5793c6a6cfbf51dc8597905dc" title=" " alt="" coords="566,555,831,581"/>
<area shape="poly" title=" " alt="" coords="992,350,968,396,934,449,891,501,865,525,838,545,813,557,811,552,835,540,862,521,887,498,930,446,964,393,987,348"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1double__oracle_1_1_double_oracle_solver.html#a44f0c375b5ef20bb1267524788ab16da" title=" " alt="" coords="281,294,513,335"/>
<area shape="poly" title=" " alt="" coords="557,317,514,317,514,312,557,312"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1mcts_1_1_m_c_t_s_bot.html#a14e053b461dc025b01a41453bc278c7d" title=" " alt="" coords="5,294,233,335"/>
<area shape="poly" title=" " alt="" coords="265,317,233,317,233,312,265,312"/>
</map>
</div>

</div>
</div>
<a id="a3fd78be8c0cd590a8c974be8e603d2d1" name="a3fd78be8c0cd590a8c974be8e603d2d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fd78be8c0cd590a8c974be8e603d2d1">&#9670;&#160;</a></span>update_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.update_params </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1jax_1_1opponent__shaping_1_1_train_state.html">TrainState</a></td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>player_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Updates the parameters of the other agents.

Args:
    state: the train state of the other agent.
    player_id: id of the other agent

Returns:
</pre> 
<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00743">743</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  743</span>  <span class="keyword">def </span>update_params(self, state: TrainState, player_id: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  744</span>    <span class="stringliteral">&quot;&quot;&quot;Updates the parameters of the other agents.</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral">        state: the train state of the other agent.</span></div>
<div class="line"><span class="lineno">  748</span><span class="stringliteral">        player_id: id of the other agent</span></div>
<div class="line"><span class="lineno">  749</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  750</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  751</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  752</span>    self._train_state.policy_params[player_id] = deepcopy(</div>
<div class="line"><span class="lineno">  753</span>        state.policy_params[player_id]</div>
<div class="line"><span class="lineno">  754</span>    )</div>
<div class="line"><span class="lineno">  755</span>    self._train_state.critic_params[player_id] = deepcopy(</div>
<div class="line"><span class="lineno">  756</span>        state.critic_params[player_id]</div>
<div class="line"><span class="lineno">  757</span>    )</div>
<div class="line"><span class="lineno">  758</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="opponent__shaping_8py_source.html#l00661">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7d512f8db3cd6995a357d1b1a9a29fe9" name="a7d512f8db3cd6995a357d1b1a9a29fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d512f8db3cd6995a357d1b1a9a29fe9">&#9670;&#160;</a></span>_batch_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._batch_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00633">633</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2nfsp_8py_source.html#l00244">open_spiel.python.algorithms.nfsp.NFSP._learn()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00266">open_spiel.python.jax.nfsp.NFSP._learn()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01052">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="dataset__generator_8py_source.html#l00034">dataset_generator.Dataset.get_batch()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00305">open_spiel.python.algorithms.dqn.DQN.learn()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00310">open_spiel.python.jax.dqn.DQN.learn()</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00221">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy.learn()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00348">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.learn()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00301">open_spiel.python.pytorch.dqn.DQN.learn()</a>, <a class="el" href="iterated__matrix__game_8py_source.html#l00144">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame.reset()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="iterated__matrix__game_8py_source.html#l00089">open_spiel.python.environments.iterated_matrix_game.IteratedMatrixGame.step()</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="a1be0298b8c774973728e71ee9e51350d" name="a1be0298b8c774973728e71ee9e51350d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1be0298b8c774973728e71ee9e51350d">&#9670;&#160;</a></span>_critic_network</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_network</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00652">652</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00734">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.critic_network()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00759">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_value_fn()</a>.</p>

</div>
</div>
<a id="af418dfaf2a015727355307aecf6f29dc" name="af418dfaf2a015727355307aecf6f29dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af418dfaf2a015727355307aecf6f29dc">&#9670;&#160;</a></span>_critic_opt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_opt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00653">653</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>.</p>

</div>
</div>
<a id="a9974fd169e235555eba0df4b5c521a89" name="a9974fd169e235555eba0df4b5c521a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9974fd169e235555eba0df4b5c521a89">&#9670;&#160;</a></span>_critic_update_fns</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._critic_update_fns</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00700">700</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l01029">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_critic()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l01035">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents()</a>.</p>

</div>
</div>
<a id="a779706e86904f179eadedece2dcf90f3" name="a779706e86904f179eadedece2dcf90f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779706e86904f179eadedece2dcf90f3">&#9670;&#160;</a></span>_current_policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._current_policy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00662">662</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2cfr_8py_source.html#l00339">open_spiel.python.algorithms.cfr._CFRSolverBase._get_infostate_policy()</a>, <a class="el" href="efr_8py_source.html#l00413">open_spiel.python.algorithms.efr._EFRSolverBase._get_infostate_policy()</a>, <a class="el" href="algorithms_2cfr_8py_source.html#l00176">open_spiel.python.algorithms.cfr._CFRSolverBase._initialize_info_state_nodes()</a>, <a class="el" href="algorithms_2discounted__cfr_8py_source.html#l00059">open_spiel.python.algorithms.discounted_cfr._DCFRSolver._initialize_info_state_nodes()</a>, <a class="el" href="efr_8py_source.html#l00165">open_spiel.python.algorithms.efr._EFRSolverBase._initialize_info_state_nodes()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01022">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy()</a>, <a class="el" href="algorithms_2cfr_8py_source.html#l00208">open_spiel.python.algorithms.cfr._CFRSolverBase.current_policy()</a>, <a class="el" href="efr_8py_source.html#l00134">open_spiel.python.algorithms.efr._EFRSolverBase.current_policy()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>.</p>

</div>
</div>
<a id="aa25f34ed6d72e2dc0b30dc1ed2941f76" name="aa25f34ed6d72e2dc0b30dc1ed2941f76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25f34ed6d72e2dc0b30dc1ed2941f76">&#9670;&#160;</a></span>_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00640">640</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00098">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer.__iter__()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00110">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.__iter__()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00371">open_spiel.python.algorithms.nfsp.ReservoirBuffer.__iter__()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00106">open_spiel.python.jax.deep_cfr.ReservoirBuffer.__iter__()</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00191">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer.__iter__()</a>, <a class="el" href="replay__buffer_8py_source.html#l00074">open_spiel.python.utils.replay_buffer.ReplayBuffer.__iter__()</a>, <a class="el" href="reservoir__buffer_8py_source.html#l00077">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer.__iter__()</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00095">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer.__len__()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00107">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.__len__()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00368">open_spiel.python.algorithms.nfsp.ReservoirBuffer.__len__()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00103">open_spiel.python.jax.deep_cfr.ReservoirBuffer.__len__()</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00188">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer.__len__()</a>, <a class="el" href="lru__cache_8py_source.html#l00091">open_spiel.python.utils.lru_cache.LRUCache.__len__()</a>, <a class="el" href="replay__buffer_8py_source.html#l00071">open_spiel.python.utils.replay_buffer.ReplayBuffer.__len__()</a>, <a class="el" href="reservoir__buffer_8py_source.html#l00074">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer.__len__()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00060">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer.add()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00072">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.add()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00333">open_spiel.python.algorithms.nfsp.ReservoirBuffer.add()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00068">open_spiel.python.jax.deep_cfr.ReservoirBuffer.add()</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00154">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer.add()</a>, <a class="el" href="replay__buffer_8py_source.html#l00034">open_spiel.python.utils.replay_buffer.ReplayBuffer.add()</a>, <a class="el" href="reservoir__buffer_8py_source.html#l00039">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer.add()</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00091">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer.clear()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00103">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.clear()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00364">open_spiel.python.algorithms.nfsp.ReservoirBuffer.clear()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00099">open_spiel.python.jax.deep_cfr.ReservoirBuffer.clear()</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00184">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer.clear()</a>, <a class="el" href="lru__cache_8py_source.html#l00051">open_spiel.python.utils.lru_cache.LRUCache.clear()</a>, <a class="el" href="reservoir__buffer_8py_source.html#l00070">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer.clear()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00114">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.data()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00110">open_spiel.python.jax.deep_cfr.ReservoirBuffer.data()</a>, <a class="el" href="lru__cache_8py_source.html#l00069">open_spiel.python.utils.lru_cache.LRUCache.get()</a>, <a class="el" href="lru__cache_8py_source.html#l00088">open_spiel.python.utils.lru_cache.LRUCache.info()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00059">open_spiel.python.algorithms.eva.QueryableFixedSizeRingBuffer.knn()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00055">open_spiel.python.pytorch.eva.QueryableFixedSizeRingBuffer.knn()</a>, <a class="el" href="lru__cache_8py_source.html#l00056">open_spiel.python.utils.lru_cache.LRUCache.make()</a>, <a class="el" href="replay__buffer_8py_source.html#l00066">open_spiel.python.utils.replay_buffer.ReplayBuffer.reset()</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00074">open_spiel.python.algorithms.deep_cfr.ReservoirBuffer.sample()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00086">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.sample()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00347">open_spiel.python.algorithms.nfsp.ReservoirBuffer.sample()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00082">open_spiel.python.jax.deep_cfr.ReservoirBuffer.sample()</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00168">open_spiel.python.pytorch.deep_cfr.ReservoirBuffer.sample()</a>, <a class="el" href="replay__buffer_8py_source.html#l00049">open_spiel.python.utils.replay_buffer.ReplayBuffer.sample()</a>, <a class="el" href="reservoir__buffer_8py_source.html#l00053">open_spiel.python.utils.reservoir_buffer.ReservoirBuffer.sample()</a>, <a class="el" href="lru__cache_8py_source.html#l00080">open_spiel.python.utils.lru_cache.LRUCache.set()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00117">open_spiel.python.algorithms.deep_cfr_tf2.ReservoirBuffer.shuffle_data()</a>, and <a class="el" href="jax_2deep__cfr_8py_source.html#l00113">open_spiel.python.jax.deep_cfr.ReservoirBuffer.shuffle_data()</a>.</p>

</div>
</div>
<a id="a06c10635825968de3e335fb21cb40487" name="a06c10635825968de3e335fb21cb40487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c10635825968de3e335fb21cb40487">&#9670;&#160;</a></span>_discount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._discount</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00635">635</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l01052">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00322">open_spiel.python.algorithms.eva.EVAAgent._trajectory_centric_planning()</a>, and <a class="el" href="pytorch_2eva_8py_source.html#l00301">open_spiel.python.pytorch.eva.EVAAgent._trajectory_centric_planning()</a>.</p>

</div>
</div>
<a id="a2bb2cffe0b4db2762a123cf45521ac6c" name="a2bb2cffe0b4db2762a123cf45521ac6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bb2cffe0b4db2762a123cf45521ac6c">&#9670;&#160;</a></span>_episode_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._episode_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00648">648</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="ac39e3b45ac16eb5b85022bd9b4977450" name="ac39e3b45ac16eb5b85022bd9b4977450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac39e3b45ac16eb5b85022bd9b4977450">&#9670;&#160;</a></span>_fit_opponent_model</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._fit_opponent_model</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00642">642</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>

</div>
</div>
<a id="ad8dcd4e6158402b9eb2e531c06b0b9a0" name="ad8dcd4e6158402b9eb2e531c06b0b9a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8dcd4e6158402b9eb2e531c06b0b9a0">&#9670;&#160;</a></span>_metrics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._metrics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00641">641</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00923">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_step()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00737">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.metrics()</a>.</p>

</div>
</div>
<a id="a23a99f733cb36d9942b3566feef619c9" name="a23a99f733cb36d9942b3566feef619c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23a99f733cb36d9942b3566feef619c9">&#9670;&#160;</a></span>_num_actions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_actions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00632">632</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="jax_2policy__gradient_8py_source.html#l00040">open_spiel.python.jax.policy_gradient.NetA2C.__call__()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00057">open_spiel.python.jax.policy_gradient.NetPG.__call__()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00281">open_spiel.python.algorithms.policy_gradient.PolicyGradient._act()</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00145">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._act()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00226">open_spiel.python.algorithms.nfsp.NFSP._add_transition()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00233">open_spiel.python.jax.nfsp.NFSP._add_transition()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="average__network__fictitious__play_8py_source.html#l00197">open_spiel.python.mfg.algorithms.average_network_fictitious_play.AveragePolicy._add_transition()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00209">open_spiel.python.algorithms.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00194">open_spiel.python.pytorch.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00269">open_spiel.python.algorithms.dqn.DQN._epsilon_greedy()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00368">open_spiel.python.algorithms.eva.EVAAgent._epsilon_greedy()</a>, <a class="el" href="tabular__multiagent__qlearner_8py_source.html#l00210">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._epsilon_greedy()</a>, <a class="el" href="tabular__qlearner_8py_source.html#l00056">open_spiel.python.algorithms.tabular_qlearner.QLearner._epsilon_greedy()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00233">open_spiel.python.jax.dqn.DQN._epsilon_greedy()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00266">open_spiel.python.pytorch.dqn.DQN._epsilon_greedy()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00342">open_spiel.python.pytorch.eva.EVAAgent._epsilon_greedy()</a>, <a class="el" href="wolf__phc_8py_source.html#l00130">open_spiel.python.algorithms.wolf_phc.WoLFPHC._get_action_probs()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00600">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._get_matched_regrets()</a>, <a class="el" href="tabular__multiagent__qlearner_8py_source.html#l00201">open_spiel.python.algorithms.tabular_multiagent_qlearner.MultiagentQLearner._get_payoffs_array()</a>, <a class="el" href="chat__game__base_8py_source.html#l00236">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._legal_actions()</a>, <a class="el" href="normal__form__game_8py_source.html#l00166">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState._legal_actions()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01052">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00391">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._reinitialize_advantage_network()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00294">open_spiel.python.jax.deep_cfr.DeepCFRSolver._reinitialize_advantage_network()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00286">open_spiel.python.jax.deep_cfr.DeepCFRSolver._reinitialize_policy_network()</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00336">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._sample_action_from_advantage()</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00393">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._sample_action_from_advantage()</a>, <a class="el" href="boltzmann__tabular__qlearner_8py_source.html#l00054">open_spiel.python.algorithms.boltzmann_tabular_qlearner.BoltzmannQLearner._softmax()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00305">open_spiel.python.jax.dqn.DQN._to_one_hot()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00342">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._to_one_hot()</a>, <a class="el" href="algorithms_2deep__cfr_8py_source.html#l00282">open_spiel.python.algorithms.deep_cfr.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="algorithms_2deep__cfr__tf2_8py_source.html#l00552">open_spiel.python.algorithms.deep_cfr_tf2.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="jax_2deep__cfr_8py_source.html#l00416">open_spiel.python.jax.deep_cfr.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="pytorch_2deep__cfr_8py_source.html#l00338">open_spiel.python.pytorch.deep_cfr.DeepCFRSolver._traverse_game_tree()</a>, <a class="el" href="chat__game__base_8py_source.html#l00153">open_spiel.python.games.chat_games.chat_game_base.ChatGameState._unravel_flat_action()</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00255">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot._update_for_state()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00405">open_spiel.python.algorithms.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00378">open_spiel.python.pytorch.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="catch_8py_source.html#l00167">open_spiel.python.environments.catch.Environment.action_spec()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00223">open_spiel.python.algorithms.dqn.DQN.add_transition()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00208">open_spiel.python.jax.dqn.DQN.add_transition()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00241">open_spiel.python.pytorch.dqn.DQN.add_transition()</a>, <a class="el" href="normal__form__game_8py_source.html#l00204">open_spiel.python.mfg.games.normal_form_game.MFGNormalFormState.distribution_support()</a>, <a class="el" href="chat__game__base_8py_source.html#l00550">open_spiel.python.games.chat_games.chat_game_base.ChatGameState.num_actions()</a>, <a class="el" href="catch_8py_source.html#l00153">open_spiel.python.environments.catch.Environment.observation_spec()</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00225">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.restart()</a>, <a class="el" href="mcts__agent_8py_source.html#l00035">open_spiel.python.algorithms.mcts_agent.MCTSAgent.step()</a>, <a class="el" href="random__agent_8py_source.html#l00029">open_spiel.python.algorithms.random_agent.RandomAgent.step()</a>, <a class="el" href="bluechip__bridge_8py_source.html#l00323">open_spiel.python.bots.bluechip_bridge.BlueChipBridgeBot.step()</a>, <a class="el" href="rl__response_8py_source.html#l00139">open_spiel.python.examples.rl_response.FirstActionAgent.step()</a>, <a class="el" href="roshambo__population__example_8py_source.html#l00063">open_spiel.python.examples.roshambo_population_example.BotAgent.step()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, and <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="a5100ba4834fa702cd43d6f0a564ef540" name="a5100ba4834fa702cd43d6f0a564ef540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5100ba4834fa702cd43d6f0a564ef540">&#9670;&#160;</a></span>_num_learn_steps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_learn_steps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00649">649</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="abea4e95324109926c7e76c4d01dfd89b" name="abea4e95324109926c7e76c4d01dfd89b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea4e95324109926c7e76c4d01dfd89b">&#9670;&#160;</a></span>_num_mini_batches</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_mini_batches</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00637">637</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

</div>
</div>
<a id="afc9e9588e36469286f584a8e913603be" name="afc9e9588e36469286f584a8e913603be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9e9588e36469286f584a8e913603be">&#9670;&#160;</a></span>_num_opponent_updates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._num_opponent_updates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00636">636</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

</div>
</div>
<a id="abe09591c36f5e4d95fffab133c3493e8" name="abe09591c36f5e4d95fffab133c3493e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe09591c36f5e4d95fffab133c3493e8">&#9670;&#160;</a></span>_opponent_ids</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_ids</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00643">643</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l01035">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents()</a>.</p>

</div>
</div>
<a id="ae849a5f35bfd8919d9c22ea227e71d90" name="ae849a5f35bfd8919d9c22ea227e71d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae849a5f35bfd8919d9c22ea227e71d90">&#9670;&#160;</a></span>_opponent_opt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._opponent_opt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00654">654</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>.</p>

</div>
</div>
<a id="aedb5ce2288d5efa955664b2994299bbb" name="aedb5ce2288d5efa955664b2994299bbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb5ce2288d5efa955664b2994299bbb">&#9670;&#160;</a></span>_pi_network</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._pi_network</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00651">651</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00730">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.policy_network()</a>.</p>

</div>
</div>
<a id="a1f3b10ed7573f44067bb1587355a5cc3" name="a1f3b10ed7573f44067bb1587355a5cc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f3b10ed7573f44067bb1587355a5cc3">&#9670;&#160;</a></span>_policy_opt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_opt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00655">655</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>.</p>

</div>
</div>
<a id="a909f3ed0316016ed57f3d506abda897b" name="a909f3ed0316016ed57f3d506abda897b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909f3ed0316016ed57f3d506abda897b">&#9670;&#160;</a></span>_policy_update_fns</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_fns</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00699">699</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l01035">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l01022">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy()</a>.</p>

</div>
</div>
<a id="a7ab713e153ecfb4625819c6eb0dd5dff" name="a7ab713e153ecfb4625819c6eb0dd5dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ab713e153ecfb4625819c6eb0dd5dff">&#9670;&#160;</a></span>_policy_update_interval</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._policy_update_interval</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00634">634</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l00945">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_agent()</a>.</p>

</div>
</div>
<a id="aafc3816de74383fdc79ce7c837f76ec4" name="aafc3816de74383fdc79ce7c837f76ec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc3816de74383fdc79ce7c837f76ec4">&#9670;&#160;</a></span>_prev_action</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_action</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00639">639</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00406">open_spiel.python.algorithms.dqn.DQN.prev_action()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00356">open_spiel.python.jax.dqn.DQN.prev_action()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00366">open_spiel.python.pytorch.dqn.DQN.prev_action()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="tabular__qlearner_8py_source.html#l00095">open_spiel.python.algorithms.tabular_qlearner.QLearner.step()</a>, <a class="el" href="wolf__phc_8py_source.html#l00155">open_spiel.python.algorithms.wolf_phc.WoLFPHC.step()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="a40e6cfee7a8d78903c3b501bf1ec57b2" name="a40e6cfee7a8d78903c3b501bf1ec57b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40e6cfee7a8d78903c3b501bf1ec57b2">&#9670;&#160;</a></span>_prev_time_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._prev_time_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00638">638</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01052">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, and <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>.</p>

</div>
</div>
<a id="a80daf71b7e3956716945f59d15d255e6" name="a80daf71b7e3956716945f59d15d255e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80daf71b7e3956716945f59d15d255e6">&#9670;&#160;</a></span>_rng</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._rng</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00644">644</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="rl__environment_8py_source.html#l00128">open_spiel.python.rl_environment.ChanceEventSampler.__call__()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>, <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00150">rnn_meta_selfplay_agent.MetaSelfplayAgent.initial_policy()</a>, <a class="el" href="meta__learning_8py_source.html#l00339">meta_learning.MetaCFRRegretAgent.next_policy()</a>, <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00156">rnn_meta_selfplay_agent.MetaSelfplayAgent.next_policy()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, <a class="el" href="uniform__random_8py_source.html#l00045">open_spiel.python.bots.uniform_random.UniformRandomBot.step_with_policy()</a>, and <a class="el" href="rnn__meta__selfplay__agent_8py_source.html#l00167">rnn_meta_selfplay_agent.MetaSelfplayAgent.training_optimizer()</a>.</p>

</div>
</div>
<a id="ad3d167ad340899d19d5308109aa38fed" name="ad3d167ad340899d19d5308109aa38fed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3d167ad340899d19d5308109aa38fed">&#9670;&#160;</a></span>_step_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._step_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00647">647</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2dqn_8py_source.html#l00295">open_spiel.python.algorithms.dqn.DQN._get_epsilon()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00261">open_spiel.python.jax.dqn.DQN._get_epsilon()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00404">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN._get_epsilon()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00291">open_spiel.python.pytorch.dqn.DQN._get_epsilon()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00933">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._should_update()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00887">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._store_time_step()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00172">open_spiel.python.algorithms.dqn.DQN.get_step_counter()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00145">open_spiel.python.algorithms.nfsp.NFSP.get_step_counter()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00144">open_spiel.python.jax.nfsp.NFSP.get_step_counter()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00410">open_spiel.python.algorithms.dqn.DQN.step_counter()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00360">open_spiel.python.jax.dqn.DQN.step_counter()</a>, and <a class="el" href="pytorch_2dqn_8py_source.html#l00370">open_spiel.python.pytorch.dqn.DQN.step_counter()</a>.</p>

</div>
</div>
<a id="a186d814ce717dbdd39519cfda01fd58b" name="a186d814ce717dbdd39519cfda01fd58b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a186d814ce717dbdd39519cfda01fd58b">&#9670;&#160;</a></span>_train_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._train_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00661">661</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="opponent__shaping_8py_source.html#l01029">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_critic()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01035">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_opponents()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01022">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00726">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.train_state()</a>, and <a class="el" href="opponent__shaping_8py_source.html#l00743">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.update_params()</a>.</p>

</div>
</div>
<a id="a6c378bf799aa6ace4e2b54e4edf1f4bb" name="a6c378bf799aa6ace4e2b54e4edf1f4bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c378bf799aa6ace4e2b54e4edf1f4bb">&#9670;&#160;</a></span>player_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.player_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="opponent__shaping_8py_source.html#l00631">631</a> of file <a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2nfsp_8py_source.html#l00226">open_spiel.python.algorithms.nfsp.NFSP._add_transition()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00404">open_spiel.python.algorithms.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00233">open_spiel.python.jax.nfsp.NFSP._add_transition()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00398">open_spiel.python.jax.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00382">open_spiel.python.pytorch.policy_gradient.PolicyGradient._add_transition()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00209">open_spiel.python.algorithms.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00194">open_spiel.python.pytorch.eva.EVAAgent._add_transition_replay()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00338">open_spiel.python.algorithms.dqn.DQN._full_checkpoint_name()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00271">open_spiel.python.algorithms.nfsp.NFSP._full_checkpoint_name()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00347">open_spiel.python.algorithms.policy_gradient.PolicyGradient._full_checkpoint_name()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00287">open_spiel.python.jax.nfsp.NFSP._full_checkpoint_name()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00329">open_spiel.python.pytorch.policy_gradient.PolicyGradient._full_checkpoint_name()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00859">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._init_train_state()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00342">open_spiel.python.algorithms.dqn.DQN._latest_checkpoint_filename()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00275">open_spiel.python.algorithms.nfsp.NFSP._latest_checkpoint_filename()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00352">open_spiel.python.algorithms.policy_gradient.PolicyGradient._latest_checkpoint_filename()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00291">open_spiel.python.jax.nfsp.NFSP._latest_checkpoint_filename()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00334">open_spiel.python.pytorch.policy_gradient.PolicyGradient._latest_checkpoint_filename()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01052">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._make_transition()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01029">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_critic()</a>, <a class="el" href="opponent__shaping_8py_source.html#l01022">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent._update_policy()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00405">open_spiel.python.algorithms.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="noisy__policy_8py_source.html#l00112">open_spiel.python.algorithms.noisy_policy.NoisyPolicy.action_probabilities()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00378">open_spiel.python.pytorch.eva.EVAAgent.action_probabilities()</a>, <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01015">utils.PurePolicyResponse.action_probabilities()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00223">open_spiel.python.algorithms.dqn.DQN.add_transition()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00208">open_spiel.python.jax.dqn.DQN.add_transition()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00247">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.add_transition()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00241">open_spiel.python.pytorch.dqn.DQN.add_transition()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00768">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_policy()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00759">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.get_value_fn()</a>, <a class="el" href="ppo_8py_source.html#l00308">open_spiel.python.pytorch.ppo.PPO.learn()</a>, <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01045">utils.PathBCDEResponse.pure_action()</a>, <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01033">utils.PathBCEResponse.pure_action()</a>, <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01057">utils.PathBDEResponse.pure_action()</a>, <a class="el" href="algorithms_2dqn_8py_source.html#l00175">open_spiel.python.algorithms.dqn.DQN.step()</a>, <a class="el" href="algorithms_2eva_8py_source.html#l00236">open_spiel.python.algorithms.eva.EVAAgent.step()</a>, <a class="el" href="algorithms_2nfsp_8py_source.html#l00176">open_spiel.python.algorithms.nfsp.NFSP.step()</a>, <a class="el" href="algorithms_2policy__gradient_8py_source.html#l00297">open_spiel.python.algorithms.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="bluechip__bridge__uncontested__bidding_8py_source.html#l00219">open_spiel.python.bots.bluechip_bridge_uncontested_bidding.BlueChipBridgeBot.step()</a>, <a class="el" href="jax_2dqn_8py_source.html#l00157">open_spiel.python.jax.dqn.DQN.step()</a>, <a class="el" href="jax_2nfsp_8py_source.html#l00184">open_spiel.python.jax.nfsp.NFSP.step()</a>, <a class="el" href="opponent__shaping_8py_source.html#l00813">open_spiel.python.jax.opponent_shaping.OpponentShapingAgent.step()</a>, <a class="el" href="jax_2policy__gradient_8py_source.html#l00342">open_spiel.python.jax.policy_gradient.PolicyGradient.step()</a>, <a class="el" href="munchausen__deep__mirror__descent_8py_source.html#l00188">open_spiel.python.mfg.algorithms.munchausen_deep_mirror_descent.MunchausenDQN.step()</a>, <a class="el" href="pytorch_2dqn_8py_source.html#l00191">open_spiel.python.pytorch.dqn.DQN.step()</a>, <a class="el" href="pytorch_2eva_8py_source.html#l00220">open_spiel.python.pytorch.eva.EVAAgent.step()</a>, <a class="el" href="pytorch_2policy__gradient_8py_source.html#l00280">open_spiel.python.pytorch.policy_gradient.PolicyGradient.step()</a>, and <a class="el" href="ppo_8py_source.html#l00256">open_spiel.python.pytorch.ppo.PPO.step()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>open_spiel/python/jax/<a class="el" href="opponent__shaping_8py_source.html">opponent_shaping.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
