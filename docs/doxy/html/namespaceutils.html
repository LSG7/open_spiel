<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: utils Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">utils Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classutils_1_1_n_f_s_p_policies.html">NFSPPolicies</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classutils_1_1_path_b_c_d_e_response.html">PathBCDEResponse</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classutils_1_1_path_b_c_e_response.html">PathBCEResponse</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classutils_1_1_path_b_d_e_response.html">PathBDEResponse</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classutils_1_1_pure_policy_response.html">PurePolicyResponse</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classutils_1_1_random_policy_deviation.html">RandomPolicyDeviation</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aac64b0d5d86152625f8df4153df68499" id="r_aac64b0d5d86152625f8df4153df68499"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac64b0d5d86152625f8df4153df68499">create_games</a> (origin, destination, num_vehicles, graph, max_time_step, time_step_length=1.0, departure_time=None)</td></tr>
<tr class="separator:aac64b0d5d86152625f8df4153df68499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a598f0f5eb6ae7883f20f8175b0828751" id="r_a598f0f5eb6ae7883f20f8175b0828751"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a598f0f5eb6ae7883f20f8175b0828751">create_braess_network</a> (capacity)</td></tr>
<tr class="separator:a598f0f5eb6ae7883f20f8175b0828751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a962ba519009f3e3212122f75c05e994b" id="r_a962ba519009f3e3212122f75c05e994b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a962ba519009f3e3212122f75c05e994b">create_augmented_braess_network</a> (capacity)</td></tr>
<tr class="separator:a962ba519009f3e3212122f75c05e994b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935972ec89788afef59c5fe5c97ee168" id="r_a935972ec89788afef59c5fe5c97ee168"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a935972ec89788afef59c5fe5c97ee168">create_series_parallel_network</a> (num_network_in_series, time_step_length=1, capacity=1)</td></tr>
<tr class="separator:a935972ec89788afef59c5fe5c97ee168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd0806ac4e8079b301c439db7f9c683d" id="r_acd0806ac4e8079b301c439db7f9c683d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd0806ac4e8079b301c439db7f9c683d">plot_network_n_player_game</a> (dynamic_routing_utils.Network g, vehicle_locations=None)</td></tr>
<tr class="separator:acd0806ac4e8079b301c439db7f9c683d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab842c32cbf7e4f23c8a1c62bc5320d18" id="r_ab842c32cbf7e4f23c8a1c62bc5320d18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab842c32cbf7e4f23c8a1c62bc5320d18">plot_network_mean_field_game</a> (dynamic_routing_utils.Network g, distribution=None, scaling=1)</td></tr>
<tr class="separator:ab842c32cbf7e4f23c8a1c62bc5320d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e0be2c7abc00acd90cab7770bbd717" id="r_a04e0be2c7abc00acd90cab7770bbd717"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a04e0be2c7abc00acd90cab7770bbd717">evolve_n_player_simultaneous_game</a> (game, policy, graph)</td></tr>
<tr class="separator:a04e0be2c7abc00acd90cab7770bbd717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cbc5bef8f521227b730aef60fa7f467" id="r_a1cbc5bef8f521227b730aef60fa7f467"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cbc5bef8f521227b730aef60fa7f467">evolve_n_player_sequential_game</a> (seq_game, policy, graph, debug=False)</td></tr>
<tr class="separator:a1cbc5bef8f521227b730aef60fa7f467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8062ff1b7dd4f583312b3ed5abd50d96" id="r_a8062ff1b7dd4f583312b3ed5abd50d96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8062ff1b7dd4f583312b3ed5abd50d96">evolve_mean_field_game</a> (mfg_game, policy, graph, scaling=1, frequency_printing=1)</td></tr>
<tr class="separator:a8062ff1b7dd4f583312b3ed5abd50d96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0195ca6f5662894ad4b8a420eb42dd2b" id="r_a0195ca6f5662894ad4b8a420eb42dd2b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0195ca6f5662894ad4b8a420eb42dd2b">uniform_policy_n_player</a> (seq_game)</td></tr>
<tr class="separator:a0195ca6f5662894ad4b8a420eb42dd2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a70dd46ba2dc295538613088476bfd9" id="r_a3a70dd46ba2dc295538613088476bfd9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a70dd46ba2dc295538613088476bfd9">first_action_policy_n_player</a> (seq_game)</td></tr>
<tr class="separator:a3a70dd46ba2dc295538613088476bfd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cd794414c7ffd371ffb268787a49498" id="r_a0cd794414c7ffd371ffb268787a49498"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cd794414c7ffd371ffb268787a49498">ficticious_play</a> (seq_game, number_of_iterations, compute_metrics=False)</td></tr>
<tr class="separator:a0cd794414c7ffd371ffb268787a49498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae437d9c834ef0704c05d2f1f7afff29b" id="r_ae437d9c834ef0704c05d2f1f7afff29b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae437d9c834ef0704c05d2f1f7afff29b">counterfactual_regret_minimization</a> (seq_game, number_of_iterations, compute_metrics=False)</td></tr>
<tr class="separator:ae437d9c834ef0704c05d2f1f7afff29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5254172f89deec655aa1cb1a41522af2" id="r_a5254172f89deec655aa1cb1a41522af2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5254172f89deec655aa1cb1a41522af2">external_sampling_monte_carlo_counterfactual_regret_minimization</a> (seq_game, number_of_iterations, compute_metrics=False)</td></tr>
<tr class="separator:a5254172f89deec655aa1cb1a41522af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17034f305471257f4c22e66b7c4c7c50" id="r_a17034f305471257f4c22e66b7c4c7c50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17034f305471257f4c22e66b7c4c7c50">neural_ficticious_self_play</a> (seq_game, num_epoch, sess, compute_metrics=False)</td></tr>
<tr class="separator:a17034f305471257f4c22e66b7c4c7c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c15a96184b6188e7bf7b71a5a7feb7b" id="r_a2c15a96184b6188e7bf7b71a5a7feb7b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c15a96184b6188e7bf7b71a5a7feb7b">mean_field_uniform_policy</a> (mfg_game, number_of_iterations, compute_metrics=False)</td></tr>
<tr class="separator:a2c15a96184b6188e7bf7b71a5a7feb7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c16321b5832d91bd745eb1979e92de7" id="r_a6c16321b5832d91bd745eb1979e92de7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c16321b5832d91bd745eb1979e92de7">mean_field_fictitious_play</a> (mfg_game, number_of_iterations, compute_metrics=False)</td></tr>
<tr class="separator:a6c16321b5832d91bd745eb1979e92de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd9acc256d5d2f70ad749c9ebaee0db" id="r_a1bd9acc256d5d2f70ad749c9ebaee0db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1bd9acc256d5d2f70ad749c9ebaee0db">online_mirror_descent</a> (mfg_game, number_of_iterations, compute_metrics=False, return_policy=False, md_p=None)</td></tr>
<tr class="separator:a1bd9acc256d5d2f70ad749c9ebaee0db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15f47cfe11e0f030c90865194a052e2d" id="r_a15f47cfe11e0f030c90865194a052e2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a15f47cfe11e0f030c90865194a052e2d">get_results_n_player_sequential_game</a> (seq_game, policy)</td></tr>
<tr class="separator:a15f47cfe11e0f030c90865194a052e2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3b1a31d288809608cfc57965916387c" id="r_ab3b1a31d288809608cfc57965916387c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3b1a31d288809608cfc57965916387c">get_list_results_n_player_game</a> (seq_game, policy, num_sample=10)</td></tr>
<tr class="separator:ab3b1a31d288809608cfc57965916387c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66829fe2303d2a3d94b75f53a1e616f0" id="r_a66829fe2303d2a3d94b75f53a1e616f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66829fe2303d2a3d94b75f53a1e616f0">get_average_results_n_player_game</a> (seq_game, policy, num_sample=10)</td></tr>
<tr class="separator:a66829fe2303d2a3d94b75f53a1e616f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81d8cea5974b660cf2c86ebc6b6cc09" id="r_ac81d8cea5974b660cf2c86ebc6b6cc09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac81d8cea5974b660cf2c86ebc6b6cc09">get_results_n_player_simultaneous_game</a> (game, policy)</td></tr>
<tr class="separator:ac81d8cea5974b660cf2c86ebc6b6cc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a515477d84f191e74fe29ac89b1e98cc9" id="r_a515477d84f191e74fe29ac89b1e98cc9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a515477d84f191e74fe29ac89b1e98cc9">get_list_results_n_player_simulataneous_game</a> (game, policy, num_sample=10)</td></tr>
<tr class="separator:a515477d84f191e74fe29ac89b1e98cc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c2879ac1c369330096786988d1a3f8" id="r_a98c2879ac1c369330096786988d1a3f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98c2879ac1c369330096786988d1a3f8">get_expected_value</a> (seq_game, policy, num_sample, <a class="el" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>=0)</td></tr>
<tr class="separator:a98c2879ac1c369330096786988d1a3f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb4aa943b1635e230e114d6f2c8f71b" id="r_afcb4aa943b1635e230e114d6f2c8f71b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afcb4aa943b1635e230e114d6f2c8f71b">compute_regret_policy</a> (game, policy, num_random_policy_tested=10, num_sample=100)</td></tr>
<tr class="separator:afcb4aa943b1635e230e114d6f2c8f71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01b602c6d76a82bcfcbbd9632e96e290" id="r_a01b602c6d76a82bcfcbbd9632e96e290"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a01b602c6d76a82bcfcbbd9632e96e290">get_expected_value_sim_game</a> (game, policy, num_sample, <a class="el" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>=0)</td></tr>
<tr class="separator:a01b602c6d76a82bcfcbbd9632e96e290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40723eaa911b97c3d5c90a0fa35a99e7" id="r_a40723eaa911b97c3d5c90a0fa35a99e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40723eaa911b97c3d5c90a0fa35a99e7">compute_regret_policy_random_noise_sim_game</a> (game, policy, num_random_policy_tested=10, num_sample=100)</td></tr>
<tr class="separator:a40723eaa911b97c3d5c90a0fa35a99e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c1909a38c4ed3355f0362fd935c7b3" id="r_af4c1909a38c4ed3355f0362fd935c7b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4c1909a38c4ed3355f0362fd935c7b3">compute_regret_policy_against_pure_policy_sim_game</a> (game, policy, compute_true_value=False, num_sample=100)</td></tr>
<tr class="separator:af4c1909a38c4ed3355f0362fd935c7b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8baa91cae31392e5604781000efdb1cc" id="r_a8baa91cae31392e5604781000efdb1cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8baa91cae31392e5604781000efdb1cc">online_mirror_descent_sioux_falls</a> (mfg_game, number_of_iterations, md_p=None)</td></tr>
<tr class="separator:a8baa91cae31392e5604781000efdb1cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8431845ac82b75d22ea15c467e6bdbce" id="r_a8431845ac82b75d22ea15c467e6bdbce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8431845ac82b75d22ea15c467e6bdbce">meta_loss</a> (opt_params, net_apply, payoff, steps)</td></tr>
<tr class="separator:a8431845ac82b75d22ea15c467e6bdbce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5534849977c7786148431bc7c9d5141" id="r_ab5534849977c7786148431bc7c9d5141"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5534849977c7786148431bc7c9d5141">get_batched_input</a> (List[jax.Array] input_list, List[InfostateNode] infostate_list, List[List[int]] illegal_action_list, int batch_size)</td></tr>
<tr class="separator:ab5534849977c7786148431bc7c9d5141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff900969cd362346efed9d6ea63e30ae" id="r_aff900969cd362346efed9d6ea63e30ae"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff900969cd362346efed9d6ea63e30ae">mask</a> (np.ndarray cfvalues, List[InfostateNode] infoset, int num_actions, int batch_size)</td></tr>
<tr class="separator:aff900969cd362346efed9d6ea63e30ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b07609963e2c422a8dafaa234fda5f" id="r_a80b07609963e2c422a8dafaa234fda5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80b07609963e2c422a8dafaa234fda5f">filter_terminal_infostates</a> (InfostateMapping infostates_map)</td></tr>
<tr class="separator:a80b07609963e2c422a8dafaa234fda5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a146363baaf8387a17e2664f9da953360" id="r_a146363baaf8387a17e2664f9da953360"><td class="memItemLeft" align="right" valign="top">jax.Array&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a146363baaf8387a17e2664f9da953360">get_network_output</a> (ApplyFn net_apply, Params net_params, np.ndarray net_input, List[int] illegal_actions, hk.PRNGSequence <a class="el" href="btree__test_8cc.html#a35af0be900467fedbb610bd6ea65ed78">key</a>)</td></tr>
<tr class="separator:a146363baaf8387a17e2664f9da953360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adee2d8b428905f02a87d98d107aadb5c" id="r_adee2d8b428905f02a87d98d107aadb5c"><td class="memItemLeft" align="right" valign="top">List[jax.Array]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adee2d8b428905f02a87d98d107aadb5c">get_network_output_batched</a> (ApplyFn net_apply, Params net_params, np.ndarray net_input, List[List[int]] all_illegal_actions, hk.PRNGSequence <a class="el" href="btree__test_8cc.html#a35af0be900467fedbb610bd6ea65ed78">key</a>)</td></tr>
<tr class="separator:adee2d8b428905f02a87d98d107aadb5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedf32c286ba750f56d157bd834f37268" id="r_aedf32c286ba750f56d157bd834f37268"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aedf32c286ba750f56d157bd834f37268">meta_loss</a> (Params net_params, np.ndarray cfvalues, ApplyFn net_apply, int steps, int num_all_actions, List[InfostateNode] infosets, InfostateMapping infostate_map, int batch_size, hk.PRNGSequence <a class="el" href="btree__test_8cc.html#a35af0be900467fedbb610bd6ea65ed78">key</a>, bool use_infostate_representation=True)</td></tr>
<tr class="separator:aedf32c286ba750f56d157bd834f37268"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a21dde32490df6b8b863cdd2b762edabc" id="r_a21dde32490df6b8b863cdd2b762edabc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21dde32490df6b8b863cdd2b762edabc">FLAGS</a> = flags.FLAGS</td></tr>
<tr class="separator:a21dde32490df6b8b863cdd2b762edabc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Utils function for routing game experiment.</pre><pre class="fragment">Utility functions for meta learning for regret minimization.</pre><pre class="fragment">Utility functions for meta-cfr algorithm.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="afcb4aa943b1635e230e114d6f2c8f71b" name="afcb4aa943b1635e230e114d6f2c8f71b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcb4aa943b1635e230e114d6f2c8f71b">&#9670;&#160;</a></span>compute_regret_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.compute_regret_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_random_policy_tested</em></span><span class="paramdefsep"> = </span><span class="paramdefval">10</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00960">960</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  963</span>                          num_sample=100):</div>
<div class="line"><span class="lineno">  964</span>  time_tick = time.time()</div>
<div class="line"><span class="lineno">  965</span>  expected_value_policy = get_expected_value(game, policy, num_sample)</div>
<div class="line"><span class="lineno">  966</span>  worse_regret = 0</div>
<div class="line"><span class="lineno">  967</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_random_policy_tested):</div>
<div class="line"><span class="lineno">  968</span>    noisy_n_policy = noisy_policy.NoisyPolicy(policy, player_id=0, alpha=1)</div>
<div class="line"><span class="lineno">  969</span>    expected_value_noise = get_expected_value(</div>
<div class="line"><span class="lineno">  970</span>        game, noisy_n_policy, num_sample, player=0)</div>
<div class="line"><span class="lineno">  971</span>    approximate_regret = expected_value_noise - expected_value_policy</div>
<div class="line"><span class="lineno">  972</span>    worse_regret = max(worse_regret, approximate_regret)</div>
<div class="line"><span class="lineno">  973</span>  <span class="keywordflow">return</span> worse_regret, time.time() - time_tick</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00948">get_expected_value()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_afcb4aa943b1635e230e114d6f2c8f71b_cgraph.png" border="0" usemap="#anamespaceutils_afcb4aa943b1635e230e114d6f2c8f71b_cgraph" alt=""/></div>
<map name="anamespaceutils_afcb4aa943b1635e230e114d6f2c8f71b_cgraph" id="anamespaceutils_afcb4aa943b1635e230e114d6f2c8f71b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,145,46"/>
<area shape="rect" href="namespaceutils.html#a98c2879ac1c369330096786988d1a3f8" title=" " alt="" coords="193,5,320,46"/>
<area shape="poly" title=" " alt="" coords="145,23,177,23,177,28,145,28"/>
<area shape="rect" href="namespaceutils.html#ab3b1a31d288809608cfc57965916387c" title=" " alt="" coords="368,5,505,46"/>
<area shape="poly" title=" " alt="" coords="320,23,353,23,353,28,320,28"/>
<area shape="rect" href="namespaceutils.html#a15f47cfe11e0f030c90865194a052e2d" title=" " alt="" coords="553,5,722,46"/>
<area shape="poly" title=" " alt="" coords="506,23,538,23,538,28,506,28"/>
</map>
</div>

</div>
</div>
<a id="af4c1909a38c4ed3355f0362fd935c7b3" name="af4c1909a38c4ed3355f0362fd935c7b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c1909a38c4ed3355f0362fd935c7b3">&#9670;&#160;</a></span>compute_regret_policy_against_pure_policy_sim_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.compute_regret_policy_against_pure_policy_sim_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_true_value</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01065">1065</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1068</span>                                                       num_sample=100):</div>
<div class="line"><span class="lineno"> 1069</span>  time_tick = time.time()</div>
<div class="line"><span class="lineno"> 1070</span>  <span class="keywordflow">if</span> compute_true_value:</div>
<div class="line"><span class="lineno"> 1071</span>    expected_value_policy = expected_game_score.policy_value(</div>
<div class="line"><span class="lineno"> 1072</span>        game.new_initial_state(), policy)[0]</div>
<div class="line"><span class="lineno"> 1073</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1074</span>    expected_value_policy = get_expected_value_sim_game(game, policy,</div>
<div class="line"><span class="lineno"> 1075</span>                                                        num_sample)</div>
<div class="line"><span class="lineno"> 1076</span>  worse_regret = 0</div>
<div class="line"><span class="lineno"> 1077</span>  policies = [</div>
<div class="line"><span class="lineno"> 1078</span>      PathBCEResponse(game, policy, 0),</div>
<div class="line"><span class="lineno"> 1079</span>      PathBCDEResponse(game, policy, 0),</div>
<div class="line"><span class="lineno"> 1080</span>      PathBDEResponse(game, policy, 0)</div>
<div class="line"><span class="lineno"> 1081</span>  ]</div>
<div class="line"><span class="lineno"> 1082</span>  <span class="keywordflow">for</span> deviation_policy <span class="keywordflow">in</span> policies:</div>
<div class="line"><span class="lineno"> 1083</span>    <span class="keywordflow">if</span> compute_true_value:</div>
<div class="line"><span class="lineno"> 1084</span>      expected_value_noise = expected_game_score.policy_value(</div>
<div class="line"><span class="lineno"> 1085</span>          game.new_initial_state(), deviation_policy)[0]</div>
<div class="line"><span class="lineno"> 1086</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1087</span>      expected_value_noise = get_expected_value_sim_game(</div>
<div class="line"><span class="lineno"> 1088</span>          game, deviation_policy, num_sample, player=0)</div>
<div class="line"><span class="lineno"> 1089</span>    approximate_regret = expected_value_noise - expected_value_policy</div>
<div class="line"><span class="lineno"> 1090</span>    worse_regret = max(worse_regret, approximate_regret)</div>
<div class="line"><span class="lineno"> 1091</span>  <span class="keywordflow">return</span> worse_regret, time.time() - time_tick</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00976">get_expected_value_sim_game()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_af4c1909a38c4ed3355f0362fd935c7b3_cgraph.png" border="0" usemap="#anamespaceutils_af4c1909a38c4ed3355f0362fd935c7b3_cgraph" alt=""/></div>
<map name="anamespaceutils_af4c1909a38c4ed3355f0362fd935c7b3_cgraph" id="anamespaceutils_af4c1909a38c4ed3355f0362fd935c7b3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,149,61"/>
<area shape="rect" href="namespaceutils.html#a01b602c6d76a82bcfcbbd9632e96e290" title=" " alt="" coords="197,13,324,54"/>
<area shape="poly" title=" " alt="" coords="149,30,181,30,181,36,149,36"/>
<area shape="rect" href="namespaceutils.html#a515477d84f191e74fe29ac89b1e98cc9" title=" " alt="" coords="372,13,579,54"/>
<area shape="poly" title=" " alt="" coords="324,30,356,30,356,36,324,36"/>
<area shape="rect" href="namespaceutils.html#ac81d8cea5974b660cf2c86ebc6b6cc09" title=" " alt="" coords="627,13,814,54"/>
<area shape="poly" title=" " alt="" coords="580,30,611,30,611,36,580,36"/>
</map>
</div>

</div>
</div>
<a id="a40723eaa911b97c3d5c90a0fa35a99e7" name="a40723eaa911b97c3d5c90a0fa35a99e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40723eaa911b97c3d5c90a0fa35a99e7">&#9670;&#160;</a></span>compute_regret_policy_random_noise_sim_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.compute_regret_policy_random_noise_sim_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_random_policy_tested</em></span><span class="paramdefsep"> = </span><span class="paramdefval">10</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00989">989</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  992</span>                                                num_sample=100):</div>
<div class="line"><span class="lineno">  993</span>  time_tick = time.time()</div>
<div class="line"><span class="lineno">  994</span>  expected_value_policy = get_expected_value_sim_game(game, policy, num_sample)</div>
<div class="line"><span class="lineno">  995</span>  worse_regret = 0</div>
<div class="line"><span class="lineno">  996</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_random_policy_tested):</div>
<div class="line"><span class="lineno">  997</span>    noisy_n_policy = noisy_policy.NoisyPolicy(policy, player_id=0, alpha=1)</div>
<div class="line"><span class="lineno">  998</span>    expected_value_noise = get_expected_value_sim_game(</div>
<div class="line"><span class="lineno">  999</span>        game, noisy_n_policy, num_sample, player=0)</div>
<div class="line"><span class="lineno"> 1000</span>    approximate_regret = expected_value_noise - expected_value_policy</div>
<div class="line"><span class="lineno"> 1001</span>    worse_regret = max(worse_regret, approximate_regret)</div>
<div class="line"><span class="lineno"> 1002</span>  <span class="keywordflow">return</span> worse_regret, time.time() - time_tick</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00976">get_expected_value_sim_game()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a40723eaa911b97c3d5c90a0fa35a99e7_cgraph.png" border="0" usemap="#anamespaceutils_a40723eaa911b97c3d5c90a0fa35a99e7_cgraph" alt=""/></div>
<map name="anamespaceutils_a40723eaa911b97c3d5c90a0fa35a99e7_cgraph" id="anamespaceutils_a40723eaa911b97c3d5c90a0fa35a99e7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,156,61"/>
<area shape="rect" href="namespaceutils.html#a01b602c6d76a82bcfcbbd9632e96e290" title=" " alt="" coords="204,13,331,54"/>
<area shape="poly" title=" " alt="" coords="156,30,188,30,188,36,156,36"/>
<area shape="rect" href="namespaceutils.html#a515477d84f191e74fe29ac89b1e98cc9" title=" " alt="" coords="379,13,586,54"/>
<area shape="poly" title=" " alt="" coords="331,30,363,30,363,36,331,36"/>
<area shape="rect" href="namespaceutils.html#ac81d8cea5974b660cf2c86ebc6b6cc09" title=" " alt="" coords="634,13,821,54"/>
<area shape="poly" title=" " alt="" coords="587,30,618,30,618,36,587,36"/>
</map>
</div>

</div>
</div>
<a id="ae437d9c834ef0704c05d2f1f7afff29b" name="ae437d9c834ef0704c05d2f1f7afff29b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae437d9c834ef0704c05d2f1f7afff29b">&#9670;&#160;</a></span>counterfactual_regret_minimization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.counterfactual_regret_minimization </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>number_of_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_metrics</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00670">670</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  672</span>                                       compute_metrics=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  673</span>  <span class="comment"># freq_iteration_printing = number_of_iterations // 10</span></div>
<div class="line"><span class="lineno">  674</span>  cfr_solver = cfr.CFRSolver(seq_game)</div>
<div class="line"><span class="lineno">  675</span>  tick_time = time.time()</div>
<div class="line"><span class="lineno">  676</span>  <span class="comment"># print(&quot;CFRSolver initialized.&quot;)</span></div>
<div class="line"><span class="lineno">  677</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(number_of_iterations):</div>
<div class="line"><span class="lineno">  678</span>    cfr_solver.evaluate_and_update_policy()</div>
<div class="line"><span class="lineno">  679</span>    <span class="comment"># if i % freq_iteration_printing == 0:</span></div>
<div class="line"><span class="lineno">  680</span>    <span class="comment">#   print(f&quot;Iteration {i}&quot;)</span></div>
<div class="line"><span class="lineno">  681</span>  timing = time.time() - tick_time</div>
<div class="line"><span class="lineno">  682</span>  <span class="comment"># print(&quot;Finish.&quot;)</span></div>
<div class="line"><span class="lineno">  683</span>  <span class="keywordflow">if</span> compute_metrics:</div>
<div class="line"><span class="lineno">  684</span>    nash_conv = exploitability.nash_conv(seq_game, cfr_solver.average_policy())</div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">return</span> timing, cfr_solver.average_policy(), nash_conv</div>
<div class="line"><span class="lineno">  686</span>  <span class="keywordflow">return</span> timing, cfr_solver.average_policy()</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a962ba519009f3e3212122f75c05e994b" name="a962ba519009f3e3212122f75c05e994b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a962ba519009f3e3212122f75c05e994b">&#9670;&#160;</a></span>create_augmented_braess_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.create_augmented_braess_network </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>capacity</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00183">183</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  183</span><span class="keyword">def </span>create_augmented_braess_network(capacity):</div>
<div class="line"><span class="lineno">  184</span>  graph_dict = {</div>
<div class="line"><span class="lineno">  185</span>      <span class="stringliteral">&quot;A&quot;</span>: {</div>
<div class="line"><span class="lineno">  186</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  187</span>              <span class="stringliteral">&quot;B&quot;</span>: {</div>
<div class="line"><span class="lineno">  188</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  189</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  190</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  191</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 0</div>
<div class="line"><span class="lineno">  192</span>              }</div>
<div class="line"><span class="lineno">  193</span>          },</div>
<div class="line"><span class="lineno">  194</span>          <span class="stringliteral">&quot;location&quot;</span>: [0, 0]</div>
<div class="line"><span class="lineno">  195</span>      },</div>
<div class="line"><span class="lineno">  196</span>      <span class="stringliteral">&quot;B&quot;</span>: {</div>
<div class="line"><span class="lineno">  197</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  198</span>              <span class="stringliteral">&quot;C&quot;</span>: {</div>
<div class="line"><span class="lineno">  199</span>                  <span class="stringliteral">&quot;a&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  200</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  201</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  202</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 1.0</div>
<div class="line"><span class="lineno">  203</span>              },</div>
<div class="line"><span class="lineno">  204</span>              <span class="stringliteral">&quot;D&quot;</span>: {</div>
<div class="line"><span class="lineno">  205</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  206</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  207</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  208</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 2.0</div>
<div class="line"><span class="lineno">  209</span>              }</div>
<div class="line"><span class="lineno">  210</span>          },</div>
<div class="line"><span class="lineno">  211</span>          <span class="stringliteral">&quot;location&quot;</span>: [1, 0]</div>
<div class="line"><span class="lineno">  212</span>      },</div>
<div class="line"><span class="lineno">  213</span>      <span class="stringliteral">&quot;C&quot;</span>: {</div>
<div class="line"><span class="lineno">  214</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  215</span>              <span class="stringliteral">&quot;D&quot;</span>: {</div>
<div class="line"><span class="lineno">  216</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  217</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  218</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  219</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 0.25</div>
<div class="line"><span class="lineno">  220</span>              },</div>
<div class="line"><span class="lineno">  221</span>              <span class="stringliteral">&quot;E&quot;</span>: {</div>
<div class="line"><span class="lineno">  222</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  223</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  224</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  225</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 2.0</div>
<div class="line"><span class="lineno">  226</span>              }</div>
<div class="line"><span class="lineno">  227</span>          },</div>
<div class="line"><span class="lineno">  228</span>          <span class="stringliteral">&quot;location&quot;</span>: [2, 1]</div>
<div class="line"><span class="lineno">  229</span>      },</div>
<div class="line"><span class="lineno">  230</span>      <span class="stringliteral">&quot;D&quot;</span>: {</div>
<div class="line"><span class="lineno">  231</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  232</span>              <span class="stringliteral">&quot;E&quot;</span>: {</div>
<div class="line"><span class="lineno">  233</span>                  <span class="stringliteral">&quot;a&quot;</span>: 1,</div>
<div class="line"><span class="lineno">  234</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  235</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  236</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 1.0</div>
<div class="line"><span class="lineno">  237</span>              },</div>
<div class="line"><span class="lineno">  238</span>              <span class="stringliteral">&quot;G&quot;</span>: {</div>
<div class="line"><span class="lineno">  239</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  240</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  241</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  242</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 0.0</div>
<div class="line"><span class="lineno">  243</span>              }</div>
<div class="line"><span class="lineno">  244</span>          },</div>
<div class="line"><span class="lineno">  245</span>          <span class="stringliteral">&quot;location&quot;</span>: [2, -1]</div>
<div class="line"><span class="lineno">  246</span>      },</div>
<div class="line"><span class="lineno">  247</span>      <span class="stringliteral">&quot;E&quot;</span>: {</div>
<div class="line"><span class="lineno">  248</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  249</span>              <span class="stringliteral">&quot;F&quot;</span>: {</div>
<div class="line"><span class="lineno">  250</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  251</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  252</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  253</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 0.0</div>
<div class="line"><span class="lineno">  254</span>              }</div>
<div class="line"><span class="lineno">  255</span>          },</div>
<div class="line"><span class="lineno">  256</span>          <span class="stringliteral">&quot;location&quot;</span>: [3, 0]</div>
<div class="line"><span class="lineno">  257</span>      },</div>
<div class="line"><span class="lineno">  258</span>      <span class="stringliteral">&quot;F&quot;</span>: {</div>
<div class="line"><span class="lineno">  259</span>          <span class="stringliteral">&quot;connection&quot;</span>: {},</div>
<div class="line"><span class="lineno">  260</span>          <span class="stringliteral">&quot;location&quot;</span>: [4, 0]</div>
<div class="line"><span class="lineno">  261</span>      },</div>
<div class="line"><span class="lineno">  262</span>      <span class="stringliteral">&quot;G&quot;</span>: {</div>
<div class="line"><span class="lineno">  263</span>          <span class="stringliteral">&quot;connection&quot;</span>: {},</div>
<div class="line"><span class="lineno">  264</span>          <span class="stringliteral">&quot;location&quot;</span>: [3, -1]</div>
<div class="line"><span class="lineno">  265</span>      }</div>
<div class="line"><span class="lineno">  266</span>  }</div>
<div class="line"><span class="lineno">  267</span>  adjacency_list = {</div>
<div class="line"><span class="lineno">  268</span>      key: list(value[<span class="stringliteral">&quot;connection&quot;</span>].<a class="code hl_variable" href="randen_8cc.html#ae05ca1b2d55f74e5686bb16c6dcca50b">keys</a>())</div>
<div class="line"><span class="lineno">  269</span>      <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> graph_dict.items()</div>
<div class="line"><span class="lineno">  270</span>  }</div>
<div class="line"><span class="lineno">  271</span>  bpr_a_coefficient = {}</div>
<div class="line"><span class="lineno">  272</span>  bpr_b_coefficient = {}</div>
<div class="line"><span class="lineno">  273</span>  capacity = {}</div>
<div class="line"><span class="lineno">  274</span>  free_flow_travel_time = {}</div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordflow">for</span> o_node, value_dict <span class="keywordflow">in</span> graph_dict.items():</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">for</span> d_node, section_dict <span class="keywordflow">in</span> value_dict[<span class="stringliteral">&quot;connection&quot;</span>].items():</div>
<div class="line"><span class="lineno">  277</span>      road_section = dynamic_routing_utils._road_section_from_nodes(</div>
<div class="line"><span class="lineno">  278</span>          origin=o_node, destination=d_node)</div>
<div class="line"><span class="lineno">  279</span>      bpr_a_coefficient[road_section] = section_dict[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line"><span class="lineno">  280</span>      bpr_b_coefficient[road_section] = section_dict[<span class="stringliteral">&quot;b&quot;</span>]</div>
<div class="line"><span class="lineno">  281</span>      capacity[road_section] = section_dict[<span class="stringliteral">&quot;capacity&quot;</span>]</div>
<div class="line"><span class="lineno">  282</span>      free_flow_travel_time[road_section] = section_dict[</div>
<div class="line"><span class="lineno">  283</span>          <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>]</div>
<div class="line"><span class="lineno">  284</span>  node_position = {key: value[<span class="stringliteral">&quot;location&quot;</span>] <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> graph_dict.items()}</div>
<div class="line"><span class="lineno">  285</span>  <span class="keywordflow">return</span> dynamic_routing_utils.Network(</div>
<div class="line"><span class="lineno">  286</span>      adjacency_list,</div>
<div class="line"><span class="lineno">  287</span>      node_position=node_position,</div>
<div class="line"><span class="lineno">  288</span>      bpr_a_coefficient=bpr_a_coefficient,</div>
<div class="line"><span class="lineno">  289</span>      bpr_b_coefficient=bpr_b_coefficient,</div>
<div class="line"><span class="lineno">  290</span>      capacity=capacity,</div>
<div class="line"><span class="lineno">  291</span>      free_flow_travel_time=free_flow_travel_time)</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="ttc" id="aranden_8cc_html_ae05ca1b2d55f74e5686bb16c6dcca50b"><div class="ttname"><a href="randen_8cc.html#ae05ca1b2d55f74e5686bb16c6dcca50b">keys</a></div><div class="ttdeci">const void * keys</div><div class="ttdef"><b>Definition</b> <a href="randen_8cc_source.html#l00049">randen.cc:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="randen_8cc_source.html#l00049">keys</a>.</p>

</div>
</div>
<a id="a598f0f5eb6ae7883f20f8175b0828751" name="a598f0f5eb6ae7883f20f8175b0828751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a598f0f5eb6ae7883f20f8175b0828751">&#9670;&#160;</a></span>create_braess_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.create_braess_network </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>capacity</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00082">82</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span><span class="keyword">def </span>create_braess_network(capacity):</div>
<div class="line"><span class="lineno">   83</span>  graph_dict = {</div>
<div class="line"><span class="lineno">   84</span>      <span class="stringliteral">&quot;A&quot;</span>: {</div>
<div class="line"><span class="lineno">   85</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">   86</span>              <span class="stringliteral">&quot;B&quot;</span>: {</div>
<div class="line"><span class="lineno">   87</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">   88</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">   89</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">   90</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 0</div>
<div class="line"><span class="lineno">   91</span>              }</div>
<div class="line"><span class="lineno">   92</span>          },</div>
<div class="line"><span class="lineno">   93</span>          <span class="stringliteral">&quot;location&quot;</span>: [0, 0]</div>
<div class="line"><span class="lineno">   94</span>      },</div>
<div class="line"><span class="lineno">   95</span>      <span class="stringliteral">&quot;B&quot;</span>: {</div>
<div class="line"><span class="lineno">   96</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">   97</span>              <span class="stringliteral">&quot;C&quot;</span>: {</div>
<div class="line"><span class="lineno">   98</span>                  <span class="stringliteral">&quot;a&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">   99</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  100</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  101</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 1.0</div>
<div class="line"><span class="lineno">  102</span>              },</div>
<div class="line"><span class="lineno">  103</span>              <span class="stringliteral">&quot;D&quot;</span>: {</div>
<div class="line"><span class="lineno">  104</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  105</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  106</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  107</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 2.0</div>
<div class="line"><span class="lineno">  108</span>              }</div>
<div class="line"><span class="lineno">  109</span>          },</div>
<div class="line"><span class="lineno">  110</span>          <span class="stringliteral">&quot;location&quot;</span>: [1, 0]</div>
<div class="line"><span class="lineno">  111</span>      },</div>
<div class="line"><span class="lineno">  112</span>      <span class="stringliteral">&quot;C&quot;</span>: {</div>
<div class="line"><span class="lineno">  113</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  114</span>              <span class="stringliteral">&quot;D&quot;</span>: {</div>
<div class="line"><span class="lineno">  115</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  116</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  117</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  118</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 0.25</div>
<div class="line"><span class="lineno">  119</span>              },</div>
<div class="line"><span class="lineno">  120</span>              <span class="stringliteral">&quot;E&quot;</span>: {</div>
<div class="line"><span class="lineno">  121</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  122</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  123</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  124</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 2.0</div>
<div class="line"><span class="lineno">  125</span>              }</div>
<div class="line"><span class="lineno">  126</span>          },</div>
<div class="line"><span class="lineno">  127</span>          <span class="stringliteral">&quot;location&quot;</span>: [2, 1]</div>
<div class="line"><span class="lineno">  128</span>      },</div>
<div class="line"><span class="lineno">  129</span>      <span class="stringliteral">&quot;D&quot;</span>: {</div>
<div class="line"><span class="lineno">  130</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  131</span>              <span class="stringliteral">&quot;E&quot;</span>: {</div>
<div class="line"><span class="lineno">  132</span>                  <span class="stringliteral">&quot;a&quot;</span>: 1,</div>
<div class="line"><span class="lineno">  133</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  134</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  135</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 1.0</div>
<div class="line"><span class="lineno">  136</span>              }</div>
<div class="line"><span class="lineno">  137</span>          },</div>
<div class="line"><span class="lineno">  138</span>          <span class="stringliteral">&quot;location&quot;</span>: [2, -1]</div>
<div class="line"><span class="lineno">  139</span>      },</div>
<div class="line"><span class="lineno">  140</span>      <span class="stringliteral">&quot;E&quot;</span>: {</div>
<div class="line"><span class="lineno">  141</span>          <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  142</span>              <span class="stringliteral">&quot;F&quot;</span>: {</div>
<div class="line"><span class="lineno">  143</span>                  <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  144</span>                  <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  145</span>                  <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  146</span>                  <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: 0.0</div>
<div class="line"><span class="lineno">  147</span>              }</div>
<div class="line"><span class="lineno">  148</span>          },</div>
<div class="line"><span class="lineno">  149</span>          <span class="stringliteral">&quot;location&quot;</span>: [3, 0]</div>
<div class="line"><span class="lineno">  150</span>      },</div>
<div class="line"><span class="lineno">  151</span>      <span class="stringliteral">&quot;F&quot;</span>: {</div>
<div class="line"><span class="lineno">  152</span>          <span class="stringliteral">&quot;connection&quot;</span>: {},</div>
<div class="line"><span class="lineno">  153</span>          <span class="stringliteral">&quot;location&quot;</span>: [4, 0]</div>
<div class="line"><span class="lineno">  154</span>      }</div>
<div class="line"><span class="lineno">  155</span>  }</div>
<div class="line"><span class="lineno">  156</span>  adjacency_list = {</div>
<div class="line"><span class="lineno">  157</span>      key: list(value[<span class="stringliteral">&quot;connection&quot;</span>].<a class="code hl_variable" href="randen_8cc.html#ae05ca1b2d55f74e5686bb16c6dcca50b">keys</a>())</div>
<div class="line"><span class="lineno">  158</span>      <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> graph_dict.items()</div>
<div class="line"><span class="lineno">  159</span>  }</div>
<div class="line"><span class="lineno">  160</span>  bpr_a_coefficient = {}</div>
<div class="line"><span class="lineno">  161</span>  bpr_b_coefficient = {}</div>
<div class="line"><span class="lineno">  162</span>  capacity = {}</div>
<div class="line"><span class="lineno">  163</span>  free_flow_travel_time = {}</div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordflow">for</span> o_node, value_dict <span class="keywordflow">in</span> graph_dict.items():</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">for</span> d_node, section_dict <span class="keywordflow">in</span> value_dict[<span class="stringliteral">&quot;connection&quot;</span>].items():</div>
<div class="line"><span class="lineno">  166</span>      road_section = dynamic_routing_utils._road_section_from_nodes(</div>
<div class="line"><span class="lineno">  167</span>          origin=o_node, destination=d_node)</div>
<div class="line"><span class="lineno">  168</span>      bpr_a_coefficient[road_section] = section_dict[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line"><span class="lineno">  169</span>      bpr_b_coefficient[road_section] = section_dict[<span class="stringliteral">&quot;b&quot;</span>]</div>
<div class="line"><span class="lineno">  170</span>      capacity[road_section] = section_dict[<span class="stringliteral">&quot;capacity&quot;</span>]</div>
<div class="line"><span class="lineno">  171</span>      free_flow_travel_time[road_section] = section_dict[</div>
<div class="line"><span class="lineno">  172</span>          <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>]</div>
<div class="line"><span class="lineno">  173</span>  node_position = {key: value[<span class="stringliteral">&quot;location&quot;</span>] <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> graph_dict.items()}</div>
<div class="line"><span class="lineno">  174</span>  <span class="keywordflow">return</span> dynamic_routing_utils.Network(</div>
<div class="line"><span class="lineno">  175</span>      adjacency_list,</div>
<div class="line"><span class="lineno">  176</span>      node_position=node_position,</div>
<div class="line"><span class="lineno">  177</span>      bpr_a_coefficient=bpr_a_coefficient,</div>
<div class="line"><span class="lineno">  178</span>      bpr_b_coefficient=bpr_b_coefficient,</div>
<div class="line"><span class="lineno">  179</span>      capacity=capacity,</div>
<div class="line"><span class="lineno">  180</span>      free_flow_travel_time=free_flow_travel_time)</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="randen_8cc_source.html#l00049">keys</a>.</p>

</div>
</div>
<a id="aac64b0d5d86152625f8df4153df68499" name="aac64b0d5d86152625f8df4153df68499"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac64b0d5d86152625f8df4153df68499">&#9670;&#160;</a></span>create_games()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.create_games </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>origin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>destination</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_vehicles</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_time_step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>time_step_length</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1.0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>departure_time</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00047">47</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                 departure_time=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">   54</span>  <span class="keywordflow">if</span> departure_time <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&quot;To do.&quot;</span>)</div>
<div class="line"><span class="lineno">   56</span>  list_of_vehicles = [</div>
<div class="line"><span class="lineno">   57</span>      dynamic_routing_utils.Vehicle(origin, destination)</div>
<div class="line"><span class="lineno">   58</span>      <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_vehicles)</div>
<div class="line"><span class="lineno">   59</span>  ]</div>
<div class="line"><span class="lineno">   60</span>  game = dynamic_routing.DynamicRoutingGame(</div>
<div class="line"><span class="lineno">   61</span>      {</div>
<div class="line"><span class="lineno">   62</span>          <span class="stringliteral">&quot;max_num_time_step&quot;</span>: max_time_step,</div>
<div class="line"><span class="lineno">   63</span>          <span class="stringliteral">&quot;time_step_length&quot;</span>: time_step_length</div>
<div class="line"><span class="lineno">   64</span>      },</div>
<div class="line"><span class="lineno">   65</span>      network=graph,</div>
<div class="line"><span class="lineno">   66</span>      vehicles=list_of_vehicles)</div>
<div class="line"><span class="lineno">   67</span>  seq_game = pyspiel.convert_to_turn_based(game)</div>
<div class="line"><span class="lineno">   68</span>  od_demand = [</div>
<div class="line"><span class="lineno">   69</span>      dynamic_routing_utils.OriginDestinationDemand(origin, destination, 0,</div>
<div class="line"><span class="lineno">   70</span>                                                    num_vehicles)</div>
<div class="line"><span class="lineno">   71</span>  ]</div>
<div class="line"><span class="lineno">   72</span>  mfg_game = mean_field_routing_game.MeanFieldRoutingGame(</div>
<div class="line"><span class="lineno">   73</span>      {</div>
<div class="line"><span class="lineno">   74</span>          <span class="stringliteral">&quot;max_num_time_step&quot;</span>: max_time_step,</div>
<div class="line"><span class="lineno">   75</span>          <span class="stringliteral">&quot;time_step_length&quot;</span>: time_step_length</div>
<div class="line"><span class="lineno">   76</span>      },</div>
<div class="line"><span class="lineno">   77</span>      network=graph,</div>
<div class="line"><span class="lineno">   78</span>      od_demand=od_demand)</div>
<div class="line"><span class="lineno">   79</span>  <span class="keywordflow">return</span> game, seq_game, mfg_game</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a935972ec89788afef59c5fe5c97ee168" name="a935972ec89788afef59c5fe5c97ee168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a935972ec89788afef59c5fe5c97ee168">&#9670;&#160;</a></span>create_series_parallel_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.create_series_parallel_network </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_network_in_series</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>time_step_length</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>capacity</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00294">294</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  296</span>                                   capacity=1):</div>
<div class="line"><span class="lineno">  297</span>  i = 0</div>
<div class="line"><span class="lineno">  298</span>  origin = <span class="stringliteral">&quot;A_0-&gt;B_0&quot;</span></div>
<div class="line"><span class="lineno">  299</span>  graph_dict = {}</div>
<div class="line"><span class="lineno">  300</span>  <span class="keywordflow">while</span> i &lt; num_network_in_series:</div>
<div class="line"><span class="lineno">  301</span>    tt_up = random.random() + time_step_length</div>
<div class="line"><span class="lineno">  302</span>    tt_down = random.random() + time_step_length</div>
<div class="line"><span class="lineno">  303</span>    graph_dict.update({</div>
<div class="line"><span class="lineno">  304</span>        f<span class="stringliteral">&quot;A_{i}&quot;</span>: {</div>
<div class="line"><span class="lineno">  305</span>            <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  306</span>                f<span class="stringliteral">&quot;B_{i}&quot;</span>: {</div>
<div class="line"><span class="lineno">  307</span>                    <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  308</span>                    <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  309</span>                    <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  310</span>                    <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: time_step_length</div>
<div class="line"><span class="lineno">  311</span>                }</div>
<div class="line"><span class="lineno">  312</span>            },</div>
<div class="line"><span class="lineno">  313</span>            <span class="stringliteral">&quot;location&quot;</span>: [0 + 3 * i, 0]</div>
<div class="line"><span class="lineno">  314</span>        },</div>
<div class="line"><span class="lineno">  315</span>        f<span class="stringliteral">&quot;B_{i}&quot;</span>: {</div>
<div class="line"><span class="lineno">  316</span>            <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  317</span>                f<span class="stringliteral">&quot;C_{i}&quot;</span>: {</div>
<div class="line"><span class="lineno">  318</span>                    <span class="stringliteral">&quot;a&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  319</span>                    <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  320</span>                    <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  321</span>                    <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: tt_up</div>
<div class="line"><span class="lineno">  322</span>                },</div>
<div class="line"><span class="lineno">  323</span>                f<span class="stringliteral">&quot;D_{i}&quot;</span>: {</div>
<div class="line"><span class="lineno">  324</span>                    <span class="stringliteral">&quot;a&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  325</span>                    <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  326</span>                    <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  327</span>                    <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: tt_down</div>
<div class="line"><span class="lineno">  328</span>                }</div>
<div class="line"><span class="lineno">  329</span>            },</div>
<div class="line"><span class="lineno">  330</span>            <span class="stringliteral">&quot;location&quot;</span>: [1 + 3 * i, 0]</div>
<div class="line"><span class="lineno">  331</span>        },</div>
<div class="line"><span class="lineno">  332</span>        f<span class="stringliteral">&quot;C_{i}&quot;</span>: {</div>
<div class="line"><span class="lineno">  333</span>            <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  334</span>                f<span class="stringliteral">&quot;A_{i+1}&quot;</span>: {</div>
<div class="line"><span class="lineno">  335</span>                    <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  336</span>                    <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  337</span>                    <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  338</span>                    <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: time_step_length</div>
<div class="line"><span class="lineno">  339</span>                }</div>
<div class="line"><span class="lineno">  340</span>            },</div>
<div class="line"><span class="lineno">  341</span>            <span class="stringliteral">&quot;location&quot;</span>: [2 + 3 * i, 1]</div>
<div class="line"><span class="lineno">  342</span>        },</div>
<div class="line"><span class="lineno">  343</span>        f<span class="stringliteral">&quot;D_{i}&quot;</span>: {</div>
<div class="line"><span class="lineno">  344</span>            <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  345</span>                f<span class="stringliteral">&quot;A_{i+1}&quot;</span>: {</div>
<div class="line"><span class="lineno">  346</span>                    <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  347</span>                    <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  348</span>                    <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  349</span>                    <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: time_step_length</div>
<div class="line"><span class="lineno">  350</span>                }</div>
<div class="line"><span class="lineno">  351</span>            },</div>
<div class="line"><span class="lineno">  352</span>            <span class="stringliteral">&quot;location&quot;</span>: [2 + 3 * i, -1]</div>
<div class="line"><span class="lineno">  353</span>        }</div>
<div class="line"><span class="lineno">  354</span>    })</div>
<div class="line"><span class="lineno">  355</span>    i += 1</div>
<div class="line"><span class="lineno">  356</span>  graph_dict[f<span class="stringliteral">&quot;A_{i}&quot;</span>] = {</div>
<div class="line"><span class="lineno">  357</span>      <span class="stringliteral">&quot;connection&quot;</span>: {</div>
<div class="line"><span class="lineno">  358</span>          <span class="stringliteral">&quot;END&quot;</span>: {</div>
<div class="line"><span class="lineno">  359</span>              <span class="stringliteral">&quot;a&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  360</span>              <span class="stringliteral">&quot;b&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  361</span>              <span class="stringliteral">&quot;capacity&quot;</span>: capacity,</div>
<div class="line"><span class="lineno">  362</span>              <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>: time_step_length</div>
<div class="line"><span class="lineno">  363</span>          }</div>
<div class="line"><span class="lineno">  364</span>      },</div>
<div class="line"><span class="lineno">  365</span>      <span class="stringliteral">&quot;location&quot;</span>: [0 + 3 * i, 0]</div>
<div class="line"><span class="lineno">  366</span>  }</div>
<div class="line"><span class="lineno">  367</span>  graph_dict[<span class="stringliteral">&quot;END&quot;</span>] = {<span class="stringliteral">&quot;connection&quot;</span>: {}, <span class="stringliteral">&quot;location&quot;</span>: [1 + 3 * i, 0]}</div>
<div class="line"><span class="lineno">  368</span>  time_horizon = int(3.0 * (num_network_in_series + 1) / time_step_length)</div>
<div class="line"><span class="lineno">  369</span>  destination = f<span class="stringliteral">&quot;A_{i}-&gt;END&quot;</span></div>
<div class="line"><span class="lineno">  370</span>  adjacency_list = {</div>
<div class="line"><span class="lineno">  371</span>      key: list(value[<span class="stringliteral">&quot;connection&quot;</span>].<a class="code hl_variable" href="randen_8cc.html#ae05ca1b2d55f74e5686bb16c6dcca50b">keys</a>())</div>
<div class="line"><span class="lineno">  372</span>      <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> graph_dict.items()</div>
<div class="line"><span class="lineno">  373</span>  }</div>
<div class="line"><span class="lineno">  374</span>  bpr_a_coefficient = {}</div>
<div class="line"><span class="lineno">  375</span>  bpr_b_coefficient = {}</div>
<div class="line"><span class="lineno">  376</span>  capacity = {}</div>
<div class="line"><span class="lineno">  377</span>  free_flow_travel_time = {}</div>
<div class="line"><span class="lineno">  378</span>  <span class="keywordflow">for</span> o_node, value_dict <span class="keywordflow">in</span> graph_dict.items():</div>
<div class="line"><span class="lineno">  379</span>    <span class="keywordflow">for</span> d_node, section_dict <span class="keywordflow">in</span> value_dict[<span class="stringliteral">&quot;connection&quot;</span>].items():</div>
<div class="line"><span class="lineno">  380</span>      road_section = dynamic_routing_utils._road_section_from_nodes(</div>
<div class="line"><span class="lineno">  381</span>          origin=o_node, destination=d_node)</div>
<div class="line"><span class="lineno">  382</span>      bpr_a_coefficient[road_section] = section_dict[<span class="stringliteral">&quot;a&quot;</span>]</div>
<div class="line"><span class="lineno">  383</span>      bpr_b_coefficient[road_section] = section_dict[<span class="stringliteral">&quot;b&quot;</span>]</div>
<div class="line"><span class="lineno">  384</span>      capacity[road_section] = section_dict[<span class="stringliteral">&quot;capacity&quot;</span>]</div>
<div class="line"><span class="lineno">  385</span>      free_flow_travel_time[road_section] = section_dict[</div>
<div class="line"><span class="lineno">  386</span>          <span class="stringliteral">&quot;free_flow_travel_time&quot;</span>]</div>
<div class="line"><span class="lineno">  387</span>  node_position = {key: value[<span class="stringliteral">&quot;location&quot;</span>] <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> graph_dict.items()}</div>
<div class="line"><span class="lineno">  388</span>  <span class="keywordflow">return</span> dynamic_routing_utils.Network(</div>
<div class="line"><span class="lineno">  389</span>      adjacency_list,</div>
<div class="line"><span class="lineno">  390</span>      node_position=node_position,</div>
<div class="line"><span class="lineno">  391</span>      bpr_a_coefficient=bpr_a_coefficient,</div>
<div class="line"><span class="lineno">  392</span>      bpr_b_coefficient=bpr_b_coefficient,</div>
<div class="line"><span class="lineno">  393</span>      capacity=capacity,</div>
<div class="line"><span class="lineno">  394</span>      free_flow_travel_time=free_flow_travel_time</div>
<div class="line"><span class="lineno">  395</span>  ), origin, destination, time_horizon</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="randen_8cc_source.html#l00049">keys</a>.</p>

</div>
</div>
<a id="a8062ff1b7dd4f583312b3ed5abd50d96" name="a8062ff1b7dd4f583312b3ed5abd50d96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8062ff1b7dd4f583312b3ed5abd50d96">&#9670;&#160;</a></span>evolve_mean_field_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.evolve_mean_field_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mfg_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>scaling</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>frequency_printing</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00563">563</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  567</span>                           frequency_printing=1):</div>
<div class="line"><span class="lineno">  568</span>  distribution_mfg = distribution_module.DistributionPolicy(mfg_game, policy)</div>
<div class="line"><span class="lineno">  569</span>  root_state = mfg_game.new_initial_state()</div>
<div class="line"><span class="lineno">  570</span>  listing_states = [root_state]</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>  <span class="comment"># plot_network_mean_field_game(graph, {origin: 1})</span></div>
<div class="line"><span class="lineno">  573</span>  i = 0</div>
<div class="line"><span class="lineno">  574</span>  <span class="keywordflow">while</span> <span class="keywordflow">not</span> listing_states[0].is_terminal() <span class="keywordflow">and</span> <span class="keywordflow">not</span> all(</div>
<div class="line"><span class="lineno">  575</span>      state._vehicle_without_legal_action <span class="keywordflow">for</span> state <span class="keywordflow">in</span> listing_states):  <span class="comment"># pylint:disable=protected-access</span></div>
<div class="line"><span class="lineno">  576</span>    <span class="keyword">assert</span> abs(sum(map(distribution_mfg.value, listing_states)) - 1) &lt; 1e-4, (</div>
<div class="line"><span class="lineno">  577</span>        f<span class="stringliteral">&quot;{list(map(distribution_mfg.value, listing_states))}&quot;</span>)</div>
<div class="line"><span class="lineno">  578</span>    new_listing_states = []</div>
<div class="line"><span class="lineno">  579</span>    list_of_state_seen = set()</div>
<div class="line"><span class="lineno">  580</span>    <span class="comment"># In case chance node:</span></div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">if</span> listing_states[0].current_player() == pyspiel.PlayerId.CHANCE:</div>
<div class="line"><span class="lineno">  582</span>      <span class="keywordflow">for</span> mfg_state <span class="keywordflow">in</span> listing_states:</div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordflow">for</span> action, _ <span class="keywordflow">in</span> mfg_state.chance_outcomes():</div>
<div class="line"><span class="lineno">  584</span>          new_mfg_state = mfg_state.child(action)</div>
<div class="line"><span class="lineno">  585</span>          <span class="comment"># Do not append twice the same file.</span></div>
<div class="line"><span class="lineno">  586</span>          <span class="keywordflow">if</span> str(new_mfg_state) <span class="keywordflow">not</span> <span class="keywordflow">in</span> list_of_state_seen:</div>
<div class="line"><span class="lineno">  587</span>            new_listing_states.append(new_mfg_state)</div>
<div class="line"><span class="lineno">  588</span>          list_of_state_seen.add(str(new_mfg_state))</div>
<div class="line"><span class="lineno">  589</span>      current_distribution = {}</div>
<div class="line"><span class="lineno">  590</span>      <span class="keywordflow">for</span> mfg_state <span class="keywordflow">in</span> new_listing_states:</div>
<div class="line"><span class="lineno">  591</span>        location = mfg_state._vehicle_location  <span class="comment"># pylint:disable=protected-access</span></div>
<div class="line"><span class="lineno">  592</span>        <span class="keywordflow">if</span> location <span class="keywordflow">not</span> <span class="keywordflow">in</span> current_distribution:</div>
<div class="line"><span class="lineno">  593</span>          current_distribution[location] = 0</div>
<div class="line"><span class="lineno">  594</span>        current_distribution[location] += distribution_mfg.value(mfg_state)</div>
<div class="line"><span class="lineno">  595</span>      plot_network_mean_field_game(graph, current_distribution, scaling=scaling)</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>    <span class="comment"># In case mean field node:</span></div>
<div class="line"><span class="lineno">  598</span>    <span class="keywordflow">elif</span> listing_states[0].current_player() == pyspiel.PlayerId.MEAN_FIELD:</div>
<div class="line"><span class="lineno">  599</span>      <span class="keywordflow">for</span> mfg_state <span class="keywordflow">in</span> listing_states:</div>
<div class="line"><span class="lineno">  600</span>        dist_to_register = mfg_state.distribution_support()</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>        <span class="keyword">def </span>get_probability_for_state(str_state):</div>
<div class="line"><span class="lineno">  603</span>          <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  604</span>            <span class="keywordflow">return</span> distribution_mfg.value_str(str_state)</div>
<div class="line"><span class="lineno">  605</span>          <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  606</span>            <span class="keywordflow">return</span> 0</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>        dist = [</div>
<div class="line"><span class="lineno">  609</span>            get_probability_for_state(str_state)</div>
<div class="line"><span class="lineno">  610</span>            <span class="keywordflow">for</span> str_state <span class="keywordflow">in</span> dist_to_register</div>
<div class="line"><span class="lineno">  611</span>        ]</div>
<div class="line"><span class="lineno">  612</span>        new_mfg_state = mfg_state.clone()</div>
<div class="line"><span class="lineno">  613</span>        new_mfg_state.update_distribution(dist)</div>
<div class="line"><span class="lineno">  614</span>        <span class="comment"># Do not append twice the same file.</span></div>
<div class="line"><span class="lineno">  615</span>        <span class="keywordflow">if</span> str(new_mfg_state) <span class="keywordflow">not</span> <span class="keywordflow">in</span> list_of_state_seen:</div>
<div class="line"><span class="lineno">  616</span>          new_listing_states.append(new_mfg_state)</div>
<div class="line"><span class="lineno">  617</span>        list_of_state_seen.add(str(new_mfg_state))</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    <span class="comment"># In case action node:</span></div>
<div class="line"><span class="lineno">  620</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  621</span>      <span class="keyword">assert</span> (listing_states[0].current_player() ==</div>
<div class="line"><span class="lineno">  622</span>              pyspiel.PlayerId.DEFAULT_PLAYER_ID), <span class="stringliteral">&quot;The player id should be 0&quot;</span></div>
<div class="line"><span class="lineno">  623</span>      <span class="keywordflow">for</span> mfg_state <span class="keywordflow">in</span> listing_states:</div>
<div class="line"><span class="lineno">  624</span>        <span class="keywordflow">for</span> action, _ <span class="keywordflow">in</span> policy.action_probabilities(mfg_state).items():</div>
<div class="line"><span class="lineno">  625</span>          new_mfg_state = mfg_state.child(action)</div>
<div class="line"><span class="lineno">  626</span>          <span class="comment"># Do not append twice the same file.</span></div>
<div class="line"><span class="lineno">  627</span>          <span class="keywordflow">if</span> str(new_mfg_state) <span class="keywordflow">not</span> <span class="keywordflow">in</span> list_of_state_seen:</div>
<div class="line"><span class="lineno">  628</span>            new_listing_states.append(new_mfg_state)</div>
<div class="line"><span class="lineno">  629</span>          list_of_state_seen.add(str(new_mfg_state))</div>
<div class="line"><span class="lineno">  630</span>      current_distribution = {}</div>
<div class="line"><span class="lineno">  631</span>      <span class="keywordflow">for</span> mfg_state <span class="keywordflow">in</span> new_listing_states:</div>
<div class="line"><span class="lineno">  632</span>        location = mfg_state._vehicle_location  <span class="comment"># pylint:disable=protected-access</span></div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordflow">if</span> location <span class="keywordflow">not</span> <span class="keywordflow">in</span> current_distribution:</div>
<div class="line"><span class="lineno">  634</span>          current_distribution[location] = 0</div>
<div class="line"><span class="lineno">  635</span>        current_distribution[location] += distribution_mfg.value(mfg_state)</div>
<div class="line"><span class="lineno">  636</span>      <span class="keyword">assert</span> abs(sum(current_distribution.values()) - 1) &lt; 1e-4, (</div>
<div class="line"><span class="lineno">  637</span>          f<span class="stringliteral">&quot;{current_distribution}&quot;</span>)</div>
<div class="line"><span class="lineno">  638</span>      i += 1</div>
<div class="line"><span class="lineno">  639</span>      <span class="keywordflow">if</span> i % frequency_printing == 0:</div>
<div class="line"><span class="lineno">  640</span>        plot_network_mean_field_game(</div>
<div class="line"><span class="lineno">  641</span>            graph, current_distribution, scaling=scaling)</div>
<div class="line"><span class="lineno">  642</span>    listing_states = new_listing_states</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00440">plot_network_mean_field_game()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a8062ff1b7dd4f583312b3ed5abd50d96_cgraph.png" border="0" usemap="#anamespaceutils_a8062ff1b7dd4f583312b3ed5abd50d96_cgraph" alt=""/></div>
<map name="anamespaceutils_a8062ff1b7dd4f583312b3ed5abd50d96_cgraph" id="anamespaceutils_a8062ff1b7dd4f583312b3ed5abd50d96_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,202,38"/>
<area shape="rect" href="namespaceutils.html#ab842c32cbf7e4f23c8a1c62bc5320d18" title=" " alt="" coords="250,5,380,46"/>
<area shape="poly" title=" " alt="" coords="202,23,234,23,234,28,202,28"/>
</map>
</div>

</div>
</div>
<a id="a1cbc5bef8f521227b730aef60fa7f467" name="a1cbc5bef8f521227b730aef60fa7f467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cbc5bef8f521227b730aef60fa7f467">&#9670;&#160;</a></span>evolve_n_player_sequential_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.evolve_n_player_sequential_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>debug</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00509">509</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  509</span><span class="keyword">def </span>evolve_n_player_sequential_game(seq_game, policy, graph, debug=False):</div>
<div class="line"><span class="lineno">  510</span>  state = seq_game.new_initial_state()</div>
<div class="line"><span class="lineno">  511</span>  <span class="keywordflow">while</span> <span class="keywordflow">not</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  512</span>    legal_actions = state.legal_actions()</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">if</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  514</span>      <span class="comment"># Sample a chance event outcome.</span></div>
<div class="line"><span class="lineno">  515</span>      outcomes_with_probs = state.chance_outcomes()</div>
<div class="line"><span class="lineno">  516</span>      action_list, prob_list = zip(*outcomes_with_probs)</div>
<div class="line"><span class="lineno">  517</span>      action = np.random.choice(action_list, p=prob_list)</div>
<div class="line"><span class="lineno">  518</span>      <span class="keywordflow">if</span> debug:</div>
<div class="line"><span class="lineno">  519</span>        print(<span class="stringliteral">&quot;------------ Change node ------------&quot;</span>)</div>
<div class="line"><span class="lineno">  520</span>        print(</div>
<div class="line"><span class="lineno">  521</span>            (f<span class="stringliteral">&quot;Possible chance actions: {outcomes_with_probs}, the one taken: &quot;</span></div>
<div class="line"><span class="lineno">  522</span>             f<span class="stringliteral">&quot;{action}.&quot;</span>))</div>
<div class="line"><span class="lineno">  523</span>      state.apply_action(action)</div>
<div class="line"><span class="lineno">  524</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  525</span>      <span class="keywordflow">if</span> debug:</div>
<div class="line"><span class="lineno">  526</span>        print(<span class="stringliteral">&quot;------------ Sequential action node ------------&quot;</span>)</div>
<div class="line"><span class="lineno">  527</span>        print(state.information_state_tensor())</div>
<div class="line"><span class="lineno">  528</span>        print(state.observation_tensor())</div>
<div class="line"><span class="lineno">  529</span>        print(state.information_state_string())</div>
<div class="line"><span class="lineno">  530</span>      <span class="keywordflow">if</span> policy <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  531</span>        state_policy = policy(state)</div>
<div class="line"><span class="lineno">  532</span>        vehicle_location = [</div>
<div class="line"><span class="lineno">  533</span>            s.replace(<span class="stringliteral">&quot;&#39;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  534</span>            <span class="keywordflow">for</span> s <span class="keywordflow">in</span> str(state).split(<span class="stringliteral">&quot;[&quot;</span>)[1].split(<span class="stringliteral">&quot;]&quot;</span>)[0].split(<span class="stringliteral">&quot;, &quot;</span>)</div>
<div class="line"><span class="lineno">  535</span>        ]</div>
<div class="line"><span class="lineno">  536</span>        <span class="keywordflow">if</span> debug:</div>
<div class="line"><span class="lineno">  537</span>          print((f<span class="stringliteral">&quot;Policy for player {state.current_player()} at location &quot;</span></div>
<div class="line"><span class="lineno">  538</span>                 f<span class="stringliteral">&quot;{vehicle_location[state.current_player()]}: &quot;</span>) +</div>
<div class="line"><span class="lineno">  539</span>                str([(str(graph.get_road_section_from_action_id(k)) +</div>
<div class="line"><span class="lineno">  540</span>                      f<span class="stringliteral">&quot;with probability {v}&quot;</span>)</div>
<div class="line"><span class="lineno">  541</span>                     <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> state_policy.items()]))</div>
<div class="line"><span class="lineno">  542</span>        <span class="keyword">assert</span> set(state_policy) == set(legal_actions)</div>
<div class="line"><span class="lineno">  543</span>        action = random.choices(legal_actions,</div>
<div class="line"><span class="lineno">  544</span>                                [state_policy[a] <span class="keywordflow">for</span> a <span class="keywordflow">in</span> legal_actions])</div>
<div class="line"><span class="lineno">  545</span>        <span class="keyword">assert</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(action) == 1</div>
<div class="line"><span class="lineno">  546</span>        action = action[0]</div>
<div class="line"><span class="lineno">  547</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  548</span>        action = random.choice(legal_actions)</div>
<div class="line"><span class="lineno">  549</span>      state.apply_action(action)</div>
<div class="line"><span class="lineno">  550</span>      vehicle_location = [</div>
<div class="line"><span class="lineno">  551</span>          s.replace(<span class="stringliteral">&quot;&#39;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  552</span>          <span class="keywordflow">for</span> s <span class="keywordflow">in</span> str(state).split(<span class="stringliteral">&quot;[&quot;</span>)[1].split(<span class="stringliteral">&quot;]&quot;</span>)[0].split(<span class="stringliteral">&quot;, &quot;</span>)</div>
<div class="line"><span class="lineno">  553</span>      ]</div>
<div class="line"><span class="lineno">  554</span>      <span class="keywordflow">if</span> debug:</div>
<div class="line"><span class="lineno">  555</span>        print(vehicle_location)</div>
<div class="line"><span class="lineno">  556</span>      plot_network_n_player_game(</div>
<div class="line"><span class="lineno">  557</span>          graph,</div>
<div class="line"><span class="lineno">  558</span>          [graph.return_position_of_road_section(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> vehicle_location])</div>
<div class="line"><span class="lineno">  559</span>  <span class="keywordflow">if</span> debug:</div>
<div class="line"><span class="lineno">  560</span>    print(f<span class="stringliteral">&quot;Travel times: {[-x for x in state.returns()]}&quot;</span>)</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="ttc" id="alow__level__alloc__test_8cc_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc__test_8cc_source.html#l00046">low_level_alloc_test.cc:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00399">plot_network_n_player_game()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a1cbc5bef8f521227b730aef60fa7f467_cgraph.png" border="0" usemap="#anamespaceutils_a1cbc5bef8f521227b730aef60fa7f467_cgraph" alt=""/></div>
<map name="anamespaceutils_a1cbc5bef8f521227b730aef60fa7f467_cgraph" id="anamespaceutils_a1cbc5bef8f521227b730aef60fa7f467_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,149,46"/>
<area shape="rect" href="namespaceutils.html#acd0806ac4e8079b301c439db7f9c683d" title=" " alt="" coords="197,5,320,46"/>
<area shape="poly" title=" " alt="" coords="149,23,181,23,181,28,149,28"/>
</map>
</div>

</div>
</div>
<a id="a04e0be2c7abc00acd90cab7770bbd717" name="a04e0be2c7abc00acd90cab7770bbd717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04e0be2c7abc00acd90cab7770bbd717">&#9670;&#160;</a></span>evolve_n_player_simultaneous_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.evolve_n_player_simultaneous_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00476">476</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  476</span><span class="keyword">def </span>evolve_n_player_simultaneous_game(game, policy, graph):</div>
<div class="line"><span class="lineno">  477</span>  state = game.new_initial_state()</div>
<div class="line"><span class="lineno">  478</span>  i = 0</div>
<div class="line"><span class="lineno">  479</span>  <span class="keywordflow">while</span> <span class="keywordflow">not</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  480</span>    i += 1</div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">if</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  482</span>      <span class="comment"># Sample a chance event outcome.</span></div>
<div class="line"><span class="lineno">  483</span>      outcomes_with_probs = state.chance_outcomes()</div>
<div class="line"><span class="lineno">  484</span>      action_list, prob_list = zip(*outcomes_with_probs)</div>
<div class="line"><span class="lineno">  485</span>      action = np.random.choice(action_list, p=prob_list)</div>
<div class="line"><span class="lineno">  486</span>      state.apply_action(action)</div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">elif</span> state.is_simultaneous_node():</div>
<div class="line"><span class="lineno">  488</span>      <span class="comment"># Simultaneous node: sample actions for all players.</span></div>
<div class="line"><span class="lineno">  489</span>      chosen_actions = []</div>
<div class="line"><span class="lineno">  490</span>      <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(game.num_players()):</div>
<div class="line"><span class="lineno">  491</span>        legal_actions = state.legal_actions(i)</div>
<div class="line"><span class="lineno">  492</span>        state_policy = policy(state, i)</div>
<div class="line"><span class="lineno">  493</span>        <span class="keyword">assert</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(legal_actions) == <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(state_policy), (</div>
<div class="line"><span class="lineno">  494</span>            f<span class="stringliteral">&quot;{legal_actions} not same length than {state_policy}&quot;</span>)</div>
<div class="line"><span class="lineno">  495</span>        chosen_actions.append(</div>
<div class="line"><span class="lineno">  496</span>            random.choices(legal_actions,</div>
<div class="line"><span class="lineno">  497</span>                           [state_policy[a] <span class="keywordflow">for</span> a <span class="keywordflow">in</span> legal_actions])[0])</div>
<div class="line"><span class="lineno">  498</span>      state.apply_actions(chosen_actions)</div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  500</span>      <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  501</span>          <span class="stringliteral">&quot;State should either be simultaneous node or change node.&quot;</span>)</div>
<div class="line"><span class="lineno">  502</span>    plot_network_n_player_game(graph, [</div>
<div class="line"><span class="lineno">  503</span>        graph.return_position_of_road_section(x)</div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> state.get_current_vehicle_locations()</div>
<div class="line"><span class="lineno">  505</span>    ])</div>
<div class="line"><span class="lineno">  506</span>  print(f<span class="stringliteral">&quot;Travel times: {[-x for x in state.returns()]}&quot;</span>)</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00399">plot_network_n_player_game()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a04e0be2c7abc00acd90cab7770bbd717_cgraph.png" border="0" usemap="#anamespaceutils_a04e0be2c7abc00acd90cab7770bbd717_cgraph" alt=""/></div>
<map name="anamespaceutils_a04e0be2c7abc00acd90cab7770bbd717_cgraph" id="anamespaceutils_a04e0be2c7abc00acd90cab7770bbd717_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,150,46"/>
<area shape="rect" href="namespaceutils.html#acd0806ac4e8079b301c439db7f9c683d" title=" " alt="" coords="198,5,321,46"/>
<area shape="poly" title=" " alt="" coords="150,23,182,23,182,28,150,28"/>
</map>
</div>

</div>
</div>
<a id="a5254172f89deec655aa1cb1a41522af2" name="a5254172f89deec655aa1cb1a41522af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5254172f89deec655aa1cb1a41522af2">&#9670;&#160;</a></span>external_sampling_monte_carlo_counterfactual_regret_minimization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.external_sampling_monte_carlo_counterfactual_regret_minimization </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>number_of_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_metrics</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00689">689</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  690</span>    seq_game, number_of_iterations, compute_metrics=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  691</span>  cfr_solver = external_mccfr.ExternalSamplingSolver(</div>
<div class="line"><span class="lineno">  692</span>      seq_game, external_mccfr.AverageType.SIMPLE)</div>
<div class="line"><span class="lineno">  693</span>  tick_time = time.time()</div>
<div class="line"><span class="lineno">  694</span>  <span class="comment"># print(&quot;CFRSolver initialized.&quot;)</span></div>
<div class="line"><span class="lineno">  695</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(number_of_iterations):</div>
<div class="line"><span class="lineno">  696</span>    cfr_solver.iteration()</div>
<div class="line"><span class="lineno">  697</span>  timing = time.time() - tick_time</div>
<div class="line"><span class="lineno">  698</span>  <span class="comment"># print(&quot;Finish.&quot;)</span></div>
<div class="line"><span class="lineno">  699</span>  <span class="keywordflow">if</span> compute_metrics:</div>
<div class="line"><span class="lineno">  700</span>    nash_conv = exploitability.nash_conv(seq_game, cfr_solver.average_policy())</div>
<div class="line"><span class="lineno">  701</span>    <span class="keywordflow">return</span> timing, cfr_solver.average_policy(), nash_conv</div>
<div class="line"><span class="lineno">  702</span>  <span class="keywordflow">return</span> timing, cfr_solver.average_policy()</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cd794414c7ffd371ffb268787a49498" name="a0cd794414c7ffd371ffb268787a49498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cd794414c7ffd371ffb268787a49498">&#9670;&#160;</a></span>ficticious_play()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.ficticious_play </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>number_of_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_metrics</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00653">653</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  653</span><span class="keyword">def </span>ficticious_play(seq_game, number_of_iterations, compute_metrics=False):</div>
<div class="line"><span class="lineno">  654</span>  xfp_solver = fictitious_play.XFPSolver(seq_game)</div>
<div class="line"><span class="lineno">  655</span>  tick_time = time.time()</div>
<div class="line"><span class="lineno">  656</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(number_of_iterations):</div>
<div class="line"><span class="lineno">  657</span>    xfp_solver.iteration()</div>
<div class="line"><span class="lineno">  658</span>  timing = time.time() - tick_time</div>
<div class="line"><span class="lineno">  659</span>  <span class="comment"># print(&#39;done&#39;)</span></div>
<div class="line"><span class="lineno">  660</span>  <span class="comment"># average_policies = xfp_solver.average_policy_tables()</span></div>
<div class="line"><span class="lineno">  661</span>  tabular_policy = policy_module.TabularPolicy(seq_game)</div>
<div class="line"><span class="lineno">  662</span>  <span class="keywordflow">if</span> compute_metrics:</div>
<div class="line"><span class="lineno">  663</span>    nash_conv = exploitability.nash_conv(seq_game, xfp_solver.average_policy())</div>
<div class="line"><span class="lineno">  664</span>    average_policy_values = expected_game_score.policy_value(</div>
<div class="line"><span class="lineno">  665</span>        seq_game.new_initial_state(), [tabular_policy])</div>
<div class="line"><span class="lineno">  666</span>    <span class="keywordflow">return</span> timing, tabular_policy, nash_conv, average_policy_values</div>
<div class="line"><span class="lineno">  667</span>  <span class="keywordflow">return</span> timing, tabular_policy</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a80b07609963e2c422a8dafaa234fda5f" name="a80b07609963e2c422a8dafaa234fda5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80b07609963e2c422a8dafaa234fda5f">&#9670;&#160;</a></span>filter_terminal_infostates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.filter_terminal_infostates </td>
          <td>(</td>
          <td class="paramtype">InfostateMapping</td>          <td class="paramname"><span class="paramname"><em>infostates_map</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Filter out terminal infostate_node values.</pre> 
<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html#l00087">87</a> of file <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   87</span><span class="keyword">def </span>filter_terminal_infostates(infostates_map: InfostateMapping):</div>
<div class="line"><span class="lineno">   88</span>  <span class="stringliteral">&quot;&quot;&quot;Filter out terminal infostate_node values.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordflow">return</span> {</div>
<div class="line"><span class="lineno">   90</span>      infostate_string: infostate_node</div>
<div class="line"><span class="lineno">   91</span>      <span class="keywordflow">for</span> infostate_string, infostate_node <span class="keywordflow">in</span> infostates_map.items()</div>
<div class="line"><span class="lineno">   92</span>      <span class="keywordflow">if</span> <span class="keywordflow">not</span> infostate_node.is_terminal()</div>
<div class="line"><span class="lineno">   93</span>  }</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, and <a class="el" href="meta__learning_8py_source.html#l00304">meta_learning.MetaCFRRegretAgent.get_num_infostates()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a80b07609963e2c422a8dafaa234fda5f_icgraph.png" border="0" usemap="#anamespaceutils_a80b07609963e2c422a8dafaa234fda5f_icgraph" alt=""/></div>
<map name="anamespaceutils_a80b07609963e2c422a8dafaa234fda5f_icgraph" id="anamespaceutils_a80b07609963e2c422a8dafaa234fda5f_icgraph">
<area shape="rect" title=" " alt="" coords="506,39,633,79"/>
<area shape="rect" href="namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="287,5,426,46"/>
<area shape="poly" title=" " alt="" coords="491,49,427,39,427,34,491,44"/>
<area shape="rect" href="classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="256,71,458,111"/>
<area shape="poly" title=" " alt="" coords="491,73,459,78,458,73,490,68"/>
<area shape="rect" href="classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="5,5,208,46"/>
<area shape="poly" title=" " alt="" coords="271,28,208,28,208,23,271,23"/>
</map>
</div>

</div>
</div>
<a id="a3a70dd46ba2dc295538613088476bfd9" name="a3a70dd46ba2dc295538613088476bfd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a70dd46ba2dc295538613088476bfd9">&#9670;&#160;</a></span>first_action_policy_n_player()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.first_action_policy_n_player </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00649">649</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  649</span><span class="keyword">def </span>first_action_policy_n_player(seq_game):</div>
<div class="line"><span class="lineno">  650</span>  <span class="keywordflow">return</span> policy_module.FirstActionPolicy(seq_game)</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a66829fe2303d2a3d94b75f53a1e616f0" name="a66829fe2303d2a3d94b75f53a1e616f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66829fe2303d2a3d94b75f53a1e616f0">&#9670;&#160;</a></span>get_average_results_n_player_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_average_results_n_player_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span><span class="paramdefsep"> = </span><span class="paramdefval">10</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00908">908</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  908</span><span class="keyword">def </span>get_average_results_n_player_game(seq_game, policy, num_sample=10):</div>
<div class="line"><span class="lineno">  909</span>  result_array = get_list_results_n_player_game(seq_game, policy, num_sample)</div>
<div class="line"><span class="lineno">  910</span>  <span class="keywordflow">return</span> sum([sum(i) / <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(i) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> zip(*result_array)]) / <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(result_array)</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00901">get_list_results_n_player_game()</a>, and <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a66829fe2303d2a3d94b75f53a1e616f0_cgraph.png" border="0" usemap="#anamespaceutils_a66829fe2303d2a3d94b75f53a1e616f0_cgraph" alt=""/></div>
<map name="anamespaceutils_a66829fe2303d2a3d94b75f53a1e616f0_cgraph" id="anamespaceutils_a66829fe2303d2a3d94b75f53a1e616f0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,46"/>
<area shape="rect" href="namespaceutils.html#ab3b1a31d288809608cfc57965916387c" title=" " alt="" coords="220,5,357,46"/>
<area shape="poly" title=" " alt="" coords="172,23,204,23,204,28,172,28"/>
<area shape="rect" href="namespaceutils.html#a15f47cfe11e0f030c90865194a052e2d" title=" " alt="" coords="405,5,573,46"/>
<area shape="poly" title=" " alt="" coords="357,23,389,23,389,28,357,28"/>
</map>
</div>

</div>
</div>
<a id="ab5534849977c7786148431bc7c9d5141" name="ab5534849977c7786148431bc7c9d5141"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5534849977c7786148431bc7c9d5141">&#9670;&#160;</a></span>get_batched_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_batched_input </td>
          <td>(</td>
          <td class="paramtype">List[jax.Array]</td>          <td class="paramname"><span class="paramname"><em>input_list</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[InfostateNode]</td>          <td class="paramname"><span class="paramname"><em>infostate_list</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[List[int]]</td>          <td class="paramname"><span class="paramname"><em>illegal_action_list</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>batch_size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns list of function arguments extended to be consistent with batch size.

Args:
  input_list: List of DeviceArrays.
  infostate_list: List of information state nodes.
  illegal_action_list: List of List of illegal actions. Each internal list
    contains illegal actions in each information state.
  batch_size: Batch size.

Returns:
  input_list, infostate_list, and illegal_action_list with a size consistent
  with batch size (the size of returned arrays are multipliers of batch size).
</pre> 
<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html#l00030">30</a> of file <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>                      illegal_action_list: List[List[int]], batch_size: int):</div>
<div class="line"><span class="lineno">   33</span>  <span class="stringliteral">&quot;&quot;&quot;Returns list of function arguments extended to be consistent with batch size.</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    input_list: List of DeviceArrays.</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    infostate_list: List of information state nodes.</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    illegal_action_list: List of List of illegal actions. Each internal list</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">      contains illegal actions in each information state.</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    batch_size: Batch size.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    input_list, infostate_list, and illegal_action_list with a size consistent</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    with batch size (the size of returned arrays are multipliers of batch size).</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   46</span>  items_to_sample = batch_size * (int(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(input_list) / batch_size) +</div>
<div class="line"><span class="lineno">   47</span>                                  1) - <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(input_list)</div>
<div class="line"><span class="lineno">   48</span>  idx_sample = np.random.choice(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(input_list), items_to_sample)</div>
<div class="line"><span class="lineno">   49</span>  input_zip = np.array(</div>
<div class="line"><span class="lineno">   50</span>      list(zip(input_list, infostate_list, illegal_action_list)),</div>
<div class="line"><span class="lineno">   51</span>      dtype=object)</div>
<div class="line"><span class="lineno">   52</span>  input_lst_sample = input_zip[idx_sample]</div>
<div class="line"><span class="lineno">   53</span>  input_sample, infostate_sample, illegal_action_sample = zip(*input_lst_sample)</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  input_list.extend(list(input_sample))</div>
<div class="line"><span class="lineno">   56</span>  infostate_list.extend(list(infostate_sample))</div>
<div class="line"><span class="lineno">   57</span>  illegal_action_list.extend(list(illegal_action_sample))</div>
<div class="line"><span class="lineno">   58</span>  <span class="keywordflow">return</span> input_list, infostate_list, illegal_action_list</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="meta__learning_8py_source.html#l00118">meta_learning.compute_next_policy()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_ab5534849977c7786148431bc7c9d5141_icgraph.png" border="0" usemap="#anamespaceutils_ab5534849977c7786148431bc7c9d5141_icgraph" alt=""/></div>
<map name="anamespaceutils_ab5534849977c7786148431bc7c9d5141_icgraph" id="anamespaceutils_ab5534849977c7786148431bc7c9d5141_icgraph">
<area shape="rect" title=" " alt="" coords="647,13,803,38"/>
<area shape="rect" href="namespacemeta__learning.html#a1e4f8865f23fc747b53a9bc696062081" title=" " alt="" coords="443,5,599,46"/>
<area shape="poly" title=" " alt="" coords="632,28,600,28,600,23,632,23"/>
<area shape="rect" href="namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="256,5,395,46"/>
<area shape="poly" title=" " alt="" coords="427,28,395,28,395,23,427,23"/>
<area shape="rect" href="classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="5,5,208,46"/>
<area shape="poly" title=" " alt="" coords="240,28,208,28,208,23,240,23"/>
</map>
</div>

</div>
</div>
<a id="a98c2879ac1c369330096786988d1a3f8" name="a98c2879ac1c369330096786988d1a3f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c2879ac1c369330096786988d1a3f8">&#9670;&#160;</a></span>get_expected_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_expected_value </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00948">948</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  948</span><span class="keyword">def </span>get_expected_value(seq_game, policy, num_sample, player=0):</div>
<div class="line"><span class="lineno">  949</span>  results = get_list_results_n_player_game(</div>
<div class="line"><span class="lineno">  950</span>      seq_game, policy, num_sample=num_sample)</div>
<div class="line"><span class="lineno">  951</span>  expected_value = sum(x[player] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> results) / num_sample</div>
<div class="line"><span class="lineno">  952</span>  <span class="comment"># num_vehicle = len(results[0])</span></div>
<div class="line"><span class="lineno">  953</span>  <span class="comment"># error_bar = abs(sum([x[1] for x in results]) - sum(</span></div>
<div class="line"><span class="lineno">  954</span>  <span class="comment"># [x[2] for x in results])) / num_sample_trajectories</span></div>
<div class="line"><span class="lineno">  955</span>  <span class="comment"># expected_value_policy = sum(sum(x[i] for x in results) for i in range(</span></div>
<div class="line"><span class="lineno">  956</span>  <span class="comment"># 1, BRAESS_NUM_VEHICLES)) / ((BRAESS_NUM_VEHICLES-1)*num_sample_trajectories)</span></div>
<div class="line"><span class="lineno">  957</span>  <span class="keywordflow">return</span> expected_value</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00901">get_list_results_n_player_game()</a>.</p>

<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00963">compute_regret_policy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a98c2879ac1c369330096786988d1a3f8_cgraph.png" border="0" usemap="#anamespaceutils_a98c2879ac1c369330096786988d1a3f8_cgraph" alt=""/></div>
<map name="anamespaceutils_a98c2879ac1c369330096786988d1a3f8_cgraph" id="anamespaceutils_a98c2879ac1c369330096786988d1a3f8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,133,46"/>
<area shape="rect" href="namespaceutils.html#ab3b1a31d288809608cfc57965916387c" title=" " alt="" coords="181,5,318,46"/>
<area shape="poly" title=" " alt="" coords="133,23,165,23,165,28,133,28"/>
<area shape="rect" href="namespaceutils.html#a15f47cfe11e0f030c90865194a052e2d" title=" " alt="" coords="366,5,534,46"/>
<area shape="poly" title=" " alt="" coords="318,23,350,23,350,28,318,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a98c2879ac1c369330096786988d1a3f8_icgraph.png" border="0" usemap="#anamespaceutils_a98c2879ac1c369330096786988d1a3f8_icgraph" alt=""/></div>
<map name="anamespaceutils_a98c2879ac1c369330096786988d1a3f8_icgraph" id="anamespaceutils_a98c2879ac1c369330096786988d1a3f8_icgraph">
<area shape="rect" title=" " alt="" coords="193,5,320,46"/>
<area shape="rect" href="namespaceutils.html#afcb4aa943b1635e230e114d6f2c8f71b" title=" " alt="" coords="5,5,145,46"/>
<area shape="poly" title=" " alt="" coords="177,28,145,28,145,23,177,23"/>
</map>
</div>

</div>
</div>
<a id="a01b602c6d76a82bcfcbbd9632e96e290" name="a01b602c6d76a82bcfcbbd9632e96e290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01b602c6d76a82bcfcbbd9632e96e290">&#9670;&#160;</a></span>get_expected_value_sim_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_expected_value_sim_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00976">976</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  976</span><span class="keyword">def </span>get_expected_value_sim_game(game, policy, num_sample, player=0):</div>
<div class="line"><span class="lineno">  977</span>  results = get_list_results_n_player_simulataneous_game(</div>
<div class="line"><span class="lineno">  978</span>      game, policy, num_sample=num_sample)</div>
<div class="line"><span class="lineno">  979</span>  <span class="keyword">assert</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(results) == num_sample</div>
<div class="line"><span class="lineno">  980</span>  expected_value = sum(x[player] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> results) / num_sample</div>
<div class="line"><span class="lineno">  981</span>  <span class="comment"># num_vehicle = len(results[0])</span></div>
<div class="line"><span class="lineno">  982</span>  <span class="comment"># error_bar = abs(sum([x[1] for x in results]) - sum(</span></div>
<div class="line"><span class="lineno">  983</span>  <span class="comment"># [x[2] for x in results])) / num_sample_trajectories</span></div>
<div class="line"><span class="lineno">  984</span>  <span class="comment"># expected_value_policy = sum(sum(x[i] for x in results) for i in range(</span></div>
<div class="line"><span class="lineno">  985</span>  <span class="comment"># 1, BRAESS_NUM_VEHICLES)) / ((BRAESS_NUM_VEHICLES-1)*num_sample_trajectories)</span></div>
<div class="line"><span class="lineno">  986</span>  <span class="keywordflow">return</span> expected_value</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00941">get_list_results_n_player_simulataneous_game()</a>, and <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01068">compute_regret_policy_against_pure_policy_sim_game()</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00992">compute_regret_policy_random_noise_sim_game()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_cgraph.png" border="0" usemap="#anamespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_cgraph" alt=""/></div>
<map name="anamespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_cgraph" id="anamespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,133,46"/>
<area shape="rect" href="namespaceutils.html#a515477d84f191e74fe29ac89b1e98cc9" title=" " alt="" coords="181,5,388,46"/>
<area shape="poly" title=" " alt="" coords="133,23,165,23,165,28,133,28"/>
<area shape="rect" href="namespaceutils.html#ac81d8cea5974b660cf2c86ebc6b6cc09" title=" " alt="" coords="436,5,622,46"/>
<area shape="poly" title=" " alt="" coords="388,23,420,23,420,28,388,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_icgraph.png" border="0" usemap="#anamespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_icgraph" alt=""/></div>
<map name="anamespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_icgraph" id="anamespaceutils_a01b602c6d76a82bcfcbbd9632e96e290_icgraph">
<area shape="rect" title=" " alt="" coords="204,53,331,94"/>
<area shape="rect" href="namespaceutils.html#af4c1909a38c4ed3355f0362fd935c7b3" title=" " alt="" coords="9,5,152,61"/>
<area shape="poly" title=" " alt="" coords="188,59,152,51,153,46,189,54"/>
<area shape="rect" href="namespaceutils.html#a40723eaa911b97c3d5c90a0fa35a99e7" title=" " alt="" coords="5,85,156,141"/>
<area shape="poly" title=" " alt="" coords="189,93,156,100,155,94,188,87"/>
</map>
</div>

</div>
</div>
<a id="ab3b1a31d288809608cfc57965916387c" name="ab3b1a31d288809608cfc57965916387c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3b1a31d288809608cfc57965916387c">&#9670;&#160;</a></span>get_list_results_n_player_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_list_results_n_player_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span><span class="paramdefsep"> = </span><span class="paramdefval">10</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00901">901</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  901</span><span class="keyword">def </span>get_list_results_n_player_game(seq_game, policy, num_sample=10):</div>
<div class="line"><span class="lineno">  902</span>  <span class="keywordflow">return</span> [</div>
<div class="line"><span class="lineno">  903</span>      get_results_n_player_sequential_game(seq_game, policy)</div>
<div class="line"><span class="lineno">  904</span>      <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_sample)</div>
<div class="line"><span class="lineno">  905</span>  ]</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00882">get_results_n_player_sequential_game()</a>.</p>

<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00908">get_average_results_n_player_game()</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00948">get_expected_value()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_ab3b1a31d288809608cfc57965916387c_cgraph.png" border="0" usemap="#anamespaceutils_ab3b1a31d288809608cfc57965916387c_cgraph" alt=""/></div>
<map name="anamespaceutils_ab3b1a31d288809608cfc57965916387c_cgraph" id="anamespaceutils_ab3b1a31d288809608cfc57965916387c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,143,46"/>
<area shape="rect" href="namespaceutils.html#a15f47cfe11e0f030c90865194a052e2d" title=" " alt="" coords="191,5,359,46"/>
<area shape="poly" title=" " alt="" coords="143,23,175,23,175,28,143,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_ab3b1a31d288809608cfc57965916387c_icgraph.png" border="0" usemap="#anamespaceutils_ab3b1a31d288809608cfc57965916387c_icgraph" alt=""/></div>
<map name="anamespaceutils_ab3b1a31d288809608cfc57965916387c_icgraph" id="anamespaceutils_ab3b1a31d288809608cfc57965916387c_icgraph">
<area shape="rect" title=" " alt="" coords="407,39,544,79"/>
<area shape="rect" href="namespaceutils.html#a66829fe2303d2a3d94b75f53a1e616f0" title=" " alt="" coords="193,5,359,46"/>
<area shape="poly" title=" " alt="" coords="391,48,359,42,360,37,392,42"/>
<area shape="rect" href="namespaceutils.html#a98c2879ac1c369330096786988d1a3f8" title=" " alt="" coords="212,71,340,111"/>
<area shape="poly" title=" " alt="" coords="392,75,340,83,339,78,391,70"/>
<area shape="rect" href="namespaceutils.html#afcb4aa943b1635e230e114d6f2c8f71b" title=" " alt="" coords="5,71,145,111"/>
<area shape="poly" title=" " alt="" coords="197,94,145,94,145,88,197,88"/>
</map>
</div>

</div>
</div>
<a id="a515477d84f191e74fe29ac89b1e98cc9" name="a515477d84f191e74fe29ac89b1e98cc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a515477d84f191e74fe29ac89b1e98cc9">&#9670;&#160;</a></span>get_list_results_n_player_simulataneous_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_list_results_n_player_simulataneous_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_sample</em></span><span class="paramdefsep"> = </span><span class="paramdefval">10</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00941">941</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  941</span><span class="keyword">def </span>get_list_results_n_player_simulataneous_game(game, policy, num_sample=10):</div>
<div class="line"><span class="lineno">  942</span>  <span class="keywordflow">return</span> [</div>
<div class="line"><span class="lineno">  943</span>      get_results_n_player_simultaneous_game(game, policy)</div>
<div class="line"><span class="lineno">  944</span>      <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_sample)</div>
<div class="line"><span class="lineno">  945</span>  ]</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00913">get_results_n_player_simultaneous_game()</a>.</p>

<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00976">get_expected_value_sim_game()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a515477d84f191e74fe29ac89b1e98cc9_cgraph.png" border="0" usemap="#anamespaceutils_a515477d84f191e74fe29ac89b1e98cc9_cgraph" alt=""/></div>
<map name="anamespaceutils_a515477d84f191e74fe29ac89b1e98cc9_cgraph" id="anamespaceutils_a515477d84f191e74fe29ac89b1e98cc9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,213,46"/>
<area shape="rect" href="namespaceutils.html#ac81d8cea5974b660cf2c86ebc6b6cc09" title=" " alt="" coords="261,5,447,46"/>
<area shape="poly" title=" " alt="" coords="213,23,245,23,245,28,213,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a515477d84f191e74fe29ac89b1e98cc9_icgraph.png" border="0" usemap="#anamespaceutils_a515477d84f191e74fe29ac89b1e98cc9_icgraph" alt=""/></div>
<map name="anamespaceutils_a515477d84f191e74fe29ac89b1e98cc9_icgraph" id="anamespaceutils_a515477d84f191e74fe29ac89b1e98cc9_icgraph">
<area shape="rect" title=" " alt="" coords="379,53,586,94"/>
<area shape="rect" href="namespaceutils.html#a01b602c6d76a82bcfcbbd9632e96e290" title=" " alt="" coords="204,53,331,94"/>
<area shape="poly" title=" " alt="" coords="364,76,331,76,331,70,364,70"/>
<area shape="rect" href="namespaceutils.html#af4c1909a38c4ed3355f0362fd935c7b3" title=" " alt="" coords="9,5,152,61"/>
<area shape="poly" title=" " alt="" coords="188,59,152,51,153,46,189,54"/>
<area shape="rect" href="namespaceutils.html#a40723eaa911b97c3d5c90a0fa35a99e7" title=" " alt="" coords="5,85,156,141"/>
<area shape="poly" title=" " alt="" coords="189,93,156,100,155,94,188,87"/>
</map>
</div>

</div>
</div>
<a id="a146363baaf8387a17e2664f9da953360" name="a146363baaf8387a17e2664f9da953360"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a146363baaf8387a17e2664f9da953360">&#9670;&#160;</a></span>get_network_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> jax.Array utils.get_network_output </td>
          <td>(</td>
          <td class="paramtype">ApplyFn</td>          <td class="paramname"><span class="paramname"><em>net_apply</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Params</td>          <td class="paramname"><span class="paramname"><em>net_params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>net_input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[int]</td>          <td class="paramname"><span class="paramname"><em>illegal_actions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hk.PRNGSequence</td>          <td class="paramname"><span class="paramname"><em>key</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns policy generated as output of model.

Args:
  net_apply: Haiku apply function.
  net_params: Haiku network parameters.
  net_input: Input of the model.
  illegal_actions: List of illegal actions we use to mask the model output.
  key: Pseudo random number.

Returns:
  Policy generated by model. Model output is filtered to mask illegal actions.
</pre> 
<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html#l00096">96</a> of file <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>                       key: hk.PRNGSequence) -&gt; jax.Array:</div>
<div class="line"><span class="lineno">   99</span>  <span class="stringliteral">&quot;&quot;&quot;Returns policy generated as output of model.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    net_apply: Haiku apply function.</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    net_params: Haiku network parameters.</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    net_input: Input of the model.</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">    illegal_actions: List of illegal actions we use to mask the model output.</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    key: Pseudo random number.</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral">    Policy generated by model. Model output is filtered to mask illegal actions.</span></div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  111</span>  net_output = jax.jit(net_apply)(net_params, key, net_input)</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordflow">if</span> illegal_actions:</div>
<div class="line"><span class="lineno">  114</span>    net_output = jnp.delete(net_output, np.array(illegal_actions))</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>  <span class="keywordflow">return</span> jax.nn.softmax(net_output)</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adee2d8b428905f02a87d98d107aadb5c" name="adee2d8b428905f02a87d98d107aadb5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adee2d8b428905f02a87d98d107aadb5c">&#9670;&#160;</a></span>get_network_output_batched()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> List[jax.Array] utils.get_network_output_batched </td>
          <td>(</td>
          <td class="paramtype">ApplyFn</td>          <td class="paramname"><span class="paramname"><em>net_apply</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Params</td>          <td class="paramname"><span class="paramname"><em>net_params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>net_input</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[List[int]]</td>          <td class="paramname"><span class="paramname"><em>all_illegal_actions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hk.PRNGSequence</td>          <td class="paramname"><span class="paramname"><em>key</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns policy of batched input generated as output of model.

Args:
  net_apply: Haiku apply function.
  net_params: Haiku network parameters.
  net_input: Input of the model.
  all_illegal_actions: Nested list of illegal actions we use to mask the model
    output. Length of outer list is equal to the batch size.
  key: Pseudo random number.

Returns:
  List of policies generated by model. Model output is filtered to mask
  illegal actions. Length of the returned list is equal to batch size.
</pre> 
<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html#l00119">119</a> of file <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  122</span>    key: hk.PRNGSequence) -&gt; List[jax.Array]:</div>
<div class="line"><span class="lineno">  123</span>  <span class="stringliteral">&quot;&quot;&quot;Returns policy of batched input generated as output of model.</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">    net_apply: Haiku apply function.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    net_params: Haiku network parameters.</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    net_input: Input of the model.</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    all_illegal_actions: Nested list of illegal actions we use to mask the model</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">      output. Length of outer list is equal to the batch size.</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    key: Pseudo random number.</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    List of policies generated by model. Model output is filtered to mask</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    illegal actions. Length of the returned list is equal to batch size.</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  137</span>  net_output_batched = net_apply(net_params, <a class="code hl_variable" href="low__level__alloc_8cc.html#a99b32867fd662c5f37b4c76816edc19e">next</a>(key), net_input)</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>  batch_policies = []</div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">for</span> i, illegal_actions <span class="keywordflow">in</span> enumerate(all_illegal_actions):</div>
<div class="line"><span class="lineno">  141</span>    net_output = net_output_batched[i]</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">if</span> illegal_actions:</div>
<div class="line"><span class="lineno">  143</span>      net_output = jnp.expand_dims(</div>
<div class="line"><span class="lineno">  144</span>          jnp.delete(net_output, jnp.array(illegal_actions)), axis=0)</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    batch_policies.append(jax.nn.softmax(net_output))</div>
<div class="line"><span class="lineno">  147</span>  <span class="keywordflow">return</span> batch_policies</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span><span class="preprocessor">@functools.partial(jax.jit, static_argnums=(2, 3, 4, 5, 7, 9)</span>)</div>
<div class="ttc" id="alow__level__alloc_8cc_html_a99b32867fd662c5f37b4c76816edc19e"><div class="ttname"><a href="low__level__alloc_8cc.html#a99b32867fd662c5f37b4c76816edc19e">next</a></div><div class="ttdeci">AllocList * next[kMaxLevel]</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc_8cc_source.html#l00100">low_level_alloc.cc:100</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc_8cc_source.html#l00100">next</a>.</p>

<p class="reference">Referenced by <a class="el" href="meta__learning_8py_source.html#l00118">meta_learning.compute_next_policy()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_adee2d8b428905f02a87d98d107aadb5c_icgraph.png" border="0" usemap="#anamespaceutils_adee2d8b428905f02a87d98d107aadb5c_icgraph" alt=""/></div>
<map name="anamespaceutils_adee2d8b428905f02a87d98d107aadb5c_icgraph" id="anamespaceutils_adee2d8b428905f02a87d98d107aadb5c_icgraph">
<area shape="rect" title=" " alt="" coords="647,5,811,46"/>
<area shape="rect" href="namespacemeta__learning.html#a1e4f8865f23fc747b53a9bc696062081" title=" " alt="" coords="443,5,599,46"/>
<area shape="poly" title=" " alt="" coords="632,28,600,28,600,23,632,23"/>
<area shape="rect" href="namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="256,5,395,46"/>
<area shape="poly" title=" " alt="" coords="427,28,395,28,395,23,427,23"/>
<area shape="rect" href="classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="5,5,208,46"/>
<area shape="poly" title=" " alt="" coords="240,28,208,28,208,23,240,23"/>
</map>
</div>

</div>
</div>
<a id="a15f47cfe11e0f030c90865194a052e2d" name="a15f47cfe11e0f030c90865194a052e2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15f47cfe11e0f030c90865194a052e2d">&#9670;&#160;</a></span>get_results_n_player_sequential_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_results_n_player_sequential_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00882">882</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  882</span><span class="keyword">def </span>get_results_n_player_sequential_game(seq_game, policy):</div>
<div class="line"><span class="lineno">  883</span>  state = seq_game.new_initial_state()</div>
<div class="line"><span class="lineno">  884</span>  <span class="keywordflow">while</span> <span class="keywordflow">not</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  885</span>    legal_actions = state.legal_actions()</div>
<div class="line"><span class="lineno">  886</span>    <span class="keywordflow">if</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  887</span>      outcomes_with_probs = state.chance_outcomes()</div>
<div class="line"><span class="lineno">  888</span>      action_list, prob_list = zip(*outcomes_with_probs)</div>
<div class="line"><span class="lineno">  889</span>      action = np.random.choice(action_list, p=prob_list)</div>
<div class="line"><span class="lineno">  890</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  891</span>      state_policy = policy(state)</div>
<div class="line"><span class="lineno">  892</span>      <span class="keyword">assert</span> set(state_policy) == set(legal_actions)</div>
<div class="line"><span class="lineno">  893</span>      action = random.choices(legal_actions,</div>
<div class="line"><span class="lineno">  894</span>                              [state_policy[a] <span class="keywordflow">for</span> a <span class="keywordflow">in</span> legal_actions])</div>
<div class="line"><span class="lineno">  895</span>      <span class="keyword">assert</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(action) == 1</div>
<div class="line"><span class="lineno">  896</span>      action = action[0]</div>
<div class="line"><span class="lineno">  897</span>    state.apply_action(action)</div>
<div class="line"><span class="lineno">  898</span>  <span class="keywordflow">return</span> state.returns()</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00901">get_list_results_n_player_game()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_a15f47cfe11e0f030c90865194a052e2d_icgraph.png" border="0" usemap="#anamespaceutils_a15f47cfe11e0f030c90865194a052e2d_icgraph" alt=""/></div>
<map name="anamespaceutils_a15f47cfe11e0f030c90865194a052e2d_icgraph" id="anamespaceutils_a15f47cfe11e0f030c90865194a052e2d_icgraph">
<area shape="rect" title=" " alt="" coords="592,39,761,79"/>
<area shape="rect" href="namespaceutils.html#ab3b1a31d288809608cfc57965916387c" title=" " alt="" coords="407,39,544,79"/>
<area shape="poly" title=" " alt="" coords="577,62,545,62,545,56,577,56"/>
<area shape="rect" href="namespaceutils.html#a66829fe2303d2a3d94b75f53a1e616f0" title=" " alt="" coords="193,5,359,46"/>
<area shape="poly" title=" " alt="" coords="391,48,359,42,360,37,392,42"/>
<area shape="rect" href="namespaceutils.html#a98c2879ac1c369330096786988d1a3f8" title=" " alt="" coords="212,71,340,111"/>
<area shape="poly" title=" " alt="" coords="392,75,340,83,339,78,391,70"/>
<area shape="rect" href="namespaceutils.html#afcb4aa943b1635e230e114d6f2c8f71b" title=" " alt="" coords="5,71,145,111"/>
<area shape="poly" title=" " alt="" coords="197,94,145,94,145,88,197,88"/>
</map>
</div>

</div>
</div>
<a id="ac81d8cea5974b660cf2c86ebc6b6cc09" name="ac81d8cea5974b660cf2c86ebc6b6cc09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac81d8cea5974b660cf2c86ebc6b6cc09">&#9670;&#160;</a></span>get_results_n_player_simultaneous_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.get_results_n_player_simultaneous_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00913">913</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  913</span><span class="keyword">def </span>get_results_n_player_simultaneous_game(game, policy):</div>
<div class="line"><span class="lineno">  914</span>  state = game.new_initial_state()</div>
<div class="line"><span class="lineno">  915</span>  i = 0</div>
<div class="line"><span class="lineno">  916</span>  <span class="keywordflow">while</span> <span class="keywordflow">not</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  917</span>    i += 1</div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordflow">if</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  919</span>      <span class="comment"># Sample a chance event outcome.</span></div>
<div class="line"><span class="lineno">  920</span>      outcomes_with_probs = state.chance_outcomes()</div>
<div class="line"><span class="lineno">  921</span>      action_list, prob_list = zip(*outcomes_with_probs)</div>
<div class="line"><span class="lineno">  922</span>      action = np.random.choice(action_list, p=prob_list)</div>
<div class="line"><span class="lineno">  923</span>      state.apply_action(action)</div>
<div class="line"><span class="lineno">  924</span>    <span class="keywordflow">elif</span> state.is_simultaneous_node():</div>
<div class="line"><span class="lineno">  925</span>      <span class="comment"># Simultaneous node: sample actions for all players.</span></div>
<div class="line"><span class="lineno">  926</span>      chosen_actions = []</div>
<div class="line"><span class="lineno">  927</span>      <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(game.num_players()):</div>
<div class="line"><span class="lineno">  928</span>        legal_actions = state.legal_actions(i)</div>
<div class="line"><span class="lineno">  929</span>        state_policy = policy(state, player_id=i)</div>
<div class="line"><span class="lineno">  930</span>        <span class="keyword">assert</span> abs(sum([state_policy[a] <span class="keywordflow">for</span> a <span class="keywordflow">in</span> legal_actions]) - 1) &lt; 1e-4</div>
<div class="line"><span class="lineno">  931</span>        chosen_actions.append(</div>
<div class="line"><span class="lineno">  932</span>            random.choices(legal_actions,</div>
<div class="line"><span class="lineno">  933</span>                           [state_policy[a] <span class="keywordflow">for</span> a <span class="keywordflow">in</span> legal_actions])[0])</div>
<div class="line"><span class="lineno">  934</span>      state.apply_actions(chosen_actions)</div>
<div class="line"><span class="lineno">  935</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  936</span>      <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  937</span>          <span class="stringliteral">&quot;State should either be simultaneous node or change node.&quot;</span>)</div>
<div class="line"><span class="lineno">  938</span>  <span class="keywordflow">return</span> state.returns()</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00941">get_list_results_n_player_simulataneous_game()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_ac81d8cea5974b660cf2c86ebc6b6cc09_icgraph.png" border="0" usemap="#anamespaceutils_ac81d8cea5974b660cf2c86ebc6b6cc09_icgraph" alt=""/></div>
<map name="anamespaceutils_ac81d8cea5974b660cf2c86ebc6b6cc09_icgraph" id="anamespaceutils_ac81d8cea5974b660cf2c86ebc6b6cc09_icgraph">
<area shape="rect" title=" " alt="" coords="634,53,821,94"/>
<area shape="rect" href="namespaceutils.html#a515477d84f191e74fe29ac89b1e98cc9" title=" " alt="" coords="379,53,586,94"/>
<area shape="poly" title=" " alt="" coords="619,76,587,76,587,70,619,70"/>
<area shape="rect" href="namespaceutils.html#a01b602c6d76a82bcfcbbd9632e96e290" title=" " alt="" coords="204,53,331,94"/>
<area shape="poly" title=" " alt="" coords="364,76,331,76,331,70,364,70"/>
<area shape="rect" href="namespaceutils.html#af4c1909a38c4ed3355f0362fd935c7b3" title=" " alt="" coords="9,5,152,61"/>
<area shape="poly" title=" " alt="" coords="188,59,152,51,153,46,189,54"/>
<area shape="rect" href="namespaceutils.html#a40723eaa911b97c3d5c90a0fa35a99e7" title=" " alt="" coords="5,85,156,141"/>
<area shape="poly" title=" " alt="" coords="189,93,156,100,155,94,188,87"/>
</map>
</div>

</div>
</div>
<a id="aff900969cd362346efed9d6ea63e30ae" name="aff900969cd362346efed9d6ea63e30ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff900969cd362346efed9d6ea63e30ae">&#9670;&#160;</a></span>mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray utils.mask </td>
          <td>(</td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>cfvalues</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[InfostateNode]</td>          <td class="paramname"><span class="paramname"><em>infoset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>num_actions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>batch_size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns counterfactual values of legal actions and put 0 for illegal ones.

Args:
  cfvalues: Numpy array of counterfactual values.
  infoset: List of information states.
  num_actions: Number of possible actions to take.
  batch_size: Batch size.

Returns:
  Masked counterfactual values. The counterfactual values of legal actions are
  kept as passed to this function and for illegal actions, we consider 0
  counterfactual value.
</pre> 
<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html#l00061">61</a> of file <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>         batch_size: int) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno">   63</span>  <span class="stringliteral">&quot;&quot;&quot;Returns counterfactual values of legal actions and put 0 for illegal ones.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    cfvalues: Numpy array of counterfactual values.</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    infoset: List of information states.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">    num_actions: Number of possible actions to take.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    batch_size: Batch size.</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    Masked counterfactual values. The counterfactual values of legal actions are</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">    kept as passed to this function and for illegal actions, we consider 0</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">    counterfactual value.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   76</span>  legal_actions = [[infoset[i].world_state.state.legal_actions()] *</div>
<div class="line"><span class="lineno">   77</span>                   cfvalues.shape[1] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(batch_size)]</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  masked_cfvalues = np.zeros(shape=[batch_size, cfvalues.shape[1], num_actions])</div>
<div class="line"><span class="lineno">   80</span>  <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(cfvalues.shape[0]):</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(cfvalues.shape[1]):</div>
<div class="line"><span class="lineno">   82</span>      np.put(masked_cfvalues[i][j], legal_actions[i][j], cfvalues[i][j])</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  <span class="keywordflow">return</span> np.stack(masked_cfvalues)</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c16321b5832d91bd745eb1979e92de7" name="a6c16321b5832d91bd745eb1979e92de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c16321b5832d91bd745eb1979e92de7">&#9670;&#160;</a></span>mean_field_fictitious_play()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.mean_field_fictitious_play </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mfg_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>number_of_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_metrics</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00819">819</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  821</span>                               compute_metrics=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  822</span>  fp = mean_field_fictitious_play_module.FictitiousPlay(mfg_game)</div>
<div class="line"><span class="lineno">  823</span>  tick_time = time.time()</div>
<div class="line"><span class="lineno">  824</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(number_of_iterations):</div>
<div class="line"><span class="lineno">  825</span>    fp.iteration()</div>
<div class="line"><span class="lineno">  826</span>  timing = time.time() - tick_time</div>
<div class="line"><span class="lineno">  827</span>  fp_policy = fp.get_policy()</div>
<div class="line"><span class="lineno">  828</span>  <span class="comment"># print(&#39;learning done&#39;)</span></div>
<div class="line"><span class="lineno">  829</span>  <span class="keywordflow">if</span> compute_metrics:</div>
<div class="line"><span class="lineno">  830</span>    distribution_mfg = distribution_module.DistributionPolicy(</div>
<div class="line"><span class="lineno">  831</span>        mfg_game, fp_policy)</div>
<div class="line"><span class="lineno">  832</span>    <span class="comment"># print(&#39;distribution done&#39;)</span></div>
<div class="line"><span class="lineno">  833</span>    policy_value_ = policy_value.PolicyValue(mfg_game, distribution_mfg,</div>
<div class="line"><span class="lineno">  834</span>                                             fp_policy).value(</div>
<div class="line"><span class="lineno">  835</span>                                                 mfg_game.new_initial_state())</div>
<div class="line"><span class="lineno">  836</span>    nash_conv_fp = nash_conv_module.NashConv(mfg_game, fp_policy)</div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">return</span> timing, fp_policy, nash_conv_fp, policy_value_</div>
<div class="line"><span class="lineno">  838</span>  <span class="keywordflow">return</span> timing, fp_policy</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c15a96184b6188e7bf7b71a5a7feb7b" name="a2c15a96184b6188e7bf7b71a5a7feb7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c15a96184b6188e7bf7b71a5a7feb7b">&#9670;&#160;</a></span>mean_field_uniform_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.mean_field_uniform_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mfg_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>number_of_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_metrics</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00804">804</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  806</span>                              compute_metrics=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  807</span>  del number_of_iterations</div>
<div class="line"><span class="lineno">  808</span>  uniform_policy = policy_module.UniformRandomPolicy(mfg_game)</div>
<div class="line"><span class="lineno">  809</span>  <span class="keywordflow">if</span> compute_metrics:</div>
<div class="line"><span class="lineno">  810</span>    distribution_mfg = distribution_module.DistributionPolicy(</div>
<div class="line"><span class="lineno">  811</span>        mfg_game, uniform_policy)</div>
<div class="line"><span class="lineno">  812</span>    policy_value_ = policy_value.PolicyValue(mfg_game, distribution_mfg,</div>
<div class="line"><span class="lineno">  813</span>                                             uniform_policy).value(</div>
<div class="line"><span class="lineno">  814</span>                                                 mfg_game.new_initial_state())</div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordflow">return</span> uniform_policy, policy_value_</div>
<div class="line"><span class="lineno">  816</span>  <span class="keywordflow">return</span> uniform_policy</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8431845ac82b75d22ea15c467e6bdbce" name="a8431845ac82b75d22ea15c467e6bdbce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8431845ac82b75d22ea15c467e6bdbce">&#9670;&#160;</a></span>meta_loss() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.meta_loss </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>opt_params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>net_apply</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>payoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>steps</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the meta learning loss value.

Args:
  opt_params: Optimizer parameters.
  net_apply: Apply function.
  payoff: Payoff matrix.
  steps: Number of steps.

Returns:
  Accumulated loss value over number of steps.</pre> 
<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2matrix__games_2utils_8py_source.html#l00025">25</a> of file <a class="el" href="python_2examples_2meta__cfr_2matrix__games_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span><span class="keyword">def </span>meta_loss(opt_params, net_apply, payoff, steps):</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the meta learning loss value.</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    opt_params: Optimizer parameters.</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">    net_apply: Apply function.</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">    payoff: Payoff matrix.</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    steps: Number of steps.</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    Accumulated loss value over number of steps.</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   39</span>  regret_sum_x = np.zeros(shape=[FLAGS.batch_size, 1, FLAGS.num_actions])</div>
<div class="line"><span class="lineno">   40</span>  regret_sum_y = np.zeros(shape=[FLAGS.batch_size, 1, FLAGS.num_actions])</div>
<div class="line"><span class="lineno">   41</span>  total_loss = 0</div>
<div class="line"><span class="lineno">   42</span>  step = 0</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="preprocessor">@jax.jit</span></div>
<div class="line"><span class="lineno">   45</span>  <span class="keyword">def </span>scan_body(carry, x):</div>
<div class="line"><span class="lineno">   46</span>    nonlocal regret_sum_x</div>
<div class="line"><span class="lineno">   47</span>    nonlocal regret_sum_y</div>
<div class="line"><span class="lineno">   48</span>    regret_sum_x, regret_sum_y, current_step, total_loss = carry</div>
<div class="line"><span class="lineno">   49</span>    x = net_apply(opt_params, <span class="keywordtype">None</span>, regret_sum_x / (current_step + 1))</div>
<div class="line"><span class="lineno">   50</span>    y = net_apply(opt_params, <span class="keywordtype">None</span>, regret_sum_y / (current_step + 1))</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>    strategy_x = jax.nn.softmax(x)</div>
<div class="line"><span class="lineno">   53</span>    strategy_y = jnp.transpose(jax.nn.softmax(y), [0, 2, 1])</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    values_x = jnp.matmul(payoff, strategy_y)  <span class="comment"># val_x = payoff * st_y</span></div>
<div class="line"><span class="lineno">   56</span>    values_y = -jnp.matmul(strategy_x, payoff)  <span class="comment"># val_y = -1 * payoff * st_x</span></div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    value_x = jnp.matmul(jnp.matmul(strategy_x, payoff), strategy_y)</div>
<div class="line"><span class="lineno">   59</span>    value_y = -value_x</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    curren_regret_x = values_x - value_x</div>
<div class="line"><span class="lineno">   62</span>    curren_regret_y = values_y - value_y</div>
<div class="line"><span class="lineno">   63</span>    curren_regret_x = jnp.transpose(curren_regret_x, [0, 2, 1])</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    regret_sum_x += curren_regret_x</div>
<div class="line"><span class="lineno">   66</span>    regret_sum_y += curren_regret_y</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    current_loss = jnp.mean(jnp.max(</div>
<div class="line"><span class="lineno">   69</span>        jax.numpy.concatenate([curren_regret_x, curren_regret_y], axis=2),</div>
<div class="line"><span class="lineno">   70</span>        axis=[1, 2]), axis=-1)</div>
<div class="line"><span class="lineno">   71</span>    total_loss += current_loss</div>
<div class="line"><span class="lineno">   72</span>    current_step += 1</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">return</span> (regret_sum_x, regret_sum_y, current_step, total_loss), <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  (regret_sum_x, regret_sum_y, step, total_loss), _ = jax.lax.scan(</div>
<div class="line"><span class="lineno">   76</span>      scan_body,</div>
<div class="line"><span class="lineno">   77</span>      (regret_sum_x, regret_sum_y, step, total_loss),</div>
<div class="line"><span class="lineno">   78</span>      <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">   79</span>      length=steps,</div>
<div class="line"><span class="lineno">   80</span>  )</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  <span class="keywordflow">return</span> total_loss</div>
</div><!-- fragment -->
</div>
</div>
<a id="aedf32c286ba750f56d157bd834f37268" name="aedf32c286ba750f56d157bd834f37268"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedf32c286ba750f56d157bd834f37268">&#9670;&#160;</a></span>meta_loss() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float utils.meta_loss </td>
          <td>(</td>
          <td class="paramtype">Params</td>          <td class="paramname"><span class="paramname"><em>net_params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>cfvalues</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ApplyFn</td>          <td class="paramname"><span class="paramname"><em>net_apply</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>steps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>num_all_actions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[InfostateNode]</td>          <td class="paramname"><span class="paramname"><em>infosets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">InfostateMapping</td>          <td class="paramname"><span class="paramname"><em>infostate_map</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>batch_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hk.PRNGSequence</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>use_infostate_representation</em></span><span class="paramdefsep"> = </span><span class="paramdefval">True</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Meta learning loss function.

Args:
  net_params: Network parameters.
  cfvalues: Counterfactual values.
  net_apply: Haiku apply function.
  steps: Number of unrolling steps.
  num_all_actions: Number of actions.
  infosets: List of information states.
  infostate_map: Mapping from information state string to information state
    node.
  batch_size: Batch size.
  key: Pseudo random number.
  use_infostate_representation: Boolean value indicating if information state
    representation is used as part of input.

Returns:
  Mean meta learning loss value.
</pre> 
<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html#l00151">151</a> of file <a class="el" href="python_2examples_2meta__cfr_2sequential__games_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  157</span>              use_infostate_representation: bool = <span class="keyword">True</span>) -&gt; float:</div>
<div class="line"><span class="lineno">  158</span>  <span class="stringliteral">&quot;&quot;&quot;Meta learning loss function.</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  160</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  161</span><span class="stringliteral">    net_params: Network parameters.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral">    cfvalues: Counterfactual values.</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">    net_apply: Haiku apply function.</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    steps: Number of unrolling steps.</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral">    num_all_actions: Number of actions.</span></div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">    infosets: List of information states.</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    infostate_map: Mapping from information state string to information state</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">      node.</span></div>
<div class="line"><span class="lineno">  169</span><span class="stringliteral">    batch_size: Batch size.</span></div>
<div class="line"><span class="lineno">  170</span><span class="stringliteral">    key: Pseudo random number.</span></div>
<div class="line"><span class="lineno">  171</span><span class="stringliteral">    use_infostate_representation: Boolean value indicating if information state</span></div>
<div class="line"><span class="lineno">  172</span><span class="stringliteral">      representation is used as part of input.</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    Mean meta learning loss value.</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  177</span>  regret_sum = np.zeros(shape=[batch_size, 1, num_all_actions])</div>
<div class="line"><span class="lineno">  178</span>  total_loss = 0</div>
<div class="line"><span class="lineno">  179</span>  step = 0</div>
<div class="line"><span class="lineno">  180</span>  infostate_str_one_hot = jnp.expand_dims(</div>
<div class="line"><span class="lineno">  181</span>      jnp.array([</div>
<div class="line"><span class="lineno">  182</span>          jax.nn.one_hot(infostate_map[infoset.infostate_string],</div>
<div class="line"><span class="lineno">  183</span>                         <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(infostate_map)) <span class="keywordflow">for</span> infoset <span class="keywordflow">in</span> infosets</div>
<div class="line"><span class="lineno">  184</span>      ]),</div>
<div class="line"><span class="lineno">  185</span>      axis=1)</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>  <span class="keyword">def </span>scan_body(carry, x):</div>
<div class="line"><span class="lineno">  188</span>    del x  <span class="comment"># Unused</span></div>
<div class="line"><span class="lineno">  189</span>    regret_sum, current_step, total_loss = carry</div>
<div class="line"><span class="lineno">  190</span>    average_regret = regret_sum / (current_step + 1)</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">if</span> use_infostate_representation:</div>
<div class="line"><span class="lineno">  193</span>      net_input = jnp.concatenate((average_regret, infostate_str_one_hot),</div>
<div class="line"><span class="lineno">  194</span>                                  axis=-1)</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  196</span>      net_input = average_regret</div>
<div class="line"><span class="lineno">  197</span>    next_step_x = jax.jit(net_apply)(net_params, key, net_input)</div>
<div class="line"><span class="lineno">  198</span>    strategy = jax.nn.softmax(next_step_x)</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    value = jnp.matmul(</div>
<div class="line"><span class="lineno">  201</span>        jnp.array(cfvalues), jnp.transpose(strategy, axes=[0, 2, 1]))</div>
<div class="line"><span class="lineno">  202</span>    curren_regret = jnp.array(cfvalues) - value</div>
<div class="line"><span class="lineno">  203</span>    regret_sum += jnp.expand_dims(jnp.mean(curren_regret, axis=1), axis=1)</div>
<div class="line"><span class="lineno">  204</span>    current_loss = jnp.mean(</div>
<div class="line"><span class="lineno">  205</span>        jnp.max(</div>
<div class="line"><span class="lineno">  206</span>            jax.numpy.concatenate(</div>
<div class="line"><span class="lineno">  207</span>                [regret_sum,</div>
<div class="line"><span class="lineno">  208</span>                 jnp.zeros(shape=[batch_size, 1, 1])],</div>
<div class="line"><span class="lineno">  209</span>                axis=-1),</div>
<div class="line"><span class="lineno">  210</span>            axis=-1))</div>
<div class="line"><span class="lineno">  211</span>    total_loss += current_loss</div>
<div class="line"><span class="lineno">  212</span>    current_step += 1</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">return</span> (regret_sum, current_step, total_loss), <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  (regret_sum, step, total_loss), _ = jax.lax.scan(</div>
<div class="line"><span class="lineno">  216</span>      scan_body, (regret_sum, step, total_loss), <span class="keywordtype">None</span>, length=steps)</div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordflow">return</span> total_loss</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

</div>
</div>
<a id="a17034f305471257f4c22e66b7c4c7c50" name="a17034f305471257f4c22e66b7c4c7c50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17034f305471257f4c22e66b7c4c7c50">&#9670;&#160;</a></span>neural_ficticious_self_play()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.neural_ficticious_self_play </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_epoch</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>sess</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_metrics</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00739">739</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  742</span>                                compute_metrics=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  743</span>  env = rl_environment.Environment(seq_game)</div>
<div class="line"><span class="lineno">  744</span>  <span class="comment"># Parameters from the game.</span></div>
<div class="line"><span class="lineno">  745</span>  num_players = env.num_players</div>
<div class="line"><span class="lineno">  746</span>  num_actions = env.action_spec()[<span class="stringliteral">&quot;num_actions&quot;</span>]</div>
<div class="line"><span class="lineno">  747</span>  info_state_size = env.observation_spec()[<span class="stringliteral">&quot;info_state&quot;</span>][0]</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>  <span class="comment"># Parameters for the algorithm.</span></div>
<div class="line"><span class="lineno">  750</span>  hidden_layers_sizes = [int(l) <span class="keywordflow">for</span> l <span class="keywordflow">in</span> [128]]</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>  kwargs = {</div>
<div class="line"><span class="lineno">  753</span>      <span class="stringliteral">&quot;replay_buffer_capacity&quot;</span>: int(2e5),</div>
<div class="line"><span class="lineno">  754</span>      <span class="stringliteral">&quot;reservoir_buffer_capacity&quot;</span>: int(2e6),</div>
<div class="line"><span class="lineno">  755</span>      <span class="stringliteral">&quot;min_buffer_size_to_learn&quot;</span>: 1000,</div>
<div class="line"><span class="lineno">  756</span>      <span class="stringliteral">&quot;anticipatory_param&quot;</span>: 0.1,</div>
<div class="line"><span class="lineno">  757</span>      <span class="stringliteral">&quot;batch_size&quot;</span>: 128,</div>
<div class="line"><span class="lineno">  758</span>      <span class="stringliteral">&quot;learn_every&quot;</span>: 64,</div>
<div class="line"><span class="lineno">  759</span>      <span class="stringliteral">&quot;rl_learning_rate&quot;</span>: 0.01,</div>
<div class="line"><span class="lineno">  760</span>      <span class="stringliteral">&quot;sl_learning_rate&quot;</span>: 0.01,</div>
<div class="line"><span class="lineno">  761</span>      <span class="stringliteral">&quot;optimizer_str&quot;</span>: <span class="stringliteral">&quot;sgd&quot;</span>,</div>
<div class="line"><span class="lineno">  762</span>      <span class="stringliteral">&quot;loss_str&quot;</span>: <span class="stringliteral">&quot;mse&quot;</span>,</div>
<div class="line"><span class="lineno">  763</span>      <span class="stringliteral">&quot;update_target_network_every&quot;</span>: 19200,</div>
<div class="line"><span class="lineno">  764</span>      <span class="stringliteral">&quot;discount_factor&quot;</span>: 1.0,</div>
<div class="line"><span class="lineno">  765</span>      <span class="stringliteral">&quot;epsilon_decay_duration&quot;</span>: int(20e6),</div>
<div class="line"><span class="lineno">  766</span>      <span class="stringliteral">&quot;epsilon_start&quot;</span>: 0.06,</div>
<div class="line"><span class="lineno">  767</span>      <span class="stringliteral">&quot;epsilon_end&quot;</span>: 0.001,</div>
<div class="line"><span class="lineno">  768</span>  }</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>  <span class="comment"># freq_epoch_printing = num_epoch // 10</span></div>
<div class="line"><span class="lineno">  771</span>  agents = [</div>
<div class="line"><span class="lineno">  772</span>      nfsp.NFSP(sess, idx, info_state_size, num_actions, hidden_layers_sizes,</div>
<div class="line"><span class="lineno">  773</span>                **kwargs) <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> range(num_players)</div>
<div class="line"><span class="lineno">  774</span>  ]</div>
<div class="line"><span class="lineno">  775</span>  joint_avg_policy = NFSPPolicies(env, agents, nfsp.MODE.average_policy)</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>  sess.run(tf.global_variables_initializer())</div>
<div class="line"><span class="lineno">  778</span>  <span class="comment"># print(&quot;TF initialized.&quot;)</span></div>
<div class="line"><span class="lineno">  779</span>  tick_time = time.time()</div>
<div class="line"><span class="lineno">  780</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(num_epoch):</div>
<div class="line"><span class="lineno">  781</span>    <span class="comment"># if ep % freq_epoch_printing == 0:</span></div>
<div class="line"><span class="lineno">  782</span>    <span class="comment">#   print(f&quot;Iteration {ep}&quot;)</span></div>
<div class="line"><span class="lineno">  783</span>    time_step = env.reset()</div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">while</span> <span class="keywordflow">not</span> time_step.last():</div>
<div class="line"><span class="lineno">  785</span>      player_id = time_step.observations[<span class="stringliteral">&quot;current_player&quot;</span>]</div>
<div class="line"><span class="lineno">  786</span>      agent_output = agents[player_id].step(time_step)</div>
<div class="line"><span class="lineno">  787</span>      action_list = [agent_output.action]</div>
<div class="line"><span class="lineno">  788</span>      time_step = env.step(action_list)</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>    <span class="comment"># Episode is over, step all agents with final info state.</span></div>
<div class="line"><span class="lineno">  791</span>    <span class="keywordflow">for</span> agent <span class="keywordflow">in</span> agents:</div>
<div class="line"><span class="lineno">  792</span>      agent.step(time_step)</div>
<div class="line"><span class="lineno">  793</span>  timing = time.time() - tick_time</div>
<div class="line"><span class="lineno">  794</span>  <span class="comment"># print(&quot;Finish.&quot;)</span></div>
<div class="line"><span class="lineno">  795</span>  <span class="keywordflow">if</span> compute_metrics:</div>
<div class="line"><span class="lineno">  796</span>    tabular_policy = joint_avg_policy.TabularPolicy(seq_game)</div>
<div class="line"><span class="lineno">  797</span>    average_policy_values = expected_game_score.policy_value(</div>
<div class="line"><span class="lineno">  798</span>        seq_game.new_initial_state(), [tabular_policy])</div>
<div class="line"><span class="lineno">  799</span>    nash_conv = exploitability.nash_conv(env.game, joint_avg_policy)</div>
<div class="line"><span class="lineno">  800</span>    <span class="keywordflow">return</span> timing, joint_avg_policy, average_policy_values, nash_conv</div>
<div class="line"><span class="lineno">  801</span>  <span class="keywordflow">return</span> timing, joint_avg_policy</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1bd9acc256d5d2f70ad749c9ebaee0db" name="a1bd9acc256d5d2f70ad749c9ebaee0db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bd9acc256d5d2f70ad749c9ebaee0db">&#9670;&#160;</a></span>online_mirror_descent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.online_mirror_descent </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mfg_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>number_of_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>compute_metrics</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>return_policy</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>md_p</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00841">841</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  845</span>                          md_p=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  846</span>  md = md_p <span class="keywordflow">if</span> md_p <span class="keywordflow">else</span> mirror_descent.MirrorDescent(mfg_game)</div>
<div class="line"><span class="lineno">  847</span>  tick_time = time.time()</div>
<div class="line"><span class="lineno">  848</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(number_of_iterations):</div>
<div class="line"><span class="lineno">  849</span>    md.iteration()</div>
<div class="line"><span class="lineno">  850</span>  timing = time.time() - tick_time</div>
<div class="line"><span class="lineno">  851</span>  md_policy = md.get_policy()</div>
<div class="line"><span class="lineno">  852</span>  <span class="keywordflow">if</span> compute_metrics:</div>
<div class="line"><span class="lineno">  853</span>    distribution_mfg = distribution_module.DistributionPolicy(</div>
<div class="line"><span class="lineno">  854</span>        mfg_game, md_policy)</div>
<div class="line"><span class="lineno">  855</span>    <span class="comment"># print(&#39;distribution done&#39;)</span></div>
<div class="line"><span class="lineno">  856</span>    policy_value_ = policy_value.PolicyValue(mfg_game, distribution_mfg,</div>
<div class="line"><span class="lineno">  857</span>                                             md_policy).value(</div>
<div class="line"><span class="lineno">  858</span>                                                 mfg_game.new_initial_state())</div>
<div class="line"><span class="lineno">  859</span>    nash_conv_md = nash_conv_module.NashConv(mfg_game, md_policy)</div>
<div class="line"><span class="lineno">  860</span>    <span class="keywordflow">if</span> return_policy:</div>
<div class="line"><span class="lineno">  861</span>      <span class="keywordflow">return</span> timing, md_policy, nash_conv_md, policy_value_, md</div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">return</span> timing, md_policy, nash_conv_md, policy_value_</div>
<div class="line"><span class="lineno">  863</span>  <span class="keywordflow">return</span> timing, md_policy</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8baa91cae31392e5604781000efdb1cc" name="a8baa91cae31392e5604781000efdb1cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8baa91cae31392e5604781000efdb1cc">&#9670;&#160;</a></span>online_mirror_descent_sioux_falls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.online_mirror_descent_sioux_falls </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mfg_game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>number_of_iterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>md_p</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l01094">1094</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1096</span>                                      md_p=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1097</span>  nash_conv_dict = {}</div>
<div class="line"><span class="lineno"> 1098</span>  md = md_p <span class="keywordflow">if</span> md_p <span class="keywordflow">else</span> mirror_descent.MirrorDescent(mfg_game)</div>
<div class="line"><span class="lineno"> 1099</span>  tick_time = time.time()</div>
<div class="line"><span class="lineno"> 1100</span>  <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(number_of_iterations):</div>
<div class="line"><span class="lineno"> 1101</span>    md.iteration()</div>
<div class="line"><span class="lineno"> 1102</span>    md_policy = md.get_policy()</div>
<div class="line"><span class="lineno"> 1103</span>    nash_conv_md = nash_conv_module.NashConv(mfg_game, md_policy)</div>
<div class="line"><span class="lineno"> 1104</span>    nash_conv_dict[i] = nash_conv_md.nash_conv()</div>
<div class="line"><span class="lineno"> 1105</span>    print((f<span class="stringliteral">&quot;Iteration {i}, Nash conv: {nash_conv_md.nash_conv()}, &quot;</span></div>
<div class="line"><span class="lineno"> 1106</span>           <span class="stringliteral">&quot;time: {time.time() - tick_time}&quot;</span>))</div>
<div class="line"><span class="lineno"> 1107</span>  timing = time.time() - tick_time</div>
<div class="line"><span class="lineno"> 1108</span>  md_policy = md.get_policy()</div>
<div class="line"><span class="lineno"> 1109</span>  distribution_mfg = distribution_module.DistributionPolicy(mfg_game, md_policy)</div>
<div class="line"><span class="lineno"> 1110</span>  policy_value_ = policy_value.PolicyValue(</div>
<div class="line"><span class="lineno"> 1111</span>      mfg_game, distribution_mfg, md_policy).value(mfg_game.new_initial_state())</div>
<div class="line"><span class="lineno"> 1112</span>  nash_conv_md = nash_conv_module.NashConv(mfg_game, md_policy)</div>
<div class="line"><span class="lineno"> 1113</span>  <span class="keywordflow">return</span> timing, md_policy, nash_conv_md, policy_value_, md, nash_conv_dict</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab842c32cbf7e4f23c8a1c62bc5320d18" name="ab842c32cbf7e4f23c8a1c62bc5320d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab842c32cbf7e4f23c8a1c62bc5320d18">&#9670;&#160;</a></span>plot_network_mean_field_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.plot_network_mean_field_game </td>
          <td>(</td>
          <td class="paramtype">dynamic_routing_utils.Network</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>distribution</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>scaling</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Plot the network.

Args:
  g: network to plot
  distribution: the distribution.
  scaling: scaling factor. for plot rendering.
</pre> 
<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00438">438</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  440</span>                                 scaling=1):</div>
<div class="line"><span class="lineno">  441</span>  <span class="stringliteral">&quot;&quot;&quot;Plot the network.</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">    g: network to plot</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    distribution: the distribution.</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">    scaling: scaling factor. for plot rendering.</span></div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  448</span>  _, ax = plt.subplots()</div>
<div class="line"><span class="lineno">  449</span>  o_xs, o_ys, d_xs, d_ys = g.return_list_for_matplotlib_quiver()</div>
<div class="line"><span class="lineno">  450</span>  ax.quiver(</div>
<div class="line"><span class="lineno">  451</span>      o_xs,</div>
<div class="line"><span class="lineno">  452</span>      o_ys,</div>
<div class="line"><span class="lineno">  453</span>      np.subtract(d_xs, o_xs),</div>
<div class="line"><span class="lineno">  454</span>      np.subtract(d_ys, o_ys),</div>
<div class="line"><span class="lineno">  455</span>      color=<span class="stringliteral">&quot;b&quot;</span>,</div>
<div class="line"><span class="lineno">  456</span>      angles=<span class="stringliteral">&quot;xy&quot;</span>,</div>
<div class="line"><span class="lineno">  457</span>      scale_units=<span class="stringliteral">&quot;xy&quot;</span>,</div>
<div class="line"><span class="lineno">  458</span>      scale=1)</div>
<div class="line"><span class="lineno">  459</span>  ax.set_xlim([</div>
<div class="line"><span class="lineno">  460</span>      np.min(np.concatenate((o_xs, d_xs))) - 0.5,</div>
<div class="line"><span class="lineno">  461</span>      np.max(np.concatenate((o_xs, d_xs))) + 0.5</div>
<div class="line"><span class="lineno">  462</span>  ])</div>
<div class="line"><span class="lineno">  463</span>  ax.set_ylim([</div>
<div class="line"><span class="lineno">  464</span>      np.min(np.concatenate((o_ys, d_ys))) - 0.5,</div>
<div class="line"><span class="lineno">  465</span>      np.max(np.concatenate((o_ys, d_ys))) + 0.5</div>
<div class="line"><span class="lineno">  466</span>  ])</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">if</span> distribution <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">for</span> x, prob_of_position <span class="keywordflow">in</span> distribution.items():</div>
<div class="line"><span class="lineno">  470</span>      point = g.return_position_of_road_section(x)</div>
<div class="line"><span class="lineno">  471</span>      width = 0.3 * scaling * prob_of_position</div>
<div class="line"><span class="lineno">  472</span>      circle = plt.Circle(point, width, color=<span class="stringliteral">&quot;r&quot;</span>)</div>
<div class="line"><span class="lineno">  473</span>      ax.add_patch(circle)</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00567">evolve_mean_field_game()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_ab842c32cbf7e4f23c8a1c62bc5320d18_icgraph.png" border="0" usemap="#anamespaceutils_ab842c32cbf7e4f23c8a1c62bc5320d18_icgraph" alt=""/></div>
<map name="anamespaceutils_ab842c32cbf7e4f23c8a1c62bc5320d18_icgraph" id="anamespaceutils_ab842c32cbf7e4f23c8a1c62bc5320d18_icgraph">
<area shape="rect" title=" " alt="" coords="250,5,380,46"/>
<area shape="rect" href="namespaceutils.html#a8062ff1b7dd4f583312b3ed5abd50d96" title=" " alt="" coords="5,13,202,38"/>
<area shape="poly" title=" " alt="" coords="234,28,202,28,202,23,234,23"/>
</map>
</div>

</div>
</div>
<a id="acd0806ac4e8079b301c439db7f9c683d" name="acd0806ac4e8079b301c439db7f9c683d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd0806ac4e8079b301c439db7f9c683d">&#9670;&#160;</a></span>plot_network_n_player_game()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.plot_network_n_player_game </td>
          <td>(</td>
          <td class="paramtype">dynamic_routing_utils.Network</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>vehicle_locations</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Plot the network.

Args:
  g: network to plot
  vehicle_locations: vehicle location
</pre> 
<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00398">398</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  399</span>                               vehicle_locations=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  400</span>  <span class="stringliteral">&quot;&quot;&quot;Plot the network.</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">    g: network to plot</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">    vehicle_locations: vehicle location</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  406</span>  _, ax = plt.subplots()</div>
<div class="line"><span class="lineno">  407</span>  o_xs, o_ys, d_xs, d_ys = g.return_list_for_matplotlib_quiver()</div>
<div class="line"><span class="lineno">  408</span>  ax.quiver(</div>
<div class="line"><span class="lineno">  409</span>      o_xs,</div>
<div class="line"><span class="lineno">  410</span>      o_ys,</div>
<div class="line"><span class="lineno">  411</span>      np.subtract(d_xs, o_xs),</div>
<div class="line"><span class="lineno">  412</span>      np.subtract(d_ys, o_ys),</div>
<div class="line"><span class="lineno">  413</span>      color=<span class="stringliteral">&quot;b&quot;</span>,</div>
<div class="line"><span class="lineno">  414</span>      angles=<span class="stringliteral">&quot;xy&quot;</span>,</div>
<div class="line"><span class="lineno">  415</span>      scale_units=<span class="stringliteral">&quot;xy&quot;</span>,</div>
<div class="line"><span class="lineno">  416</span>      scale=1)</div>
<div class="line"><span class="lineno">  417</span>  ax.set_xlim([</div>
<div class="line"><span class="lineno">  418</span>      np.min(np.concatenate((o_xs, d_xs))) - 0.5,</div>
<div class="line"><span class="lineno">  419</span>      np.max(np.concatenate((o_xs, d_xs))) + 0.5</div>
<div class="line"><span class="lineno">  420</span>  ])</div>
<div class="line"><span class="lineno">  421</span>  ax.set_ylim([</div>
<div class="line"><span class="lineno">  422</span>      np.min(np.concatenate((o_ys, d_ys))) - 0.5,</div>
<div class="line"><span class="lineno">  423</span>      np.max(np.concatenate((o_ys, d_ys))) + 0.5</div>
<div class="line"><span class="lineno">  424</span>  ])</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  <span class="keywordflow">if</span> vehicle_locations <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  427</span>    num_vehicle = <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(vehicle_locations)</div>
<div class="line"><span class="lineno">  428</span>    dict_location = {}</div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">for</span> vehicle_location <span class="keywordflow">in</span> vehicle_locations:</div>
<div class="line"><span class="lineno">  430</span>      <span class="keywordflow">if</span> vehicle_location <span class="keywordflow">not</span> <span class="keywordflow">in</span> dict_location:</div>
<div class="line"><span class="lineno">  431</span>        dict_location[vehicle_location] = 0.0</div>
<div class="line"><span class="lineno">  432</span>      dict_location[vehicle_location] += 0.3 / num_vehicle</div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">for</span> point, width <span class="keywordflow">in</span> dict_location.items():</div>
<div class="line"><span class="lineno">  434</span>      circle = plt.Circle(point, width, color=<span class="stringliteral">&quot;r&quot;</span>)</div>
<div class="line"><span class="lineno">  435</span>      ax.add_patch(circle)</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00509">evolve_n_player_sequential_game()</a>, and <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00476">evolve_n_player_simultaneous_game()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceutils_acd0806ac4e8079b301c439db7f9c683d_icgraph.png" border="0" usemap="#anamespaceutils_acd0806ac4e8079b301c439db7f9c683d_icgraph" alt=""/></div>
<map name="anamespaceutils_acd0806ac4e8079b301c439db7f9c683d_icgraph" id="anamespaceutils_acd0806ac4e8079b301c439db7f9c683d_icgraph">
<area shape="rect" title=" " alt="" coords="198,39,321,79"/>
<area shape="rect" href="namespaceutils.html#a1cbc5bef8f521227b730aef60fa7f467" title=" " alt="" coords="6,5,149,46"/>
<area shape="poly" title=" " alt="" coords="182,48,149,41,150,36,183,42"/>
<area shape="rect" href="namespaceutils.html#a04e0be2c7abc00acd90cab7770bbd717" title=" " alt="" coords="5,71,150,111"/>
<area shape="poly" title=" " alt="" coords="183,75,150,81,149,76,182,70"/>
</map>
</div>

</div>
</div>
<a id="a0195ca6f5662894ad4b8a420eb42dd2b" name="a0195ca6f5662894ad4b8a420eb42dd2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0195ca6f5662894ad4b8a420eb42dd2b">&#9670;&#160;</a></span>uniform_policy_n_player()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.uniform_policy_n_player </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seq_game</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html#l00645">645</a> of file <a class="el" href="data_2paper__data_2routing__game__experiments_2utils_8py_source.html">utils.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span><span class="keyword">def </span>uniform_policy_n_player(seq_game):</div>
<div class="line"><span class="lineno">  646</span>  <span class="keywordflow">return</span> policy_module.UniformRandomPolicy(seq_game)</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a21dde32490df6b8b863cdd2b762edabc" name="a21dde32490df6b8b863cdd2b762edabc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21dde32490df6b8b863cdd2b762edabc">&#9670;&#160;</a></span>FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">utils.FLAGS = flags.FLAGS</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="python_2examples_2meta__cfr_2matrix__games_2utils_8py_source.html#l00022">22</a> of file <a class="el" href="python_2examples_2meta__cfr_2matrix__games_2utils_8py_source.html">utils.py</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
