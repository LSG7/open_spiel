<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.algorithms.alpha_zero.alpha_zero Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms.html">algorithms</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero.html">alpha_zero</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html">alpha_zero</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.algorithms.alpha_zero.alpha_zero Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_1_1_buffer.html">Buffer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_1_1_config.html">Config</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_1_1_trajectory.html">Trajectory</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_1_1_trajectory_state.html">TrajectoryState</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a14b2168aa16f269b624e4caac3a0b646" id="r_a14b2168aa16f269b624e4caac3a0b646"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14b2168aa16f269b624e4caac3a0b646">_init_model_from_config</a> (config)</td></tr>
<tr class="separator:a14b2168aa16f269b624e4caac3a0b646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34c31ec585536cd817d156e51bb04c92" id="r_a34c31ec585536cd817d156e51bb04c92"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34c31ec585536cd817d156e51bb04c92">watcher</a> (fn)</td></tr>
<tr class="separator:a34c31ec585536cd817d156e51bb04c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7acd5428f39d29e671cf9250aca2d00" id="r_ad7acd5428f39d29e671cf9250aca2d00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7acd5428f39d29e671cf9250aca2d00">_init_bot</a> (config, game, evaluator_, evaluation)</td></tr>
<tr class="separator:ad7acd5428f39d29e671cf9250aca2d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503c1926b23ae0cbcc19284aaa36a106" id="r_a503c1926b23ae0cbcc19284aaa36a106"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a503c1926b23ae0cbcc19284aaa36a106">_play_game</a> (logger, game_num, game, bots, temperature, temperature_drop)</td></tr>
<tr class="separator:a503c1926b23ae0cbcc19284aaa36a106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81563ef6789e2e0a54eb6d57434c7052" id="r_a81563ef6789e2e0a54eb6d57434c7052"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81563ef6789e2e0a54eb6d57434c7052">update_checkpoint</a> (logger, queue, model, az_evaluator)</td></tr>
<tr class="separator:a81563ef6789e2e0a54eb6d57434c7052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af8c736f361c43d6876cab3fe0f728f" id="r_a1af8c736f361c43d6876cab3fe0f728f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1af8c736f361c43d6876cab3fe0f728f">actor</a> (*, config, game, logger, queue)</td></tr>
<tr class="separator:a1af8c736f361c43d6876cab3fe0f728f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad545cdea9eff4b96d15228ca6a50a4d0" id="r_ad545cdea9eff4b96d15228ca6a50a4d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad545cdea9eff4b96d15228ca6a50a4d0">evaluator</a> (*, game, config, logger, queue)</td></tr>
<tr class="separator:ad545cdea9eff4b96d15228ca6a50a4d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad905692adf6a7e949f4ce4519c93e5f7" id="r_ad905692adf6a7e949f4ce4519c93e5f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad905692adf6a7e949f4ce4519c93e5f7">learner</a> (*, game, config, actors, evaluators, broadcast_fn, logger)</td></tr>
<tr class="separator:ad905692adf6a7e949f4ce4519c93e5f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c4849f03cdac5c324bfbab611185d74" id="r_a7c4849f03cdac5c324bfbab611185d74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c4849f03cdac5c324bfbab611185d74">alpha_zero</a> (<a class="el" href="classopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_1_1_config.html">Config</a> config)</td></tr>
<tr class="separator:a7c4849f03cdac5c324bfbab611185d74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7c80c1f6232960ba37c58a7ce69a1c6f" id="r_a7c80c1f6232960ba37c58a7ce69a1c6f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c80c1f6232960ba37c58a7ce69a1c6f">JOIN_WAIT_DELAY</a> = 0.001</td></tr>
<tr class="separator:a7c80c1f6232960ba37c58a7ce69a1c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">A basic AlphaZero implementation.

This implements the AlphaZero training algorithm. It spawns N actors which feed
trajectories into a replay buffer which are consumed by a learner. The learner
generates new weights, saves a checkpoint, and tells the actors to update. There
are also M evaluators running games continuously against a standard MCTS+Solver,
though each at a different difficulty (ie number of simulations for MCTS).

Due to the multi-process nature of this algorithm the logs are written to files,
one per process. The learner logs are also output to stdout. The checkpoints are
also written to the same directory.

Links to relevant articles/papers:
  https://deepmind.com/blog/article/alphago-zero-starting-scratch has an open
    access link to the AlphaGo Zero nature paper.
  https://deepmind.com/blog/article/alphazero-shedding-new-light-grand-games-chess-shogi-and-go
    has an open access link to the AlphaZero science paper.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ad7acd5428f39d29e671cf9250aca2d00" name="ad7acd5428f39d29e671cf9250aca2d00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7acd5428f39d29e671cf9250aca2d00">&#9670;&#160;</a></span>_init_bot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero._init_bot </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>evaluator_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>evaluation</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Initializes a bot.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00187">187</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  187</span><span class="keyword">def </span>_init_bot(config, game, evaluator_, evaluation):</div>
<div class="line"><span class="lineno">  188</span>  <span class="stringliteral">&quot;&quot;&quot;Initializes a bot.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  189</span>  noise = <span class="keywordtype">None</span> <span class="keywordflow">if</span> evaluation <span class="keywordflow">else</span> (config.policy_epsilon, config.policy_alpha)</div>
<div class="line"><span class="lineno">  190</span>  <span class="keywordflow">return</span> mcts.MCTSBot(</div>
<div class="line"><span class="lineno">  191</span>      game,</div>
<div class="line"><span class="lineno">  192</span>      config.uct_c,</div>
<div class="line"><span class="lineno">  193</span>      config.max_simulations,</div>
<div class="line"><span class="lineno">  194</span>      evaluator_,</div>
<div class="line"><span class="lineno">  195</span>      solve=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  196</span>      dirichlet_noise=noise,</div>
<div class="line"><span class="lineno">  197</span>      child_selection_fn=mcts.SearchNode.puct_value,</div>
<div class="line"><span class="lineno">  198</span>      verbose=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  199</span>      dont_return_chance_node=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00265">open_spiel.python.algorithms.alpha_zero.alpha_zero.actor()</a>, and <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00283">open_spiel.python.algorithms.alpha_zero.alpha_zero.evaluator()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad7acd5428f39d29e671cf9250aca2d00_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad7acd5428f39d29e671cf9250aca2d00_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad7acd5428f39d29e671cf9250aca2d00_icgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad7acd5428f39d29e671cf9250aca2d00_icgraph">
<area shape="rect" title=" " alt="" coords="279,39,504,79"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a1af8c736f361c43d6876cab3fe0f728f" title=" " alt="" coords="5,5,231,46"/>
<area shape="poly" title=" " alt="" coords="263,46,231,42,231,37,264,41"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad545cdea9eff4b96d15228ca6a50a4d0" title=" " alt="" coords="5,71,231,111"/>
<area shape="poly" title=" " alt="" coords="264,77,231,80,231,75,263,71"/>
</map>
</div>

</div>
</div>
<a id="a14b2168aa16f269b624e4caac3a0b646" name="a14b2168aa16f269b624e4caac3a0b646"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b2168aa16f269b624e4caac3a0b646">&#9670;&#160;</a></span>_init_model_from_config()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero._init_model_from_config </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>config</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00147">147</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  147</span><span class="keyword">def </span>_init_model_from_config(config):</div>
<div class="line"><span class="lineno">  148</span>  <span class="keywordflow">return</span> model_lib.Model.build_model(</div>
<div class="line"><span class="lineno">  149</span>      config.nn_model,</div>
<div class="line"><span class="lineno">  150</span>      config.observation_shape,</div>
<div class="line"><span class="lineno">  151</span>      config.output_size,</div>
<div class="line"><span class="lineno">  152</span>      config.nn_width,</div>
<div class="line"><span class="lineno">  153</span>      config.nn_depth,</div>
<div class="line"><span class="lineno">  154</span>      config.weight_decay,</div>
<div class="line"><span class="lineno">  155</span>      config.learning_rate,</div>
<div class="line"><span class="lineno">  156</span>      config.path)</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00265">open_spiel.python.algorithms.alpha_zero.alpha_zero.actor()</a>, <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00283">open_spiel.python.algorithms.alpha_zero.alpha_zero.evaluator()</a>, and <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00325">open_spiel.python.algorithms.alpha_zero.alpha_zero.learner()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a14b2168aa16f269b624e4caac3a0b646_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a14b2168aa16f269b624e4caac3a0b646_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a14b2168aa16f269b624e4caac3a0b646_icgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a14b2168aa16f269b624e4caac3a0b646_icgraph">
<area shape="rect" title=" " alt="" coords="552,63,777,119"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a1af8c736f361c43d6876cab3fe0f728f" title=" " alt="" coords="279,5,504,46"/>
<area shape="poly" title=" " alt="" coords="536,63,479,49,480,44,537,58"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad545cdea9eff4b96d15228ca6a50a4d0" title=" " alt="" coords="279,71,504,111"/>
<area shape="poly" title=" " alt="" coords="537,94,505,94,505,88,537,88"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad905692adf6a7e949f4ce4519c93e5f7" title=" " alt="" coords="279,136,504,177"/>
<area shape="poly" title=" " alt="" coords="537,124,480,138,479,133,536,119"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a7c4849f03cdac5c324bfbab611185d74" title=" " alt="" coords="5,136,231,177"/>
<area shape="poly" title=" " alt="" coords="263,159,231,159,231,154,263,154"/>
</map>
</div>

</div>
</div>
<a id="a503c1926b23ae0cbcc19284aaa36a106" name="a503c1926b23ae0cbcc19284aaa36a106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503c1926b23ae0cbcc19284aaa36a106">&#9670;&#160;</a></span>_play_game()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero._play_game </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>logger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>bots</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>temperature</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>temperature_drop</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Play one game, return the trajectory.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00202">202</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  202</span><span class="keyword">def </span>_play_game(logger, game_num, game, bots, temperature, temperature_drop):</div>
<div class="line"><span class="lineno">  203</span>  <span class="stringliteral">&quot;&quot;&quot;Play one game, return the trajectory.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  204</span>  trajectory = Trajectory()</div>
<div class="line"><span class="lineno">  205</span>  actions = []</div>
<div class="line"><span class="lineno">  206</span>  state = game.new_initial_state()</div>
<div class="line"><span class="lineno">  207</span>  random_state = np.random.RandomState()</div>
<div class="line"><span class="lineno">  208</span>  logger.opt_print(<span class="stringliteral">&quot; Starting game {} &quot;</span>.format(game_num).center(60, <span class="stringliteral">&quot;-&quot;</span>))</div>
<div class="line"><span class="lineno">  209</span>  logger.opt_print(<span class="stringliteral">&quot;Initial state:\n{}&quot;</span>.format(state))</div>
<div class="line"><span class="lineno">  210</span>  <span class="keywordflow">while</span> <span class="keywordflow">not</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  212</span>      <span class="comment"># For chance nodes, rollout according to chance node&#39;s probability</span></div>
<div class="line"><span class="lineno">  213</span>      <span class="comment"># distribution</span></div>
<div class="line"><span class="lineno">  214</span>      outcomes = state.chance_outcomes()</div>
<div class="line"><span class="lineno">  215</span>      action_list, prob_list = zip(*outcomes)</div>
<div class="line"><span class="lineno">  216</span>      action = random_state.choice(action_list, p=prob_list)</div>
<div class="line"><span class="lineno">  217</span>      state.apply_action(action)</div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  219</span>      root = bots[state.current_player()].mcts_search(state)</div>
<div class="line"><span class="lineno">  220</span>      policy = np.zeros(game.num_distinct_actions())</div>
<div class="line"><span class="lineno">  221</span>      <span class="keywordflow">for</span> c <span class="keywordflow">in</span> root.children:</div>
<div class="line"><span class="lineno">  222</span>        policy[c.action] = c.explore_count</div>
<div class="line"><span class="lineno">  223</span>      policy = policy**(1 / temperature)</div>
<div class="line"><span class="lineno">  224</span>      policy /= policy.sum()</div>
<div class="line"><span class="lineno">  225</span>      <span class="keywordflow">if</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions) &gt;= temperature_drop:</div>
<div class="line"><span class="lineno">  226</span>        action = root.best_child().action</div>
<div class="line"><span class="lineno">  227</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  228</span>        action = np.random.choice(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(policy), p=policy)</div>
<div class="line"><span class="lineno">  229</span>      trajectory.states.append(</div>
<div class="line"><span class="lineno">  230</span>          TrajectoryState(state.observation_tensor(), state.current_player(),</div>
<div class="line"><span class="lineno">  231</span>                          state.legal_actions_mask(), action, policy,</div>
<div class="line"><span class="lineno">  232</span>                          root.total_reward / root.explore_count))</div>
<div class="line"><span class="lineno">  233</span>      action_str = state.action_to_string(state.current_player(), action)</div>
<div class="line"><span class="lineno">  234</span>      actions.append(action_str)</div>
<div class="line"><span class="lineno">  235</span>      logger.opt_print(<span class="stringliteral">&quot;Player {} sampled action: {}&quot;</span>.format(</div>
<div class="line"><span class="lineno">  236</span>          state.current_player(), action_str))</div>
<div class="line"><span class="lineno">  237</span>      state.apply_action(action)</div>
<div class="line"><span class="lineno">  238</span>  logger.opt_print(<span class="stringliteral">&quot;Next state:\n{}&quot;</span>.format(state))</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>  trajectory.returns = state.returns()</div>
<div class="line"><span class="lineno">  241</span>  logger.print(<span class="stringliteral">&quot;Game {}: Returns: {}; Actions: {}&quot;</span>.format(</div>
<div class="line"><span class="lineno">  242</span>      game_num, <span class="stringliteral">&quot; &quot;</span>.join(map(str, trajectory.returns)), <span class="stringliteral">&quot; &quot;</span>.join(actions)))</div>
<div class="line"><span class="lineno">  243</span>  <span class="keywordflow">return</span> trajectory</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="ttc" id="alow__level__alloc__test_8cc_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc__test_8cc_source.html#l00046">low_level_alloc_test.cc:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00265">open_spiel.python.algorithms.alpha_zero.alpha_zero.actor()</a>, and <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00283">open_spiel.python.algorithms.alpha_zero.alpha_zero.evaluator()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a503c1926b23ae0cbcc19284aaa36a106_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a503c1926b23ae0cbcc19284aaa36a106_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a503c1926b23ae0cbcc19284aaa36a106_icgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a503c1926b23ae0cbcc19284aaa36a106_icgraph">
<area shape="rect" title=" " alt="" coords="279,39,504,79"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a1af8c736f361c43d6876cab3fe0f728f" title=" " alt="" coords="5,5,231,46"/>
<area shape="poly" title=" " alt="" coords="263,46,231,42,231,37,264,41"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad545cdea9eff4b96d15228ca6a50a4d0" title=" " alt="" coords="5,71,231,111"/>
<area shape="poly" title=" " alt="" coords="264,77,231,80,231,75,263,71"/>
</map>
</div>

</div>
</div>
<a id="a1af8c736f361c43d6876cab3fe0f728f" name="a1af8c736f361c43d6876cab3fe0f728f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af8c736f361c43d6876cab3fe0f728f">&#9670;&#160;</a></span>actor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero.actor </td>
          <td>(</td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>logger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>queue</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">An actor process runner that generates games and returns trajectories.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00265">265</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span><span class="keyword">def </span>actor(*, config, game, logger, queue):</div>
<div class="line"><span class="lineno">  266</span>  <span class="stringliteral">&quot;&quot;&quot;An actor process runner that generates games and returns trajectories.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  267</span>  logger.print(<span class="stringliteral">&quot;Initializing model&quot;</span>)</div>
<div class="line"><span class="lineno">  268</span>  model = _init_model_from_config(config)</div>
<div class="line"><span class="lineno">  269</span>  logger.print(<span class="stringliteral">&quot;Initializing bots&quot;</span>)</div>
<div class="line"><span class="lineno">  270</span>  az_evaluator = evaluator_lib.AlphaZeroEvaluator(game, model)</div>
<div class="line"><span class="lineno">  271</span>  bots = [</div>
<div class="line"><span class="lineno">  272</span>      _init_bot(config, game, az_evaluator, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno">  273</span>      _init_bot(config, game, az_evaluator, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno">  274</span>  ]</div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordflow">for</span> game_num <span class="keywordflow">in</span> itertools.count():</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> update_checkpoint(logger, queue, model, az_evaluator):</div>
<div class="line"><span class="lineno">  277</span>      <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  278</span>    queue.put(_play_game(logger, game_num, game, bots, config.temperature,</div>
<div class="line"><span class="lineno">  279</span>                         config.temperature_drop))</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span><span class="preprocessor">@watcher</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00187">open_spiel.python.algorithms.alpha_zero.alpha_zero._init_bot()</a>, <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00147">open_spiel.python.algorithms.alpha_zero.alpha_zero._init_model_from_config()</a>, <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00202">open_spiel.python.algorithms.alpha_zero.alpha_zero._play_game()</a>, and <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00246">open_spiel.python.algorithms.alpha_zero.alpha_zero.update_checkpoint()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a1af8c736f361c43d6876cab3fe0f728f_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a1af8c736f361c43d6876cab3fe0f728f_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a1af8c736f361c43d6876cab3fe0f728f_cgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a1af8c736f361c43d6876cab3fe0f728f_cgraph">
<area shape="rect" title=" " alt="" coords="5,113,231,154"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad7acd5428f39d29e671cf9250aca2d00" title=" " alt="" coords="283,5,508,46"/>
<area shape="poly" title=" " alt="" coords="157,111,213,83,278,55,296,49,298,54,280,60,215,88,159,115"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a14b2168aa16f269b624e4caac3a0b646" title=" " alt="" coords="283,70,508,126"/>
<area shape="poly" title=" " alt="" coords="231,116,267,112,268,117,231,122"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a503c1926b23ae0cbcc19284aaa36a106" title=" " alt="" coords="283,149,508,190"/>
<area shape="poly" title=" " alt="" coords="231,146,268,150,267,156,231,151"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a81563ef6789e2e0a54eb6d57434c7052" title=" " alt="" coords="279,215,512,255"/>
<area shape="poly" title=" " alt="" coords="165,152,280,199,303,207,301,212,278,204,163,157"/>
</map>
</div>

</div>
</div>
<a id="a7c4849f03cdac5c324bfbab611185d74" name="a7c4849f03cdac5c324bfbab611185d74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c4849f03cdac5c324bfbab611185d74">&#9670;&#160;</a></span>alpha_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero.alpha_zero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_1_1_config.html">Config</a></td>          <td class="paramname"><span class="paramname"><em>config</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Start all the worker processes for a full alphazero setup.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00498">498</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  498</span><span class="keyword">def </span>alpha_zero(config: Config):</div>
<div class="line"><span class="lineno">  499</span>  <span class="stringliteral">&quot;&quot;&quot;Start all the worker processes for a full alphazero setup.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  500</span>  game = pyspiel.load_game(config.game)</div>
<div class="line"><span class="lineno">  501</span>  config = config._replace(</div>
<div class="line"><span class="lineno">  502</span>      observation_shape=game.observation_tensor_shape(),</div>
<div class="line"><span class="lineno">  503</span>      output_size=game.num_distinct_actions())</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>  print(<span class="stringliteral">&quot;Starting game&quot;</span>, config.game)</div>
<div class="line"><span class="lineno">  506</span>  <span class="keywordflow">if</span> game.num_players() != 2:</div>
<div class="line"><span class="lineno">  507</span>    sys.exit(<span class="stringliteral">&quot;AlphaZero can only handle 2-player games.&quot;</span>)</div>
<div class="line"><span class="lineno">  508</span>  game_type = game.get_type()</div>
<div class="line"><span class="lineno">  509</span>  <span class="keywordflow">if</span> game_type.reward_model != pyspiel.GameType.RewardModel.TERMINAL:</div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Game must have terminal rewards.&quot;</span>)</div>
<div class="line"><span class="lineno">  511</span>  <span class="keywordflow">if</span> game_type.dynamics != pyspiel.GameType.Dynamics.SEQUENTIAL:</div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Game must have sequential turns.&quot;</span>)</div>
<div class="line"><span class="lineno">  513</span>  <span class="keywordflow">if</span> game_type.chance_mode != pyspiel.GameType.ChanceMode.DETERMINISTIC:</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Game must be deterministic.&quot;</span>)</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>  path = config.path</div>
<div class="line"><span class="lineno">  517</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> path:</div>
<div class="line"><span class="lineno">  518</span>    path = tempfile.mkdtemp(prefix=<span class="stringliteral">&quot;az-{}-{}-&quot;</span>.format(</div>
<div class="line"><span class="lineno">  519</span>        datetime.datetime.now().strftime(<span class="stringliteral">&quot;%Y-%m-%d-%H-%M&quot;</span>), config.game))</div>
<div class="line"><span class="lineno">  520</span>    config = config._replace(path=path)</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.exists(path):</div>
<div class="line"><span class="lineno">  523</span>    os.makedirs(path)</div>
<div class="line"><span class="lineno">  524</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.isdir(path):</div>
<div class="line"><span class="lineno">  525</span>    sys.exit(<span class="stringliteral">&quot;{} isn&#39;t a directory&quot;</span>.format(path))</div>
<div class="line"><span class="lineno">  526</span>  print(<span class="stringliteral">&quot;Writing logs and checkpoints to:&quot;</span>, path)</div>
<div class="line"><span class="lineno">  527</span>  print(<span class="stringliteral">&quot;Model type: %s(%s, %s)&quot;</span> % (config.nn_model, config.nn_width,</div>
<div class="line"><span class="lineno">  528</span>                                    config.nn_depth))</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>  <span class="keyword">with</span> open(os.path.join(config.path, <span class="stringliteral">&quot;config.json&quot;</span>), <span class="stringliteral">&quot;w&quot;</span>) <span class="keyword">as</span> fp:</div>
<div class="line"><span class="lineno">  531</span>    fp.write(json.dumps(config._asdict(), indent=2, sort_keys=<span class="keyword">True</span>) + <span class="stringliteral">&quot;\n&quot;</span>)</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>  actors = [spawn.Process(actor, kwargs={<span class="stringliteral">&quot;game&quot;</span>: game, <span class="stringliteral">&quot;config&quot;</span>: config,</div>
<div class="line"><span class="lineno">  534</span>                                         <span class="stringliteral">&quot;num&quot;</span>: i})</div>
<div class="line"><span class="lineno">  535</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(config.actors)]</div>
<div class="line"><span class="lineno">  536</span>  evaluators = [spawn.Process(evaluator, kwargs={<span class="stringliteral">&quot;game&quot;</span>: game, <span class="stringliteral">&quot;config&quot;</span>: config,</div>
<div class="line"><span class="lineno">  537</span>                                                 <span class="stringliteral">&quot;num&quot;</span>: i})</div>
<div class="line"><span class="lineno">  538</span>                <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(config.evaluators)]</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  <span class="keyword">def </span>broadcast(msg):</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">for</span> proc <span class="keywordflow">in</span> actors + evaluators:</div>
<div class="line"><span class="lineno">  542</span>      proc.queue.put(msg)</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>  <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  545</span>    learner(game=game, config=config, actors=actors,  <span class="comment"># pylint: disable=missing-kwoa</span></div>
<div class="line"><span class="lineno">  546</span>            evaluators=evaluators, broadcast_fn=broadcast)</div>
<div class="line"><span class="lineno">  547</span>  <span class="keywordflow">except</span> (KeyboardInterrupt, EOFError):</div>
<div class="line"><span class="lineno">  548</span>    print(<span class="stringliteral">&quot;Caught a KeyboardInterrupt, stopping early.&quot;</span>)</div>
<div class="line"><span class="lineno">  549</span>  <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  550</span>    broadcast(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  551</span>    <span class="comment"># for actor processes to join we have to make sure that their q_in is empty,</span></div>
<div class="line"><span class="lineno">  552</span>    <span class="comment"># including backed up items</span></div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">for</span> proc <span class="keywordflow">in</span> actors:</div>
<div class="line"><span class="lineno">  554</span>      <span class="keywordflow">while</span> proc.exitcode <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  555</span>        <span class="keywordflow">while</span> <span class="keywordflow">not</span> proc.queue.empty():</div>
<div class="line"><span class="lineno">  556</span>          proc.queue.get_nowait()</div>
<div class="line"><span class="lineno">  557</span>        proc.join(JOIN_WAIT_DELAY)</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">for</span> proc <span class="keywordflow">in</span> evaluators:</div>
<div class="line"><span class="lineno">  559</span>      proc.join()</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00325">open_spiel.python.algorithms.alpha_zero.alpha_zero.learner()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a7c4849f03cdac5c324bfbab611185d74_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a7c4849f03cdac5c324bfbab611185d74_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a7c4849f03cdac5c324bfbab611185d74_cgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a7c4849f03cdac5c324bfbab611185d74_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,231,54"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad905692adf6a7e949f4ce4519c93e5f7" title=" " alt="" coords="279,13,504,54"/>
<area shape="poly" title=" " alt="" coords="231,30,263,30,263,36,231,36"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a14b2168aa16f269b624e4caac3a0b646" title=" " alt="" coords="552,5,777,61"/>
<area shape="poly" title=" " alt="" coords="504,30,536,30,536,36,504,36"/>
</map>
</div>

</div>
</div>
<a id="ad545cdea9eff4b96d15228ca6a50a4d0" name="ad545cdea9eff4b96d15228ca6a50a4d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad545cdea9eff4b96d15228ca6a50a4d0">&#9670;&#160;</a></span>evaluator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero.evaluator </td>
          <td>(</td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>logger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>queue</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">A process that plays the latest checkpoint vs standard MCTS.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00283">283</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  283</span><span class="keyword">def </span>evaluator(*, game, config, logger, queue):</div>
<div class="line"><span class="lineno">  284</span>  <span class="stringliteral">&quot;&quot;&quot;A process that plays the latest checkpoint vs standard MCTS.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  285</span>  results = Buffer(config.evaluation_window)</div>
<div class="line"><span class="lineno">  286</span>  logger.print(<span class="stringliteral">&quot;Initializing model&quot;</span>)</div>
<div class="line"><span class="lineno">  287</span>  model = _init_model_from_config(config)</div>
<div class="line"><span class="lineno">  288</span>  logger.print(<span class="stringliteral">&quot;Initializing bots&quot;</span>)</div>
<div class="line"><span class="lineno">  289</span>  az_evaluator = evaluator_lib.AlphaZeroEvaluator(game, model)</div>
<div class="line"><span class="lineno">  290</span>  random_evaluator = mcts.RandomRolloutEvaluator()</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>  <span class="keywordflow">for</span> game_num <span class="keywordflow">in</span> itertools.count():</div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> update_checkpoint(logger, queue, model, az_evaluator):</div>
<div class="line"><span class="lineno">  294</span>      <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    az_player = game_num % 2</div>
<div class="line"><span class="lineno">  297</span>    difficulty = (game_num // 2) % config.eval_levels</div>
<div class="line"><span class="lineno">  298</span>    max_simulations = int(config.max_simulations * (10 ** (difficulty / 2)))</div>
<div class="line"><span class="lineno">  299</span>    bots = [</div>
<div class="line"><span class="lineno">  300</span>        _init_bot(config, game, az_evaluator, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">  301</span>        mcts.MCTSBot(</div>
<div class="line"><span class="lineno">  302</span>            game,</div>
<div class="line"><span class="lineno">  303</span>            config.uct_c,</div>
<div class="line"><span class="lineno">  304</span>            max_simulations,</div>
<div class="line"><span class="lineno">  305</span>            random_evaluator,</div>
<div class="line"><span class="lineno">  306</span>            solve=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  307</span>            verbose=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  308</span>            dont_return_chance_node=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  309</span>    ]</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">if</span> az_player == 1:</div>
<div class="line"><span class="lineno">  311</span>      bots = list(reversed(bots))</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    trajectory = _play_game(logger, game_num, game, bots, temperature=1,</div>
<div class="line"><span class="lineno">  314</span>                            temperature_drop=0)</div>
<div class="line"><span class="lineno">  315</span>    results.append(trajectory.returns[az_player])</div>
<div class="line"><span class="lineno">  316</span>    queue.put((difficulty, trajectory.returns[az_player]))</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    logger.print(<span class="stringliteral">&quot;AZ: {}, MCTS: {}, AZ avg/{}: {:.3f}&quot;</span>.format(</div>
<div class="line"><span class="lineno">  319</span>        trajectory.returns[az_player],</div>
<div class="line"><span class="lineno">  320</span>        trajectory.returns[1 - az_player],</div>
<div class="line"><span class="lineno">  321</span>        <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(results), np.mean(results.data)))</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span><span class="preprocessor">@watcher</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00187">open_spiel.python.algorithms.alpha_zero.alpha_zero._init_bot()</a>, <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00147">open_spiel.python.algorithms.alpha_zero.alpha_zero._init_model_from_config()</a>, <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00202">open_spiel.python.algorithms.alpha_zero.alpha_zero._play_game()</a>, <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>, and <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00246">open_spiel.python.algorithms.alpha_zero.alpha_zero.update_checkpoint()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad545cdea9eff4b96d15228ca6a50a4d0_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad545cdea9eff4b96d15228ca6a50a4d0_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad545cdea9eff4b96d15228ca6a50a4d0_cgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad545cdea9eff4b96d15228ca6a50a4d0_cgraph">
<area shape="rect" title=" " alt="" coords="5,113,231,154"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad7acd5428f39d29e671cf9250aca2d00" title=" " alt="" coords="283,5,508,46"/>
<area shape="poly" title=" " alt="" coords="157,111,213,83,278,55,296,49,298,54,280,60,215,88,159,115"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a14b2168aa16f269b624e4caac3a0b646" title=" " alt="" coords="283,70,508,126"/>
<area shape="poly" title=" " alt="" coords="231,116,267,112,268,117,231,122"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a503c1926b23ae0cbcc19284aaa36a106" title=" " alt="" coords="283,149,508,190"/>
<area shape="poly" title=" " alt="" coords="231,146,268,150,267,156,231,151"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a81563ef6789e2e0a54eb6d57434c7052" title=" " alt="" coords="279,215,512,255"/>
<area shape="poly" title=" " alt="" coords="165,152,280,199,303,207,301,212,278,204,163,157"/>
</map>
</div>

</div>
</div>
<a id="ad905692adf6a7e949f4ce4519c93e5f7" name="ad905692adf6a7e949f4ce4519c93e5f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad905692adf6a7e949f4ce4519c93e5f7">&#9670;&#160;</a></span>learner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero.learner </td>
          <td>(</td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>actors</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>evaluators</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>broadcast_fn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>logger</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">A learner that consumes the replay buffer and trains the network.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00325">325</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  325</span><span class="keyword">def </span>learner(*, game, config, actors, evaluators, broadcast_fn, logger):</div>
<div class="line"><span class="lineno">  326</span>  <span class="stringliteral">&quot;&quot;&quot;A learner that consumes the replay buffer and trains the network.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  327</span>  logger.also_to_stdout = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  328</span>  replay_buffer = Buffer(config.replay_buffer_size)</div>
<div class="line"><span class="lineno">  329</span>  learn_rate = config.replay_buffer_size // config.replay_buffer_reuse</div>
<div class="line"><span class="lineno">  330</span>  logger.print(<span class="stringliteral">&quot;Initializing model&quot;</span>)</div>
<div class="line"><span class="lineno">  331</span>  model = _init_model_from_config(config)</div>
<div class="line"><span class="lineno">  332</span>  logger.print(<span class="stringliteral">&quot;Model type: %s(%s, %s)&quot;</span> % (config.nn_model, config.nn_width,</div>
<div class="line"><span class="lineno">  333</span>                                           config.nn_depth))</div>
<div class="line"><span class="lineno">  334</span>  logger.print(<span class="stringliteral">&quot;Model size:&quot;</span>, model.num_trainable_variables, <span class="stringliteral">&quot;variables&quot;</span>)</div>
<div class="line"><span class="lineno">  335</span>  save_path = model.save_checkpoint(0)</div>
<div class="line"><span class="lineno">  336</span>  logger.print(<span class="stringliteral">&quot;Initial checkpoint:&quot;</span>, save_path)</div>
<div class="line"><span class="lineno">  337</span>  broadcast_fn(save_path)</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  data_log = data_logger.DataLoggerJsonLines(config.path, <span class="stringliteral">&quot;learner&quot;</span>, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>  stage_count = 7</div>
<div class="line"><span class="lineno">  342</span>  value_accuracies = [stats.BasicStats() <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(stage_count)]</div>
<div class="line"><span class="lineno">  343</span>  value_predictions = [stats.BasicStats() <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(stage_count)]</div>
<div class="line"><span class="lineno">  344</span>  game_lengths = stats.BasicStats()</div>
<div class="line"><span class="lineno">  345</span>  game_lengths_hist = stats.HistogramNumbered(game.max_game_length() + 1)</div>
<div class="line"><span class="lineno">  346</span>  outcomes = stats.HistogramNamed([<span class="stringliteral">&quot;Player1&quot;</span>, <span class="stringliteral">&quot;Player2&quot;</span>, <span class="stringliteral">&quot;Draw&quot;</span>])</div>
<div class="line"><span class="lineno">  347</span>  evals = [Buffer(config.evaluation_window) <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(config.eval_levels)]</div>
<div class="line"><span class="lineno">  348</span>  total_trajectories = 0</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>  <span class="keyword">def </span>trajectory_generator():</div>
<div class="line"><span class="lineno">  351</span>    <span class="stringliteral">&quot;&quot;&quot;Merge all the actor queues into a single generator.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  353</span>      found = 0</div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">for</span> actor_process <span class="keywordflow">in</span> actors:</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  356</span>          <span class="keywordflow">yield</span> actor_process.queue.get_nowait()</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">except</span> spawn.Empty:</div>
<div class="line"><span class="lineno">  358</span>          <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  360</span>          found += 1</div>
<div class="line"><span class="lineno">  361</span>      <span class="keywordflow">if</span> found == 0:</div>
<div class="line"><span class="lineno">  362</span>        time.sleep(0.01)  <span class="comment"># 10ms</span></div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>  <span class="keyword">def </span>collect_trajectories():</div>
<div class="line"><span class="lineno">  365</span>    <span class="stringliteral">&quot;&quot;&quot;Collects the trajectories from actors into the replay buffer.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  366</span>    num_trajectories = 0</div>
<div class="line"><span class="lineno">  367</span>    num_states = 0</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">for</span> trajectory <span class="keywordflow">in</span> trajectory_generator():</div>
<div class="line"><span class="lineno">  369</span>      num_trajectories += 1</div>
<div class="line"><span class="lineno">  370</span>      num_states += <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(trajectory.states)</div>
<div class="line"><span class="lineno">  371</span>      game_lengths.add(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(trajectory.states))</div>
<div class="line"><span class="lineno">  372</span>      game_lengths_hist.add(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(trajectory.states))</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>      p1_outcome = trajectory.returns[0]</div>
<div class="line"><span class="lineno">  375</span>      <span class="keywordflow">if</span> p1_outcome &gt; 0:</div>
<div class="line"><span class="lineno">  376</span>        outcomes.add(0)</div>
<div class="line"><span class="lineno">  377</span>      <span class="keywordflow">elif</span> p1_outcome &lt; 0:</div>
<div class="line"><span class="lineno">  378</span>        outcomes.add(1)</div>
<div class="line"><span class="lineno">  379</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  380</span>        outcomes.add(2)</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>      replay_buffer.extend(</div>
<div class="line"><span class="lineno">  383</span>          model_lib.TrainInput(</div>
<div class="line"><span class="lineno">  384</span>              s.observation, s.legals_mask, s.policy, p1_outcome)</div>
<div class="line"><span class="lineno">  385</span>          <span class="keywordflow">for</span> s <span class="keywordflow">in</span> trajectory.states)</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>      <span class="keywordflow">for</span> stage <span class="keywordflow">in</span> range(stage_count):</div>
<div class="line"><span class="lineno">  388</span>        <span class="comment"># Scale for the length of the game</span></div>
<div class="line"><span class="lineno">  389</span>        index = (<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(trajectory.states) - 1) * stage // (stage_count - 1)</div>
<div class="line"><span class="lineno">  390</span>        n = trajectory.states[index]</div>
<div class="line"><span class="lineno">  391</span>        accurate = (n.value &gt;= 0) == (trajectory.returns[n.current_player] &gt;= 0)</div>
<div class="line"><span class="lineno">  392</span>        value_accuracies[stage].add(1 <span class="keywordflow">if</span> accurate <span class="keywordflow">else</span> 0)</div>
<div class="line"><span class="lineno">  393</span>        value_predictions[stage].add(abs(n.value))</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>      <span class="keywordflow">if</span> num_states &gt;= learn_rate:</div>
<div class="line"><span class="lineno">  396</span>        <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">return</span> num_trajectories, num_states</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>  <span class="keyword">def </span>learn(step):</div>
<div class="line"><span class="lineno">  400</span>    <span class="stringliteral">&quot;&quot;&quot;Sample from the replay buffer, update weights and save a checkpoint.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  401</span>    losses = []</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(replay_buffer) // config.train_batch_size):</div>
<div class="line"><span class="lineno">  403</span>      data = replay_buffer.sample(config.train_batch_size)</div>
<div class="line"><span class="lineno">  404</span>      losses.append(model.update(data))</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="comment"># Always save a checkpoint, either for keeping or for loading the weights to</span></div>
<div class="line"><span class="lineno">  407</span>    <span class="comment"># the actors. It only allows numbers, so use -1 as &quot;latest&quot;.</span></div>
<div class="line"><span class="lineno">  408</span>    save_path = model.save_checkpoint(</div>
<div class="line"><span class="lineno">  409</span>        step <span class="keywordflow">if</span> step % config.checkpoint_freq == 0 <span class="keywordflow">else</span> -1)</div>
<div class="line"><span class="lineno">  410</span>    losses = sum(losses, model_lib.Losses(0, 0, 0)) / <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(losses)</div>
<div class="line"><span class="lineno">  411</span>    logger.print(losses)</div>
<div class="line"><span class="lineno">  412</span>    logger.print(<span class="stringliteral">&quot;Checkpoint saved:&quot;</span>, save_path)</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">return</span> save_path, losses</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>  last_time = time.time() - 60</div>
<div class="line"><span class="lineno">  416</span>  <span class="keywordflow">for</span> step <span class="keywordflow">in</span> itertools.count(1):</div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">for</span> value_accuracy <span class="keywordflow">in</span> value_accuracies:</div>
<div class="line"><span class="lineno">  418</span>      value_accuracy.reset()</div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">for</span> value_prediction <span class="keywordflow">in</span> value_predictions:</div>
<div class="line"><span class="lineno">  420</span>      value_prediction.reset()</div>
<div class="line"><span class="lineno">  421</span>    game_lengths.reset()</div>
<div class="line"><span class="lineno">  422</span>    game_lengths_hist.reset()</div>
<div class="line"><span class="lineno">  423</span>    outcomes.reset()</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    num_trajectories, num_states = collect_trajectories()</div>
<div class="line"><span class="lineno">  426</span>    total_trajectories += num_trajectories</div>
<div class="line"><span class="lineno">  427</span>    now = time.time()</div>
<div class="line"><span class="lineno">  428</span>    seconds = now - last_time</div>
<div class="line"><span class="lineno">  429</span>    last_time = now</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>    logger.print(<span class="stringliteral">&quot;Step:&quot;</span>, step)</div>
<div class="line"><span class="lineno">  432</span>    logger.print(</div>
<div class="line"><span class="lineno">  433</span>        (<span class="stringliteral">&quot;Collected {:5} states from {:3} games, {:.1f} states/s. &quot;</span></div>
<div class="line"><span class="lineno">  434</span>         <span class="stringliteral">&quot;{:.1f} states/(s*actor), game length: {:.1f}&quot;</span>).format(</div>
<div class="line"><span class="lineno">  435</span>             num_states, num_trajectories, num_states / seconds,</div>
<div class="line"><span class="lineno">  436</span>             num_states / (config.actors * seconds),</div>
<div class="line"><span class="lineno">  437</span>             num_states / num_trajectories))</div>
<div class="line"><span class="lineno">  438</span>    logger.print(<span class="stringliteral">&quot;Buffer size: {}. States seen: {}&quot;</span>.format(</div>
<div class="line"><span class="lineno">  439</span>        <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(replay_buffer), replay_buffer.total_seen))</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    save_path, losses = learn(step)</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">for</span> eval_process <span class="keywordflow">in</span> evaluators:</div>
<div class="line"><span class="lineno">  444</span>      <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  445</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  446</span>          difficulty, outcome = eval_process.queue.get_nowait()</div>
<div class="line"><span class="lineno">  447</span>          evals[difficulty].append(outcome)</div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordflow">except</span> spawn.Empty:</div>
<div class="line"><span class="lineno">  449</span>          <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    batch_size_stats = stats.BasicStats()  <span class="comment"># Only makes sense in C++.</span></div>
<div class="line"><span class="lineno">  452</span>    batch_size_stats.add(1)</div>
<div class="line"><span class="lineno">  453</span>    data_log.write({</div>
<div class="line"><span class="lineno">  454</span>        <span class="stringliteral">&quot;step&quot;</span>: step,</div>
<div class="line"><span class="lineno">  455</span>        <span class="stringliteral">&quot;total_states&quot;</span>: replay_buffer.total_seen,</div>
<div class="line"><span class="lineno">  456</span>        <span class="stringliteral">&quot;states_per_s&quot;</span>: num_states / seconds,</div>
<div class="line"><span class="lineno">  457</span>        <span class="stringliteral">&quot;states_per_s_actor&quot;</span>: num_states / (config.actors * seconds),</div>
<div class="line"><span class="lineno">  458</span>        <span class="stringliteral">&quot;total_trajectories&quot;</span>: total_trajectories,</div>
<div class="line"><span class="lineno">  459</span>        <span class="stringliteral">&quot;trajectories_per_s&quot;</span>: num_trajectories / seconds,</div>
<div class="line"><span class="lineno">  460</span>        <span class="stringliteral">&quot;queue_size&quot;</span>: 0,  <span class="comment"># Only available in C++.</span></div>
<div class="line"><span class="lineno">  461</span>        <span class="stringliteral">&quot;game_length&quot;</span>: game_lengths.as_dict,</div>
<div class="line"><span class="lineno">  462</span>        <span class="stringliteral">&quot;game_length_hist&quot;</span>: game_lengths_hist.data,</div>
<div class="line"><span class="lineno">  463</span>        <span class="stringliteral">&quot;outcomes&quot;</span>: outcomes.data,</div>
<div class="line"><span class="lineno">  464</span>        <span class="stringliteral">&quot;value_accuracy&quot;</span>: [v.as_dict <span class="keywordflow">for</span> v <span class="keywordflow">in</span> value_accuracies],</div>
<div class="line"><span class="lineno">  465</span>        <span class="stringliteral">&quot;value_prediction&quot;</span>: [v.as_dict <span class="keywordflow">for</span> v <span class="keywordflow">in</span> value_predictions],</div>
<div class="line"><span class="lineno">  466</span>        <span class="stringliteral">&quot;eval&quot;</span>: {</div>
<div class="line"><span class="lineno">  467</span>            <span class="stringliteral">&quot;count&quot;</span>: evals[0].total_seen,</div>
<div class="line"><span class="lineno">  468</span>            <span class="stringliteral">&quot;results&quot;</span>: [sum(e.data) / <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(e) <span class="keywordflow">if</span> e <span class="keywordflow">else</span> 0 <span class="keywordflow">for</span> e <span class="keywordflow">in</span> evals],</div>
<div class="line"><span class="lineno">  469</span>        },</div>
<div class="line"><span class="lineno">  470</span>        <span class="stringliteral">&quot;batch_size&quot;</span>: batch_size_stats.as_dict,</div>
<div class="line"><span class="lineno">  471</span>        <span class="stringliteral">&quot;batch_size_hist&quot;</span>: [0, 1],</div>
<div class="line"><span class="lineno">  472</span>        <span class="stringliteral">&quot;loss&quot;</span>: {</div>
<div class="line"><span class="lineno">  473</span>            <span class="stringliteral">&quot;policy&quot;</span>: losses.policy,</div>
<div class="line"><span class="lineno">  474</span>            <span class="stringliteral">&quot;value&quot;</span>: losses.value,</div>
<div class="line"><span class="lineno">  475</span>            <span class="stringliteral">&quot;l2reg&quot;</span>: losses.l2,</div>
<div class="line"><span class="lineno">  476</span>            <span class="stringliteral">&quot;sum&quot;</span>: losses.total,</div>
<div class="line"><span class="lineno">  477</span>        },</div>
<div class="line"><span class="lineno">  478</span>        <span class="stringliteral">&quot;cache&quot;</span>: {  <span class="comment"># Null stats because it&#39;s hard to report between processes.</span></div>
<div class="line"><span class="lineno">  479</span>            <span class="stringliteral">&quot;size&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  480</span>            <span class="stringliteral">&quot;max_size&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  481</span>            <span class="stringliteral">&quot;usage&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  482</span>            <span class="stringliteral">&quot;requests&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  483</span>            <span class="stringliteral">&quot;requests_per_s&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  484</span>            <span class="stringliteral">&quot;hits&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  485</span>            <span class="stringliteral">&quot;misses&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  486</span>            <span class="stringliteral">&quot;misses_per_s&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  487</span>            <span class="stringliteral">&quot;hit_rate&quot;</span>: 0,</div>
<div class="line"><span class="lineno">  488</span>        },</div>
<div class="line"><span class="lineno">  489</span>    })</div>
<div class="line"><span class="lineno">  490</span>    logger.print()</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">if</span> config.max_steps &gt; 0 <span class="keywordflow">and</span> step &gt;= config.max_steps:</div>
<div class="line"><span class="lineno">  493</span>      <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    broadcast_fn(save_path)</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00147">open_spiel.python.algorithms.alpha_zero.alpha_zero._init_model_from_config()</a>, and <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00498">open_spiel.python.algorithms.alpha_zero.alpha_zero.alpha_zero()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_cgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,231,54"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a14b2168aa16f269b624e4caac3a0b646" title=" " alt="" coords="279,5,504,61"/>
<area shape="poly" title=" " alt="" coords="231,30,263,30,263,36,231,36"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_icgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_ad905692adf6a7e949f4ce4519c93e5f7_icgraph">
<area shape="rect" title=" " alt="" coords="279,5,504,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a7c4849f03cdac5c324bfbab611185d74" title=" " alt="" coords="5,5,231,46"/>
<area shape="poly" title=" " alt="" coords="263,28,231,28,231,23,263,23"/>
</map>
</div>

</div>
</div>
<a id="a81563ef6789e2e0a54eb6d57434c7052" name="a81563ef6789e2e0a54eb6d57434c7052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81563ef6789e2e0a54eb6d57434c7052">&#9670;&#160;</a></span>update_checkpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero.update_checkpoint </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>logger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>queue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>az_evaluator</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Read the queue for a checkpoint to load, or an exit signal.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00246">246</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  246</span><span class="keyword">def </span>update_checkpoint(logger, queue, model, az_evaluator):</div>
<div class="line"><span class="lineno">  247</span>  <span class="stringliteral">&quot;&quot;&quot;Read the queue for a checkpoint to load, or an exit signal.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  248</span>  path = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordflow">while</span> <span class="keyword">True</span>:  <span class="comment"># Get the last message, ignore intermediate ones.</span></div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  251</span>      path = queue.get_nowait()</div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">except</span> spawn.Empty:</div>
<div class="line"><span class="lineno">  253</span>      <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  254</span>  <span class="keywordflow">if</span> path:</div>
<div class="line"><span class="lineno">  255</span>    logger.print(<span class="stringliteral">&quot;Inference cache:&quot;</span>, az_evaluator.cache_info())</div>
<div class="line"><span class="lineno">  256</span>    logger.print(<span class="stringliteral">&quot;Loading checkpoint&quot;</span>, path)</div>
<div class="line"><span class="lineno">  257</span>    model.load_checkpoint(path)</div>
<div class="line"><span class="lineno">  258</span>    az_evaluator.clear_cache()</div>
<div class="line"><span class="lineno">  259</span>  <span class="keywordflow">elif</span> path <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:  <span class="comment"># Empty string means stop this process.</span></div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  261</span>  <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span><span class="preprocessor">@watcher</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00265">open_spiel.python.algorithms.alpha_zero.alpha_zero.actor()</a>, and <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00283">open_spiel.python.algorithms.alpha_zero.alpha_zero.evaluator()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a81563ef6789e2e0a54eb6d57434c7052_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a81563ef6789e2e0a54eb6d57434c7052_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a81563ef6789e2e0a54eb6d57434c7052_icgraph" id="anamespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero_a81563ef6789e2e0a54eb6d57434c7052_icgraph">
<area shape="rect" title=" " alt="" coords="279,39,512,79"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#a1af8c736f361c43d6876cab3fe0f728f" title=" " alt="" coords="5,5,231,46"/>
<area shape="poly" title=" " alt="" coords="263,46,231,42,231,37,263,40"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1alpha__zero_1_1alpha__zero.html#ad545cdea9eff4b96d15228ca6a50a4d0" title=" " alt="" coords="5,71,231,111"/>
<area shape="poly" title=" " alt="" coords="263,77,231,81,231,75,263,72"/>
</map>
</div>

</div>
</div>
<a id="a34c31ec585536cd817d156e51bb04c92" name="a34c31ec585536cd817d156e51bb04c92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34c31ec585536cd817d156e51bb04c92">&#9670;&#160;</a></span>watcher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.alpha_zero.alpha_zero.watcher </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fn</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">A decorator to fn/processes that gives a logger and logs exceptions.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00159">159</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  159</span><span class="keyword">def </span>watcher(fn):</div>
<div class="line"><span class="lineno">  160</span>  <span class="stringliteral">&quot;&quot;&quot;A decorator to fn/processes that gives a logger and logs exceptions.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  161</span>  <span class="preprocessor">@functools.wraps(fn)</span></div>
<div class="line"><span class="lineno">  162</span>  <span class="keyword">def </span>_watcher(*, config, num=None, **kwargs):</div>
<div class="line"><span class="lineno">  163</span>    <span class="stringliteral">&quot;&quot;&quot;Wrap the decorated function.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  164</span>    name = fn.__name__</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> num <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  166</span>      name += <span class="stringliteral">&quot;-&quot;</span> + str(num)</div>
<div class="line"><span class="lineno">  167</span>    <span class="keyword">with</span> file_logger.FileLogger(config.path, name, config.quiet) <span class="keyword">as</span> logger:</div>
<div class="line"><span class="lineno">  168</span>      print(<span class="stringliteral">&quot;{} started&quot;</span>.format(name))</div>
<div class="line"><span class="lineno">  169</span>      logger.print(<span class="stringliteral">&quot;{} started&quot;</span>.format(name))</div>
<div class="line"><span class="lineno">  170</span>      <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">return</span> fn(config=config, logger=logger, **kwargs)</div>
<div class="line"><span class="lineno">  172</span>      <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  173</span>        logger.print(<span class="stringliteral">&quot;\n&quot;</span>.join([</div>
<div class="line"><span class="lineno">  174</span>            <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  175</span>            <span class="stringliteral">&quot; Exception caught &quot;</span>.center(60, <span class="stringliteral">&quot;=&quot;</span>),</div>
<div class="line"><span class="lineno">  176</span>            traceback.format_exc(),</div>
<div class="line"><span class="lineno">  177</span>            <span class="stringliteral">&quot;=&quot;</span> * 60,</div>
<div class="line"><span class="lineno">  178</span>        ]))</div>
<div class="line"><span class="lineno">  179</span>        print(<span class="stringliteral">&quot;Exception caught in {}: {}&quot;</span>.format(name, e))</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">raise</span></div>
<div class="line"><span class="lineno">  181</span>      <span class="keywordflow">finally</span>:</div>
<div class="line"><span class="lineno">  182</span>        logger.print(<span class="stringliteral">&quot;{} exiting&quot;</span>.format(name))</div>
<div class="line"><span class="lineno">  183</span>        print(<span class="stringliteral">&quot;{} exiting&quot;</span>.format(name))</div>
<div class="line"><span class="lineno">  184</span>  <span class="keywordflow">return</span> _watcher</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7c80c1f6232960ba37c58a7ce69a1c6f" name="a7c80c1f6232960ba37c58a7ce69a1c6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c80c1f6232960ba37c58a7ce69a1c6f">&#9670;&#160;</a></span>JOIN_WAIT_DELAY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float open_spiel.python.algorithms.alpha_zero.alpha_zero.JOIN_WAIT_DELAY = 0.001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html#l00058">58</a> of file <a class="el" href="algorithms_2alpha__zero_2alpha__zero_8py_source.html">alpha_zero.py</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
