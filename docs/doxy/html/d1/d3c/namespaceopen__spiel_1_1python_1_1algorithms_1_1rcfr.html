<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.algorithms.rcfr Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../df/dc9/namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="../../d9/d47/namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><b>algorithms</b></li><li class="navelem"><a class="el" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html">rcfr</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.algorithms.rcfr Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3f/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1___rcfr_solver.html">_RcfrSolver</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcf/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_deep_rcfr_model.html">DeepRcfrModel</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc5/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_rcfr_solver.html">RcfrSolver</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d16/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_reservoir_buffer.html">ReservoirBuffer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd5/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_reservoir_rcfr_solver.html">ReservoirRcfrSolver</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d39/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html">RootStateWrapper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaa3bbbf0a61e98541e810de32f35866a" id="r_aaa3bbbf0a61e98541e810de32f35866a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa3bbbf0a61e98541e810de32f35866a">tensor_to_matrix</a> (tensor)</td></tr>
<tr class="separator:aaa3bbbf0a61e98541e810de32f35866a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5adbdaccd340d29ea38ff65f1a83315" id="r_aa5adbdaccd340d29ea38ff65f1a83315"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5adbdaccd340d29ea38ff65f1a83315">with_one_hot_action_features</a> (state_features, legal_actions, num_distinct_actions)</td></tr>
<tr class="separator:aa5adbdaccd340d29ea38ff65f1a83315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2285f0242da7d8f1cb1ac8e065ce1fab" id="r_a2285f0242da7d8f1cb1ac8e065ce1fab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2285f0242da7d8f1cb1ac8e065ce1fab">sequence_features</a> (state, num_distinct_actions)</td></tr>
<tr class="separator:a2285f0242da7d8f1cb1ac8e065ce1fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a002e3c93e4ab288d0a4114d49a15f58c" id="r_a002e3c93e4ab288d0a4114d49a15f58c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a002e3c93e4ab288d0a4114d49a15f58c">num_features</a> (game)</td></tr>
<tr class="separator:a002e3c93e4ab288d0a4114d49a15f58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab516d86285f4a118e24b82e875da94e6" id="r_ab516d86285f4a118e24b82e875da94e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab516d86285f4a118e24b82e875da94e6">normalized_by_sum</a> (v, axis=0, mutate=False)</td></tr>
<tr class="separator:ab516d86285f4a118e24b82e875da94e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725661082888af5e09c209ab0af9fd97" id="r_a725661082888af5e09c209ab0af9fd97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a725661082888af5e09c209ab0af9fd97">relu</a> (v)</td></tr>
<tr class="separator:a725661082888af5e09c209ab0af9fd97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a213ee9384a4cd89a02b5e2a989f202f1" id="r_a213ee9384a4cd89a02b5e2a989f202f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a213ee9384a4cd89a02b5e2a989f202f1">_descendant_states</a> (state, depth_limit, depth, include_terminals, include_chance_states)</td></tr>
<tr class="separator:a213ee9384a4cd89a02b5e2a989f202f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184f582e819bb9f520f39a28afacc6c8" id="r_a184f582e819bb9f520f39a28afacc6c8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a184f582e819bb9f520f39a28afacc6c8">all_states</a> (initial_state, depth_limit=-1, include_terminals=False, include_chance_states=False)</td></tr>
<tr class="separator:a184f582e819bb9f520f39a28afacc6c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23094f5d347d73886f31686108e9e229" id="r_a23094f5d347d73886f31686108e9e229"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a23094f5d347d73886f31686108e9e229">sequence_weights_to_tabular_profile</a> (root, policy_fn)</td></tr>
<tr class="separator:a23094f5d347d73886f31686108e9e229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e922095e43e27b1c93b4f5ed9a69cd5" id="r_a5e922095e43e27b1c93b4f5ed9a69cd5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e922095e43e27b1c93b4f5ed9a69cd5">feedforward_evaluate</a> (layers, x, use_skip_connections=False, hidden_are_factored=False)</td></tr>
<tr class="separator:a5e922095e43e27b1c93b4f5ed9a69cd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Regression counterfactual regret minimization (RCFR) [Waugh et al., 2015; Morrill, 2016].

In contrast to (tabular) counterfactual regret minimization (CFR)
[Zinkevich et al., 2007], RCFR replaces the table of regrets that generate the
current policy profile with a profile of regression models. The average
policy is still tracked exactly with a full game-size table. The exploitability
of the average policy in zero-sum games decreases as the model accuracy and
the number of iterations increase [Waugh et al., 2015; Morrill, 2016]. As long
as the regression model errors decrease across iterations, the average policy
converges toward a Nash equilibrium in zero-sum games.

# References

Dustin Morrill. Using Regret Estimation to Solve Games Compactly.
    M.Sc. thesis, Computing Science Department, University of Alberta,
    Apr 1, 2016, Edmonton Alberta, Canada.
Kevin Waugh, Dustin Morrill, J. Andrew Bagnell, and Michael Bowling.
    Solving Games with Functional Regret Estimation. At the Twenty-Ninth AAAI
    Conference on Artificial Intelligence, January 25-29, 2015, Austin Texas,
    USA. Pages 2138-2145.
Martin Zinkevich, Michael Johanson, Michael Bowling, and Carmelo Piccione.
    Regret Minimization in Games with Incomplete Information.
    At Advances in Neural Information Processing Systems 20 (NeurIPS). 2007.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a213ee9384a4cd89a02b5e2a989f202f1" name="a213ee9384a4cd89a02b5e2a989f202f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a213ee9384a4cd89a02b5e2a989f202f1">&#9670;&#160;</a></span>_descendant_states()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr._descendant_states </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>depth_limit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>depth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>include_terminals</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>include_chance_states</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Recursive descendant state generator.

Decision states are always yielded.

Args:
  state: The current state.
  depth_limit: The descendant depth limit. Zero will ensure only
    `initial_state` is generated and negative numbers specify the absence of a
    limit.
  depth: The current descendant depth.
  include_terminals: Whether or not to include terminal states.
  include_chance_states: Whether or not to include chance states.

Yields:
  `State`, a state that is `initial_state` or one of its descendants.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00426">426</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  427</span>                       include_chance_states):</div>
<div class="line"><span class="lineno">  428</span>  <span class="stringliteral">&quot;&quot;&quot;Recursive descendant state generator.</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">  Decision states are always yielded.</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    state: The current state.</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    depth_limit: The descendant depth limit. Zero will ensure only</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">      `initial_state` is generated and negative numbers specify the absence of a</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">      limit.</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">    depth: The current descendant depth.</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">    include_terminals: Whether or not to include terminal states.</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">    include_chance_states: Whether or not to include chance states.</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">  Yields:</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    `State`, a state that is `initial_state` or one of its descendants.</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  444</span>  <span class="keywordflow">if</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">if</span> include_terminals:</div>
<div class="line"><span class="lineno">  446</span>      <span class="keywordflow">yield</span> state</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordflow">if</span> depth &gt; depth_limit &gt;= 0:</div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> state.is_chance_node() <span class="keywordflow">or</span> include_chance_states:</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">yield</span> state</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>  <span class="keywordflow">for</span> action <span class="keywordflow">in</span> state.legal_actions():</div>
<div class="line"><span class="lineno">  456</span>    state_for_search = state.child(action)</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">for</span> substate <span class="keywordflow">in</span> _descendant_states(state_for_search, depth_limit, depth + 1,</div>
<div class="line"><span class="lineno">  458</span>                                       include_terminals,</div>
<div class="line"><span class="lineno">  459</span>                                       include_chance_states):</div>
<div class="line"><span class="lineno">  460</span>      <span class="keywordflow">yield</span> substate</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00427">open_spiel.python.algorithms.rcfr._descendant_states()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00427">open_spiel.python.algorithms.rcfr._descendant_states()</a>, and <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00466">open_spiel.python.algorithms.rcfr.all_states()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_cgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_cgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_cgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,222,70"/>
<area shape="poly" title=" " alt="" coords="73,29,71,19,77,10,92,5,114,3,137,5,151,11,149,16,136,10,113,8,93,10,80,15,76,21,78,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a213ee9384a4cd89a02b5e2a989f202f1_icgraph">
<area shape="rect" title=" " alt="" coords="1492,55,1708,95"/>
<area shape="poly" title=" " alt="" coords="1645,42,1628,36,1600,33,1574,35,1558,40,1552,46,1555,53,1550,55,1547,45,1555,36,1573,30,1600,28,1629,30,1646,37"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a184f582e819bb9f520f39a28afacc6c8" title=" " alt="" coords="1215,55,1444,95"/>
<area shape="poly" title=" " alt="" coords="1477,78,1444,78,1444,72,1477,72"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a23094f5d347d73886f31686108e9e229" title=" " alt="" coords="894,55,1167,95"/>
<area shape="poly" title=" " alt="" coords="1199,78,1167,78,1167,72,1199,72"/>
<area shape="rect" href="../../d1/d3f/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1___rcfr_solver.html#a8845c137359294b9b42dabd0b50ec8d1" title=" " alt="" coords="630,13,846,54"/>
<area shape="poly" title=" " alt="" coords="879,56,846,52,847,46,880,51"/>
<area shape="rect" href="../../d1/d3f/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1___rcfr_solver.html#aac98104675c0b08fbfb8020429a94e35" title=" " alt="" coords="630,87,846,127"/>
<area shape="poly" title=" " alt="" coords="879,94,847,98,846,93,879,89"/>
<area shape="rect" href="../../d4/d73/classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#a269a6c5777fc6d965a73fb153e1ab2f0" title=" " alt="" coords="313,5,582,46"/>
<area shape="poly" title=" " alt="" coords="614,33,582,32,582,27,614,28"/>
<area shape="rect" href="../../d4/d73/classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#abb5dd376bae11720a03f4da6867caca2" title=" " alt="" coords="13,5,257,46"/>
<area shape="poly" title=" " alt="" coords="297,37,257,37,257,32,297,32"/>
<area shape="poly" title=" " alt="" coords="272,14,312,14,312,19,272,19"/>
<area shape="rect" href="../../d8/dcb/classopen__spiel_1_1python_1_1algorithms_1_1efr_1_1___e_f_r_solver_base.html#a97247da249ef52e8dae5212c742884b6" title=" " alt="" coords="321,94,574,150"/>
<area shape="poly" title=" " alt="" coords="614,116,575,118,574,113,614,111"/>
<area shape="poly" title=" " alt="" coords="495,82,477,75,447,72,421,74,404,79,397,86,396,94,391,93,392,83,402,75,421,69,447,67,478,70,497,77"/>
<area shape="rect" href="../../dc/d97/classopen__spiel_1_1python_1_1algorithms_1_1efr_1_1___e_f_r_solver.html#acf1961cc5aa3d18e2477349257aaf5e3" title=" " alt="" coords="5,101,265,142"/>
<area shape="poly" title=" " alt="" coords="305,124,265,124,265,119,305,119"/>
</map>
</div>

</div>
</div>
<a id="a184f582e819bb9f520f39a28afacc6c8" name="a184f582e819bb9f520f39a28afacc6c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184f582e819bb9f520f39a28afacc6c8">&#9670;&#160;</a></span>all_states()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.all_states </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>initial_state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>depth_limit</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>include_terminals</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>include_chance_states</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generates states from `initial_state`.

Generates the set of states that includes only the `initial_state` and its
descendants that satisfy the inclusion criteria specified by the remaining
parameters. Decision states are always included.

Args:
  initial_state: The initial state from which to generate states.
  depth_limit: The descendant depth limit. Zero will ensure only
    `initial_state` is generated and negative numbers specify the absence of a
    limit. Defaults to no limit.
  include_terminals: Whether or not to include terminal states. Defaults to
    `False`.
  include_chance_states: Whether or not to include chance states. Defaults to
    `False`.

Returns:
  A generator that yields the `initial_state` and its descendants that
  satisfy the inclusion criteria specified by the remaining parameters.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00463">463</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  466</span>               include_chance_states=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  467</span>  <span class="stringliteral">&quot;&quot;&quot;Generates states from `initial_state`.</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">  Generates the set of states that includes only the `initial_state` and its</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">  descendants that satisfy the inclusion criteria specified by the remaining</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">  parameters. Decision states are always included.</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">    initial_state: The initial state from which to generate states.</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">    depth_limit: The descendant depth limit. Zero will ensure only</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">      `initial_state` is generated and negative numbers specify the absence of a</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">      limit. Defaults to no limit.</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    include_terminals: Whether or not to include terminal states. Defaults to</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">      `False`.</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">    include_chance_states: Whether or not to include chance states. Defaults to</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral">      `False`.</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">    A generator that yields the `initial_state` and its descendants that</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">    satisfy the inclusion criteria specified by the remaining parameters.</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  487</span>  <span class="keywordflow">return</span> _descendant_states(</div>
<div class="line"><span class="lineno">  488</span>      state=initial_state,</div>
<div class="line"><span class="lineno">  489</span>      depth_limit=depth_limit,</div>
<div class="line"><span class="lineno">  490</span>      depth=0,</div>
<div class="line"><span class="lineno">  491</span>      include_terminals=include_terminals,</div>
<div class="line"><span class="lineno">  492</span>      include_chance_states=include_chance_states)</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00427">open_spiel.python.algorithms.rcfr._descendant_states()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00495">open_spiel.python.algorithms.rcfr.sequence_weights_to_tabular_profile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_cgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_cgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_cgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,235,70"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a213ee9384a4cd89a02b5e2a989f202f1" title=" " alt="" coords="283,29,499,70"/>
<area shape="poly" title=" " alt="" coords="235,47,267,47,267,52,235,52"/>
<area shape="poly" title=" " alt="" coords="340,29,338,19,346,10,364,5,391,3,420,5,437,11,435,16,419,10,391,8,365,10,349,15,343,21,345,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a184f582e819bb9f520f39a28afacc6c8_icgraph">
<area shape="rect" title=" " alt="" coords="1215,55,1444,95"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a23094f5d347d73886f31686108e9e229" title=" " alt="" coords="894,55,1167,95"/>
<area shape="poly" title=" " alt="" coords="1199,78,1167,78,1167,72,1199,72"/>
<area shape="rect" href="../../d1/d3f/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1___rcfr_solver.html#a8845c137359294b9b42dabd0b50ec8d1" title=" " alt="" coords="630,13,846,54"/>
<area shape="poly" title=" " alt="" coords="879,56,846,52,847,46,880,51"/>
<area shape="rect" href="../../d1/d3f/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1___rcfr_solver.html#aac98104675c0b08fbfb8020429a94e35" title=" " alt="" coords="630,87,846,127"/>
<area shape="poly" title=" " alt="" coords="879,94,847,98,846,93,879,89"/>
<area shape="rect" href="../../d4/d73/classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#a269a6c5777fc6d965a73fb153e1ab2f0" title=" " alt="" coords="313,5,582,46"/>
<area shape="poly" title=" " alt="" coords="614,33,582,32,582,27,614,28"/>
<area shape="rect" href="../../d4/d73/classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#abb5dd376bae11720a03f4da6867caca2" title=" " alt="" coords="13,5,257,46"/>
<area shape="poly" title=" " alt="" coords="297,37,257,37,257,32,297,32"/>
<area shape="poly" title=" " alt="" coords="272,14,312,14,312,19,272,19"/>
<area shape="rect" href="../../d8/dcb/classopen__spiel_1_1python_1_1algorithms_1_1efr_1_1___e_f_r_solver_base.html#a97247da249ef52e8dae5212c742884b6" title=" " alt="" coords="321,94,574,150"/>
<area shape="poly" title=" " alt="" coords="614,116,575,118,574,113,614,111"/>
<area shape="poly" title=" " alt="" coords="495,82,477,75,447,72,421,74,404,79,397,86,396,94,391,93,392,83,402,75,421,69,447,67,478,70,497,77"/>
<area shape="rect" href="../../dc/d97/classopen__spiel_1_1python_1_1algorithms_1_1efr_1_1___e_f_r_solver.html#acf1961cc5aa3d18e2477349257aaf5e3" title=" " alt="" coords="5,101,265,142"/>
<area shape="poly" title=" " alt="" coords="305,124,265,124,265,119,305,119"/>
</map>
</div>

</div>
</div>
<a id="a5e922095e43e27b1c93b4f5ed9a69cd5" name="a5e922095e43e27b1c93b4f5ed9a69cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e922095e43e27b1c93b4f5ed9a69cd5">&#9670;&#160;</a></span>feedforward_evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.feedforward_evaluate </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>layers</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>use_skip_connections</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>hidden_are_factored</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Evaluates `layers` as a feedforward neural network on `x`.

Args:
  layers: The neural network layers (`tf.Tensor` -&gt; `tf.Tensor` callables).
  x: The array-like input to evaluate. Must be trivially convertible to a
    matrix (tensor rank &lt;= 2).
  use_skip_connections: Whether or not to use skip connections between layers.
    If the layer input has too few features to be added to the layer output,
    then the end of input is padded with zeros. If it has too many features,
    then the input is truncated.
  hidden_are_factored: Whether or not hidden logical layers are factored into
    two separate linear transformations stored as adjacent elements of
    `layers`.

Returns:
  The `tf.Tensor` evaluation result.

Raises:
  ValueError: If `x` has a rank greater than 2.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00513">513</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  516</span>                         hidden_are_factored=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno">  517</span>  <span class="stringliteral">&quot;&quot;&quot;Evaluates `layers` as a feedforward neural network on `x`.</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">    layers: The neural network layers (`tf.Tensor` -&gt; `tf.Tensor` callables).</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">    x: The array-like input to evaluate. Must be trivially convertible to a</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">      matrix (tensor rank &lt;= 2).</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">    use_skip_connections: Whether or not to use skip connections between layers.</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">      If the layer input has too few features to be added to the layer output,</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">      then the end of input is padded with zeros. If it has too many features,</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">      then the input is truncated.</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    hidden_are_factored: Whether or not hidden logical layers are factored into</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">      two separate linear transformations stored as adjacent elements of</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">      `layers`.</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">    The `tf.Tensor` evaluation result.</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">  Raises:</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral">    ValueError: If `x` has a rank greater than 2.</span></div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  537</span>  x = tensor_to_matrix(x)</div>
<div class="line"><span class="lineno">  538</span>  i = 0</div>
<div class="line"><span class="lineno">  539</span>  <span class="keywordflow">while</span> i &lt; len(layers) - 1:</div>
<div class="line"><span class="lineno">  540</span>    y = layers[i](x)</div>
<div class="line"><span class="lineno">  541</span>    i += 1</div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">if</span> hidden_are_factored:</div>
<div class="line"><span class="lineno">  543</span>      y = layers[i](y)</div>
<div class="line"><span class="lineno">  544</span>      i += 1</div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">if</span> use_skip_connections:</div>
<div class="line"><span class="lineno">  546</span>      my_num_features = x.shape[1].value</div>
<div class="line"><span class="lineno">  547</span>      padding = y.shape[1].value - my_num_features</div>
<div class="line"><span class="lineno">  548</span>      <span class="keywordflow">if</span> padding &gt; 0:</div>
<div class="line"><span class="lineno">  549</span>        zeros = tf.zeros([tf.shape(x)[0], padding])</div>
<div class="line"><span class="lineno">  550</span>        x = tf.concat([x, zeros], axis=1)</div>
<div class="line"><span class="lineno">  551</span>      <span class="keywordflow">elif</span> padding &lt; 0:</div>
<div class="line"><span class="lineno">  552</span>        x = tf.strided_slice(x, [0, 0], [tf.shape(x)[0], y.shape[1].value])</div>
<div class="line"><span class="lineno">  553</span>      y = x + y</div>
<div class="line"><span class="lineno">  554</span>    x = y</div>
<div class="line"><span class="lineno">  555</span>  <span class="keywordflow">return</span> layers[-1](x)</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00057">open_spiel.python.algorithms.rcfr.tensor_to_matrix()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00627">open_spiel.python.algorithms.rcfr.DeepRcfrModel.__call__()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_cgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_cgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_cgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,290,46"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#aaa3bbbf0a61e98541e810de32f35866a" title=" " alt="" coords="338,5,590,46"/>
<area shape="poly" title=" " alt="" coords="290,23,322,23,322,28,290,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a5e922095e43e27b1c93b4f5ed9a69cd5_icgraph">
<area shape="rect" title=" " alt="" coords="270,5,554,46"/>
<area shape="rect" href="../../d9/dcf/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_deep_rcfr_model.html#a57dafbc3e36162cfda14005900f22559" title=" " alt="" coords="5,5,222,46"/>
<area shape="poly" title=" " alt="" coords="254,28,222,28,222,23,254,23"/>
</map>
</div>

</div>
</div>
<a id="ab516d86285f4a118e24b82e875da94e6" name="ab516d86285f4a118e24b82e875da94e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab516d86285f4a118e24b82e875da94e6">&#9670;&#160;</a></span>normalized_by_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.normalized_by_sum </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>axis</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mutate</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Divides each element of `v` along `axis` by the sum of `v` along `axis`.

Assumes `v` is non-negative. Sets of `v` elements along `axis` that sum to
zero are normalized to `1 / v.shape[axis]` (a uniform distribution).

Args:
  v: Non-negative array of values.
  axis: An integer axis.
  mutate: Whether or not to store the result in `v`.

Returns:
  The normalized array.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00389">389</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span><span class="keyword">def </span>normalized_by_sum(v, axis=0, mutate=False):</div>
<div class="line"><span class="lineno">  390</span>  <span class="stringliteral">&quot;&quot;&quot;Divides each element of `v` along `axis` by the sum of `v` along `axis`.</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">  Assumes `v` is non-negative. Sets of `v` elements along `axis` that sum to</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">  zero are normalized to `1 / v.shape[axis]` (a uniform distribution).</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    v: Non-negative array of values.</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    axis: An integer axis.</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral">    mutate: Whether or not to store the result in `v`.</span></div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    The normalized array.</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  403</span>  v = np.asarray(v)</div>
<div class="line"><span class="lineno">  404</span>  denominator = v.sum(axis=axis, keepdims=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  405</span>  denominator_is_zero = denominator == 0</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>  <span class="comment"># Every element of `denominator_is_zero` that is true corresponds to a</span></div>
<div class="line"><span class="lineno">  408</span>  <span class="comment"># set of elements in `v` along `axis` that are all zero. By setting these</span></div>
<div class="line"><span class="lineno">  409</span>  <span class="comment"># denominators to `v.shape[axis]` and adding 1 to each of the corresponding</span></div>
<div class="line"><span class="lineno">  410</span>  <span class="comment"># elements in `v`, these elements are normalized to `1 / v.shape[axis]`</span></div>
<div class="line"><span class="lineno">  411</span>  <span class="comment"># (a uniform distribution).</span></div>
<div class="line"><span class="lineno">  412</span>  denominator += v.shape[axis] * denominator_is_zero</div>
<div class="line"><span class="lineno">  413</span>  <span class="keywordflow">if</span> mutate:</div>
<div class="line"><span class="lineno">  414</span>    v += denominator_is_zero</div>
<div class="line"><span class="lineno">  415</span>    v /= denominator</div>
<div class="line"><span class="lineno">  416</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  417</span>    v = (v + denominator_is_zero) / denominator</div>
<div class="line"><span class="lineno">  418</span>  <span class="keywordflow">return</span> v</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00270">open_spiel.python.algorithms.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>, and <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00206">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_policy()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_ab516d86285f4a118e24b82e875da94e6_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_ab516d86285f4a118e24b82e875da94e6_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_ab516d86285f4a118e24b82e875da94e6_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_ab516d86285f4a118e24b82e875da94e6_icgraph">
<area shape="rect" title=" " alt="" coords="867,53,1147,94"/>
<area shape="rect" href="../../d8/d39/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#a28eafcaed96017c18a066f2b69ad5643" title=" " alt="" coords="592,5,808,61"/>
<area shape="poly" title=" " alt="" coords="851,56,808,50,809,45,852,50"/>
<area shape="rect" href="../../d8/d39/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#aa94d22c36f4f9934673a2ff955b3efed" title=" " alt="" coords="580,85,819,141"/>
<area shape="poly" title=" " alt="" coords="852,96,820,100,819,95,851,91"/>
<area shape="rect" href="../../d8/d39/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#a52d0bb68845b652e8eb5ee2bc1d07b83" title=" " alt="" coords="293,45,532,101"/>
<area shape="poly" title=" " alt="" coords="564,97,532,93,533,87,565,92"/>
<area shape="rect" href="../../df/d9b/classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#add1d3765404d9a9d66905095722ff9a9" title=" " alt="" coords="313,125,512,181"/>
<area shape="poly" title=" " alt="" coords="565,135,513,142,512,137,564,129"/>
<area shape="rect" href="../../d8/d39/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#acc411392e4e4070b36ae28f21ba87143" title=" " alt="" coords="5,33,245,89"/>
<area shape="poly" title=" " alt="" coords="277,70,245,69,245,64,277,65"/>
<area shape="rect" href="../../df/d9b/classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#a656e7b9c66bbf57c4ab041a56fdadac2" title=" " alt="" coords="25,137,225,193"/>
<area shape="poly" title=" " alt="" coords="309,109,215,139,213,134,308,104"/>
<area shape="poly" title=" " alt="" coords="172,21,154,15,125,12,99,14,83,19,75,25,75,33,69,33,70,23,80,14,98,9,125,7,156,9,174,16"/>
<area shape="poly" title=" " alt="" coords="172,125,154,119,125,116,99,118,83,123,75,129,75,137,69,137,70,127,80,118,98,113,125,111,156,113,174,120"/>
<area shape="poly" title=" " alt="" coords="308,123,213,92,215,87,309,117"/>
<area shape="poly" title=" " alt="" coords="297,161,225,164,225,158,297,155"/>
</map>
</div>

</div>
</div>
<a id="a002e3c93e4ab288d0a4114d49a15f58c" name="a002e3c93e4ab288d0a4114d49a15f58c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a002e3c93e4ab288d0a4114d49a15f58c">&#9670;&#160;</a></span>num_features()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.num_features </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the number of features returned by `sequence_features`.

Args:
  game: An OpenSpiel `Game`.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00134">134</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span><span class="keyword">def </span>num_features(game):</div>
<div class="line"><span class="lineno">  135</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the number of features returned by `sequence_features`.</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    game: An OpenSpiel `Game`.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">return</span> game.information_state_tensor_size() + game.num_distinct_actions()</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00574">open_spiel.python.algorithms.rcfr.DeepRcfrModel.__init__()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a002e3c93e4ab288d0a4114d49a15f58c_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a002e3c93e4ab288d0a4114d49a15f58c_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a002e3c93e4ab288d0a4114d49a15f58c_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a002e3c93e4ab288d0a4114d49a15f58c_icgraph">
<area shape="rect" title=" " alt="" coords="270,5,511,46"/>
<area shape="rect" href="../../d9/dcf/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_deep_rcfr_model.html#ab165924b5480e134fda08020e017611d" title=" " alt="" coords="5,5,222,46"/>
<area shape="poly" title=" " alt="" coords="254,28,222,28,222,23,254,23"/>
</map>
</div>

</div>
</div>
<a id="a725661082888af5e09c209ab0af9fd97" name="a725661082888af5e09c209ab0af9fd97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a725661082888af5e09c209ab0af9fd97">&#9670;&#160;</a></span>relu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.relu </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>v</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the element-wise maximum between `v` and 0.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00421">421</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  421</span><span class="keyword">def </span>relu(v):</div>
<div class="line"><span class="lineno">  422</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the element-wise maximum between `v` and 0.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordflow">return</span> np.maximum(v, 0)</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00758">open_spiel.python.algorithms.rcfr.RcfrSolver.evaluate_and_update_policy()</a>, and <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00850">open_spiel.python.algorithms.rcfr.ReservoirRcfrSolver.evaluate_and_update_policy()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a725661082888af5e09c209ab0af9fd97_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a725661082888af5e09c209ab0af9fd97_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a725661082888af5e09c209ab0af9fd97_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a725661082888af5e09c209ab0af9fd97_icgraph">
<area shape="rect" title=" " alt="" coords="304,49,541,74"/>
<area shape="rect" href="../../d2/dc5/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_rcfr_solver.html#a8cd50d2cd7aabb7dca683bce7bc8c398" title=" " alt="" coords="5,5,256,46"/>
<area shape="poly" title=" " alt="" coords="298,49,256,44,256,38,298,44"/>
<area shape="rect" href="../../d5/dd5/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_reservoir_rcfr_solver.html#a5061c90b466be19b1a79cd1741f62921" title=" " alt="" coords="22,70,239,126"/>
<area shape="poly" title=" " alt="" coords="298,80,240,87,239,82,298,74"/>
</map>
</div>

</div>
</div>
<a id="a2285f0242da7d8f1cb1ac8e065ce1fab" name="a2285f0242da7d8f1cb1ac8e065ce1fab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2285f0242da7d8f1cb1ac8e065ce1fab">&#9670;&#160;</a></span>sequence_features()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.sequence_features </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_distinct_actions</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The sequence features at `state`.

Features are constructed by concatenating `state`'s normalized feature
vector with one-hot vectors indicating each action (see
`with_one_hot_action_features`).

Args:
  state: An OpenSpiel `State`.
  num_distinct_actions: The number of globally distinct actions in `state`'s
    game.

Returns:
  A `tf.Tensor` feature matrix with one row for each sequence.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00114">114</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  114</span><span class="keyword">def </span>sequence_features(state, num_distinct_actions):</div>
<div class="line"><span class="lineno">  115</span>  <span class="stringliteral">&quot;&quot;&quot;The sequence features at `state`.</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">  Features are constructed by concatenating `state`&#39;s normalized feature</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">  vector with one-hot vectors indicating each action (see</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">  `with_one_hot_action_features`).</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    state: An OpenSpiel `State`.</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    num_distinct_actions: The number of globally distinct actions in `state`&#39;s</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">      game.</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    A `tf.Tensor` feature matrix with one row for each sequence.</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">return</span> with_one_hot_action_features(state.information_state_tensor(),</div>
<div class="line"><span class="lineno">  130</span>                                      state.legal_actions(),</div>
<div class="line"><span class="lineno">  131</span>                                      num_distinct_actions)</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00082">open_spiel.python.algorithms.rcfr.with_one_hot_action_features()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a2285f0242da7d8f1cb1ac8e065ce1fab_cgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a2285f0242da7d8f1cb1ac8e065ce1fab_cgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a2285f0242da7d8f1cb1ac8e065ce1fab_cgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a2285f0242da7d8f1cb1ac8e065ce1fab_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,278,46"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#aa5adbdaccd340d29ea38ff65f1a83315" title=" " alt="" coords="326,5,566,46"/>
<area shape="poly" title=" " alt="" coords="278,23,310,23,310,28,278,28"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#aaa3bbbf0a61e98541e810de32f35866a" title=" " alt="" coords="614,5,866,46"/>
<area shape="poly" title=" " alt="" coords="567,23,598,23,598,28,567,28"/>
</map>
</div>

</div>
</div>
<a id="a23094f5d347d73886f31686108e9e229" name="a23094f5d347d73886f31686108e9e229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23094f5d347d73886f31686108e9e229">&#9670;&#160;</a></span>sequence_weights_to_tabular_profile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.sequence_weights_to_tabular_profile </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>root</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>policy_fn</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the `dict` of `list`s of action-prob pairs-form of `policy_fn`.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00495">495</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  495</span><span class="keyword">def </span>sequence_weights_to_tabular_profile(root, policy_fn):</div>
<div class="line"><span class="lineno">  496</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the `dict` of `list`s of action-prob pairs-form of `policy_fn`.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  497</span>  tabular_policy = {}</div>
<div class="line"><span class="lineno">  498</span>  players = range(root.num_players())</div>
<div class="line"><span class="lineno">  499</span>  <span class="keywordflow">for</span> state <span class="keywordflow">in</span> all_states(root):</div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordflow">for</span> player <span class="keywordflow">in</span> players:</div>
<div class="line"><span class="lineno">  501</span>      legal_actions = state.legal_actions(player)</div>
<div class="line"><span class="lineno">  502</span>      <span class="keywordflow">if</span> len(legal_actions) &lt; 1:</div>
<div class="line"><span class="lineno">  503</span>        <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  504</span>      info_state = state.information_state_string(player)</div>
<div class="line"><span class="lineno">  505</span>      <span class="keywordflow">if</span> info_state <span class="keywordflow">in</span> tabular_policy:</div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  507</span>      my_policy = policy_fn(state)</div>
<div class="line"><span class="lineno">  508</span>      tabular_policy[info_state] = list(zip(legal_actions, my_policy))</div>
<div class="line"><span class="lineno">  509</span>  <span class="keywordflow">return</span> tabular_policy</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span><span class="preprocessor">@tf.function</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00466">open_spiel.python.algorithms.rcfr.all_states()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00708">open_spiel.python.algorithms.rcfr._RcfrSolver.average_policy()</a>, and <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00698">open_spiel.python.algorithms.rcfr._RcfrSolver.current_policy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_cgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_cgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_cgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,278,70"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a184f582e819bb9f520f39a28afacc6c8" title=" " alt="" coords="326,29,555,70"/>
<area shape="poly" title=" " alt="" coords="278,47,310,47,310,52,278,52"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a213ee9384a4cd89a02b5e2a989f202f1" title=" " alt="" coords="603,29,819,70"/>
<area shape="poly" title=" " alt="" coords="555,47,588,47,588,52,555,52"/>
<area shape="poly" title=" " alt="" coords="661,29,658,19,666,10,684,5,711,3,740,5,757,11,756,16,739,10,711,8,685,10,669,15,663,21,666,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_a23094f5d347d73886f31686108e9e229_icgraph">
<area shape="rect" title=" " alt="" coords="894,55,1167,95"/>
<area shape="rect" href="../../d1/d3f/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1___rcfr_solver.html#a8845c137359294b9b42dabd0b50ec8d1" title=" " alt="" coords="630,13,846,54"/>
<area shape="poly" title=" " alt="" coords="879,56,846,52,847,46,880,51"/>
<area shape="rect" href="../../d1/d3f/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1___rcfr_solver.html#aac98104675c0b08fbfb8020429a94e35" title=" " alt="" coords="630,87,846,127"/>
<area shape="poly" title=" " alt="" coords="879,94,847,98,846,93,879,89"/>
<area shape="rect" href="../../d4/d73/classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#a269a6c5777fc6d965a73fb153e1ab2f0" title=" " alt="" coords="313,5,582,46"/>
<area shape="poly" title=" " alt="" coords="614,33,582,32,582,27,614,28"/>
<area shape="rect" href="../../d4/d73/classopen__spiel_1_1python_1_1algorithms_1_1fictitious__play_1_1_x_f_p_solver.html#abb5dd376bae11720a03f4da6867caca2" title=" " alt="" coords="13,5,257,46"/>
<area shape="poly" title=" " alt="" coords="297,37,257,37,257,32,297,32"/>
<area shape="poly" title=" " alt="" coords="272,14,312,14,312,19,272,19"/>
<area shape="rect" href="../../d8/dcb/classopen__spiel_1_1python_1_1algorithms_1_1efr_1_1___e_f_r_solver_base.html#a97247da249ef52e8dae5212c742884b6" title=" " alt="" coords="321,94,574,150"/>
<area shape="poly" title=" " alt="" coords="614,116,575,118,574,113,614,111"/>
<area shape="poly" title=" " alt="" coords="495,82,477,75,447,72,421,74,404,79,397,86,396,94,391,93,392,83,402,75,421,69,447,67,478,70,497,77"/>
<area shape="rect" href="../../dc/d97/classopen__spiel_1_1python_1_1algorithms_1_1efr_1_1___e_f_r_solver.html#acf1961cc5aa3d18e2477349257aaf5e3" title=" " alt="" coords="5,101,265,142"/>
<area shape="poly" title=" " alt="" coords="305,124,265,124,265,119,305,119"/>
</map>
</div>

</div>
</div>
<a id="aaa3bbbf0a61e98541e810de32f35866a" name="aaa3bbbf0a61e98541e810de32f35866a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa3bbbf0a61e98541e810de32f35866a">&#9670;&#160;</a></span>tensor_to_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.tensor_to_matrix </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>tensor</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Converts `tensor` to a matrix (a rank-2 tensor) or raises an exception.

Args:
  tensor: The tensor to convert.

Returns:
  A TensorFlow matrix (rank-2 `tf.Tensor`).
Raises:
  ValueError: If `tensor` cannot be trivially converted to a matrix, i.e.
    `tensor` has a rank &gt; 2.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00057">57</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span><span class="keyword">def </span>tensor_to_matrix(tensor):</div>
<div class="line"><span class="lineno">   58</span>  <span class="stringliteral">&quot;&quot;&quot;Converts `tensor` to a matrix (a rank-2 tensor) or raises an exception.</span></div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral">    tensor: The tensor to convert.</span></div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    A TensorFlow matrix (rank-2 `tf.Tensor`).</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">  Raises:</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">    ValueError: If `tensor` cannot be trivially converted to a matrix, i.e.</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">      `tensor` has a rank &gt; 2.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   69</span>  tensor = tf.convert_to_tensor(tensor)</div>
<div class="line"><span class="lineno">   70</span>  rank = tensor.shape.rank</div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordflow">if</span> rank &gt; 2:</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">   73</span>        (<span class="stringliteral">&quot;Tensor {} cannot be converted into a matrix as it is rank &quot;</span></div>
<div class="line"><span class="lineno">   74</span>         <span class="stringliteral">&quot;{} &gt; 2.&quot;</span>).format(tensor, rank))</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">elif</span> rank &lt; 2:</div>
<div class="line"><span class="lineno">   76</span>    num_columns = 1 <span class="keywordflow">if</span> rank == 0 <span class="keywordflow">else</span> tensor.shape[0].value</div>
<div class="line"><span class="lineno">   77</span>    tensor = tf.reshape(tensor, [1, num_columns])</div>
<div class="line"><span class="lineno">   78</span>  <span class="keywordflow">return</span> tensor</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00516">open_spiel.python.algorithms.rcfr.feedforward_evaluate()</a>, and <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00082">open_spiel.python.algorithms.rcfr.with_one_hot_action_features()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aaa3bbbf0a61e98541e810de32f35866a_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aaa3bbbf0a61e98541e810de32f35866a_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aaa3bbbf0a61e98541e810de32f35866a_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aaa3bbbf0a61e98541e810de32f35866a_icgraph">
<area shape="rect" title=" " alt="" coords="658,39,910,79"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a5e922095e43e27b1c93b4f5ed9a69cd5" title=" " alt="" coords="326,5,610,46"/>
<area shape="poly" title=" " alt="" coords="642,47,610,43,611,38,643,41"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#aa5adbdaccd340d29ea38ff65f1a83315" title=" " alt="" coords="348,71,588,111"/>
<area shape="poly" title=" " alt="" coords="643,76,588,82,588,76,642,71"/>
<area shape="rect" href="../../d9/dcf/classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_deep_rcfr_model.html#a57dafbc3e36162cfda14005900f22559" title=" " alt="" coords="33,5,250,46"/>
<area shape="poly" title=" " alt="" coords="310,28,250,28,250,23,310,23"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a2285f0242da7d8f1cb1ac8e065ce1fab" title=" " alt="" coords="5,71,278,111"/>
<area shape="poly" title=" " alt="" coords="332,94,278,94,278,88,332,88"/>
</map>
</div>

</div>
</div>
<a id="aa5adbdaccd340d29ea38ff65f1a83315" name="aa5adbdaccd340d29ea38ff65f1a83315"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5adbdaccd340d29ea38ff65f1a83315">&#9670;&#160;</a></span>with_one_hot_action_features()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.with_one_hot_action_features </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>state_features</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>legal_actions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num_distinct_actions</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Constructs features for each sequence by extending state features.

Sequences features are constructed by concatenating one-hot features
indicating each action to the information state features and stacking them.

Args:
  state_features: The features for the information state alone. Must be a
    `tf.Tensor` with a rank less than or equal to (if batched) 2.
  legal_actions: The list of legal actions in this state. Determines the
    number of rows in the returned feature matrix.
  num_distinct_actions: The number of globally distinct actions in the game.
    Determines the length of the action feature vector concatenated onto the
    state features.

Returns:
  A `tf.Tensor` feature matrix with one row for each sequence and # state
  features plus `num_distinct_actions`-columns.

Raises:
  ValueError: If `state_features` has a rank &gt; 2.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00081">81</a> of file <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span>                                 num_distinct_actions):</div>
<div class="line"><span class="lineno">   83</span>  <span class="stringliteral">&quot;&quot;&quot;Constructs features for each sequence by extending state features.</span></div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">  Sequences features are constructed by concatenating one-hot features</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">  indicating each action to the information state features and stacking them.</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">    state_features: The features for the information state alone. Must be a</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">      `tf.Tensor` with a rank less than or equal to (if batched) 2.</span></div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    legal_actions: The list of legal actions in this state. Determines the</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">      number of rows in the returned feature matrix.</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral">    num_distinct_actions: The number of globally distinct actions in the game.</span></div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">      Determines the length of the action feature vector concatenated onto the</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">      state features.</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral">    A `tf.Tensor` feature matrix with one row for each sequence and # state</span></div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    features plus `num_distinct_actions`-columns.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">  Raises:</span></div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    ValueError: If `state_features` has a rank &gt; 2.</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  104</span>  state_features = tensor_to_matrix(state_features)</div>
<div class="line"><span class="lineno">  105</span>  with_action_features = []</div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordflow">for</span> action <span class="keywordflow">in</span> legal_actions:</div>
<div class="line"><span class="lineno">  107</span>    action_features = tf.one_hot([action], num_distinct_actions)</div>
<div class="line"><span class="lineno">  108</span>    action_features = tf.tile(action_features, [tf.shape(state_features)[0], 1])</div>
<div class="line"><span class="lineno">  109</span>    all_features = tf.concat([state_features, action_features], axis=1)</div>
<div class="line"><span class="lineno">  110</span>    with_action_features.append(all_features)</div>
<div class="line"><span class="lineno">  111</span>  <span class="keywordflow">return</span> tf.concat(with_action_features, axis=0)</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00057">open_spiel.python.algorithms.rcfr.tensor_to_matrix()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d71/algorithms_2rcfr_8py_source.html#l00114">open_spiel.python.algorithms.rcfr.sequence_features()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_cgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_cgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_cgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,246,46"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#aaa3bbbf0a61e98541e810de32f35866a" title=" " alt="" coords="294,5,546,46"/>
<area shape="poly" title=" " alt="" coords="246,23,278,23,278,28,246,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_icgraph.png" border="0" usemap="#ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_icgraph" alt=""/></div>
<map name="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_icgraph" id="ad1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr_aa5adbdaccd340d29ea38ff65f1a83315_icgraph">
<area shape="rect" title=" " alt="" coords="326,5,566,46"/>
<area shape="rect" href="../../d1/d3c/namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#a2285f0242da7d8f1cb1ac8e065ce1fab" title=" " alt="" coords="5,5,278,46"/>
<area shape="poly" title=" " alt="" coords="310,28,278,28,278,23,310,23"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
