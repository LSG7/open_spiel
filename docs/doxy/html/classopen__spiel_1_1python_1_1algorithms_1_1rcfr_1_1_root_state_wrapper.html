<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.algorithms.rcfr.RootStateWrapper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms.html">algorithms</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html">rcfr</a></li><li class="navelem"><a class="el" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html">RootStateWrapper</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.algorithms.rcfr.RootStateWrapper Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for open_spiel.python.algorithms.rcfr.RootStateWrapper:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper__inherit__graph.png" border="0" usemap="#aopen__spiel_8python_8algorithms_8rcfr_8_root_state_wrapper_inherit__map" alt="Inheritance graph"/></div>
<map name="aopen__spiel_8python_8algorithms_8rcfr_8_root_state_wrapper_inherit__map" id="aopen__spiel_8python_8algorithms_8rcfr_8_root_state_wrapper_inherit__map">
<area shape="rect" title=" " alt="" coords="5,119,213,457"/>
<area shape="rect" title=" " alt="" coords="85,5,133,71"/>
<area shape="poly" title=" " alt="" coords="112,86,112,119,107,119,107,86"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for open_spiel.python.algorithms.rcfr.RootStateWrapper:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper__coll__graph.png" border="0" usemap="#aopen__spiel_8python_8algorithms_8rcfr_8_root_state_wrapper_coll__map" alt="Collaboration graph"/></div>
<map name="aopen__spiel_8python_8algorithms_8rcfr_8_root_state_wrapper_coll__map" id="aopen__spiel_8python_8algorithms_8rcfr_8_root_state_wrapper_coll__map">
<area shape="rect" title=" " alt="" coords="5,119,213,457"/>
<area shape="rect" title=" " alt="" coords="85,5,133,71"/>
<area shape="poly" title=" " alt="" coords="112,86,112,119,107,119,107,86"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6e5150d50c31acb31fd80b9580ab035f" id="r_a6e5150d50c31acb31fd80b9580ab035f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e5150d50c31acb31fd80b9580ab035f">__init__</a> (self, <a class="el" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>)</td></tr>
<tr class="separator:a6e5150d50c31acb31fd80b9580ab035f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa94d22c36f4f9934673a2ff955b3efed" id="r_aa94d22c36f4f9934673a2ff955b3efed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa94d22c36f4f9934673a2ff955b3efed">sequence_weights_to_policy</a> (self, sequence_weights, <a class="el" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>)</td></tr>
<tr class="separator:aa94d22c36f4f9934673a2ff955b3efed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52d0bb68845b652e8eb5ee2bc1d07b83" id="r_a52d0bb68845b652e8eb5ee2bc1d07b83"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a52d0bb68845b652e8eb5ee2bc1d07b83">sequence_weights_to_policy_fn</a> (self, player_sequence_weights)</td></tr>
<tr class="separator:a52d0bb68845b652e8eb5ee2bc1d07b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc411392e4e4070b36ae28f21ba87143" id="r_acc411392e4e4070b36ae28f21ba87143"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc411392e4e4070b36ae28f21ba87143">sequence_weights_to_tabular_profile</a> (self, player_sequence_weights)</td></tr>
<tr class="separator:acc411392e4e4070b36ae28f21ba87143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28eafcaed96017c18a066f2b69ad5643" id="r_a28eafcaed96017c18a066f2b69ad5643"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28eafcaed96017c18a066f2b69ad5643">counterfactual_regrets_and_reach_weights</a> (self, regret_player, reach_weight_player, *sequence_weights)</td></tr>
<tr class="separator:a28eafcaed96017c18a066f2b69ad5643"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a1972b2156146c49bcd1ba76951632db8" id="r_a1972b2156146c49bcd1ba76951632db8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1972b2156146c49bcd1ba76951632db8">root</a></td></tr>
<tr class="separator:a1972b2156146c49bcd1ba76951632db8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa290fe51e66aa67ae954cdc1c922aed7" id="r_aa290fe51e66aa67ae954cdc1c922aed7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa290fe51e66aa67ae954cdc1c922aed7">sequence_features</a></td></tr>
<tr class="separator:aa290fe51e66aa67ae954cdc1c922aed7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab234b8e80562d1895978a2b06678dca7" id="r_ab234b8e80562d1895978a2b06678dca7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab234b8e80562d1895978a2b06678dca7">num_player_sequences</a></td></tr>
<tr class="separator:ab234b8e80562d1895978a2b06678dca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27c31c9cbaea9a15b370de9ff54d551" id="r_ad27c31c9cbaea9a15b370de9ff54d551"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad27c31c9cbaea9a15b370de9ff54d551">info_state_to_sequence_idx</a></td></tr>
<tr class="separator:ad27c31c9cbaea9a15b370de9ff54d551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45f2dbe042c1e3bbbf244399fcd68a36" id="r_a45f2dbe042c1e3bbbf244399fcd68a36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45f2dbe042c1e3bbbf244399fcd68a36">terminal_values</a></td></tr>
<tr class="separator:a45f2dbe042c1e3bbbf244399fcd68a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa62346a2edb39c57bf59e9bdb8ff2974" id="r_aa62346a2edb39c57bf59e9bdb8ff2974"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa62346a2edb39c57bf59e9bdb8ff2974">_walk_descendants</a> (self, <a class="el" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>)</td></tr>
<tr class="separator:aa62346a2edb39c57bf59e9bdb8ff2974"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab6c7795ec023091b32b1ee2fceedb9cf" id="r_ab6c7795ec023091b32b1ee2fceedb9cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6c7795ec023091b32b1ee2fceedb9cf">_num_distinct_actions</a></td></tr>
<tr class="separator:ab6c7795ec023091b32b1ee2fceedb9cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Analyzes the subgame at a given root state.

It enumerates features for each player sequence, creates a mapping between
information states to sequence index offsets, and caches terminal values
in a dictionary with history string keys.

Properties:
  root: An OpenSpiel `State`.
  sequence_features: A `list` of sequence feature matrices, one for each
    player. This list uses depth-first, information state-major ordering, so
    sequences are grouped by information state. I.e. the first legal action
    in the first state has index 0, the second action in the same information
    state has index 1, the third action will have index 3, and so on.
    Sequences in the next information state descendant of the first action
    will begin indexing its sequences at the number of legal actions in the
    ancestor information state.
  num_player_sequences: The number of sequences for each player.
  info_state_to_sequence_idx: A `dict` mapping each information state string
    to the `sequence_features` index of the first sequence in the
    corresponding information state.
  terminal_values: A `dict` mapping history strings to terminal values for
    each player.
</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00143">143</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6e5150d50c31acb31fd80b9580ab035f" name="a6e5150d50c31acb31fd80b9580ab035f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e5150d50c31acb31fd80b9580ab035f">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00168">168</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  168</span>  <span class="keyword">def </span>__init__(self, state):</div>
<div class="line"><span class="lineno">  169</span>    self.root = state</div>
<div class="line"><span class="lineno">  170</span>    self._num_distinct_actions = <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(state.legal_actions_mask(0))</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    self.sequence_features = [[] <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(state.num_players())]</div>
<div class="line"><span class="lineno">  173</span>    self.num_player_sequences = [0] * state.num_players()</div>
<div class="line"><span class="lineno">  174</span>    self.info_state_to_sequence_idx = {}</div>
<div class="line"><span class="lineno">  175</span>    self.terminal_values = {}</div>
<div class="line"><span class="lineno">  176</span>    self._walk_descendants(state)</div>
<div class="line"><span class="lineno">  177</span>    self.sequence_features = [</div>
<div class="line"><span class="lineno">  178</span>        tf.concat(rows, axis=0) <span class="keywordflow">for</span> rows <span class="keywordflow">in</span> self.sequence_features</div>
<div class="line"><span class="lineno">  179</span>    ]</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="ttc" id="alow__level__alloc__test_8cc_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc__test_8cc_source.html#l00046">low_level_alloc_test.cc:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa62346a2edb39c57bf59e9bdb8ff2974" name="aa62346a2edb39c57bf59e9bdb8ff2974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa62346a2edb39c57bf59e9bdb8ff2974">&#9670;&#160;</a></span>_walk_descendants()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Records information about `state` and its descendants.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">181</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  181</span>  <span class="keyword">def </span>_walk_descendants(self, state):</div>
<div class="line"><span class="lineno">  182</span>    <span class="stringliteral">&quot;&quot;&quot;Records information about `state` and its descendants.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  183</span>    <span class="keywordflow">if</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  184</span>      self.terminal_values[state.history_str()] = np.array(state.returns())</div>
<div class="line"><span class="lineno">  185</span>      <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">elif</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  188</span>      <span class="keywordflow">for</span> action, _ <span class="keywordflow">in</span> state.chance_outcomes():</div>
<div class="line"><span class="lineno">  189</span>        self._walk_descendants(state.child(action))</div>
<div class="line"><span class="lineno">  190</span>      <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    player = state.current_player()</div>
<div class="line"><span class="lineno">  193</span>    info_state = state.information_state_string(player)</div>
<div class="line"><span class="lineno">  194</span>    actions = state.legal_actions()</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">if</span> info_state <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.info_state_to_sequence_idx:</div>
<div class="line"><span class="lineno">  197</span>      n = self.num_player_sequences[player]</div>
<div class="line"><span class="lineno">  198</span>      self.info_state_to_sequence_idx[info_state] = n</div>
<div class="line"><span class="lineno">  199</span>      self.sequence_features[player].append(</div>
<div class="line"><span class="lineno">  200</span>          sequence_features(state, self._num_distinct_actions))</div>
<div class="line"><span class="lineno">  201</span>      self.num_player_sequences[player] += <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions)</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">for</span> action <span class="keywordflow">in</span> actions:</div>
<div class="line"><span class="lineno">  204</span>      self._walk_descendants(state.child(action))</div>
<div class="line"><span class="lineno">  205</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2rcfr_8py_source.html#l00170">open_spiel.python.algorithms.rcfr.RootStateWrapper._num_distinct_actions</a>, <a class="el" href="chat__game_8py_source.html#l00267">open_spiel.python.games.chat_game.ChatGame._num_distinct_actions</a>, <a class="el" href="chat__game__base_8py_source.html#l00777">open_spiel.python.games.chat_games.chat_game_base.BaseChatGame._num_distinct_actions</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00161">open_spiel.python.pytorch.rcfr.RootStateWrapper._num_distinct_actions</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00172">open_spiel.python.pytorch.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00174">open_spiel.python.algorithms.rcfr.RootStateWrapper.info_state_to_sequence_idx</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00165">open_spiel.python.pytorch.rcfr.RootStateWrapper.info_state_to_sequence_idx</a>, <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00173">open_spiel.python.algorithms.rcfr.RootStateWrapper.num_player_sequences</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00164">open_spiel.python.pytorch.rcfr.RootStateWrapper.num_player_sequences</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00172">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_features</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00163">open_spiel.python.pytorch.rcfr.RootStateWrapper.sequence_features</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00175">open_spiel.python.algorithms.rcfr.RootStateWrapper.terminal_values</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00166">open_spiel.python.pytorch.rcfr.RootStateWrapper.terminal_values</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00172">open_spiel.python.pytorch.rcfr.RootStateWrapper._walk_descendants()</a>, and <a class="el" href="algorithms_2rcfr_8py_source.html#l00270">open_spiel.python.algorithms.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_cgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,252,70"/>
<area shape="poly" title=" " alt="" coords="74,29,71,19,80,10,99,5,129,3,160,5,179,11,177,16,159,10,128,8,100,10,83,15,76,21,79,28"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#adc51daef22a186da2705d2a3f7cb0a38" title=" " alt="" coords="300,29,546,70"/>
<area shape="poly" title=" " alt="" coords="252,56,284,56,284,61,252,61"/>
<area shape="poly" title=" " alt="" coords="299,43,267,43,267,38,299,38"/>
<area shape="poly" title=" " alt="" coords="368,29,365,19,374,10,394,5,423,3,454,5,473,11,471,16,453,10,423,8,394,10,377,15,371,21,373,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_icgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa62346a2edb39c57bf59e9bdb8ff2974_icgraph">
<area shape="rect" title=" " alt="" coords="561,29,807,70"/>
<area shape="poly" title=" " alt="" coords="733,16,715,10,684,8,656,10,638,15,632,21,635,28,629,29,627,19,636,10,655,5,684,3,716,5,734,11"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#adc51daef22a186da2705d2a3f7cb0a38" title=" " alt="" coords="267,29,513,70"/>
<area shape="poly" title=" " alt="" coords="545,61,513,61,513,56,545,56"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#a28eafcaed96017c18a066f2b69ad5643" title=" " alt="" coords="282,94,498,150"/>
<area shape="poly" title=" " alt="" coords="584,77,499,98,498,93,583,72"/>
<area shape="poly" title=" " alt="" coords="528,38,560,38,560,43,528,43"/>
<area shape="poly" title=" " alt="" coords="436,16,419,10,390,8,363,10,347,15,341,21,343,28,338,29,335,19,344,10,362,5,390,3,420,5,437,11"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#a0a7e164b5510e7236fba6ac3dc2cf4de" title=" " alt="" coords="5,22,219,78"/>
<area shape="poly" title=" " alt="" coords="251,52,219,52,219,47,251,47"/>
</map>
</div>

</div>
</div>
<a id="a28eafcaed96017c18a066f2b69ad5643" name="a28eafcaed96017c18a066f2b69ad5643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28eafcaed96017c18a066f2b69ad5643">&#9670;&#160;</a></span>counterfactual_regrets_and_reach_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>regret_player</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>reach_weight_player</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>sequence_weights</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns counterfactual regrets and reach weights as a tuple.

Args:
  regret_player: The player for whom counterfactual regrets are computed.
  reach_weight_player: The player for whom reach weights are computed.
  *sequence_weights: A list of non-negative sequence weights for each player
    determining the policy profile. Behavioral policies are generated by
    normalizing sequence weights corresponding to actions in each
    information state by their sum.

Returns:
  The counterfactual regrets and reach weights as an `np.array`-`np.array`
    tuple.

Raises:
  ValueError: If there are too few sequence weights at any information state
    for any player.
</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00268">268</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  270</span>                                               *sequence_weights):</div>
<div class="line"><span class="lineno">  271</span>    <span class="stringliteral">&quot;&quot;&quot;Returns counterfactual regrets and reach weights as a tuple.</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">      regret_player: The player for whom counterfactual regrets are computed.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">      reach_weight_player: The player for whom reach weights are computed.</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">      *sequence_weights: A list of non-negative sequence weights for each player</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">        determining the policy profile. Behavioral policies are generated by</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">        normalizing sequence weights corresponding to actions in each</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">        information state by their sum.</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">      The counterfactual regrets and reach weights as an `np.array`-`np.array`</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">        tuple.</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    Raises:</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">      ValueError: If there are too few sequence weights at any information state</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">        for any player.</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  289</span>    num_players = <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(sequence_weights)</div>
<div class="line"><span class="lineno">  290</span>    regrets = np.zeros(self.num_player_sequences[regret_player])</div>
<div class="line"><span class="lineno">  291</span>    reach_weights = np.zeros(self.num_player_sequences[reach_weight_player])</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="keyword">def </span>_walk_descendants(state, reach_probabilities, chance_reach_probability):</div>
<div class="line"><span class="lineno">  294</span>      <span class="stringliteral">&quot;&quot;&quot;Compute `state`&#39;s counterfactual regrets and reach weights.</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">      Args:</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">        state: An OpenSpiel `State`.</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">        reach_probabilities: The probability that each player plays to reach</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">          `state`&#39;s history.</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">        chance_reach_probability: The probability that all chance outcomes in</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">          `state`&#39;s history occur.</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">      Returns:</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        The counterfactual value of `state`&#39;s history.</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">      Raises:</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">        ValueError if there are too few sequence weights at any information</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">        state for any player.</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">      &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>      <span class="keywordflow">if</span> state.is_terminal():</div>
<div class="line"><span class="lineno">  311</span>        player_reach = (</div>
<div class="line"><span class="lineno">  312</span>            np.prod(reach_probabilities[:regret_player]) *</div>
<div class="line"><span class="lineno">  313</span>            np.prod(reach_probabilities[regret_player + 1:]))</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>        counterfactual_reach_prob = player_reach * chance_reach_probability</div>
<div class="line"><span class="lineno">  316</span>        u = self.terminal_values[state.history_str()]</div>
<div class="line"><span class="lineno">  317</span>        <span class="keywordflow">return</span> u[regret_player] * counterfactual_reach_prob</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>      <span class="keywordflow">elif</span> state.is_chance_node():</div>
<div class="line"><span class="lineno">  320</span>        v = 0.0</div>
<div class="line"><span class="lineno">  321</span>        <span class="keywordflow">for</span> action, action_prob <span class="keywordflow">in</span> state.chance_outcomes():</div>
<div class="line"><span class="lineno">  322</span>          v += _walk_descendants(</div>
<div class="line"><span class="lineno">  323</span>              state.child(action), reach_probabilities,</div>
<div class="line"><span class="lineno">  324</span>              chance_reach_probability * action_prob)</div>
<div class="line"><span class="lineno">  325</span>        <span class="keywordflow">return</span> v</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>      player = state.current_player()</div>
<div class="line"><span class="lineno">  328</span>      info_state = state.information_state_string(player)</div>
<div class="line"><span class="lineno">  329</span>      sequence_idx_offset = self.info_state_to_sequence_idx[info_state]</div>
<div class="line"><span class="lineno">  330</span>      actions = state.legal_actions(player)</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>      sequence_idx_end = sequence_idx_offset + <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions)</div>
<div class="line"><span class="lineno">  333</span>      my_sequence_weights = sequence_weights[player][</div>
<div class="line"><span class="lineno">  334</span>          sequence_idx_offset:sequence_idx_end]</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>      <span class="keywordflow">if</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(my_sequence_weights) &lt; <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions):</div>
<div class="line"><span class="lineno">  337</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  338</span>            (<span class="stringliteral">&quot;Invalid policy: Policy {player} at sequence offset &quot;</span></div>
<div class="line"><span class="lineno">  339</span>             <span class="stringliteral">&quot;{sequence_idx_offset} has only {policy_len} elements but there &quot;</span></div>
<div class="line"><span class="lineno">  340</span>             <span class="stringliteral">&quot;are {num_actions} legal actions.&quot;</span>).format(</div>
<div class="line"><span class="lineno">  341</span>                 player=player,</div>
<div class="line"><span class="lineno">  342</span>                 sequence_idx_offset=sequence_idx_offset,</div>
<div class="line"><span class="lineno">  343</span>                 policy_len=<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(my_sequence_weights),</div>
<div class="line"><span class="lineno">  344</span>                 num_actions=<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions)))</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>      policy = normalized_by_sum(my_sequence_weights)</div>
<div class="line"><span class="lineno">  347</span>      action_values = np.zeros(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions))</div>
<div class="line"><span class="lineno">  348</span>      state_value = 0.0</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>      is_reach_weight_player_node = player == reach_weight_player</div>
<div class="line"><span class="lineno">  351</span>      is_regret_player_node = player == regret_player</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>      reach_prob = reach_probabilities[player]</div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">for</span> action_idx, action <span class="keywordflow">in</span> enumerate(actions):</div>
<div class="line"><span class="lineno">  355</span>        action_prob = policy[action_idx]</div>
<div class="line"><span class="lineno">  356</span>        next_reach_prob = reach_prob * action_prob</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">if</span> is_reach_weight_player_node:</div>
<div class="line"><span class="lineno">  359</span>          reach_weight_player_plays_down_this_line = next_reach_prob &gt; 0</div>
<div class="line"><span class="lineno">  360</span>          <span class="keywordflow">if</span> <span class="keywordflow">not</span> reach_weight_player_plays_down_this_line:</div>
<div class="line"><span class="lineno">  361</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  362</span>          sequence_idx = sequence_idx_offset + action_idx</div>
<div class="line"><span class="lineno">  363</span>          reach_weights[sequence_idx] += next_reach_prob</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>        reach_probabilities[player] = next_reach_prob</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>        action_value = _walk_descendants(</div>
<div class="line"><span class="lineno">  368</span>            state.child(action), reach_probabilities, chance_reach_probability)</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>        <span class="keywordflow">if</span> is_regret_player_node:</div>
<div class="line"><span class="lineno">  371</span>          state_value = state_value + action_prob * action_value</div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  373</span>          state_value = state_value + action_value</div>
<div class="line"><span class="lineno">  374</span>        action_values[action_idx] = action_value</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>      reach_probabilities[player] = reach_prob</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>      <span class="keywordflow">if</span> is_regret_player_node:</div>
<div class="line"><span class="lineno">  379</span>        regrets[sequence_idx_offset:sequence_idx_end] += (</div>
<div class="line"><span class="lineno">  380</span>            action_values - state_value)</div>
<div class="line"><span class="lineno">  381</span>      <span class="keywordflow">return</span> state_value</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="comment"># End of _walk_descendants</span></div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    _walk_descendants(self.root, np.ones(num_players), 1.0)</div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">return</span> regrets, reach_weights</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00174">open_spiel.python.algorithms.rcfr.RootStateWrapper.info_state_to_sequence_idx</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00165">open_spiel.python.pytorch.rcfr.RootStateWrapper.info_state_to_sequence_idx</a>, <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00389">open_spiel.python.algorithms.rcfr.normalized_by_sum()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00173">open_spiel.python.algorithms.rcfr.RootStateWrapper.num_player_sequences</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00164">open_spiel.python.pytorch.rcfr.RootStateWrapper.num_player_sequences</a>, <a class="el" href="btree_8h_source.html#l01633">absl::container_internal::btree&lt; Params &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01634">absl::container_internal::btree&lt; Params &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01633">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, false &gt; &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01634">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, false &gt; &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01633">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, true &gt; &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01634">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, true &gt; &gt;.root()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00169">open_spiel.python.algorithms.rcfr.RootStateWrapper.root</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00160">open_spiel.python.pytorch.rcfr.RootStateWrapper.root</a>, <a class="el" href="infostate__tree_8h_source.html#l00309">open_spiel::algorithms::InfostateTree.root()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00175">open_spiel.python.algorithms.rcfr.RootStateWrapper.terminal_values</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00166">open_spiel.python.pytorch.rcfr.RootStateWrapper.terminal_values</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a28eafcaed96017c18a066f2b69ad5643_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a28eafcaed96017c18a066f2b69ad5643_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a28eafcaed96017c18a066f2b69ad5643_cgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a28eafcaed96017c18a066f2b69ad5643_cgraph">
<area shape="rect" title=" " alt="" coords="5,152,222,208"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#aa62346a2edb39c57bf59e9bdb8ff2974" title=" " alt="" coords="286,29,532,70"/>
<area shape="poly" title=" " alt="" coords="151,150,205,114,269,81,289,73,291,78,271,85,208,118,154,154"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#ab516d86285f4a118e24b82e875da94e6" title=" " alt="" coords="270,95,549,135"/>
<area shape="poly" title=" " alt="" coords="222,154,299,137,300,142,223,159"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1btree.html#ac3a12aad5b60d27f443cd74fbe65989d" title=" " alt="" coords="332,160,487,201"/>
<area shape="poly" title=" " alt="" coords="222,195,316,195,316,200,222,200"/>
<area shape="poly" title=" " alt="" coords="222,178,316,178,316,183,222,183"/>
<area shape="poly" title=" " alt="" coords="222,160,316,161,316,166,222,166"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1btree.html#a2d73b89a364a1c2c005f4ca41df811c3" title=" " alt="" coords="332,225,487,266"/>
<area shape="poly" title=" " alt="" coords="176,206,245,224,317,239,316,245,243,230,175,211"/>
<area shape="poly" title=" " alt="" coords="223,202,317,223,316,228,222,207"/>
<area shape="poly" title=" " alt="" coords="223,184,356,217,355,222,222,189"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1_infostate_tree.html#a67a7e789ed77f573f09b503d8b584ce2" title=" " alt="" coords="334,291,485,331"/>
<area shape="poly" title=" " alt="" coords="154,207,208,242,271,275,320,292,318,297,269,280,205,247,151,211"/>
<area shape="poly" title=" " alt="" coords="354,29,352,19,361,10,380,5,409,3,441,5,460,11,458,16,440,10,409,8,381,10,363,15,357,21,359,28"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#adc51daef22a186da2705d2a3f7cb0a38" title=" " alt="" coords="597,29,843,70"/>
<area shape="poly" title=" " alt="" coords="533,56,582,56,582,61,533,61"/>
<area shape="poly" title=" " alt="" coords="597,44,548,43,548,38,597,38"/>
<area shape="poly" title=" " alt="" coords="663,30,660,19,669,10,689,5,720,3,753,5,773,11,771,16,752,10,720,8,690,10,672,15,665,21,668,28"/>
</map>
</div>

</div>
</div>
<a id="aa94d22c36f4f9934673a2ff955b3efed" name="aa94d22c36f4f9934673a2ff955b3efed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa94d22c36f4f9934673a2ff955b3efed">&#9670;&#160;</a></span>sequence_weights_to_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>sequence_weights</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a behavioral policy at `state` from sequence weights.

Args:
  sequence_weights: An array of non-negative weights, one for each of
    `state.current_player()`'s sequences in `state`'s game.
  state: An OpenSpiel `State` that represents an information state in an
    alternating-move game.

Returns:
  A `np.array&lt;double&gt;` probability distribution representing the policy in
  `state` encoded by `sequence_weights`. Weights corresponding to actions
  in `state` are normalized by their sum.

Raises:
  ValueError: If there are too few sequence weights at `state`.
</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00206">206</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>  <span class="keyword">def </span>sequence_weights_to_policy(self, sequence_weights, state):</div>
<div class="line"><span class="lineno">  207</span>    <span class="stringliteral">&quot;&quot;&quot;Returns a behavioral policy at `state` from sequence weights.</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">      sequence_weights: An array of non-negative weights, one for each of</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">        `state.current_player()`&#39;s sequences in `state`&#39;s game.</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">      state: An OpenSpiel `State` that represents an information state in an</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        alternating-move game.</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">      A `np.array&lt;double&gt;` probability distribution representing the policy in</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">      `state` encoded by `sequence_weights`. Weights corresponding to actions</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">      in `state` are normalized by their sum.</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    Raises:</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">      ValueError: If there are too few sequence weights at `state`.</span></div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  223</span>    info_state = state.information_state_string()</div>
<div class="line"><span class="lineno">  224</span>    sequence_offset = self.info_state_to_sequence_idx[info_state]</div>
<div class="line"><span class="lineno">  225</span>    actions = state.legal_actions()</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    sequence_idx_end = sequence_offset + <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions)</div>
<div class="line"><span class="lineno">  228</span>    weights = sequence_weights[sequence_offset:sequence_idx_end]</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">if</span> <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(weights) &lt; <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions):</div>
<div class="line"><span class="lineno">  231</span>      <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  232</span>          (<span class="stringliteral">&quot;Invalid policy: Policy {player} at sequence offset &quot;</span></div>
<div class="line"><span class="lineno">  233</span>           <span class="stringliteral">&quot;{sequence_offset} has only {policy_len} elements but there &quot;</span></div>
<div class="line"><span class="lineno">  234</span>           <span class="stringliteral">&quot;are {num_actions} legal actions.&quot;</span>).format(</div>
<div class="line"><span class="lineno">  235</span>               player=state.current_player(),</div>
<div class="line"><span class="lineno">  236</span>               sequence_offset=sequence_offset,</div>
<div class="line"><span class="lineno">  237</span>               policy_len=<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(weights),</div>
<div class="line"><span class="lineno">  238</span>               num_actions=<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(actions)))</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">return</span> normalized_by_sum(weights)</div>
<div class="line"><span class="lineno">  240</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2rcfr_8py_source.html#l00174">open_spiel.python.algorithms.rcfr.RootStateWrapper.info_state_to_sequence_idx</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00165">open_spiel.python.pytorch.rcfr.RootStateWrapper.info_state_to_sequence_idx</a>, <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>, and <a class="el" href="algorithms_2rcfr_8py_source.html#l00389">open_spiel.python.algorithms.rcfr.normalized_by_sum()</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00241">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_policy_fn()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00232">open_spiel.python.pytorch.rcfr.RootStateWrapper.sequence_weights_to_policy_fn()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_cgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,245,61"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#ab516d86285f4a118e24b82e875da94e6" title=" " alt="" coords="293,13,572,54"/>
<area shape="poly" title=" " alt="" coords="245,30,277,30,277,36,245,36"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_icgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_aa94d22c36f4f9934673a2ff955b3efed_icgraph">
<area shape="rect" title=" " alt="" coords="580,81,819,137"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#a52d0bb68845b652e8eb5ee2bc1d07b83" title=" " alt="" coords="293,41,532,97"/>
<area shape="poly" title=" " alt="" coords="564,93,532,89,533,83,565,88"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#add1d3765404d9a9d66905095722ff9a9" title=" " alt="" coords="313,121,512,177"/>
<area shape="poly" title=" " alt="" coords="565,131,513,138,512,133,564,125"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#acc411392e4e4070b36ae28f21ba87143" title=" " alt="" coords="5,29,245,85"/>
<area shape="poly" title=" " alt="" coords="277,66,245,65,245,60,277,61"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#a656e7b9c66bbf57c4ab041a56fdadac2" title=" " alt="" coords="25,133,225,189"/>
<area shape="poly" title=" " alt="" coords="309,105,215,135,213,130,308,100"/>
<area shape="poly" title=" " alt="" coords="172,17,154,11,125,8,99,10,83,15,75,21,75,29,69,29,70,19,80,10,98,5,125,3,156,5,174,12"/>
<area shape="poly" title=" " alt="" coords="172,121,154,115,125,112,99,114,83,119,75,125,75,133,69,133,70,123,80,114,98,109,125,107,156,109,174,116"/>
<area shape="poly" title=" " alt="" coords="308,119,213,88,215,83,309,113"/>
<area shape="poly" title=" " alt="" coords="297,157,225,160,225,154,297,151"/>
</map>
</div>

</div>
</div>
<a id="a52d0bb68845b652e8eb5ee2bc1d07b83" name="a52d0bb68845b652e8eb5ee2bc1d07b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52d0bb68845b652e8eb5ee2bc1d07b83">&#9670;&#160;</a></span>sequence_weights_to_policy_fn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_policy_fn </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player_sequence_weights</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns a policy function based on sequence weights for each player.

Args:
  player_sequence_weights: A list of weight arrays, one for each player.
    Each array should have a weight for each of that player's sequences in
    `state`'s game.

Returns:
  A `State` -&gt; `np.array&lt;double&gt;` function. The output of this function is
    a probability distribution that represents the policy at the given
    `State` encoded by `player_sequence_weights` according to
    `sequence_weights_to_policy`.
</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00241">241</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  241</span>  <span class="keyword">def </span>sequence_weights_to_policy_fn(self, player_sequence_weights):</div>
<div class="line"><span class="lineno">  242</span>    <span class="stringliteral">&quot;&quot;&quot;Returns a policy function based on sequence weights for each player.</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">      player_sequence_weights: A list of weight arrays, one for each player.</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">        Each array should have a weight for each of that player&#39;s sequences in</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">        `state`&#39;s game.</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">      A `State` -&gt; `np.array&lt;double&gt;` function. The output of this function is</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">        a probability distribution that represents the policy at the given</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">        `State` encoded by `player_sequence_weights` according to</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">        `sequence_weights_to_policy`.</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="keyword">def </span>policy_fn(state):</div>
<div class="line"><span class="lineno">  257</span>      player = state.current_player()</div>
<div class="line"><span class="lineno">  258</span>      <span class="keywordflow">return</span> self.sequence_weights_to_policy(player_sequence_weights[player],</div>
<div class="line"><span class="lineno">  259</span>                                             state)</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">return</span> policy_fn</div>
<div class="line"><span class="lineno">  262</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="algorithms_2rcfr_8py_source.html#l00206">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_policy()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00197">open_spiel.python.pytorch.rcfr.RootStateWrapper.sequence_weights_to_policy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00263">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_tabular_profile()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00254">open_spiel.python.pytorch.rcfr.RootStateWrapper.sequence_weights_to_tabular_profile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_cgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_cgraph">
<area shape="rect" title=" " alt="" coords="5,45,245,101"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#aa94d22c36f4f9934673a2ff955b3efed" title=" " alt="" coords="293,5,532,61"/>
<area shape="poly" title=" " alt="" coords="245,54,277,49,277,55,245,59"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#a34fcbf70df9936dc5e93f13b8cb665ac" title=" " alt="" coords="313,85,512,141"/>
<area shape="poly" title=" " alt="" coords="245,87,298,95,297,100,245,92"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#ab516d86285f4a118e24b82e875da94e6" title=" " alt="" coords="580,13,859,54"/>
<area shape="poly" title=" " alt="" coords="532,30,564,30,564,36,532,36"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1pytorch_1_1rcfr.html#a7e315e2264e283602e4e64133f8643a3" title=" " alt="" coords="588,93,851,134"/>
<area shape="poly" title=" " alt="" coords="513,110,573,110,573,116,513,116"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_icgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_a52d0bb68845b652e8eb5ee2bc1d07b83_icgraph">
<area shape="rect" title=" " alt="" coords="293,81,532,137"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#acc411392e4e4070b36ae28f21ba87143" title=" " alt="" coords="5,29,245,85"/>
<area shape="poly" title=" " alt="" coords="277,87,245,82,246,76,278,82"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#a656e7b9c66bbf57c4ab041a56fdadac2" title=" " alt="" coords="25,133,225,189"/>
<area shape="poly" title=" " alt="" coords="278,136,225,146,224,141,277,131"/>
<area shape="poly" title=" " alt="" coords="172,17,154,11,125,8,99,10,83,15,75,21,75,29,69,29,70,19,80,10,98,5,125,3,156,5,174,12"/>
<area shape="poly" title=" " alt="" coords="172,121,154,115,125,112,99,114,83,119,75,125,75,133,69,133,70,123,80,114,98,109,125,107,156,109,174,116"/>
</map>
</div>

</div>
</div>
<a id="acc411392e4e4070b36ae28f21ba87143" name="acc411392e4e4070b36ae28f21ba87143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc411392e4e4070b36ae28f21ba87143">&#9670;&#160;</a></span>sequence_weights_to_tabular_profile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_tabular_profile </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>player_sequence_weights</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the tabular profile-form of `player_sequence_weights`.</pre> 
<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00263">263</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  263</span>  <span class="keyword">def </span>sequence_weights_to_tabular_profile(self, player_sequence_weights):</div>
<div class="line"><span class="lineno">  264</span>    <span class="stringliteral">&quot;&quot;&quot;Returns the tabular profile-form of `player_sequence_weights`.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">return</span> sequence_weights_to_tabular_profile(</div>
<div class="line"><span class="lineno">  266</span>        self.root, self.sequence_weights_to_policy_fn(player_sequence_weights))</div>
<div class="line"><span class="lineno">  267</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="btree_8h_source.html#l01633">absl::container_internal::btree&lt; Params &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01634">absl::container_internal::btree&lt; Params &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01633">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, false &gt; &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01634">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, false &gt; &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01633">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, true &gt; &gt;.root()</a>, <a class="el" href="btree_8h_source.html#l01634">absl::container_internal::btree&lt; container_internal::set_params&lt; Key, std::less&lt; Key &gt;, std::allocator&lt; Key &gt;, 256, true &gt; &gt;.root()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00169">open_spiel.python.algorithms.rcfr.RootStateWrapper.root</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00160">open_spiel.python.pytorch.rcfr.RootStateWrapper.root</a>, <a class="el" href="infostate__tree_8h_source.html#l00309">open_spiel::algorithms::InfostateTree.root()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00241">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_policy_fn()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00232">open_spiel.python.pytorch.rcfr.RootStateWrapper.sequence_weights_to_policy_fn()</a>, and <a class="el" href="algorithms_2rcfr_8py_source.html#l00263">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_tabular_profile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00263">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_tabular_profile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_cgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_cgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_cgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,245,119"/>
<area shape="poly" title=" " alt="" coords="69,63,70,53,80,44,98,38,125,37,156,39,174,46,172,51,154,44,125,42,99,44,83,49,75,55,75,63"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1btree.html#ac3a12aad5b60d27f443cd74fbe65989d" title=" " alt="" coords="335,5,490,46"/>
<area shape="poly" title=" " alt="" coords="244,79,360,49,361,54,246,84"/>
<area shape="poly" title=" " alt="" coords="244,61,319,44,320,49,246,66"/>
<area shape="poly" title=" " alt="" coords="185,60,319,27,320,32,186,65"/>
<area shape="rect" href="classabsl_1_1container__internal_1_1btree.html#a2d73b89a364a1c2c005f4ca41df811c3" title=" " alt="" coords="335,71,490,111"/>
<area shape="poly" title=" " alt="" coords="245,106,319,105,319,111,245,111"/>
<area shape="poly" title=" " alt="" coords="245,88,319,88,319,94,245,94"/>
<area shape="poly" title=" " alt="" coords="245,71,319,71,319,77,245,76"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1_infostate_tree.html#a67a7e789ed77f573f09b503d8b584ce2" title=" " alt="" coords="337,136,488,177"/>
<area shape="poly" title=" " alt="" coords="246,116,322,133,321,138,244,121"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#a52d0bb68845b652e8eb5ee2bc1d07b83" title=" " alt="" coords="293,280,532,336"/>
<area shape="poly" title=" " alt="" coords="148,117,208,191,249,231,294,266,302,271,299,275,291,271,245,235,204,195,144,121"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#add1d3765404d9a9d66905095722ff9a9" title=" " alt="" coords="313,200,512,256"/>
<area shape="poly" title=" " alt="" coords="171,117,228,152,294,186,307,192,305,197,292,191,226,157,168,122"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper.html#aa94d22c36f4f9934673a2ff955b3efed" title=" " alt="" coords="580,200,819,256"/>
<area shape="poly" title=" " alt="" coords="514,277,582,258,583,263,516,282"/>
<area shape="rect" href="classopen__spiel_1_1python_1_1pytorch_1_1rcfr_1_1_root_state_wrapper.html#a34fcbf70df9936dc5e93f13b8cb665ac" title=" " alt="" coords="600,280,799,336"/>
<area shape="poly" title=" " alt="" coords="532,306,585,306,585,311,532,311"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1rcfr.html#ab516d86285f4a118e24b82e875da94e6" title=" " alt="" coords="867,208,1147,249"/>
<area shape="poly" title=" " alt="" coords="820,226,852,226,852,231,820,231"/>
<area shape="rect" href="namespaceopen__spiel_1_1python_1_1pytorch_1_1rcfr.html#a7e315e2264e283602e4e64133f8643a3" title=" " alt="" coords="876,288,1138,329"/>
<area shape="poly" title=" " alt="" coords="800,306,861,306,861,311,800,311"/>
<area shape="poly" title=" " alt="" coords="512,226,564,226,564,231,512,231"/>
<area shape="poly" title=" " alt="" coords="513,254,586,274,584,279,512,259"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_icgraph.png" border="0" usemap="#aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_icgraph" alt=""/></div>
<map name="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_icgraph" id="aclassopen__spiel_1_1python_1_1algorithms_1_1rcfr_1_1_root_state_wrapper_acc411392e4e4070b36ae28f21ba87143_icgraph">
<area shape="rect" title=" " alt="" coords="5,29,245,85"/>
<area shape="poly" title=" " alt="" coords="163,17,149,10,125,8,104,10,90,15,84,21,83,29,78,29,79,19,87,10,103,5,125,3,150,5,165,12"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ab6c7795ec023091b32b1ee2fceedb9cf" name="ab6c7795ec023091b32b1ee2fceedb9cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c7795ec023091b32b1ee2fceedb9cf">&#9670;&#160;</a></span>_num_distinct_actions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper._num_distinct_actions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00170">170</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00172">open_spiel.python.pytorch.rcfr.RootStateWrapper._walk_descendants()</a>.</p>

</div>
</div>
<a id="ad27c31c9cbaea9a15b370de9ff54d551" name="ad27c31c9cbaea9a15b370de9ff54d551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad27c31c9cbaea9a15b370de9ff54d551">&#9670;&#160;</a></span>info_state_to_sequence_idx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.info_state_to_sequence_idx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00174">174</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00172">open_spiel.python.pytorch.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00270">open_spiel.python.algorithms.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00261">open_spiel.python.pytorch.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00206">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_policy()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00197">open_spiel.python.pytorch.rcfr.RootStateWrapper.sequence_weights_to_policy()</a>.</p>

</div>
</div>
<a id="ab234b8e80562d1895978a2b06678dca7" name="ab234b8e80562d1895978a2b06678dca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab234b8e80562d1895978a2b06678dca7">&#9670;&#160;</a></span>num_player_sequences</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.num_player_sequences</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00173">173</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00172">open_spiel.python.pytorch.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00270">open_spiel.python.algorithms.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00261">open_spiel.python.pytorch.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>.</p>

</div>
</div>
<a id="a1972b2156146c49bcd1ba76951632db8" name="a1972b2156146c49bcd1ba76951632db8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1972b2156146c49bcd1ba76951632db8">&#9670;&#160;</a></span>root</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.root</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00169">169</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00270">open_spiel.python.algorithms.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00261">open_spiel.python.pytorch.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00263">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_weights_to_tabular_profile()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00254">open_spiel.python.pytorch.rcfr.RootStateWrapper.sequence_weights_to_tabular_profile()</a>.</p>

</div>
</div>
<a id="aa290fe51e66aa67ae954cdc1c922aed7" name="aa290fe51e66aa67ae954cdc1c922aed7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa290fe51e66aa67ae954cdc1c922aed7">&#9670;&#160;</a></span>sequence_features</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.sequence_features</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00172">172</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00172">open_spiel.python.pytorch.rcfr.RootStateWrapper._walk_descendants()</a>.</p>

</div>
</div>
<a id="a45f2dbe042c1e3bbbf244399fcd68a36" name="a45f2dbe042c1e3bbbf244399fcd68a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45f2dbe042c1e3bbbf244399fcd68a36">&#9670;&#160;</a></span>terminal_values</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.rcfr.RootStateWrapper.terminal_values</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="algorithms_2rcfr_8py_source.html#l00175">175</a> of file <a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="algorithms_2rcfr_8py_source.html#l00181">open_spiel.python.algorithms.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="pytorch_2rcfr_8py_source.html#l00172">open_spiel.python.pytorch.rcfr.RootStateWrapper._walk_descendants()</a>, <a class="el" href="algorithms_2rcfr_8py_source.html#l00270">open_spiel.python.algorithms.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>, and <a class="el" href="pytorch_2rcfr_8py_source.html#l00261">open_spiel.python.pytorch.rcfr.RootStateWrapper.counterfactual_regrets_and_reach_weights()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>open_spiel/python/algorithms/<a class="el" href="algorithms_2rcfr_8py_source.html">rcfr.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
