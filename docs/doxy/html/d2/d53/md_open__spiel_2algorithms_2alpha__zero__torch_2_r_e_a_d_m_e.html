<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: C++ LibTorch-based AlphaZero</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">C++ LibTorch-based AlphaZero</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md39"></a> This is a C++ implementation of the AlphaZero algorithm based on LibTorch, similar to the C++ TF-based AlphaZero.</p>
<p>To build and use this implementation, you must set the optional global variables <code>OPEN_SPIEL_BUILD_WITH_LIBTORCH</code> and <code>OPEN_SPIEL_BUILD_WITH_LIBNOP</code> to <code>ON</code> when installing dependencies and building OpenSpiel.</p>
<p><b>Note</b>: Note: there are currently known problems with the C++ PyTorch: inteferences with pybind11 versions. Until it is properly fixed, please see <a href="https://github.com/deepmind/open_spiel/issues/966#issuecomment-1322982393">the workaround described here</a>.</p>
<p>Then, to get started, see <code>examples/alpha_zero_torch_example.cc</code>.</p>
<p>Important note: this implementation was a user contribution (see <a href="https://github.com/deepmind/open_spiel/pull/319">this PR</a>), and is not regularly tested nor maintained by the core team. This means that, at any time, it may not build or work as originally intended due to a change that will not have been caught by our tests. Hence, if bugs occur, please open an issue to let us know so we can fix them.</p>
<p>This code was structured in a similar way to the TF-based C++ AlphaZero, using several of the same components. If you have any questions, feel free to ask the original author Christian Jans directly by following up on the PR linked above. The PR also includes some results of experiments run using this implementation that may be useful.</p>
<h1><a class="anchor" id="autotoc_md40"></a>
Setting up LibTorch AlphaZero</h1>
<ol type="1">
<li>In <a href="../../../../scripts/global_variables.sh">global_variables.sh</a>, find the <code>OPEN_SPIEL_BUILD_WITH_LIBNOP</code> variable and set its value to <code>"ON"</code>.</li>
<li>In <a href="../../../../scripts/global_variables.sh">global_variables.sh</a>, find the <code>OPEN_SPIEL_BUILD_WITH_LIBTORCH</code> variable and set its value to <code>"ON"</code>.</li>
<li>In <a href="../../../../scripts/global_variables.sh">global_variables.sh</a>, find the <code>OPEN_SPIEL_BUILD_WITH_LIBTORCH_DOWNLOAD_URL</code> variable and set its value to the LibTorch version URL compatible with your OS and hardware (see the comments in global_variables.sh for the URLs):</li>
<li>Download libnop and the specified version of LibTorch by running: <code>bash $ ./install.sh </code></li>
<li>Build OpenSpiel to compile LibTorch-dependent and libnop-dependent code (such as LibTorch AlphaZero). <code>bash $ ./open_spiel/scripts/build_and_run_tests.sh </code></li>
</ol>
<p><b>Note:</b> If you are building from CentOS and/or encounter missing symbol errors (e.g. undefined reference to <code>memcpy@GLIBC_2.14</code>, <code>lgamma@GLIBC_2.23</code>, etc.), see solution steps described in <a href="https://github.com/deepmind/open_spiel/issues/619#issuecomment-854126238">this issue</a>.</p>
<h1><a class="anchor" id="autotoc_md41"></a>
Starting LibTorch AlphaZero Training</h1>
<p>Starting training from scratch can be done by running <code>alpha_zero_torch_example</code>: </p><div class="fragment"><div class="line">$ ./build/examples/alpha_zero_torch_example --game=tic_tac_toe --path=/home/me/az_example/</div>
</div><!-- fragment --><p> Run with the <code>--help</code> flag to see a complete list of flags and a brief description of each.</p>
<h1><a class="anchor" id="autotoc_md42"></a>
Resuming LibTorch AlphaZero Training</h1>
<p>Training can be resumed from the most recent checkpoint by providing the path to the <code>config.json</code> (which is created during the initial training run) as a positional argument: </p><div class="fragment"><div class="line">$ ./build/examples/alpha_zero_torch_example /home/me/az_example/config.json</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md43"></a>
Playing a Trained LibTorch AlphaZero</h1>
<p>A trained LibTorch AlphaZero can be played by running <code>alpha_zero_torch_game_example</code>: </p><div class="fragment"><div class="line">$ ./build/examples/alpha_zero_torch_game_example --game=tic_tac_toe --player1=az --player2=mcts --az_path=/home/me/az_example/ --az_checkpoint=-1</div>
</div><!-- fragment --><p> Run with the <code>--help</code> flag to see a complete list of flags and a brief description of each. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
