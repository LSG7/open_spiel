<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel::algorithms::torch_az Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1algorithms.html">algorithms</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html">torch_az</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">open_spiel::algorithms::torch_az Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html">DeviceManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html">EvalResults</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_m_l_p_block_impl.html">MLPBlockImpl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_m_l_p_output_block_impl.html">MLPOutputBlockImpl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_model_impl.html">ModelImpl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_res_input_block_config.html">ResInputBlockConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_res_input_block_impl.html">ResInputBlockImpl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_res_output_block_config.html">ResOutputBlockConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_res_output_block_impl.html">ResOutputBlockImpl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_res_torso_block_config.html">ResTorsoBlockConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_res_torso_block_impl.html">ResTorsoBlockImpl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html">StartInfo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_evaluator.html">VPNetEvaluator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html">VPNetModel</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a812e290fffa06f3d711e2035347de6e4" id="r_a812e290fffa06f3d711e2035347de6e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html">StartInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a812e290fffa06f3d711e2035347de6e4">StartInfoFromLearnerJson</a> (const std::string &amp;path)</td></tr>
<tr class="separator:a812e290fffa06f3d711e2035347de6e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e57a250c58223d4f65dddb330040d9" id="r_a50e57a250c58223d4f65dddb330040d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50e57a250c58223d4f65dddb330040d9">PlayGame</a> (<a class="el" href="classopen__spiel_1_1_logger.html">Logger</a> *logger, int game_num, const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;game, std::vector&lt; std::unique_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1_m_c_t_s_bot.html">MCTSBot</a> &gt; &gt; *bots, std::mt19937 *rng, double temperature, int temperature_drop, double cutoff_value, bool verbose=false)</td></tr>
<tr class="separator:a50e57a250c58223d4f65dddb330040d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5401114eb4044a0bc75f914348e5099" id="r_aa5401114eb4044a0bc75f914348e5099"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1_m_c_t_s_bot.html">MCTSBot</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5401114eb4044a0bc75f914348e5099">InitAZBot</a> (const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;config, const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;game, std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1_evaluator.html">Evaluator</a> &gt; <a class="el" href="#a93a78c3862b261da879f8fa47863e224">evaluator</a>, bool evaluation)</td></tr>
<tr class="separator:aa5401114eb4044a0bc75f914348e5099"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ce4e92571dc52dbf4adc2c85c0aeb0d" id="r_a6ce4e92571dc52dbf4adc2c85c0aeb0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ce4e92571dc52dbf4adc2c85c0aeb0d">actor</a> (const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;game, const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;config, int <a class="el" href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>, <a class="el" href="classopen__spiel_1_1_threaded_queue.html">ThreadedQueue</a>&lt; <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a> &gt; *trajectory_queue, std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_evaluator.html">VPNetEvaluator</a> &gt; vp_eval, <a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *stop)</td></tr>
<tr class="separator:a6ce4e92571dc52dbf4adc2c85c0aeb0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93a78c3862b261da879f8fa47863e224" id="r_a93a78c3862b261da879f8fa47863e224"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93a78c3862b261da879f8fa47863e224">evaluator</a> (const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;game, const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;config, int <a class="el" href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>, <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html">EvalResults</a> *results, std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_evaluator.html">VPNetEvaluator</a> &gt; vp_eval, <a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *stop)</td></tr>
<tr class="separator:a93a78c3862b261da879f8fa47863e224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116924f1114dd4ba855b9028b443fff2" id="r_a116924f1114dd4ba855b9028b443fff2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a116924f1114dd4ba855b9028b443fff2">learner</a> (const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;game, const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;config, <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html">DeviceManager</a> *device_manager, std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_evaluator.html">VPNetEvaluator</a> &gt; eval, <a class="el" href="classopen__spiel_1_1_threaded_queue.html">ThreadedQueue</a>&lt; <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a> &gt; *trajectory_queue, <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html">EvalResults</a> *eval_results, <a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *stop, const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html">StartInfo</a> &amp;start_info)</td></tr>
<tr class="separator:a116924f1114dd4ba855b9028b443fff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141f9989682f14bd0a5d4e153d4e2fd4" id="r_a141f9989682f14bd0a5d4e153d4e2fd4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a141f9989682f14bd0a5d4e153d4e2fd4">AlphaZero</a> (<a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> config, <a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *stop, bool resuming)</td></tr>
<tr class="separator:a141f9989682f14bd0a5d4e153d4e2fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654d47127d86b175b6fbb09a5fc990b2" id="r_a654d47127d86b175b6fbb09a5fc990b2"><td class="memItemLeft" align="right" valign="top">std::istream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a654d47127d86b175b6fbb09a5fc990b2">operator&gt;&gt;</a> (std::istream &amp;stream, <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> &amp;config)</td></tr>
<tr class="separator:a654d47127d86b175b6fbb09a5fc990b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0467afc46ef19d4d99fe243c171721fa" id="r_a0467afc46ef19d4d99fe243c171721fa"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0467afc46ef19d4d99fe243c171721fa">operator&lt;&lt;</a> (std::ostream &amp;stream, const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> &amp;config)</td></tr>
<tr class="separator:a0467afc46ef19d4d99fe243c171721fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a55556f7c3be87ce31808db62f9c98f" id="r_a1a55556f7c3be87ce31808db62f9c98f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a55556f7c3be87ce31808db62f9c98f">TORCH_MODULE</a> (ResInputBlock)</td></tr>
<tr class="separator:a1a55556f7c3be87ce31808db62f9c98f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919778bcd5aec8a8418d825d12b59b7d" id="r_a919778bcd5aec8a8418d825d12b59b7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a919778bcd5aec8a8418d825d12b59b7d">TORCH_MODULE</a> (ResTorsoBlock)</td></tr>
<tr class="separator:a919778bcd5aec8a8418d825d12b59b7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0588dda1c353f6d26ea04e1f5098ca01" id="r_a0588dda1c353f6d26ea04e1f5098ca01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0588dda1c353f6d26ea04e1f5098ca01">TORCH_MODULE</a> (ResOutputBlock)</td></tr>
<tr class="separator:a0588dda1c353f6d26ea04e1f5098ca01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad12240e5450fc2c9e2946f6388d59da2" id="r_ad12240e5450fc2c9e2946f6388d59da2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad12240e5450fc2c9e2946f6388d59da2">TORCH_MODULE</a> (MLPBlock)</td></tr>
<tr class="separator:ad12240e5450fc2c9e2946f6388d59da2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd268144d66f4661b9243fd74d92b2db" id="r_afd268144d66f4661b9243fd74d92b2db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afd268144d66f4661b9243fd74d92b2db">TORCH_MODULE</a> (MLPOutputBlock)</td></tr>
<tr class="separator:afd268144d66f4661b9243fd74d92b2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05778b3c19d991920d68c3dde16c92f" id="r_af05778b3c19d991920d68c3dde16c92f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af05778b3c19d991920d68c3dde16c92f">TORCH_MODULE</a> (Model)</td></tr>
<tr class="separator:af05778b3c19d991920d68c3dde16c92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e1169d351ea651f9f0577190f31190" id="r_a74e1169d351ea651f9f0577190f31190"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74e1169d351ea651f9f0577190f31190">SaveModelConfig</a> (const std::string &amp;path, const std::string &amp;filename, const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> &amp;net_config)</td></tr>
<tr class="separator:a74e1169d351ea651f9f0577190f31190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dbd22df502a575efc78f7b5d627d746" id="r_a4dbd22df502a575efc78f7b5d627d746"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4dbd22df502a575efc78f7b5d627d746">LoadModelConfig</a> (const std::string &amp;path, const std::string &amp;filename)</td></tr>
<tr class="separator:a4dbd22df502a575efc78f7b5d627d746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e151002142b677bb6393e692b172856" id="r_a1e151002142b677bb6393e692b172856"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e151002142b677bb6393e692b172856">TorchDeviceName</a> (const std::string &amp;device)</td></tr>
<tr class="separator:a1e151002142b677bb6393e692b172856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a961b83641d3a89f6507458f98a273132" id="r_a961b83641d3a89f6507458f98a273132"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a961b83641d3a89f6507458f98a273132">CreateGraphDef</a> (const <a class="el" href="classopen__spiel_1_1_game.html">Game</a> &amp;game, double learning_rate, double weight_decay, const std::string &amp;path, const std::string &amp;filename, std::string nn_model, int nn_width, int nn_depth, bool verbose)</td></tr>
<tr class="separator:a961b83641d3a89f6507458f98a273132"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6ce4e92571dc52dbf4adc2c85c0aeb0d" name="a6ce4e92571dc52dbf4adc2c85c0aeb0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ce4e92571dc52dbf4adc2c85c0aeb0d">&#9670;&#160;</a></span>actor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void open_spiel::algorithms::torch_az::actor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1_threaded_queue.html">ThreadedQueue</a>&lt; <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>trajectory_queue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_evaluator.html">VPNetEvaluator</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>vp_eval</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *</td>          <td class="paramname"><span class="paramname"><em>stop</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="alpha__zero_8cc_source.html#l00179">179</a> of file <a class="el" href="alpha__zero_8cc_source.html">alpha_zero.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  181</span>                                                                   {</div>
<div class="line"><span class="lineno">  182</span>  std::unique_ptr&lt;Logger&gt; logger;</div>
<div class="line"><span class="lineno">  183</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a> &lt; 20) {  <span class="comment">// Limit the number of open files.</span></div>
<div class="line"><span class="lineno">  184</span>    logger.reset(<span class="keyword">new</span> <a class="code hl_class" href="classopen__spiel_1_1_file_logger.html">FileLogger</a>(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>, <a class="code hl_function" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df">absl::StrCat</a>(<span class="stringliteral">&quot;actor-&quot;</span>, <a class="code hl_variable" href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>)));</div>
<div class="line"><span class="lineno">  185</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  186</span>    logger.reset(<span class="keyword">new</span> <a class="code hl_class" href="classopen__spiel_1_1_noop_logger.html">NoopLogger</a>());</div>
<div class="line"><span class="lineno">  187</span>  }</div>
<div class="line"><span class="lineno">  188</span>  std::mt19937 rng(<a class="code hl_function" href="namespaceabsl.html#ae79026cc56809b3cbb42198d6419d144">absl::ToUnixNanos</a>(<a class="code hl_function" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb">absl::Now</a>()));</div>
<div class="line"><span class="lineno">  189</span>  <a class="code hl_class" href="classabsl_1_1uniform__real__distribution.html">absl::uniform_real_distribution&lt;double&gt;</a> dist(0.0, 1.0);</div>
<div class="line"><span class="lineno">  190</span>  std::vector&lt;std::unique_ptr&lt;MCTSBot&gt;&gt; bots;</div>
<div class="line"><span class="lineno">  191</span>  bots.reserve(2);</div>
<div class="line"><span class="lineno">  192</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a> = 0; <a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a> &lt; 2; <a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>++) {</div>
<div class="line"><span class="lineno">  193</span>    bots.push_back(InitAZBot(config, game, vp_eval, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  194</span>  }</div>
<div class="line"><span class="lineno">  195</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> game_num = 1; !stop-&gt;<a class="code hl_function" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075">StopRequested</a>(); ++game_num) {</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordtype">double</span> cutoff =</div>
<div class="line"><span class="lineno">  197</span>        (dist(rng) &lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1700d5f185a3804f040af626bce8c4fe">cutoff_probability</a> ? config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a267b8c7dbba54a3044d74c5689ed8099">cutoff_value</a></div>
<div class="line"><span class="lineno">  198</span>                                               : game.MaxUtility() + 1);</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (!trajectory_queue-&gt;<a class="code hl_function" href="classopen__spiel_1_1_threaded_queue.html#a6e080c0d5c7376ab6c6018088d405178">Push</a>(</div>
<div class="line"><span class="lineno">  200</span>            <a class="code hl_function" href="simple__gin__rummy__bot__example_8cc.html#a70e8a75d545a109419ffb09fc16be6f6">PlayGame</a>(logger.get(), game_num, game, &amp;bots, &amp;rng,</div>
<div class="line"><span class="lineno">  201</span>                     config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a754db4c4608b490cc764459331869702">temperature</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#aa20176336145d96f512a9c5f0c22f2cf">temperature_drop</a>, cutoff),</div>
<div class="line"><span class="lineno">  202</span>            <a class="code hl_function" href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67">absl::Seconds</a>(10))) {</div>
<div class="line"><span class="lineno">  203</span>      logger-&gt;Print(<span class="stringliteral">&quot;Failed to push a trajectory after 10 seconds.&quot;</span>);</div>
<div class="line"><span class="lineno">  204</span>    }</div>
<div class="line"><span class="lineno">  205</span>  }</div>
<div class="line"><span class="lineno">  206</span>  logger-&gt;Print(<span class="stringliteral">&quot;Got a quit.&quot;</span>);</div>
<div class="line"><span class="lineno">  207</span>}</div>
<div class="ttc" id="abasic__tests_8cc_html_af61d6983a9396a11078805087518af88"><div class="ttname"><a href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a></div><div class="ttdeci">Player player</div><div class="ttdef"><b>Definition</b> <a href="basic__tests_8cc_source.html#l00050">basic_tests.cc:50</a></div></div>
<div class="ttc" id="abtree__test_8cc_html_a86cf672daa4e0ad11ad10efc894d19c8"><div class="ttname"><a href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a></div><div class="ttdeci">int num</div><div class="ttdef"><b>Definition</b> <a href="btree__test_8cc_source.html#l01584">btree_test.cc:1584</a></div></div>
<div class="ttc" id="aclassabsl_1_1uniform__real__distribution_html"><div class="ttname"><a href="classabsl_1_1uniform__real__distribution.html">absl::uniform_real_distribution</a></div><div class="ttdef"><b>Definition</b> <a href="uniform__real__distribution_8h_source.html#l00064">uniform_real_distribution.h:64</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_file_logger_html"><div class="ttname"><a href="classopen__spiel_1_1_file_logger.html">open_spiel::FileLogger</a></div><div class="ttdef"><b>Definition</b> <a href="logger_8h_source.html#l00043">logger.h:43</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_noop_logger_html"><div class="ttname"><a href="classopen__spiel_1_1_noop_logger.html">open_spiel::NoopLogger</a></div><div class="ttdef"><b>Definition</b> <a href="logger_8h_source.html#l00068">logger.h:68</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_stop_token_html_a6f24b7509d39170e844de885122de075"><div class="ttname"><a href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075">open_spiel::StopToken::StopRequested</a></div><div class="ttdeci">bool StopRequested() const</div><div class="ttdef"><b>Definition</b> <a href="thread_8h_source.html#l00050">thread.h:50</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_threaded_queue_html_a6e080c0d5c7376ab6c6018088d405178"><div class="ttname"><a href="classopen__spiel_1_1_threaded_queue.html#a6e080c0d5c7376ab6c6018088d405178">open_spiel::ThreadedQueue::Push</a></div><div class="ttdeci">bool Push(const T &amp;value)</div><div class="ttdef"><b>Definition</b> <a href="threaded__queue_8h_source.html#l00034">threaded_queue.h:34</a></div></div>
<div class="ttc" id="anamespaceabsl_html_a0a9abdb6ee6367339931d4cab29d50df"><div class="ttname"><a href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df">absl::StrCat</a></div><div class="ttdeci">ABSL_MUST_USE_RESULT std::string StrCat()</div><div class="ttdef"><b>Definition</b> <a href="str__cat_8h_source.html#l00381">str_cat.h:381</a></div></div>
<div class="ttc" id="anamespaceabsl_html_a1e6efc5516746f611fed68ca25227f67"><div class="ttname"><a href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67">absl::Seconds</a></div><div class="ttdeci">ABSL_ATTRIBUTE_CONST_FUNCTION constexpr Duration Seconds(T n)</div><div class="ttdef"><b>Definition</b> <a href="time_8h_source.html#l00451">time.h:451</a></div></div>
<div class="ttc" id="anamespaceabsl_html_a316c486d0d8e740b8ead5b7638d14dbb"><div class="ttname"><a href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb">absl::Now</a></div><div class="ttdeci">ABSL_NAMESPACE_BEGIN Time Now()</div><div class="ttdef"><b>Definition</b> <a href="clock_8cc_source.html#l00039">clock.cc:39</a></div></div>
<div class="ttc" id="anamespaceabsl_html_ae79026cc56809b3cbb42198d6419d144"><div class="ttname"><a href="namespaceabsl.html#ae79026cc56809b3cbb42198d6419d144">absl::ToUnixNanos</a></div><div class="ttdeci">int64_t ToUnixNanos(Time t)</div><div class="ttdef"><b>Definition</b> <a href="time_8cc_source.html#l00243">time.cc:243</a></div></div>
<div class="ttc" id="asimple__gin__rummy__bot__example_8cc_html_a70e8a75d545a109419ffb09fc16be6f6"><div class="ttname"><a href="simple__gin__rummy__bot__example_8cc.html#a70e8a75d545a109419ffb09fc16be6f6">PlayGame</a></div><div class="ttdeci">std::vector&lt; double &gt; PlayGame(const open_spiel::Game &amp;game, const std::vector&lt; std::unique_ptr&lt; open_spiel::Bot &gt; &gt; &amp;bots, std::mt19937 *rng, std::ostream &amp;os, bool verbose, bool show_legals, bool log_histories, bool log_returns, bool log_reach_probs)</div><div class="ttdef"><b>Definition</b> <a href="simple__gin__rummy__bot__example_8cc_source.html#l00065">simple_gin_rummy_bot_example.cc:65</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a1700d5f185a3804f040af626bce8c4fe"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1700d5f185a3804f040af626bce8c4fe">open_spiel::algorithms::torch_az::AlphaZeroConfig::cutoff_probability</a></div><div class="ttdeci">double cutoff_probability</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00057">alpha_zero.h:57</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a267b8c7dbba54a3044d74c5689ed8099"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a267b8c7dbba54a3044d74c5689ed8099">open_spiel::algorithms::torch_az::AlphaZeroConfig::cutoff_value</a></div><div class="ttdeci">double cutoff_value</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00058">alpha_zero.h:58</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a55d9ee521fa0206897c132cb9812783d"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">open_spiel::algorithms::torch_az::AlphaZeroConfig::path</a></div><div class="ttdeci">std::string path</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00032">alpha_zero.h:32</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a754db4c4608b490cc764459331869702"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a754db4c4608b490cc764459331869702">open_spiel::algorithms::torch_az::AlphaZeroConfig::temperature</a></div><div class="ttdeci">double temperature</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00055">alpha_zero.h:55</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_aa20176336145d96f512a9c5f0c22f2cf"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#aa20176336145d96f512a9c5f0c22f2cf">open_spiel::algorithms::torch_az::AlphaZeroConfig::temperature_drop</a></div><div class="ttdeci">double temperature_drop</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00056">alpha_zero.h:56</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="alpha__zero_8h_source.html#l00057">open_spiel::algorithms::torch_az::AlphaZeroConfig::cutoff_probability</a>, <a class="el" href="alpha__zero_8h_source.html#l00058">open_spiel::algorithms::torch_az::AlphaZeroConfig::cutoff_value</a>, <a class="el" href="alpha__zero_8cc_source.html#l00163">InitAZBot()</a>, <a class="el" href="clock_8cc_source.html#l00039">absl::Now()</a>, <a class="el" href="btree__test_8cc_source.html#l01584">num</a>, <a class="el" href="alpha__zero_8h_source.html#l00032">open_spiel::algorithms::torch_az::AlphaZeroConfig::path</a>, <a class="el" href="basic__tests_8cc_source.html#l00050">player</a>, <a class="el" href="alpha__zero_8cc_source.html#l00104">PlayGame()</a>, <a class="el" href="threaded__queue_8h_source.html#l00034">open_spiel::ThreadedQueue&lt; T &gt;::Push()</a>, <a class="el" href="time_8h_source.html#l00451">absl::Seconds()</a>, <a class="el" href="thread_8h_source.html#l00050">open_spiel::StopToken::StopRequested()</a>, <a class="el" href="str__cat_8h_source.html#l00381">absl::StrCat()</a>, <a class="el" href="alpha__zero_8h_source.html#l00055">open_spiel::algorithms::torch_az::AlphaZeroConfig::temperature</a>, <a class="el" href="alpha__zero_8h_source.html#l00056">open_spiel::algorithms::torch_az::AlphaZeroConfig::temperature_drop</a>, and <a class="el" href="time_8cc_source.html#l00243">absl::ToUnixNanos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="alpha__zero_8cc_source.html#l00496">AlphaZero()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_cgraph">
<area shape="rect" title=" " alt="" coords="5,292,157,333"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#aa5401114eb4044a0bc75f914348e5099" title=" " alt="" coords="221,42,372,82"/>
<area shape="poly" title=" " alt="" coords="86,291,101,250,125,197,159,142,180,116,203,93,209,89,212,93,206,98,184,120,163,145,130,200,106,252,91,293"/>
<area shape="rect" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb" title=" " alt="" coords="256,196,336,222"/>
<area shape="poly" title=" " alt="" coords="124,290,253,226,255,231,126,294"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a50e57a250c58223d4f65dddb330040d9" title=" " alt="" coords="221,516,372,557"/>
<area shape="poly" title=" " alt="" coords="104,332,267,503,263,507,100,335"/>
<area shape="rect" href="classopen__spiel_1_1_threaded_queue.html#a6e080c0d5c7376ab6c6018088d405178" title=" " alt="" coords="205,131,388,172"/>
<area shape="poly" title=" " alt="" coords="95,290,140,237,170,207,203,181,211,177,213,181,206,186,173,211,143,240,99,294"/>
<area shape="rect" href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67" title=" " alt="" coords="244,275,348,300"/>
<area shape="poly" title=" " alt="" coords="157,301,229,293,229,298,158,307"/>
<area shape="rect" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075" title=" " alt="" coords="220,582,373,622"/>
<area shape="poly" title=" " alt="" coords="89,333,102,380,125,443,159,509,181,540,206,567,212,571,208,575,203,571,177,543,155,512,120,445,97,382,84,334"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="251,647,342,672"/>
<area shape="poly" title=" " alt="" coords="87,333,95,392,115,473,130,516,150,559,176,598,206,632,220,642,236,649,234,654,218,647,203,636,171,601,146,561,125,518,109,475,90,393,81,334"/>
<area shape="rect" href="namespaceabsl.html#ae79026cc56809b3cbb42198d6419d144" title=" " alt="" coords="230,328,362,354"/>
<area shape="poly" title=" " alt="" coords="158,320,215,328,214,333,157,325"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a03ac95838baccb5f128b99788affe9f7" title=" " alt="" coords="462,106,597,146"/>
<area shape="poly" title=" " alt="" coords="336,197,387,181,435,156,449,150,451,155,437,161,389,186,338,202"/>
<area shape="rect" href="namespaceabsl.html#a466f5e42bfba7b7295daaa10d530172e" title=" " alt="" coords="437,171,621,196"/>
<area shape="poly" title=" " alt="" coords="336,202,421,193,421,198,337,207"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a08534fb0fd3d4cc76f89c49ea990770b" title=" " alt="" coords="1084,48,1211,89"/>
<area shape="poly" title=" " alt="" coords="336,202,362,195,386,181,396,171,402,160,408,137,415,113,422,102,435,92,485,71,555,58,639,50,730,47,916,50,1069,59,1068,65,916,55,730,52,639,55,556,63,487,76,437,96,426,105,420,115,413,138,407,162,401,174,390,186,364,200,338,207"/>
<area shape="rect" href="namespaceabsl.html#a9c808ce1e415bc23b0303e96414e404a" title=" " alt="" coords="462,220,596,246"/>
<area shape="poly" title=" " alt="" coords="337,210,447,222,447,227,336,216"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a38be6aa6cfdce9ed5fe2adf2c1a300bc" title=" " alt="" coords="677,212,805,253"/>
<area shape="poly" title=" " alt="" coords="596,230,661,230,661,236,596,236"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a159819a84704eb739e572c4a49a5a238" title=" " alt="" coords="860,159,1036,200"/>
<area shape="poly" title=" " alt="" coords="805,214,851,202,853,207,806,219"/>
<area shape="poly" title=" " alt="" coords="985,156,1095,95,1097,99,988,161"/>
<area shape="rect" href="namespaceopen__spiel.html#af4e1a06b98575bc24c84e635a12efec4" title=" " alt="" coords="436,736,622,762"/>
<area shape="poly" title=" " alt="" coords="373,556,390,568,403,584,410,599,416,630,421,660,427,675,438,691,459,711,483,726,480,731,456,715,434,695,422,678,416,661,411,631,405,601,398,587,386,572,370,560"/>
<area shape="rect" href="classopen__spiel_1_1_logger.html#a2ac1d943258600354c2853700fd5a8f0" title=" " alt="" coords="464,516,594,557"/>
<area shape="poly" title=" " alt="" coords="372,534,448,534,448,540,372,540"/>
<area shape="rect" href="namespaceopen__spiel.html#a5eb64a0ea2eb4de455fbb51e4824c65b" title=" " alt="" coords="443,605,615,631"/>
<area shape="poly" title=" " alt="" coords="358,555,476,597,474,602,356,560"/>
<area shape="rect" href="namespaceabsl.html#a66735d042e8e255930c66b67f3b39244" title=" " alt="" coords="482,655,576,680"/>
<area shape="poly" title=" " alt="" coords="370,555,390,568,406,587,414,606,422,624,438,641,468,656,466,661,434,646,417,627,409,608,402,590,386,572,367,560"/>
<area shape="rect" href="namespaceabsl.html#ae6fbe921bb3366983a0c238625d1048f" title=" " alt="" coords="674,736,808,762"/>
<area shape="poly" title=" " alt="" coords="623,746,658,746,658,752,623,752"/>
<area shape="rect" href="namespaceabsl.html#af37cda8b31ee20257caf8799ed35a66e" title=" " alt="" coords="682,785,800,811"/>
<area shape="poly" title=" " alt="" coords="588,760,669,779,667,784,587,765"/>
<area shape="rect" href="namespaceabsl_1_1container__algorithm__internal.html#a06daa82467b235da8b6b9b1d09b520a1" title=" " alt="" coords="865,794,1031,834"/>
<area shape="poly" title=" " alt="" coords="785,760,867,786,866,791,783,765"/>
<area shape="rect" href="namespaceabsl_1_1container__algorithm__internal.html#a00879fc0ada934de06b3b429cecddb57" title=" " alt="" coords="865,728,1031,769"/>
<area shape="poly" title=" " alt="" coords="809,746,849,746,849,752,809,752"/>
<area shape="poly" title=" " alt="" coords="801,800,849,804,849,809,800,805"/>
<area shape="poly" title=" " alt="" coords="797,782,849,770,850,775,799,787"/>
<area shape="poly" title=" " alt="" coords="494,607,487,597,491,587,506,581,529,579,555,581,568,588,566,593,554,586,529,584,507,586,495,591,492,596,498,603"/>
<area shape="rect" href="namespaceabsl.html#af52417fc36b2948cfca4fae144b0046f" title=" " alt="" coords="691,540,791,566"/>
<area shape="poly" title=" " alt="" coords="573,602,681,568,683,573,574,607"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#a0eebfd02e61f2e234a5295efe985f198" title=" " alt="" coords="867,499,1029,540"/>
<area shape="poly" title=" " alt="" coords="791,542,851,532,852,538,792,547"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#ab540f8d00b33fedfcd4c8044b16ca079" title=" " alt="" coords="872,564,1024,605"/>
<area shape="poly" title=" " alt="" coords="792,558,857,568,856,573,791,563"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#a8207d795f98f94f497a3e777e2a26084" title=" " alt="" coords="871,434,1024,474"/>
<area shape="poly" title=" " alt="" coords="763,537,858,485,874,478,876,483,861,490,766,542"/>
<area shape="rect" href="namespaceabsl_1_1strings__internal.html#ad5b694c25b0f1ab42df683172f72e1ce" title=" " alt="" coords="670,647,812,688"/>
<area shape="poly" title=" " alt="" coords="577,665,655,665,655,670,577,670"/>
<area shape="rect" href="classabsl_1_1string__view.html#acdd63d87adecc9cb89e3bb2c4efedf47" title=" " alt="" coords="872,679,1024,704"/>
<area shape="poly" title=" " alt="" coords="812,673,856,678,856,684,812,678"/>
<area shape="rect" href="classabsl_1_1string__view.html#a3950f228eccec8f88e34b9a90ad94428" title=" " alt="" coords="872,629,1024,655"/>
<area shape="poly" title=" " alt="" coords="812,656,856,651,857,656,812,661"/>
<area shape="poly" title=" " alt="" coords="256,131,254,121,260,112,275,107,296,105,320,107,334,113,331,118,318,112,296,110,276,112,263,116,259,122,261,130"/>
<area shape="rect" href="namespaceabsl.html#a6ab40a82498f46a1bc88f451a24e54b7" title=" " alt="" coords="670,5,812,31"/>
<area shape="poly" title=" " alt="" coords="332,128,386,92,409,68,419,58,435,48,490,29,547,17,604,12,655,10,655,16,604,17,548,22,491,34,437,53,422,62,413,72,390,96,335,133"/>
<area shape="poly" title=" " alt="" coords="812,22,1036,48,1069,52,1068,58,1036,53,812,27"/>
<area shape="poly" title=" " alt="" coords="349,282,474,273,622,256,662,248,663,254,623,261,474,278,349,287"/>
<area shape="poly" title=" " alt="" coords="347,325,387,310,444,282,494,252,496,257,447,286,389,315,349,330"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a383fceb1e978fc587346bd616c98d556" title=" " alt="" coords="466,320,593,361"/>
<area shape="poly" title=" " alt="" coords="363,338,450,338,450,344,363,344"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a4d3d91a4c3d19a402680e6787081c14d" title=" " alt="" coords="466,386,593,426"/>
<area shape="poly" title=" " alt="" coords="346,352,451,382,450,387,344,357"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a2a5fe21c8d0c6a1f31d2f79253aebda6" title=" " alt="" coords="466,451,593,492"/>
<area shape="poly" title=" " alt="" coords="315,352,368,392,437,436,452,443,450,448,435,441,365,397,312,356"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a6ce4e92571dc52dbf4adc2c85c0aeb0d_icgraph">
<area shape="rect" title=" " alt="" coords="205,5,356,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,5,157,46"/>
<area shape="poly" title=" " alt="" coords="189,28,157,28,157,23,189,23"/>
</map>
</div>

</div>
</div>
<a id="a141f9989682f14bd0a5d4e153d4e2fd4" name="a141f9989682f14bd0a5d4e153d4e2fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a141f9989682f14bd0a5d4e153d4e2fd4">&#9670;&#160;</a></span>AlphaZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool open_spiel::algorithms::torch_az::AlphaZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a></td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *</td>          <td class="paramname"><span class="paramname"><em>stop</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>resuming</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="alpha__zero_8cc_source.html#l00496">496</a> of file <a class="el" href="alpha__zero_8cc_source.html">alpha_zero.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  496</span>                                                                       {</div>
<div class="line"><span class="lineno">  497</span>  std::shared_ptr&lt;const open_spiel::Game&gt; game =</div>
<div class="line"><span class="lineno">  498</span>      <a class="code hl_function" href="namespaceopen__spiel.html#afd4ac299a038385def0ea56521067137">open_spiel::LoadGame</a>(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ad769002cc50fb833fedf67f35f9f06b3">game</a>);</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  <a class="code hl_struct" href="structopen__spiel_1_1_game_type.html">open_spiel::GameType</a> game_type = game-&gt;GetType();</div>
<div class="line"><span class="lineno">  501</span>  <span class="keywordflow">if</span> (game-&gt;NumPlayers() != 2)</div>
<div class="line"><span class="lineno">  502</span>    <a class="code hl_function" href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011">open_spiel::SpielFatalError</a>(<span class="stringliteral">&quot;AlphaZero can only handle 2-player games.&quot;</span>);</div>
<div class="line"><span class="lineno">  503</span>  <span class="keywordflow">if</span> (game_type.<a class="code hl_variable" href="structopen__spiel_1_1_game_type.html#aa72d7337710404c4a4c85cad77ad9992">reward_model</a> != <a class="code hl_enumvalue" href="structopen__spiel_1_1_game_type.html#a5a5f739de73ade6cfe6961fd4a2f41a5a217dd2f6ef26065693bb5043fce241ea">open_spiel::GameType::RewardModel::kTerminal</a>)</div>
<div class="line"><span class="lineno">  504</span>    <a class="code hl_function" href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011">open_spiel::SpielFatalError</a>(<span class="stringliteral">&quot;Game must have terminal rewards.&quot;</span>);</div>
<div class="line"><span class="lineno">  505</span>  <span class="keywordflow">if</span> (game_type.<a class="code hl_variable" href="structopen__spiel_1_1_game_type.html#ac1176bf5ed045dc24fb4b113af2750b8">dynamics</a> != <a class="code hl_enumvalue" href="structopen__spiel_1_1_game_type.html#a624349737f34cc67d0cf81fd7138c17baeb609b99f542b955302693c0f445ba0c">open_spiel::GameType::Dynamics::kSequential</a>)</div>
<div class="line"><span class="lineno">  506</span>    <a class="code hl_function" href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011">open_spiel::SpielFatalError</a>(<span class="stringliteral">&quot;Game must have sequential turns.&quot;</span>);</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>  file::Mkdirs(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>);</div>
<div class="line"><span class="lineno">  509</span>  <span class="keywordflow">if</span> (!file::IsDirectory(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>)) {</div>
<div class="line"><span class="lineno">  510</span>    std::cerr &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a> &lt;&lt; <span class="stringliteral">&quot; is not a directory.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  512</span>  }</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Logging directory: &quot;</span> &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>  <span class="keywordflow">if</span> (config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4b4dbf19d6c00112f8ba3270f6982a65">graph_def</a>.empty()) {</div>
<div class="line"><span class="lineno">  517</span>    config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4b4dbf19d6c00112f8ba3270f6982a65">graph_def</a> = <span class="stringliteral">&quot;vpnet.pb&quot;</span>;</div>
<div class="line"><span class="lineno">  518</span>    std::string model_path = <a class="code hl_function" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df">absl::StrCat</a>(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>, <span class="stringliteral">&quot;/&quot;</span>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4b4dbf19d6c00112f8ba3270f6982a65">graph_def</a>);</div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">if</span> (file::Exists(model_path)) {</div>
<div class="line"><span class="lineno">  520</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Overwriting existing model: &quot;</span> &lt;&lt; model_path &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  521</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  522</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Creating model: &quot;</span> &lt;&lt; model_path &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  523</span>    }</div>
<div class="line"><span class="lineno">  524</span>    <a class="code hl_define" href="spiel__utils_8h.html#ac998e613afb013e8bd31b3da80f747ae">SPIEL_CHECK_TRUE</a>(CreateGraphDef(</div>
<div class="line"><span class="lineno">  525</span>        *game, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ae3d3b7cc40f9aaeb911f4d29fb8400dc">learning_rate</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a73f8e2fc9e3e871bae516c4783d26c95">weight_decay</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>,</div>
<div class="line"><span class="lineno">  526</span>        config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4b4dbf19d6c00112f8ba3270f6982a65">graph_def</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#aad42392e5f18e7a2112744e61dab47a9">nn_model</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9dcc79de865c7f234369e9fd7e9c77f5">nn_width</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a7f100c7aee06687a74fe15d93182623c">nn_depth</a>));</div>
<div class="line"><span class="lineno">  527</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  528</span>    std::string model_path = <a class="code hl_function" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df">absl::StrCat</a>(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>, <span class="stringliteral">&quot;/&quot;</span>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4b4dbf19d6c00112f8ba3270f6982a65">graph_def</a>);</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">if</span> (file::Exists(model_path)) {</div>
<div class="line"><span class="lineno">  530</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Using existing model: &quot;</span> &lt;&lt; model_path &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  531</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  532</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Model not found: &quot;</span> &lt;&lt; model_path &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  533</span>    }</div>
<div class="line"><span class="lineno">  534</span>  }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Playing game: &quot;</span> &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ad769002cc50fb833fedf67f35f9f06b3">game</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>  config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a6513a45fa9318011c7c98159ac815602">inference_batch_size</a> = std::max(</div>
<div class="line"><span class="lineno">  539</span>      1,</div>
<div class="line"><span class="lineno">  540</span>      std::min(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a6513a45fa9318011c7c98159ac815602">inference_batch_size</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">actors</a> + config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a07dd2d2ec9867c3f3841ebc5adf8fbf1">evaluators</a>));</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>  config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a2b0812b3502033f9a15499817600007d">inference_threads</a> =</div>
<div class="line"><span class="lineno">  543</span>      std::max(1, std::min(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a2b0812b3502033f9a15499817600007d">inference_threads</a>,</div>
<div class="line"><span class="lineno">  544</span>                           (1 + config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">actors</a> + config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a07dd2d2ec9867c3f3841ebc5adf8fbf1">evaluators</a>) / 2));</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>  {</div>
<div class="line"><span class="lineno">  547</span>    file::File fd(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a> + <span class="stringliteral">&quot;/config.json&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  548</span>    fd.Write(json::ToString(config.<a class="code hl_function" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1446209ea2c61c45ff686cd02ca840c0">ToJson</a>(), <span class="keyword">true</span>) + <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  549</span>  }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>  StartInfo start_info = {<span class="comment">/*start_time=*/</span><a class="code hl_function" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb">absl::Now</a>(),</div>
<div class="line"><span class="lineno">  552</span>                          <span class="comment">/*start_step=*/</span>1,</div>
<div class="line"><span class="lineno">  553</span>                          <span class="comment">/*model_checkpoint_step=*/</span>0,</div>
<div class="line"><span class="lineno">  554</span>                          <span class="comment">/*total_trajectories=*/</span>0};</div>
<div class="line"><span class="lineno">  555</span>  <span class="keywordflow">if</span> (resuming) {</div>
<div class="line"><span class="lineno">  556</span>    start_info = <a class="code hl_function" href="#a812e290fffa06f3d711e2035347de6e4">StartInfoFromLearnerJson</a>(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>);</div>
<div class="line"><span class="lineno">  557</span>  }</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>  DeviceManager device_manager;</div>
<div class="line"><span class="lineno">  560</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_class" href="classabsl_1_1string__view.html">absl::string_view</a>&amp; device : <a class="code hl_namespace" href="namespaceabsl.html">absl</a>::<a class="code hl_function" href="namespaceabsl.html#a5f113a4d08f171c39b3b4f2709d154bb">StrSplit</a>(config.devices, <span class="stringliteral">&#39;,&#39;</span>)) {</div>
<div class="line"><span class="lineno">  561</span>    device_manager.AddDevice(</div>
<div class="line"><span class="lineno">  562</span>        VPNetModel(*game, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4b4dbf19d6c00112f8ba3270f6982a65">graph_def</a>, std::string(device)));</div>
<div class="line"><span class="lineno">  563</span>  }</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>  <span class="keywordflow">if</span> (device_manager.Count() == 0) {</div>
<div class="line"><span class="lineno">  566</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;No devices specified?&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  567</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  568</span>  }</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>  <span class="comment">// The explicit_learning option should only be used when multiple</span></div>
<div class="line"><span class="lineno">  571</span>  <span class="comment">// devices are available (so that inference can continue while</span></div>
<div class="line"><span class="lineno">  572</span>  <span class="comment">// also undergoing learning).</span></div>
<div class="line"><span class="lineno">  573</span>  <span class="keywordflow">if</span> (device_manager.Count() &lt;= 1 &amp;&amp; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1b154c87aa7db32356688042c269a7b0">explicit_learning</a>) {</div>
<div class="line"><span class="lineno">  574</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;Explicit learning can only be used with multiple devices.&quot;</span></div>
<div class="line"><span class="lineno">  575</span>              &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  577</span>  }</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>  std::cerr &lt;&lt; <span class="stringliteral">&quot;Loading model from step &quot;</span> &lt;&lt; start_info.model_checkpoint_step</div>
<div class="line"><span class="lineno">  580</span>            &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  581</span>  {  <span class="comment">// Make sure they&#39;re all in sync.</span></div>
<div class="line"><span class="lineno">  582</span>    <span class="keywordflow">if</span> (!resuming) {</div>
<div class="line"><span class="lineno">  583</span>      device_manager.Get(0)-&gt;SaveCheckpoint(start_info.model_checkpoint_step);</div>
<div class="line"><span class="lineno">  584</span>    }</div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> = 0; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> &lt; device_manager.Count(); ++<a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>) {</div>
<div class="line"><span class="lineno">  586</span>      device_manager.Get(0, <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>)-&gt;LoadCheckpoint(</div>
<div class="line"><span class="lineno">  587</span>          start_info.model_checkpoint_step);</div>
<div class="line"><span class="lineno">  588</span>    }</div>
<div class="line"><span class="lineno">  589</span>  }</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>  <span class="keyword">auto</span> eval = std::make_shared&lt;VPNetEvaluator&gt;(</div>
<div class="line"><span class="lineno">  592</span>      &amp;device_manager, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a6513a45fa9318011c7c98159ac815602">inference_batch_size</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a2b0812b3502033f9a15499817600007d">inference_threads</a>,</div>
<div class="line"><span class="lineno">  593</span>      config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a783b9be9bc7d41aee0ffc6013a4dd098">inference_cache</a>, (config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">actors</a> + config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a07dd2d2ec9867c3f3841ebc5adf8fbf1">evaluators</a>) / 16);</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>  ThreadedQueue&lt;Trajectory&gt; trajectory_queue(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#acf186cc5d9ab970bc1cf2d510144c697">replay_buffer_size</a> /</div>
<div class="line"><span class="lineno">  596</span>                                             config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a047e72a48e922dec6056a61e6cb0fd0e">replay_buffer_reuse</a>);</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>  EvalResults eval_results(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a0ca864d70acf6d100c65069d9bebc3b8">eval_levels</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a33e40b4c31e65020f21eb1370201a5da">evaluation_window</a>);</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>  std::vector&lt;Thread&gt; actors;</div>
<div class="line"><span class="lineno">  601</span>  actors.reserve(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">actors</a>);</div>
<div class="line"><span class="lineno">  602</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> = 0; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> &lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">actors</a>; ++<a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>) {</div>
<div class="line"><span class="lineno">  603</span>    actors.emplace_back(</div>
<div class="line"><span class="lineno">  604</span>        [&amp;, <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>]() { <a class="code hl_function" href="#a6ce4e92571dc52dbf4adc2c85c0aeb0d">actor</a>(*game, config, <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>, &amp;trajectory_queue, eval, stop); });</div>
<div class="line"><span class="lineno">  605</span>  }</div>
<div class="line"><span class="lineno">  606</span>  std::vector&lt;Thread&gt; evaluators;</div>
<div class="line"><span class="lineno">  607</span>  evaluators.reserve(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a07dd2d2ec9867c3f3841ebc5adf8fbf1">evaluators</a>);</div>
<div class="line"><span class="lineno">  608</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> = 0; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> &lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a07dd2d2ec9867c3f3841ebc5adf8fbf1">evaluators</a>; ++<a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>) {</div>
<div class="line"><span class="lineno">  609</span>    evaluators.emplace_back(</div>
<div class="line"><span class="lineno">  610</span>        [&amp;, <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>]() { evaluator(*game, config, <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>, &amp;eval_results, eval, stop); });</div>
<div class="line"><span class="lineno">  611</span>  }</div>
<div class="line"><span class="lineno">  612</span>  <a class="code hl_function" href="#a116924f1114dd4ba855b9028b443fff2">learner</a>(*game, config, &amp;device_manager, eval, &amp;trajectory_queue,</div>
<div class="line"><span class="lineno">  613</span>          &amp;eval_results, stop, start_info);</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>  <span class="keywordflow">if</span> (!stop-&gt;<a class="code hl_function" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075">StopRequested</a>()) {</div>
<div class="line"><span class="lineno">  616</span>    stop-&gt;<a class="code hl_function" href="classopen__spiel_1_1_stop_token.html#ad962f8525420ef1c37c5f23d562ac5ce">Stop</a>();</div>
<div class="line"><span class="lineno">  617</span>  }</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>  <span class="comment">// Empty the queue so that the actors can exit.</span></div>
<div class="line"><span class="lineno">  620</span>  trajectory_queue.BlockNewValues();</div>
<div class="line"><span class="lineno">  621</span>  trajectory_queue.Clear();</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Joining all the threads.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  624</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : actors) {</div>
<div class="line"><span class="lineno">  625</span>    <a class="code hl_enumvalue" href="namespaceabsl_1_1str__format__internal.html#a208aa9c1527b41e79ca80679ceeb9c38ae358efa489f58062f10dd7316b65649e">t</a>.join();</div>
<div class="line"><span class="lineno">  626</span>  }</div>
<div class="line"><span class="lineno">  627</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : evaluators) {</div>
<div class="line"><span class="lineno">  628</span>    <a class="code hl_enumvalue" href="namespaceabsl_1_1str__format__internal.html#a208aa9c1527b41e79ca80679ceeb9c38ae358efa489f58062f10dd7316b65649e">t</a>.join();</div>
<div class="line"><span class="lineno">  629</span>  }</div>
<div class="line"><span class="lineno">  630</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Exiting cleanly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  631</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  632</span>}</div>
<div class="ttc" id="abtree__benchmark_8cc_html_a717c50cfde3924051c279a89096afd3d"><div class="ttname"><a href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a></div><div class="ttdeci">uint64_t i</div><div class="ttdef"><b>Definition</b> <a href="btree__benchmark_8cc_source.html#l00232">btree_benchmark.cc:232</a></div></div>
<div class="ttc" id="aclassabsl_1_1string__view_html"><div class="ttname"><a href="classabsl_1_1string__view.html">absl::string_view</a></div><div class="ttdef"><b>Definition</b> <a href="string__view_8h_source.html#l00161">string_view.h:161</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_stop_token_html_ad962f8525420ef1c37c5f23d562ac5ce"><div class="ttname"><a href="classopen__spiel_1_1_stop_token.html#ad962f8525420ef1c37c5f23d562ac5ce">open_spiel::StopToken::Stop</a></div><div class="ttdeci">void Stop()</div><div class="ttdef"><b>Definition</b> <a href="thread_8h_source.html#l00049">thread.h:49</a></div></div>
<div class="ttc" id="anamespaceabsl_1_1str__format__internal_html_a208aa9c1527b41e79ca80679ceeb9c38ae358efa489f58062f10dd7316b65649e"><div class="ttname"><a href="namespaceabsl_1_1str__format__internal.html#a208aa9c1527b41e79ca80679ceeb9c38ae358efa489f58062f10dd7316b65649e">absl::str_format_internal::LengthMod::t</a></div><div class="ttdeci">@ t</div></div>
<div class="ttc" id="anamespaceabsl_html"><div class="ttname"><a href="namespaceabsl.html">absl</a></div><div class="ttdef"><b>Definition</b> <a href="algorithm_8h_source.html#l00031">algorithm.h:31</a></div></div>
<div class="ttc" id="anamespaceabsl_html_a5f113a4d08f171c39b3b4f2709d154bb"><div class="ttname"><a href="namespaceabsl.html#a5f113a4d08f171c39b3b4f2709d154bb">absl::StrSplit</a></div><div class="ttdeci">strings_internal::Splitter&lt; typename strings_internal::SelectDelimiter&lt; Delimiter &gt;::type, AllowEmpty, absl::string_view &gt; StrSplit(strings_internal::ConvertibleToStringView text, Delimiter d)</div><div class="ttdef"><b>Definition</b> <a href="str__split_8h_source.html#l00499">str_split.h:499</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_html_a116924f1114dd4ba855b9028b443fff2"><div class="ttname"><a href="#a116924f1114dd4ba855b9028b443fff2">open_spiel::algorithms::torch_az::learner</a></div><div class="ttdeci">void learner(const open_spiel::Game &amp;game, const AlphaZeroConfig &amp;config, DeviceManager *device_manager, std::shared_ptr&lt; VPNetEvaluator &gt; eval, ThreadedQueue&lt; Trajectory &gt; *trajectory_queue, EvalResults *eval_results, StopToken *stop, const StartInfo &amp;start_info)</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00298">alpha_zero.cc:298</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_html_a6ce4e92571dc52dbf4adc2c85c0aeb0d"><div class="ttname"><a href="#a6ce4e92571dc52dbf4adc2c85c0aeb0d">open_spiel::algorithms::torch_az::actor</a></div><div class="ttdeci">void actor(const open_spiel::Game &amp;game, const AlphaZeroConfig &amp;config, int num, ThreadedQueue&lt; Trajectory &gt; *trajectory_queue, std::shared_ptr&lt; VPNetEvaluator &gt; vp_eval, StopToken *stop)</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00179">alpha_zero.cc:179</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_html_a812e290fffa06f3d711e2035347de6e4"><div class="ttname"><a href="#a812e290fffa06f3d711e2035347de6e4">open_spiel::algorithms::torch_az::StartInfoFromLearnerJson</a></div><div class="ttdeci">StartInfo StartInfoFromLearnerJson(const std::string &amp;path)</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00062">alpha_zero.cc:62</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_html_a43513b6f8f3a26ce1a64a1a807df9011"><div class="ttname"><a href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011">open_spiel::SpielFatalError</a></div><div class="ttdeci">void SpielFatalError(const std::string &amp;error_msg)</div><div class="ttdef"><b>Definition</b> <a href="spiel__utils_8cc_source.html#l00132">spiel_utils.cc:132</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_html_afd4ac299a038385def0ea56521067137"><div class="ttname"><a href="namespaceopen__spiel.html#afd4ac299a038385def0ea56521067137">open_spiel::LoadGame</a></div><div class="ttdeci">std::shared_ptr&lt; const Game &gt; LoadGame(const std::string &amp;game_string)</div><div class="ttdef"><b>Definition</b> <a href="spiel_8cc_source.html#l00227">spiel.cc:227</a></div></div>
<div class="ttc" id="aspiel__utils_8h_html_ac998e613afb013e8bd31b3da80f747ae"><div class="ttname"><a href="spiel__utils_8h.html#ac998e613afb013e8bd31b3da80f747ae">SPIEL_CHECK_TRUE</a></div><div class="ttdeci">#define SPIEL_CHECK_TRUE(x)</div><div class="ttdef"><b>Definition</b> <a href="spiel__utils_8h_source.html#l00282">spiel_utils.h:282</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1_game_type_html"><div class="ttname"><a href="structopen__spiel_1_1_game_type.html">open_spiel::GameType</a></div><div class="ttdef"><b>Definition</b> <a href="spiel_8h_source.html#l00049">spiel.h:49</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1_game_type_html_a5a5f739de73ade6cfe6961fd4a2f41a5a217dd2f6ef26065693bb5043fce241ea"><div class="ttname"><a href="structopen__spiel_1_1_game_type.html#a5a5f739de73ade6cfe6961fd4a2f41a5a217dd2f6ef26065693bb5043fce241ea">open_spiel::GameType::RewardModel::kTerminal</a></div><div class="ttdeci">@ kTerminal</div></div>
<div class="ttc" id="astructopen__spiel_1_1_game_type_html_a624349737f34cc67d0cf81fd7138c17baeb609b99f542b955302693c0f445ba0c"><div class="ttname"><a href="structopen__spiel_1_1_game_type.html#a624349737f34cc67d0cf81fd7138c17baeb609b99f542b955302693c0f445ba0c">open_spiel::GameType::Dynamics::kSequential</a></div><div class="ttdeci">@ kSequential</div></div>
<div class="ttc" id="astructopen__spiel_1_1_game_type_html_aa72d7337710404c4a4c85cad77ad9992"><div class="ttname"><a href="structopen__spiel_1_1_game_type.html#aa72d7337710404c4a4c85cad77ad9992">open_spiel::GameType::reward_model</a></div><div class="ttdeci">RewardModel reward_model</div><div class="ttdef"><b>Definition</b> <a href="spiel_8h_source.html#l00110">spiel.h:110</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1_game_type_html_ac1176bf5ed045dc24fb4b113af2750b8"><div class="ttname"><a href="structopen__spiel_1_1_game_type.html#ac1176bf5ed045dc24fb4b113af2750b8">open_spiel::GameType::dynamics</a></div><div class="ttdeci">Dynamics dynamics</div><div class="ttdef"><b>Definition</b> <a href="spiel_8h_source.html#l00065">spiel.h:65</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a047e72a48e922dec6056a61e6cb0fd0e"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a047e72a48e922dec6056a61e6cb0fd0e">open_spiel::algorithms::torch_az::AlphaZeroConfig::replay_buffer_reuse</a></div><div class="ttdeci">int replay_buffer_reuse</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00047">alpha_zero.h:47</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a07dd2d2ec9867c3f3841ebc5adf8fbf1"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a07dd2d2ec9867c3f3841ebc5adf8fbf1">open_spiel::algorithms::torch_az::AlphaZeroConfig::evaluators</a></div><div class="ttdeci">int evaluators</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00061">alpha_zero.h:61</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a0ca864d70acf6d100c65069d9bebc3b8"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a0ca864d70acf6d100c65069d9bebc3b8">open_spiel::algorithms::torch_az::AlphaZeroConfig::eval_levels</a></div><div class="ttdeci">int eval_levels</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00062">alpha_zero.h:62</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a1446209ea2c61c45ff686cd02ca840c0"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1446209ea2c61c45ff686cd02ca840c0">open_spiel::algorithms::torch_az::AlphaZeroConfig::ToJson</a></div><div class="ttdeci">json::Object ToJson() const</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00065">alpha_zero.h:65</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a1b154c87aa7db32356688042c269a7b0"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1b154c87aa7db32356688042c269a7b0">open_spiel::algorithms::torch_az::AlphaZeroConfig::explicit_learning</a></div><div class="ttdeci">bool explicit_learning</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00039">alpha_zero.h:39</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a2b0812b3502033f9a15499817600007d"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a2b0812b3502033f9a15499817600007d">open_spiel::algorithms::torch_az::AlphaZeroConfig::inference_threads</a></div><div class="ttdeci">int inference_threads</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00044">alpha_zero.h:44</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a33e40b4c31e65020f21eb1370201a5da"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a33e40b4c31e65020f21eb1370201a5da">open_spiel::algorithms::torch_az::AlphaZeroConfig::evaluation_window</a></div><div class="ttdeci">int evaluation_window</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00049">alpha_zero.h:49</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a4b4dbf19d6c00112f8ba3270f6982a65"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4b4dbf19d6c00112f8ba3270f6982a65">open_spiel::algorithms::torch_az::AlphaZeroConfig::graph_def</a></div><div class="ttdeci">std::string graph_def</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00033">alpha_zero.h:33</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a6513a45fa9318011c7c98159ac815602"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a6513a45fa9318011c7c98159ac815602">open_spiel::algorithms::torch_az::AlphaZeroConfig::inference_batch_size</a></div><div class="ttdeci">int inference_batch_size</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00043">alpha_zero.h:43</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a73f8e2fc9e3e871bae516c4783d26c95"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a73f8e2fc9e3e871bae516c4783d26c95">open_spiel::algorithms::torch_az::AlphaZeroConfig::weight_decay</a></div><div class="ttdeci">double weight_decay</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00041">alpha_zero.h:41</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a783b9be9bc7d41aee0ffc6013a4dd098"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a783b9be9bc7d41aee0ffc6013a4dd098">open_spiel::algorithms::torch_az::AlphaZeroConfig::inference_cache</a></div><div class="ttdeci">int inference_cache</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00045">alpha_zero.h:45</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a7f100c7aee06687a74fe15d93182623c"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a7f100c7aee06687a74fe15d93182623c">open_spiel::algorithms::torch_az::AlphaZeroConfig::nn_depth</a></div><div class="ttdeci">int nn_depth</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00036">alpha_zero.h:36</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a9328128047c27c33821d45de7f91e612"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">open_spiel::algorithms::torch_az::AlphaZeroConfig::actors</a></div><div class="ttdeci">int actors</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00060">alpha_zero.h:60</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a9dcc79de865c7f234369e9fd7e9c77f5"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9dcc79de865c7f234369e9fd7e9c77f5">open_spiel::algorithms::torch_az::AlphaZeroConfig::nn_width</a></div><div class="ttdeci">int nn_width</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00035">alpha_zero.h:35</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_aad42392e5f18e7a2112744e61dab47a9"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#aad42392e5f18e7a2112744e61dab47a9">open_spiel::algorithms::torch_az::AlphaZeroConfig::nn_model</a></div><div class="ttdeci">std::string nn_model</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00034">alpha_zero.h:34</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_acf186cc5d9ab970bc1cf2d510144c697"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#acf186cc5d9ab970bc1cf2d510144c697">open_spiel::algorithms::torch_az::AlphaZeroConfig::replay_buffer_size</a></div><div class="ttdeci">int replay_buffer_size</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00046">alpha_zero.h:46</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_ad769002cc50fb833fedf67f35f9f06b3"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ad769002cc50fb833fedf67f35f9f06b3">open_spiel::algorithms::torch_az::AlphaZeroConfig::game</a></div><div class="ttdeci">std::string game</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00031">alpha_zero.h:31</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_ae3d3b7cc40f9aaeb911f4d29fb8400dc"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ae3d3b7cc40f9aaeb911f4d29fb8400dc">open_spiel::algorithms::torch_az::AlphaZeroConfig::learning_rate</a></div><div class="ttdeci">double learning_rate</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00040">alpha_zero.h:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="alpha__zero_8cc_source.html#l00179">actor()</a>, <a class="el" href="alpha__zero_8h_source.html#l00060">open_spiel::algorithms::torch_az::AlphaZeroConfig::actors</a>, <a class="el" href="device__manager_8h_source.html#l00038">open_spiel::algorithms::torch_az::DeviceManager::AddDevice()</a>, <a class="el" href="threaded__queue_8h_source.html#l00088">open_spiel::ThreadedQueue&lt; T &gt;::BlockNewValues()</a>, <a class="el" href="threaded__queue_8h_source.html#l00075">open_spiel::ThreadedQueue&lt; T &gt;::Clear()</a>, <a class="el" href="device__manager_8h_source.html#l00093">open_spiel::algorithms::torch_az::DeviceManager::Count()</a>, <a class="el" href="vpnet_8cc_source.html#l00095">CreateGraphDef()</a>, <a class="el" href="alpha__zero_8h_source.html#l00037">open_spiel::algorithms::torch_az::AlphaZeroConfig::devices</a>, <a class="el" href="spiel_8h_source.html#l00065">open_spiel::GameType::dynamics</a>, <a class="el" href="alpha__zero_8h_source.html#l00062">open_spiel::algorithms::torch_az::AlphaZeroConfig::eval_levels</a>, <a class="el" href="alpha__zero_8h_source.html#l00049">open_spiel::algorithms::torch_az::AlphaZeroConfig::evaluation_window</a>, <a class="el" href="alpha__zero_8cc_source.html#l00256">evaluator()</a>, <a class="el" href="alpha__zero_8h_source.html#l00061">open_spiel::algorithms::torch_az::AlphaZeroConfig::evaluators</a>, <a class="el" href="file_8cc_source.html#l00100">open_spiel::file::Exists()</a>, <a class="el" href="alpha__zero_8h_source.html#l00039">open_spiel::algorithms::torch_az::AlphaZeroConfig::explicit_learning</a>, <a class="el" href="alpha__zero_8h_source.html#l00031">open_spiel::algorithms::torch_az::AlphaZeroConfig::game</a>, <a class="el" href="device__manager_8h_source.html#l00070">open_spiel::algorithms::torch_az::DeviceManager::Get()</a>, <a class="el" href="alpha__zero_8h_source.html#l00033">open_spiel::algorithms::torch_az::AlphaZeroConfig::graph_def</a>, <a class="el" href="btree__benchmark_8cc_source.html#l00232">i</a>, <a class="el" href="alpha__zero_8h_source.html#l00043">open_spiel::algorithms::torch_az::AlphaZeroConfig::inference_batch_size</a>, <a class="el" href="alpha__zero_8h_source.html#l00045">open_spiel::algorithms::torch_az::AlphaZeroConfig::inference_cache</a>, <a class="el" href="alpha__zero_8h_source.html#l00044">open_spiel::algorithms::torch_az::AlphaZeroConfig::inference_threads</a>, <a class="el" href="file_8cc_source.html#l00105">open_spiel::file::IsDirectory()</a>, <a class="el" href="structopen__spiel_1_1_game_type.html#a624349737f34cc67d0cf81fd7138c17baeb609b99f542b955302693c0f445ba0c">open_spiel::GameType::kSequential</a>, <a class="el" href="structopen__spiel_1_1_game_type.html#a5a5f739de73ade6cfe6961fd4a2f41a5a217dd2f6ef26065693bb5043fce241ea">open_spiel::GameType::kTerminal</a>, <a class="el" href="alpha__zero_8cc_source.html#l00298">learner()</a>, <a class="el" href="alpha__zero_8h_source.html#l00040">open_spiel::algorithms::torch_az::AlphaZeroConfig::learning_rate</a>, <a class="el" href="vpnet_8cc_source.html#l00140">open_spiel::algorithms::torch_az::VPNetModel::LoadCheckpoint()</a>, <a class="el" href="spiel_8cc_source.html#l00227">open_spiel::LoadGame()</a>, <a class="el" href="file_8cc_source.html#l00114">open_spiel::file::Mkdirs()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00058">open_spiel::algorithms::torch_az::StartInfo::model_checkpoint_step</a>, <a class="el" href="alpha__zero_8h_source.html#l00036">open_spiel::algorithms::torch_az::AlphaZeroConfig::nn_depth</a>, <a class="el" href="alpha__zero_8h_source.html#l00034">open_spiel::algorithms::torch_az::AlphaZeroConfig::nn_model</a>, <a class="el" href="alpha__zero_8h_source.html#l00035">open_spiel::algorithms::torch_az::AlphaZeroConfig::nn_width</a>, <a class="el" href="clock_8cc_source.html#l00039">absl::Now()</a>, <a class="el" href="alpha__zero_8h_source.html#l00032">open_spiel::algorithms::torch_az::AlphaZeroConfig::path</a>, <a class="el" href="alpha__zero_8h_source.html#l00047">open_spiel::algorithms::torch_az::AlphaZeroConfig::replay_buffer_reuse</a>, <a class="el" href="alpha__zero_8h_source.html#l00046">open_spiel::algorithms::torch_az::AlphaZeroConfig::replay_buffer_size</a>, <a class="el" href="spiel_8h_source.html#l00110">open_spiel::GameType::reward_model</a>, <a class="el" href="vpnet_8cc_source.html#l00131">open_spiel::algorithms::torch_az::VPNetModel::SaveCheckpoint()</a>, <a class="el" href="spiel__utils_8h_source.html#l00282">SPIEL_CHECK_TRUE</a>, <a class="el" href="spiel__utils_8cc_source.html#l00132">open_spiel::SpielFatalError()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00062">StartInfoFromLearnerJson()</a>, <a class="el" href="thread_8h_source.html#l00049">open_spiel::StopToken::Stop()</a>, <a class="el" href="thread_8h_source.html#l00050">open_spiel::StopToken::StopRequested()</a>, <a class="el" href="str__cat_8h_source.html#l00381">absl::StrCat()</a>, <a class="el" href="str__split_8h_source.html#l00499">absl::StrSplit()</a>, <a class="el" href="alpha__zero_8h_source.html#l00065">open_spiel::algorithms::torch_az::AlphaZeroConfig::ToJson()</a>, <a class="el" href="json_8cc_source.html#l00246">open_spiel::json::ToString()</a>, <a class="el" href="alpha__zero_8h_source.html#l00041">open_spiel::algorithms::torch_az::AlphaZeroConfig::weight_decay</a>, and <a class="el" href="file_8cc_source.html#l00075">open_spiel::file::File::Write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a141f9989682f14bd0a5d4e153d4e2fd4_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a141f9989682f14bd0a5d4e153d4e2fd4_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a141f9989682f14bd0a5d4e153d4e2fd4_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a141f9989682f14bd0a5d4e153d4e2fd4_cgraph">
<area shape="rect" title=" " alt="" coords="5,1596,157,1636"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a6ce4e92571dc52dbf4adc2c85c0aeb0d" title=" " alt="" coords="248,422,400,463"/>
<area shape="poly" title=" " alt="" coords="79,1595,81,1454,94,1219,109,1080,131,935,162,788,202,647,222,598,247,551,296,474,300,477,252,553,227,600,207,649,167,790,136,936,115,1081,100,1219,86,1455,85,1595"/>
<area shape="rect" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb" title=" " alt="" coords="830,191,910,217"/>
<area shape="poly" title=" " alt="" coords="80,1595,85,1310,103,841,119,599,140,383,153,293,167,219,184,163,203,129,262,73,322,34,383,11,446,3,512,7,581,22,655,45,734,75,772,95,805,122,853,177,849,180,801,126,769,100,732,80,653,50,580,27,511,13,446,9,384,17,324,39,265,77,207,132,189,165,173,220,158,294,145,384,124,599,108,841,91,1310,85,1595"/>
<area shape="rect" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075" title=" " alt="" coords="536,610,689,651"/>
<area shape="poly" title=" " alt="" coords="79,1595,80,1424,84,1297,93,1157,108,1017,130,887,144,831,161,781,180,740,203,709,236,680,273,658,314,641,357,630,442,619,520,618,520,624,443,624,358,635,316,646,276,663,239,685,207,713,185,743,166,783,149,832,135,889,113,1017,98,1157,90,1297,86,1424,85,1595"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="824,2257,916,2282"/>
<area shape="poly" title=" " alt="" coords="106,1635,150,1670,206,1703,241,1714,274,1718,334,1714,363,1713,390,1717,418,1730,445,1754,461,1780,471,1811,477,1849,479,1891,475,1987,466,2089,457,2191,454,2284,458,2325,465,2360,476,2390,493,2412,521,2434,549,2448,577,2454,604,2454,633,2449,664,2439,732,2411,771,2388,804,2357,831,2324,851,2294,856,2297,836,2327,808,2361,774,2392,735,2416,666,2444,635,2454,605,2460,576,2460,547,2453,519,2439,489,2415,472,2392,460,2362,452,2326,449,2284,451,2191,460,2089,470,1986,473,1891,471,1850,466,1813,456,1782,441,1758,415,1735,389,1723,362,1719,334,1719,274,1723,240,1720,204,1708,147,1675,103,1639"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a7539eef65c4376acd4eef4dd3cfeb68d" title=" " alt="" coords="235,1768,413,1824"/>
<area shape="poly" title=" " alt="" coords="99,1635,143,1690,173,1721,206,1747,225,1759,222,1763,203,1752,169,1725,139,1694,95,1639"/>
<area shape="rect" href="classopen__spiel_1_1_threaded_queue.html#ab0952535c49a20dd0d05339239ebcdc7" title=" " alt="" coords="232,1848,416,1888"/>
<area shape="poly" title=" " alt="" coords="90,1636,104,1678,128,1732,162,1787,183,1812,206,1834,220,1843,217,1848,203,1838,179,1816,157,1790,123,1734,99,1680,85,1638"/>
<area shape="rect" href="classopen__spiel_1_1_threaded_queue.html#ab97db6531e9898bc043045721fb24026" title=" " alt="" coords="232,1913,416,1954"/>
<area shape="poly" title=" " alt="" coords="88,1636,98,1689,119,1760,135,1798,154,1834,178,1868,206,1898,220,1908,217,1912,203,1902,174,1872,150,1837,130,1800,114,1762,93,1690,82,1637"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a13ee074af0f7a1140b8c328ae9284301" title=" " alt="" coords="523,1023,701,1079"/>
<area shape="poly" title=" " alt="" coords="83,1595,96,1539,119,1462,154,1376,176,1334,203,1296,268,1221,299,1194,330,1172,400,1133,490,1088,507,1080,510,1085,492,1093,402,1138,333,1177,302,1198,272,1225,207,1299,181,1337,159,1378,124,1463,101,1540,89,1596"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a961b83641d3a89f6507458f98a273132" title=" " alt="" coords="233,1653,415,1694"/>
<area shape="poly" title=" " alt="" coords="158,1631,221,1646,220,1652,156,1637"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a93a78c3862b261da879f8fa47863e224" title=" " alt="" coords="248,722,400,763"/>
<area shape="poly" title=" " alt="" coords="81,1595,95,1455,120,1240,137,1127,156,1021,178,930,202,864,219,837,239,812,281,771,284,775,243,816,223,840,207,867,183,932,161,1022,142,1128,125,1241,100,1455,87,1596"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#ad3e0b39c19efd6e65cd59b9dfe653323" title=" " alt="" coords="801,836,939,876"/>
<area shape="poly" title=" " alt="" coords="82,1595,95,1490,120,1339,136,1260,156,1189,178,1129,203,1088,233,1057,266,1028,338,980,417,941,498,912,579,890,656,874,786,858,786,863,657,879,580,895,500,917,419,946,341,985,269,1033,236,1060,207,1091,183,1131,161,1190,142,1262,125,1340,100,1491,87,1596"/>
<area shape="rect" href="namespaceopen__spiel_1_1file.html#ab8ef485ff9e17f423c62d2945c06c655" title=" " alt="" coords="247,1978,400,2004"/>
<area shape="poly" title=" " alt="" coords="86,1637,92,1701,109,1790,125,1837,146,1884,173,1927,206,1963,234,1979,231,1984,203,1968,168,1930,141,1886,120,1839,104,1791,86,1702,80,1637"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165" title=" " alt="" coords="508,1102,716,1143"/>
<area shape="poly" title=" " alt="" coords="93,1594,147,1513,235,1397,291,1333,352,1270,419,1211,490,1159,512,1147,514,1152,492,1164,422,1215,356,1274,295,1336,240,1400,151,1516,97,1597"/>
<area shape="rect" href="namespaceopen__spiel_1_1file.html#af2cfc6de0fcddc3156b8ddef37cc5be0" title=" " alt="" coords="234,2027,414,2053"/>
<area shape="poly" title=" " alt="" coords="85,1637,87,1709,93,1758,103,1812,118,1867,139,1921,169,1971,206,2014,221,2024,218,2029,203,2018,164,1974,135,1923,113,1869,97,1813,88,1759,82,1710,79,1637"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a116924f1114dd4ba855b9028b443fff2" title=" " alt="" coords="248,1488,400,1528"/>
<area shape="poly" title=" " alt="" coords="114,1593,156,1568,204,1544,236,1532,238,1537,206,1549,158,1573,116,1597"/>
<area shape="rect" href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011" title=" " alt="" coords="781,1074,959,1100"/>
<area shape="poly" title=" " alt="" coords="81,1595,87,1522,106,1416,121,1357,142,1298,169,1241,203,1188,265,1115,295,1089,326,1068,397,1037,490,1008,557,992,612,987,667,993,734,1008,764,1018,793,1032,841,1062,838,1067,790,1037,762,1023,733,1013,666,998,612,992,558,997,492,1013,399,1042,329,1073,299,1093,269,1119,207,1191,174,1243,147,1300,126,1359,111,1417,92,1523,86,1595"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a07f597ead45df9b15172e1f0701447ae" title=" " alt="" coords="532,2202,693,2257"/>
<area shape="poly" title=" " alt="" coords="128,1593,197,1569,238,1559,282,1552,326,1551,369,1557,409,1571,445,1596,460,1615,472,1641,479,1672,483,1707,483,1787,479,1874,472,1962,470,2044,475,2114,483,2142,493,2164,520,2191,516,2195,489,2167,477,2144,470,2115,465,2044,467,1962,473,1874,478,1787,477,1708,473,1673,466,1643,456,1618,441,1599,407,1576,368,1562,326,1557,282,1558,239,1564,199,1574,129,1598"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a65dc38ee167b98a43c831f55141915f7" title=" " alt="" coords="532,2282,693,2337"/>
<area shape="poly" title=" " alt="" coords="157,1608,236,1605,321,1607,396,1617,425,1626,445,1640,461,1662,473,1692,480,1726,483,1766,482,1855,475,1951,467,2048,464,2139,471,2214,480,2244,493,2268,519,2289,516,2293,489,2271,475,2246,466,2215,458,2139,461,2048,469,1951,476,1854,478,1766,474,1727,467,1693,457,1665,441,1643,422,1631,395,1622,321,1612,236,1610,157,1613"/>
<area shape="rect" href="namespaceopen__spiel.html#afd4ac299a038385def0ea56521067137" title=" " alt="" coords="247,2101,401,2126"/>
<area shape="poly" title=" " alt="" coords="85,1637,87,1715,103,1828,118,1890,139,1952,169,2011,207,2064,226,2080,248,2092,246,2097,223,2084,203,2067,164,2014,134,1955,112,1892,97,1829,82,1715,79,1637"/>
<area shape="rect" href="namespaceopen__spiel_1_1file.html#af179ba2cfbacd26dfdbb873be5e169ab" title=" " alt="" coords="246,2150,402,2176"/>
<area shape="poly" title=" " alt="" coords="87,1637,99,1742,122,1893,139,1971,158,2041,181,2099,207,2137,233,2153,230,2158,203,2141,176,2101,153,2043,134,1972,117,1894,94,1743,82,1637"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a812e290fffa06f3d711e2035347de6e4" title=" " alt="" coords="205,210,443,251"/>
<area shape="poly" title=" " alt="" coords="80,1595,90,1383,112,1037,129,850,149,673,174,522,187,460,202,410,221,367,244,327,292,262,296,265,249,330,226,370,207,412,192,461,179,523,154,674,134,850,118,1037,95,1383,86,1595"/>
<area shape="rect" href="namespaceabsl.html#a5f113a4d08f171c39b3b4f2709d154bb" title=" " alt="" coords="564,90,660,116"/>
<area shape="poly" title=" " alt="" coords="80,1595,87,1322,106,876,122,645,143,440,156,354,170,283,185,230,203,197,239,164,281,138,326,119,374,107,422,99,468,95,548,94,548,100,469,100,423,104,375,112,328,124,283,143,242,168,207,200,190,232,175,284,161,355,148,440,128,645,112,876,92,1322,85,1595"/>
<area shape="rect" href="classopen__spiel_1_1_stop_token.html#ad962f8525420ef1c37c5f23d562ac5ce" title=" " alt="" coords="247,2200,400,2240"/>
<area shape="poly" title=" " alt="" coords="87,1637,98,1750,120,1916,137,2001,156,2079,180,2143,193,2168,207,2186,234,2205,231,2209,203,2190,188,2171,175,2146,151,2081,131,2002,115,1917,92,1751,81,1637"/>
<area shape="rect" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1446209ea2c61c45ff686cd02ca840c0" title=" " alt="" coords="232,2264,416,2320"/>
<area shape="poly" title=" " alt="" coords="86,1637,96,1761,118,1945,134,2041,154,2129,178,2201,192,2229,207,2250,220,2263,217,2267,203,2254,187,2232,173,2203,149,2130,129,2042,113,1946,91,1762,81,1637"/>
<area shape="rect" href="namespaceopen__spiel_1_1json.html#af0fc555df99f714edac7a80e71b8a0b5" title=" " alt="" coords="238,2369,410,2394"/>
<area shape="poly" title=" " alt="" coords="86,1637,94,1774,115,1982,131,2090,151,2190,177,2273,191,2306,207,2330,225,2348,247,2360,245,2365,222,2352,203,2334,186,2308,172,2275,146,2192,126,2091,110,1983,89,1775,81,1637"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#aa5401114eb4044a0bc75f914348e5099" title=" " alt="" coords="536,545,688,586"/>
<area shape="poly" title=" " alt="" coords="360,461,420,496,492,530,523,541,521,546,490,535,418,500,357,466"/>
<area shape="poly" title=" " alt="" coords="332,421,353,378,387,324,433,270,460,246,490,227,531,209,574,197,618,189,663,185,746,185,815,192,814,197,746,190,663,190,619,194,575,202,532,214,492,232,463,251,437,274,391,327,358,381,336,423"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a50e57a250c58223d4f65dddb330040d9" title=" " alt="" coords="536,480,688,520"/>
<area shape="poly" title=" " alt="" coords="400,455,522,480,521,485,399,460"/>
<area shape="rect" href="classopen__spiel_1_1_threaded_queue.html#a6e080c0d5c7376ab6c6018088d405178" title=" " alt="" coords="520,365,704,406"/>
<area shape="poly" title=" " alt="" coords="399,425,505,404,506,409,400,430"/>
<area shape="rect" href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67" title=" " alt="" coords="560,242,664,268"/>
<area shape="poly" title=" " alt="" coords="337,421,362,388,398,349,441,309,490,276,516,265,544,258,545,264,518,271,492,281,444,314,401,353,367,392,342,424"/>
<area shape="poly" title=" " alt="" coords="344,462,405,528,446,564,492,595,522,609,520,613,490,600,443,568,401,532,340,466"/>
<area shape="poly" title=" " alt="" coords="400,434,490,429,589,430,677,441,711,451,735,466,745,482,752,507,764,580,772,675,777,782,784,1112,869,2241,864,2241,779,1112,772,782,767,675,759,580,747,508,740,484,731,470,709,456,676,446,589,435,490,435,400,439"/>
<area shape="rect" href="namespaceabsl.html#ae79026cc56809b3cbb42198d6419d144" title=" " alt="" coords="546,291,678,317"/>
<area shape="poly" title=" " alt="" coords="348,420,409,373,449,348,490,327,530,314,532,319,492,332,451,353,412,377,351,424"/>
<area shape="poly" title=" " alt="" coords="564,365,561,355,569,346,586,340,612,338,640,341,656,347,654,352,639,346,612,344,587,346,572,351,567,356,569,364"/>
<area shape="rect" href="classabsl_1_1_cond_var.html#a223a93405caf0047a7516b2b0309712d" title=" " alt="" coords="531,2477,693,2502"/>
<area shape="poly" title=" " alt="" coords="417,1879,432,1888,445,1900,458,1921,467,1948,475,2015,475,2094,469,2180,464,2265,464,2344,472,2410,481,2436,493,2456,518,2475,515,2479,489,2459,476,2438,467,2411,458,2344,459,2265,464,2180,469,2094,470,2015,462,1950,453,1924,441,1903,429,1892,414,1883"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a74e1169d351ea651f9f0577190f31190" title=" " alt="" coords="517,2361,707,2402"/>
<area shape="poly" title=" " alt="" coords="417,1688,432,1698,445,1711,459,1735,469,1767,477,1843,475,1934,468,2032,462,2129,460,2219,463,2259,469,2295,479,2324,493,2348,505,2359,502,2363,489,2351,474,2327,464,2296,458,2260,455,2220,456,2129,463,2032,470,1934,472,1844,464,1768,455,1738,441,1714,429,1702,414,1693"/>
<area shape="poly" title=" " alt="" coords="702,2358,732,2347,788,2319,836,2289,839,2294,791,2324,734,2352,704,2363"/>
<area shape="poly" title=" " alt="" coords="342,720,403,659,445,625,490,596,520,583,523,588,492,601,448,630,407,663,345,724"/>
<area shape="poly" title=" " alt="" coords="333,721,357,680,391,629,436,576,490,531,521,516,523,520,492,536,440,580,396,632,361,683,338,723"/>
<area shape="poly" title=" " alt="" coords="367,720,490,662,520,651,522,657,492,667,369,724"/>
<area shape="poly" title=" " alt="" coords="356,762,492,857,530,879,565,895,628,918,656,932,684,949,710,974,736,1009,759,1057,780,1118,798,1189,814,1270,838,1450,854,1644,864,1835,870,2009,872,2241,866,2241,864,2009,859,1835,849,1644,833,1451,809,1271,793,1190,775,1119,755,1059,731,1012,706,978,680,954,654,936,626,923,563,900,528,883,490,861,353,766"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#a39a24c775717f28cfa48d0e9d44314bb" title=" " alt="" coords="518,676,707,716"/>
<area shape="poly" title=" " alt="" coords="399,728,502,711,503,717,400,733"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#ab7aff12d0ab8545920eea7589100895c" title=" " alt="" coords="515,741,709,782"/>
<area shape="poly" title=" " alt="" coords="400,745,500,752,499,757,400,750"/>
<area shape="rect" href="classopen__spiel_1_1_file_logger.html#a56b1c28d743f30e0401814fae8dfdc3e" title=" " alt="" coords="536,806,688,847"/>
<area shape="poly" title=" " alt="" coords="393,761,492,791,522,800,521,805,490,796,392,766"/>
<area shape="poly" title=" " alt="" coords="687,817,711,807,731,792,746,773,759,749,783,685,805,607,823,521,849,353,863,232,869,233,855,354,828,522,810,608,789,687,764,751,750,776,735,795,714,811,689,822"/>
<area shape="poly" title=" " alt="" coords="689,833,786,844,785,849,688,838"/>
<area shape="poly" title=" " alt="" coords="380,1485,413,1465,441,1437,457,1406,463,1376,463,1347,459,1318,457,1290,458,1261,468,1232,489,1204,519,1182,551,1173,582,1174,613,1178,644,1183,674,1183,703,1174,731,1153,862,232,867,233,736,1156,706,1179,675,1188,644,1188,613,1184,582,1179,551,1179,522,1187,493,1207,472,1235,463,1262,462,1290,465,1318,468,1347,469,1377,462,1408,445,1440,416,1469,382,1490"/>
<area shape="poly" title=" " alt="" coords="326,1487,376,1204,409,993,440,775,443,725,443,663,442,516,444,443,452,375,466,318,476,295,489,277,514,259,544,251,545,256,517,264,493,281,481,298,471,320,457,376,450,443,447,516,449,663,449,725,446,775,415,994,381,1205,332,1488"/>
<area shape="poly" title=" " alt="" coords="325,1487,350,1315,391,1053,415,919,441,801,465,712,477,681,489,662,503,650,520,641,523,646,506,655,493,666,482,684,470,713,446,803,421,920,396,1054,355,1316,331,1488"/>
<area shape="poly" title=" " alt="" coords="325,1487,337,1413,364,1306,386,1248,413,1190,447,1136,489,1089,508,1075,511,1079,493,1093,452,1140,418,1193,391,1250,369,1308,342,1414,330,1488"/>
<area shape="poly" title=" " alt="" coords="327,1487,348,1408,382,1288,430,1149,489,1010,537,926,584,858,588,861,541,929,493,1012,435,1151,387,1290,353,1409,333,1488"/>
<area shape="poly" title=" " alt="" coords="338,1486,388,1414,416,1367,441,1318,453,1273,456,1234,464,1198,473,1179,489,1160,501,1150,504,1154,493,1163,478,1182,469,1200,462,1235,459,1274,445,1320,420,1369,392,1416,343,1489"/>
<area shape="rect" href="classopen__spiel_1_1_basic_stats.html#a6aa54ee5d0274862cfb0636903ed7cce" title=" " alt="" coords="519,1581,705,1606"/>
<area shape="poly" title=" " alt="" coords="394,1527,444,1544,492,1566,521,1574,520,1579,490,1571,442,1549,392,1532"/>
<area shape="rect" href="classopen__spiel_1_1_circular_buffer.html#ad2de53bedb6f2123d64e6aa12b58b0b7" title=" " alt="" coords="511,1630,713,1656"/>
<area shape="poly" title=" " alt="" coords="401,1522,424,1532,445,1545,461,1563,469,1583,477,1600,493,1617,499,1621,496,1625,489,1621,472,1603,464,1585,457,1566,441,1549,421,1536,399,1527"/>
<area shape="rect" href="classopen__spiel_1_1_histogram_numbered.html#af1dd234caf1522f78f73d64c62591df1" title=" " alt="" coords="491,1679,733,1705"/>
<area shape="poly" title=" " alt="" coords="401,1519,424,1530,445,1545,458,1561,465,1577,469,1608,473,1638,480,1652,493,1666,497,1669,493,1673,489,1670,476,1655,468,1640,463,1609,459,1578,453,1563,441,1549,421,1534,399,1524"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#aef50405351fb7327726388f169848300" title=" " alt="" coords="533,1730,691,1785"/>
<area shape="poly" title=" " alt="" coords="401,1518,424,1529,445,1545,461,1567,468,1589,470,1632,471,1674,478,1695,493,1716,520,1735,517,1740,489,1719,473,1697,466,1675,464,1632,463,1590,456,1569,441,1549,422,1534,399,1523"/>
<area shape="rect" href="namespaceopen__spiel_1_1json.html#afaa0bf12de1061d4916a520d97cdc046" title=" " alt="" coords="530,1809,695,1850"/>
<area shape="poly" title=" " alt="" coords="401,1517,425,1528,445,1545,466,1578,474,1610,473,1642,469,1673,464,1704,464,1735,472,1765,493,1796,517,1813,514,1817,489,1799,467,1767,459,1736,459,1704,463,1673,468,1641,469,1611,461,1580,441,1549,422,1533,399,1522"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a74299f306339bc1d548e40a00117ec95" title=" " alt="" coords="532,1874,693,1929"/>
<area shape="poly" title=" " alt="" coords="401,1517,425,1528,445,1545,460,1566,470,1586,479,1626,477,1666,470,1705,463,1743,461,1782,469,1820,479,1840,493,1860,519,1880,516,1884,489,1863,474,1843,464,1822,455,1782,457,1743,464,1704,472,1665,474,1627,465,1588,455,1568,441,1549,422,1532,399,1522"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#af9f13cc9e977653cb3d6a53ad7697704" title=" " alt="" coords="533,1954,691,2009"/>
<area shape="poly" title=" " alt="" coords="401,1516,425,1528,445,1545,463,1571,475,1596,482,1622,485,1647,481,1696,470,1745,459,1793,455,1841,457,1865,464,1890,476,1915,493,1940,520,1961,517,1965,489,1943,471,1917,459,1892,452,1866,449,1841,454,1792,465,1743,475,1695,479,1647,477,1623,470,1598,458,1574,441,1549,422,1532,398,1521"/>
<area shape="rect" href="structopen__spiel_1_1_l_r_u_cache_info.html#ab23726ee0c9ad951d74688c5765c8ac2" title=" " alt="" coords="523,2033,701,2074"/>
<area shape="poly" title=" " alt="" coords="401,1516,425,1528,445,1545,466,1576,480,1607,488,1638,490,1668,483,1728,468,1786,453,1844,447,1902,450,1931,457,1961,472,1990,493,2020,511,2034,507,2039,489,2023,467,1993,452,1962,444,1932,442,1902,448,1843,463,1785,478,1727,485,1668,482,1639,475,1609,462,1579,441,1549,422,1532,399,1521"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_1_1_loss_info.html#a223228c4ab1c3a8b9a3a7279c4bb3fb8" title=" " alt="" coords="532,2098,693,2153"/>
<area shape="poly" title=" " alt="" coords="401,1516,425,1527,445,1545,457,1566,466,1593,474,1657,474,1734,470,1816,465,1899,465,1975,473,2039,481,2064,493,2084,519,2105,516,2109,489,2087,477,2066,468,2040,460,1975,460,1898,464,1816,469,1734,469,1658,461,1594,453,1568,441,1549,422,1532,399,1521"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a3cd6b3933712da41eacac728cc0e5973" title=" " alt="" coords="532,1282,693,1337"/>
<area shape="poly" title=" " alt="" coords="339,1486,401,1418,443,1380,490,1347,516,1334,519,1338,492,1352,446,1385,405,1422,343,1489"/>
<area shape="rect" href="classopen__spiel_1_1_serializable_circular_buffer.html#a9d3a6c6f81e680a9657c083c9a3b2348" title=" " alt="" coords="526,1217,698,1258"/>
<area shape="poly" title=" " alt="" coords="335,1486,407,1369,451,1307,489,1267,510,1256,513,1260,493,1272,455,1310,412,1371,339,1489"/>
<area shape="poly" title=" " alt="" coords="401,1516,425,1527,445,1545,459,1569,469,1599,478,1673,478,1760,473,1854,468,1948,466,2035,473,2110,481,2140,493,2164,520,2191,516,2195,489,2167,476,2142,468,2111,461,2035,462,1948,468,1853,473,1760,473,1673,464,1600,454,1571,441,1549,422,1532,399,1521"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_1_1_loss_info.html#a3ec4b014375ed4077d9f2da65052a427" title=" " alt="" coords="532,1362,693,1417"/>
<area shape="poly" title=" " alt="" coords="365,1485,490,1427,516,1417,518,1422,492,1432,367,1490"/>
<area shape="rect" href="classopen__spiel_1_1_threaded_queue.html#a27ffd37c853a69bf56c1a4eef2ec93f9" title=" " alt="" coords="505,1466,719,1492"/>
<area shape="poly" title=" " alt="" coords="400,1498,489,1489,489,1494,400,1503"/>
<area shape="rect" href="classopen__spiel_1_1_basic_stats.html#a3bda2bf3c739b5679d8ae69c2467395b" title=" " alt="" coords="534,1516,690,1556"/>
<area shape="poly" title=" " alt="" coords="400,1513,519,1525,519,1530,400,1518"/>
<area shape="poly" title=" " alt="" coords="370,1527,411,1556,430,1574,445,1596,457,1625,464,1659,470,1741,468,1837,462,1939,457,2040,457,2133,468,2211,479,2243,493,2268,519,2289,516,2293,489,2271,474,2245,463,2213,452,2133,452,2040,457,1938,463,1837,465,1741,459,1660,452,1626,441,1599,426,1578,408,1560,367,1531"/>
<area shape="poly" title=" " alt="" coords="692,1214,732,1197,795,1153,844,1109,847,1113,798,1157,735,1201,694,1219"/>
<area shape="poly" title=" " alt="" coords="694,2239,809,2257,808,2263,693,2245"/>
<area shape="poly" title=" " alt="" coords="562,2201,563,2191,572,2182,588,2177,612,2175,639,2178,656,2184,654,2189,638,2183,612,2180,589,2182,574,2187,567,2193,567,2201"/>
<area shape="poly" title=" " alt="" coords="570,1467,561,1457,566,1447,584,1441,612,1439,644,1442,660,1449,658,1454,643,1447,612,1445,585,1447,570,1452,567,1457,574,1464"/>
<area shape="poly" title=" " alt="" coords="693,2294,808,2276,809,2282,694,2300"/>
<area shape="poly" title=" " alt="" coords="284,2102,276,2092,281,2082,297,2076,324,2074,354,2077,369,2084,367,2089,353,2082,324,2079,298,2081,284,2086,281,2091,288,2099"/>
<area shape="poly" title=" " alt="" coords="386,207,437,193,491,183,559,176,612,175,734,183,815,192,814,198,733,188,612,180,559,181,491,188,438,198,387,212"/>
<area shape="poly" title=" " alt="" coords="444,238,545,247,544,252,443,243"/>
<area shape="poly" title=" " alt="" coords="366,208,442,166,465,148,490,132,548,113,549,118,492,137,468,153,444,170,369,212"/>
<area shape="poly" title=" " alt="" coords="284,2370,276,2360,281,2350,297,2344,324,2342,354,2345,369,2352,367,2357,353,2350,324,2347,298,2349,284,2354,281,2359,288,2367"/>
</map>
</div>

</div>
</div>
<a id="a961b83641d3a89f6507458f98a273132" name="a961b83641d3a89f6507458f98a273132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a961b83641d3a89f6507458f98a273132">&#9670;&#160;</a></span>CreateGraphDef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool open_spiel::algorithms::torch_az::CreateGraphDef </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classopen__spiel_1_1_game.html">Game</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>learning_rate</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>weight_decay</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>nn_model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nn_width</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nn_depth</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>verbose</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vpnet_8cc_source.html#l00095">95</a> of file <a class="el" href="vpnet_8cc_source.html">vpnet.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>                                  {</div>
<div class="line"><span class="lineno">   99</span>  <a class="code hl_struct" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> net_config = {</div>
<div class="line"><span class="lineno">  100</span>      <span class="comment">/*observation_tensor_shape=*/</span>game.ObservationTensorShape(),</div>
<div class="line"><span class="lineno">  101</span>      <span class="comment">/*number_of_actions=*/</span>game.NumDistinctActions(),</div>
<div class="line"><span class="lineno">  102</span>      <span class="comment">/*nn_depth=*/</span>nn_depth,</div>
<div class="line"><span class="lineno">  103</span>      <span class="comment">/*nn_width=*/</span>nn_width,</div>
<div class="line"><span class="lineno">  104</span>      <span class="comment">/*learning_rate=*/</span>learning_rate,</div>
<div class="line"><span class="lineno">  105</span>      <span class="comment">/*weight_decay=*/</span>weight_decay,</div>
<div class="line"><span class="lineno">  106</span>      <span class="comment">/*nn_model=*/</span>nn_model};</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">return</span> SaveModelConfig(path, filename, net_config);</div>
<div class="line"><span class="lineno">  109</span>}</div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">open_spiel::algorithms::torch_az::ModelConfig</a></div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00062">model.h:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vpnet_8cc_source.html#l00045">SaveModelConfig()</a>.</p>

<p class="reference">Referenced by <a class="el" href="alpha__zero_8cc_source.html#l00496">AlphaZero()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,188,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a74e1169d351ea651f9f0577190f31190" title=" " alt="" coords="236,5,426,46"/>
<area shape="poly" title=" " alt="" coords="188,23,220,23,220,28,188,28"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="474,13,565,38"/>
<area shape="poly" title=" " alt="" coords="426,23,458,23,458,28,426,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a961b83641d3a89f6507458f98a273132_icgraph">
<area shape="rect" title=" " alt="" coords="205,5,387,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,5,157,46"/>
<area shape="poly" title=" " alt="" coords="189,28,157,28,157,23,189,23"/>
</map>
</div>

</div>
</div>
<a id="a93a78c3862b261da879f8fa47863e224" name="a93a78c3862b261da879f8fa47863e224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93a78c3862b261da879f8fa47863e224">&#9670;&#160;</a></span>evaluator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void open_spiel::algorithms::torch_az::evaluator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html">EvalResults</a> *</td>          <td class="paramname"><span class="paramname"><em>results</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_evaluator.html">VPNetEvaluator</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>vp_eval</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *</td>          <td class="paramname"><span class="paramname"><em>stop</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="alpha__zero_8cc_source.html#l00256">256</a> of file <a class="el" href="alpha__zero_8cc_source.html">alpha_zero.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  258</span>                                                                       {</div>
<div class="line"><span class="lineno">  259</span>  <a class="code hl_class" href="classopen__spiel_1_1_file_logger.html">FileLogger</a> logger(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>, <a class="code hl_function" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df">absl::StrCat</a>(<span class="stringliteral">&quot;evaluator-&quot;</span>, <a class="code hl_variable" href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>));</div>
<div class="line"><span class="lineno">  260</span>  std::mt19937 rng;</div>
<div class="line"><span class="lineno">  261</span>  <span class="keyword">auto</span> rand_evaluator = std::make_shared&lt;RandomRolloutEvaluator&gt;(1, <a class="code hl_variable" href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>);</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> game_num = 1; !stop-&gt;<a class="code hl_function" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075">StopRequested</a>(); ++game_num) {</div>
<div class="line"><span class="lineno">  264</span>    <span class="keyword">auto</span> [difficulty, <a class="code hl_variable" href="hands_8cpp.html#a1334c4a4638471a447d2290b7ceaf345">first</a>] = results-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#ab7aff12d0ab8545920eea7589100895c">Next</a>();</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordtype">int</span> az_player = <a class="code hl_variable" href="hands_8cpp.html#a1334c4a4638471a447d2290b7ceaf345">first</a> ? 0 : 1;</div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordtype">int</span> rand_max_simulations =</div>
<div class="line"><span class="lineno">  267</span>        config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a53662e34066a95450ec9a11308086510">max_simulations</a> * std::pow(10, difficulty / 2.0);</div>
<div class="line"><span class="lineno">  268</span>    std::vector&lt;std::unique_ptr&lt;MCTSBot&gt;&gt; bots;</div>
<div class="line"><span class="lineno">  269</span>    bots.reserve(2);</div>
<div class="line"><span class="lineno">  270</span>    bots.push_back(<a class="code hl_function" href="#aa5401114eb4044a0bc75f914348e5099">InitAZBot</a>(config, game, vp_eval, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  271</span>    bots.push_back(std::make_unique&lt;MCTSBot&gt;(</div>
<div class="line"><span class="lineno">  272</span>        game, rand_evaluator, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ae14c212e1b6cd9fb9fc495234e4fe931">uct_c</a>, rand_max_simulations,</div>
<div class="line"><span class="lineno">  273</span>        <span class="comment">/*max_memory_mb=*/</span>1000,</div>
<div class="line"><span class="lineno">  274</span>        <span class="comment">/*solve=*/</span><span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  275</span>        <span class="comment">/*seed=*/</span><a class="code hl_variable" href="btree__test_8cc.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a> * 1000 + game_num,</div>
<div class="line"><span class="lineno">  276</span>        <span class="comment">/*verbose=*/</span><span class="keyword">false</span>, ChildSelectionPolicy::UCT,</div>
<div class="line"><span class="lineno">  277</span>        <span class="comment">/*dirichlet_alpha=*/</span>0,</div>
<div class="line"><span class="lineno">  278</span>        <span class="comment">/*dirichlet_epsilon=*/</span>0,</div>
<div class="line"><span class="lineno">  279</span>        <span class="comment">/*dont_return_chance_node=*/</span><span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span> (az_player == 1) {</div>
<div class="line"><span class="lineno">  281</span>      std::swap(bots[0], bots[1]);</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    logger.Print(<span class="stringliteral">&quot;Running MCTS with %d simulations&quot;</span>, rand_max_simulations);</div>
<div class="line"><span class="lineno">  285</span>    Trajectory trajectory = <a class="code hl_function" href="simple__gin__rummy__bot__example_8cc.html#a70e8a75d545a109419ffb09fc16be6f6">PlayGame</a>(</div>
<div class="line"><span class="lineno">  286</span>        &amp;logger, game_num, game, &amp;bots, &amp;rng, <span class="comment">/*temperature=*/</span>1,</div>
<div class="line"><span class="lineno">  287</span>        <span class="comment">/*temperature_drop=*/</span>0, <span class="comment">/*cutoff_value=*/</span>game.MaxUtility() + 1);</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>    results-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#a39a24c775717f28cfa48d0e9d44314bb">Add</a>(difficulty, trajectory.returns[az_player]);</div>
<div class="line"><span class="lineno">  290</span>    logger.Print(<span class="stringliteral">&quot;Game %d: AZ: %5.2f, MCTS: %5.2f, MCTS-sims: %d, length: %d&quot;</span>,</div>
<div class="line"><span class="lineno">  291</span>                 game_num, trajectory.returns[az_player],</div>
<div class="line"><span class="lineno">  292</span>                 trajectory.returns[1 - az_player], rand_max_simulations,</div>
<div class="line"><span class="lineno">  293</span>                 trajectory.states.size());</div>
<div class="line"><span class="lineno">  294</span>  }</div>
<div class="line"><span class="lineno">  295</span>  logger.Print(<span class="stringliteral">&quot;Got a quit.&quot;</span>);</div>
<div class="line"><span class="lineno">  296</span>}</div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results_html_a39a24c775717f28cfa48d0e9d44314bb"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#a39a24c775717f28cfa48d0e9d44314bb">open_spiel::algorithms::torch_az::EvalResults::Add</a></div><div class="ttdeci">void Add(int i, double value)</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00232">alpha_zero.cc:232</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results_html_ab7aff12d0ab8545920eea7589100895c"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#ab7aff12d0ab8545920eea7589100895c">open_spiel::algorithms::torch_az::EvalResults::Next</a></div><div class="ttdeci">std::pair&lt; int, bool &gt; Next()</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00225">alpha_zero.cc:225</a></div></div>
<div class="ttc" id="ahands_8cpp_html_a1334c4a4638471a447d2290b7ceaf345"><div class="ttname"><a href="hands_8cpp.html#a1334c4a4638471a447d2290b7ceaf345">first</a></div><div class="ttdeci">int first[3]</div><div class="ttdef"><b>Definition</b> <a href="hands_8cpp_source.html#l00074">hands.cpp:74</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_html_aa5401114eb4044a0bc75f914348e5099"><div class="ttname"><a href="#aa5401114eb4044a0bc75f914348e5099">open_spiel::algorithms::torch_az::InitAZBot</a></div><div class="ttdeci">std::unique_ptr&lt; MCTSBot &gt; InitAZBot(const AlphaZeroConfig &amp;config, const open_spiel::Game &amp;game, std::shared_ptr&lt; Evaluator &gt; evaluator, bool evaluation)</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00163">alpha_zero.cc:163</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a53662e34066a95450ec9a11308086510"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a53662e34066a95450ec9a11308086510">open_spiel::algorithms::torch_az::AlphaZeroConfig::max_simulations</a></div><div class="ttdeci">int max_simulations</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00052">alpha_zero.h:52</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_ae14c212e1b6cd9fb9fc495234e4fe931"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ae14c212e1b6cd9fb9fc495234e4fe931">open_spiel::algorithms::torch_az::AlphaZeroConfig::uct_c</a></div><div class="ttdeci">double uct_c</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00051">alpha_zero.h:51</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="alpha__zero_8cc_source.html#l00232">open_spiel::algorithms::torch_az::EvalResults::Add()</a>, <a class="el" href="hands_8cpp_source.html#l00074">first</a>, <a class="el" href="alpha__zero_8cc_source.html#l00163">InitAZBot()</a>, <a class="el" href="alpha__zero_8h_source.html#l00052">open_spiel::algorithms::torch_az::AlphaZeroConfig::max_simulations</a>, <a class="el" href="alpha__zero_8cc_source.html#l00225">open_spiel::algorithms::torch_az::EvalResults::Next()</a>, <a class="el" href="btree__test_8cc_source.html#l01584">num</a>, <a class="el" href="alpha__zero_8h_source.html#l00032">open_spiel::algorithms::torch_az::AlphaZeroConfig::path</a>, <a class="el" href="alpha__zero_8cc_source.html#l00104">PlayGame()</a>, <a class="el" href="logger_8h_source.html#l00053">open_spiel::FileLogger::Print()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00101">open_spiel::algorithms::torch_az::Trajectory::returns</a>, <a class="el" href="alpha__zero_8cc_source.html#l00100">open_spiel::algorithms::torch_az::Trajectory::states</a>, <a class="el" href="thread_8h_source.html#l00050">open_spiel::StopToken::StopRequested()</a>, <a class="el" href="str__cat_8h_source.html#l00381">absl::StrCat()</a>, <a class="el" href="namespaceopen__spiel_1_1algorithms.html#a2cadfaa2556be62de2302cb2fe4cfb5da96cec03cdb0dea47fe5378fcf5638c01">open_spiel::algorithms::UCT</a>, and <a class="el" href="alpha__zero_8h_source.html#l00051">open_spiel::algorithms::torch_az::AlphaZeroConfig::uct_c</a>.</p>

<p class="reference">Referenced by <a class="el" href="alpha__zero_8cc_source.html#l00496">AlphaZero()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_cgraph">
<area shape="rect" title=" " alt="" coords="5,349,157,390"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#a39a24c775717f28cfa48d0e9d44314bb" title=" " alt="" coords="207,153,396,194"/>
<area shape="poly" title=" " alt="" coords="90,348,133,278,165,239,203,205,212,199,214,204,206,209,169,243,138,281,95,350"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#aa5401114eb4044a0bc75f914348e5099" title=" " alt="" coords="226,219,378,259"/>
<area shape="poly" title=" " alt="" coords="102,347,147,308,203,270,216,264,218,268,206,275,150,313,105,351"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#ab7aff12d0ab8545920eea7589100895c" title=" " alt="" coords="205,284,399,325"/>
<area shape="poly" title=" " alt="" coords="151,346,215,327,217,332,153,351"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a50e57a250c58223d4f65dddb330040d9" title=" " alt="" coords="226,349,378,390"/>
<area shape="poly" title=" " alt="" coords="157,367,211,367,211,372,157,372"/>
<area shape="rect" href="classopen__spiel_1_1_file_logger.html#a56b1c28d743f30e0401814fae8dfdc3e" title=" " alt="" coords="226,436,378,477"/>
<area shape="poly" title=" " alt="" coords="136,388,235,427,233,432,134,393"/>
<area shape="rect" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075" title=" " alt="" coords="225,501,378,542"/>
<area shape="poly" title=" " alt="" coords="101,389,145,437,174,463,206,486,217,492,214,497,203,491,171,467,142,441,97,392"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="256,566,348,592"/>
<area shape="poly" title=" " alt="" coords="93,389,109,425,133,469,166,514,206,551,242,568,240,573,203,556,162,517,129,472,104,427,88,391"/>
<area shape="rect" href="namespaceopen__spiel.html#af4e1a06b98575bc24c84e635a12efec4" title=" " alt="" coords="447,357,633,382"/>
<area shape="poly" title=" " alt="" coords="378,367,431,367,431,372,378,372"/>
<area shape="rect" href="classopen__spiel_1_1_logger.html#a2ac1d943258600354c2853700fd5a8f0" title=" " alt="" coords="475,169,605,210"/>
<area shape="poly" title=" " alt="" coords="376,349,397,334,409,321,415,307,420,279,426,249,433,234,445,220,460,209,463,213,449,224,437,237,431,251,426,279,420,309,413,324,401,338,379,353"/>
<area shape="rect" href="namespaceopen__spiel.html#a5eb64a0ea2eb4de455fbb51e4824c65b" title=" " alt="" coords="454,258,626,284"/>
<area shape="poly" title=" " alt="" coords="372,346,398,334,411,324,421,313,431,303,446,293,458,287,460,292,448,297,434,307,425,317,415,328,400,339,374,351"/>
<area shape="rect" href="namespaceabsl.html#a66735d042e8e255930c66b67f3b39244" title=" " alt="" coords="493,308,587,333"/>
<area shape="poly" title=" " alt="" coords="377,351,477,331,478,336,378,357"/>
<area shape="rect" href="namespaceabsl.html#ae6fbe921bb3366983a0c238625d1048f" title=" " alt="" coords="706,308,841,333"/>
<area shape="poly" title=" " alt="" coords="604,354,694,334,695,340,605,359"/>
<area shape="rect" href="namespaceabsl.html#af37cda8b31ee20257caf8799ed35a66e" title=" " alt="" coords="715,357,832,382"/>
<area shape="poly" title=" " alt="" coords="634,367,700,367,700,372,634,372"/>
<area shape="rect" href="namespaceabsl_1_1container__algorithm__internal.html#a06daa82467b235da8b6b9b1d09b520a1" title=" " alt="" coords="914,365,1080,406"/>
<area shape="poly" title=" " alt="" coords="828,331,866,342,919,358,917,363,865,347,827,336"/>
<area shape="rect" href="namespaceabsl_1_1container__algorithm__internal.html#a00879fc0ada934de06b3b429cecddb57" title=" " alt="" coords="914,300,1080,341"/>
<area shape="poly" title=" " alt="" coords="841,318,898,318,898,323,841,323"/>
<area shape="poly" title=" " alt="" coords="833,371,898,376,898,381,833,377"/>
<area shape="poly" title=" " alt="" coords="832,354,898,339,899,345,833,359"/>
<area shape="poly" title=" " alt="" coords="502,259,494,250,498,240,514,234,540,232,569,234,583,241,581,246,567,239,540,237,515,239,502,244,499,249,506,256"/>
<area shape="rect" href="namespaceabsl.html#af52417fc36b2948cfca4fae144b0046f" title=" " alt="" coords="724,110,823,136"/>
<area shape="poly" title=" " alt="" coords="567,255,632,219,742,143,745,147,635,224,570,260"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#a0eebfd02e61f2e234a5295efe985f198" title=" " alt="" coords="916,71,1078,111"/>
<area shape="poly" title=" " alt="" coords="823,113,900,102,901,107,824,119"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#ab540f8d00b33fedfcd4c8044b16ca079" title=" " alt="" coords="921,136,1073,177"/>
<area shape="poly" title=" " alt="" coords="824,128,906,140,905,145,823,133"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#a8207d795f98f94f497a3e777e2a26084" title=" " alt="" coords="920,5,1074,46"/>
<area shape="poly" title=" " alt="" coords="802,107,913,57,928,50,930,55,915,61,804,112"/>
<area shape="rect" href="namespaceabsl_1_1strings__internal.html#ad5b694c25b0f1ab42df683172f72e1ce" title=" " alt="" coords="703,243,844,283"/>
<area shape="poly" title=" " alt="" coords="587,306,687,281,688,287,588,311"/>
<area shape="rect" href="classabsl_1_1string__view.html#acdd63d87adecc9cb89e3bb2c4efedf47" title=" " alt="" coords="921,250,1073,276"/>
<area shape="poly" title=" " alt="" coords="845,260,905,260,905,266,845,266"/>
<area shape="rect" href="classabsl_1_1string__view.html#a3950f228eccec8f88e34b9a90ad94428" title=" " alt="" coords="921,201,1072,226"/>
<area shape="poly" title=" " alt="" coords="844,245,920,228,921,233,845,250"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#a8d6b92c4076759a646ad110ad69f7c03" title=" " alt="" coords="472,529,609,570"/>
<area shape="poly" title=" " alt="" coords="369,475,400,487,448,514,464,521,462,526,446,519,398,492,367,480"/>
<area shape="rect" href="namespaceabsl.html#aee45114fa5eaa52393e9743f211784f2" title=" " alt="" coords="478,594,602,620"/>
<area shape="poly" title=" " alt="" coords="379,474,401,488,419,512,425,535,432,558,449,580,466,590,463,595,445,584,427,561,420,537,414,514,397,492,377,478"/>
<area shape="rect" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb" title=" " alt="" coords="500,716,580,741"/>
<area shape="poly" title=" " alt="" coords="379,472,401,488,415,506,424,523,430,557,434,592,439,611,449,631,480,671,513,704,509,707,476,675,445,634,434,613,429,593,425,558,419,525,411,509,397,492,376,477"/>
<area shape="rect" href="namespaceabsl.html#a98cbbfcb2d5675cc43cc9a278c015294" title=" " alt="" coords="484,414,596,440"/>
<area shape="poly" title=" " alt="" coords="377,444,469,433,469,438,378,450"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#ad3e0b39c19efd6e65cd59b9dfe653323" title=" " alt="" coords="472,464,609,505"/>
<area shape="poly" title=" " alt="" coords="378,463,456,472,456,477,377,468"/>
<area shape="rect" href="namespaceabsl.html#ac19c128151577d722fb1b07f93b0edf3" title=" " alt="" coords="709,552,838,577"/>
<area shape="poly" title=" " alt="" coords="602,593,693,576,694,581,603,598"/>
<area shape="rect" href="namespaceabsl.html#a8512559742557e00fd92e6b92aeb23fa" title=" " alt="" coords="714,601,833,626"/>
<area shape="poly" title=" " alt="" coords="602,606,698,609,698,614,602,611"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a03ac95838baccb5f128b99788affe9f7" title=" " alt="" coords="706,651,841,691"/>
<area shape="poly" title=" " alt="" coords="580,716,690,689,691,694,581,721"/>
<area shape="rect" href="namespaceabsl.html#a466f5e42bfba7b7295daaa10d530172e" title=" " alt="" coords="681,716,866,741"/>
<area shape="poly" title=" " alt="" coords="581,726,666,726,666,731,581,731"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a08534fb0fd3d4cc76f89c49ea990770b" title=" " alt="" coords="1352,788,1480,829"/>
<area shape="poly" title=" " alt="" coords="581,734,682,751,865,771,1048,786,1337,803,1337,808,1048,791,865,776,681,756,580,739"/>
<area shape="rect" href="namespaceabsl.html#a9c808ce1e415bc23b0303e96414e404a" title=" " alt="" coords="707,820,840,845"/>
<area shape="poly" title=" " alt="" coords="568,739,682,795,722,811,720,816,680,800,565,744"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a38be6aa6cfdce9ed5fe2adf2c1a300bc" title=" " alt="" coords="933,816,1060,857"/>
<area shape="poly" title=" " alt="" coords="840,831,918,832,917,838,840,836"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a159819a84704eb739e572c4a49a5a238" title=" " alt="" coords="1128,816,1304,857"/>
<area shape="poly" title=" " alt="" coords="1061,834,1113,834,1113,839,1061,839"/>
<area shape="poly" title=" " alt="" coords="1304,821,1336,817,1337,822,1305,827"/>
<area shape="rect" href="classabsl_1_1str__format__internal_1_1_untyped_format_spec_impl.html#af84dc9c0f2f14446defb286792924acd" title=" " alt="" coords="686,407,861,463"/>
<area shape="poly" title=" " alt="" coords="596,426,671,429,671,434,596,432"/>
<area shape="rect" href="namespaceabsl_1_1str__format__internal.html#a89bd04bf53e61ab432125c6027bcdcbc" title=" " alt="" coords="693,487,854,527"/>
<area shape="poly" title=" " alt="" coords="597,438,634,450,682,473,697,478,695,483,680,477,632,455,596,443"/>
<area shape="rect" href="namespaceabsl_1_1str__format__internal.html#a3e56f2396d099bf6126c322baa84839c" title=" " alt="" coords="916,487,1078,527"/>
<area shape="poly" title=" " alt="" coords="854,504,900,504,900,510,854,510"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a93a78c3862b261da879f8fa47863e224_icgraph">
<area shape="rect" title=" " alt="" coords="205,5,356,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,5,157,46"/>
<area shape="poly" title=" " alt="" coords="189,28,157,28,157,23,189,23"/>
</map>
</div>

</div>
</div>
<a id="aa5401114eb4044a0bc75f914348e5099" name="aa5401114eb4044a0bc75f914348e5099"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5401114eb4044a0bc75f914348e5099">&#9670;&#160;</a></span>InitAZBot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1_m_c_t_s_bot.html">MCTSBot</a> &gt; open_spiel::algorithms::torch_az::InitAZBot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1_evaluator.html">Evaluator</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>evaluator</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>evaluation</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="alpha__zero_8cc_source.html#l00163">163</a> of file <a class="el" href="alpha__zero_8cc_source.html">alpha_zero.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  166</span>                                                    {</div>
<div class="line"><span class="lineno">  167</span>  <span class="keywordflow">return</span> std::make_unique&lt;MCTSBot&gt;(</div>
<div class="line"><span class="lineno">  168</span>      game, std::move(evaluator), config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#ae14c212e1b6cd9fb9fc495234e4fe931">uct_c</a>, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a53662e34066a95450ec9a11308086510">max_simulations</a>,</div>
<div class="line"><span class="lineno">  169</span>      <span class="comment">/*max_memory_mb=*/</span>10,</div>
<div class="line"><span class="lineno">  170</span>      <span class="comment">/*solve=*/</span><span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  171</span>      <span class="comment">/*seed=*/</span>0,</div>
<div class="line"><span class="lineno">  172</span>      <span class="comment">/*verbose=*/</span><span class="keyword">false</span>, ChildSelectionPolicy::PUCT,</div>
<div class="line"><span class="lineno">  173</span>      <a class="code hl_namespace" href="namespaceevaluation.html">evaluation</a> ? 0 : config.policy_alpha,</div>
<div class="line"><span class="lineno">  174</span>      <a class="code hl_namespace" href="namespaceevaluation.html">evaluation</a> ? 0 : config.policy_epsilon,</div>
<div class="line"><span class="lineno">  175</span>      <span class="comment">/*dont_return_chance_node*/</span> true);</div>
<div class="line"><span class="lineno">  176</span>}</div>
<div class="ttc" id="anamespaceevaluation_html"><div class="ttname"><a href="namespaceevaluation.html">evaluation</a></div><div class="ttdef"><b>Definition</b> <a href="matrix__games_2evaluation_8py_source.html#l00001">evaluation.py:1</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="alpha__zero_8h_source.html#l00052">open_spiel::algorithms::torch_az::AlphaZeroConfig::max_simulations</a>, <a class="el" href="alpha__zero_8h_source.html#l00053">open_spiel::algorithms::torch_az::AlphaZeroConfig::policy_alpha</a>, <a class="el" href="alpha__zero_8h_source.html#l00054">open_spiel::algorithms::torch_az::AlphaZeroConfig::policy_epsilon</a>, <a class="el" href="namespaceopen__spiel_1_1algorithms.html#a2cadfaa2556be62de2302cb2fe4cfb5dac735a97bd083d2eeef49e9bbda3c7e57">open_spiel::algorithms::PUCT</a>, and <a class="el" href="alpha__zero_8h_source.html#l00051">open_spiel::algorithms::torch_az::AlphaZeroConfig::uct_c</a>.</p>

<p class="reference">Referenced by <a class="el" href="alpha__zero_8cc_source.html#l00179">actor()</a>, and <a class="el" href="alpha__zero_8cc_source.html#l00256">evaluator()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_aa5401114eb4044a0bc75f914348e5099_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_aa5401114eb4044a0bc75f914348e5099_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_aa5401114eb4044a0bc75f914348e5099_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_aa5401114eb4044a0bc75f914348e5099_icgraph">
<area shape="rect" title=" " alt="" coords="404,39,555,79"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a6ce4e92571dc52dbf4adc2c85c0aeb0d" title=" " alt="" coords="205,5,356,46"/>
<area shape="poly" title=" " alt="" coords="388,46,356,41,357,36,389,41"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a93a78c3862b261da879f8fa47863e224" title=" " alt="" coords="205,71,356,111"/>
<area shape="poly" title=" " alt="" coords="389,76,357,81,356,76,388,71"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,39,157,79"/>
<area shape="poly" title=" " alt="" coords="190,44,157,49,157,44,189,38"/>
<area shape="poly" title=" " alt="" coords="189,79,157,74,157,69,190,74"/>
</map>
</div>

</div>
</div>
<a id="a116924f1114dd4ba855b9028b443fff2" name="a116924f1114dd4ba855b9028b443fff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116924f1114dd4ba855b9028b443fff2">&#9670;&#160;</a></span>learner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void open_spiel::algorithms::torch_az::learner </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html">AlphaZeroConfig</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html">DeviceManager</a> *</td>          <td class="paramname"><span class="paramname"><em>device_manager</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_evaluator.html">VPNetEvaluator</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>eval</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1_threaded_queue.html">ThreadedQueue</a>&lt; <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>trajectory_queue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html">EvalResults</a> *</td>          <td class="paramname"><span class="paramname"><em>eval_results</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1_stop_token.html">StopToken</a> *</td>          <td class="paramname"><span class="paramname"><em>stop</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html">StartInfo</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>start_info</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="alpha__zero_8cc_source.html#l00298">298</a> of file <a class="el" href="alpha__zero_8cc_source.html">alpha_zero.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  303</span>                                          {</div>
<div class="line"><span class="lineno">  304</span>  <a class="code hl_class" href="classopen__spiel_1_1_file_logger.html">FileLogger</a> logger(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>, <span class="stringliteral">&quot;learner&quot;</span>, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><span class="lineno">  305</span>  <a class="code hl_class" href="classopen__spiel_1_1_data_logger_json_lines.html">DataLoggerJsonLines</a> data_logger(</div>
<div class="line"><span class="lineno">  306</span>      config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a>, <span class="stringliteral">&quot;learner&quot;</span>, <span class="keyword">true</span>, <span class="stringliteral">&quot;a&quot;</span>, start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a106d8c2c2a6709d98fe1eb3b22f192df">start_time</a>);</div>
<div class="line"><span class="lineno">  307</span>  std::mt19937 rng;</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <span class="keywordtype">int</span> device_id = 0;  <span class="comment">// Do not change, the first device is the learner.</span></div>
<div class="line"><span class="lineno">  310</span>  logger.Print(<span class="stringliteral">&quot;Running the learner on device %d: %s&quot;</span>, device_id,</div>
<div class="line"><span class="lineno">  311</span>               device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165">Get</a>(0, device_id)-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a74299f306339bc1d548e40a00117ec95">Device</a>());</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>  <a class="code hl_class" href="classopen__spiel_1_1_serializable_circular_buffer.html">SerializableCircularBuffer&lt;VPNetModel::TrainInputs&gt;</a> replay_buffer(</div>
<div class="line"><span class="lineno">  314</span>      config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#acf186cc5d9ab970bc1cf2d510144c697">replay_buffer_size</a>);</div>
<div class="line"><span class="lineno">  315</span>  <span class="keywordflow">if</span> (start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a391e225a39cbb2b05ad9de1e4e62b599">start_step</a> &gt; 1) {</div>
<div class="line"><span class="lineno">  316</span>    replay_buffer.LoadBuffer(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a> + <span class="stringliteral">&quot;/replay_buffer.data&quot;</span>);</div>
<div class="line"><span class="lineno">  317</span>  }</div>
<div class="line"><span class="lineno">  318</span>  <span class="keywordtype">int</span> learn_rate = config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#acf186cc5d9ab970bc1cf2d510144c697">replay_buffer_size</a> / config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a047e72a48e922dec6056a61e6cb0fd0e">replay_buffer_reuse</a>;</div>
<div class="line"><span class="lineno">  319</span>  int64_t total_trajectories = start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a72c40d01e4e73bde6b2c7da947f81d64">total_trajectories</a>;</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> stage_count = 7;</div>
<div class="line"><span class="lineno">  322</span>  std::vector&lt;open_spiel::BasicStats&gt; value_accuracies(stage_count);</div>
<div class="line"><span class="lineno">  323</span>  std::vector&lt;open_spiel::BasicStats&gt; value_predictions(stage_count);</div>
<div class="line"><span class="lineno">  324</span>  <a class="code hl_class" href="classopen__spiel_1_1_basic_stats.html">open_spiel::BasicStats</a> game_lengths;</div>
<div class="line"><span class="lineno">  325</span>  <a class="code hl_class" href="classopen__spiel_1_1_histogram_numbered.html">open_spiel::HistogramNumbered</a> game_lengths_hist(game.MaxGameLength() + 1);</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  <a class="code hl_class" href="classopen__spiel_1_1_histogram_named.html">open_spiel::HistogramNamed</a> outcomes({<span class="stringliteral">&quot;Player1&quot;</span>, <span class="stringliteral">&quot;Player2&quot;</span>, <span class="stringliteral">&quot;Draw&quot;</span>});</div>
<div class="line"><span class="lineno">  328</span>  <span class="comment">// Actor threads have likely been contributing for a while, so put `last` in</span></div>
<div class="line"><span class="lineno">  329</span>  <span class="comment">// the past to avoid a giant spike on the first step.</span></div>
<div class="line"><span class="lineno">  330</span>  <a class="code hl_class" href="classabsl_1_1_time.html">absl::Time</a> last = <a class="code hl_function" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb">absl::Now</a>() - <a class="code hl_function" href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67">absl::Seconds</a>(60);</div>
<div class="line"><span class="lineno">  331</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> step = start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a391e225a39cbb2b05ad9de1e4e62b599">start_step</a>;</div>
<div class="line"><span class="lineno">  332</span>       !stop-&gt;<a class="code hl_function" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075">StopRequested</a>() &amp;&amp;</div>
<div class="line"><span class="lineno">  333</span>           (config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a59dd53e882cb137ef7695d34f8fa615c">max_steps</a> == 0 || step &lt;= config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a59dd53e882cb137ef7695d34f8fa615c">max_steps</a>);</div>
<div class="line"><span class="lineno">  334</span>       ++step) {</div>
<div class="line"><span class="lineno">  335</span>    outcomes.Reset();</div>
<div class="line"><span class="lineno">  336</span>    game_lengths.<a class="code hl_function" href="classopen__spiel_1_1_basic_stats.html#a3bda2bf3c739b5679d8ae69c2467395b">Reset</a>();</div>
<div class="line"><span class="lineno">  337</span>    game_lengths_hist.Reset();</div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; value_accuracy : value_accuracies) {</div>
<div class="line"><span class="lineno">  339</span>      value_accuracy.Reset();</div>
<div class="line"><span class="lineno">  340</span>    }</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; value_prediction : value_predictions) {</div>
<div class="line"><span class="lineno">  342</span>      value_prediction.Reset();</div>
<div class="line"><span class="lineno">  343</span>    }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">// Collect trajectories</span></div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordtype">int</span> queue_size = trajectory_queue-&gt;<a class="code hl_function" href="classopen__spiel_1_1_threaded_queue.html#a879757635d08eaf0a6134bb9ea04bdde">Size</a>();</div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordtype">int</span> num_states = 0;</div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordtype">int</span> num_trajectories = 0;</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">while</span> (!stop-&gt;<a class="code hl_function" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075">StopRequested</a>() &amp;&amp; num_states &lt; learn_rate) {</div>
<div class="line"><span class="lineno">  350</span>      <a class="code hl_class" href="classabsl_1_1optional.html">absl::optional&lt;Trajectory&gt;</a> trajectory = trajectory_queue-&gt;<a class="code hl_function" href="classopen__spiel_1_1_threaded_queue.html#a27ffd37c853a69bf56c1a4eef2ec93f9">Pop</a>();</div>
<div class="line"><span class="lineno">  351</span>      <span class="keywordflow">if</span> (trajectory) {</div>
<div class="line"><span class="lineno">  352</span>        num_trajectories += 1;</div>
<div class="line"><span class="lineno">  353</span>        total_trajectories += 1;</div>
<div class="line"><span class="lineno">  354</span>        game_lengths.<a class="code hl_function" href="classopen__spiel_1_1_basic_stats.html#a6aa54ee5d0274862cfb0636903ed7cce">Add</a>(trajectory-&gt;states.size());</div>
<div class="line"><span class="lineno">  355</span>        game_lengths_hist.Add(trajectory-&gt;states.size());</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordtype">double</span> p1_outcome = trajectory-&gt;returns[0];</div>
<div class="line"><span class="lineno">  358</span>        outcomes.Add(p1_outcome &gt; 0 ? 0 : (p1_outcome &lt; 0 ? 1 : 2));</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> Trajectory::State&amp; <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a> : trajectory-&gt;states) {</div>
<div class="line"><span class="lineno">  361</span>          replay_buffer.Add(VPNetModel::TrainInputs{<a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>.legal_actions,</div>
<div class="line"><span class="lineno">  362</span>                                                    <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>.observation,</div>
<div class="line"><span class="lineno">  363</span>                                                    <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>.policy, p1_outcome});</div>
<div class="line"><span class="lineno">  364</span>          num_states += 1;</div>
<div class="line"><span class="lineno">  365</span>        }</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> stage = 0; stage &lt; stage_count; ++stage) {</div>
<div class="line"><span class="lineno">  368</span>          <span class="comment">// Scale for the length of the game</span></div>
<div class="line"><span class="lineno">  369</span>          <span class="keywordtype">int</span> index = (trajectory-&gt;states.size() - 1) *</div>
<div class="line"><span class="lineno">  370</span>                      <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(stage) / (stage_count - 1);</div>
<div class="line"><span class="lineno">  371</span>          <span class="keyword">const</span> Trajectory::State&amp; <a class="code hl_enumvalue" href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca03c7c0ace395d80182db07ae2c30f034">s</a> = trajectory-&gt;states[index];</div>
<div class="line"><span class="lineno">  372</span>          value_accuracies[stage].Add(</div>
<div class="line"><span class="lineno">  373</span>              (<a class="code hl_enumvalue" href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca03c7c0ace395d80182db07ae2c30f034">s</a>.value &gt;= 0) == (trajectory-&gt;returns[<a class="code hl_enumvalue" href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca03c7c0ace395d80182db07ae2c30f034">s</a>.current_player] &gt;= 0));</div>
<div class="line"><span class="lineno">  374</span>          value_predictions[stage].Add(abs(<a class="code hl_enumvalue" href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca03c7c0ace395d80182db07ae2c30f034">s</a>.value));</div>
<div class="line"><span class="lineno">  375</span>        }</div>
<div class="line"><span class="lineno">  376</span>      }</div>
<div class="line"><span class="lineno">  377</span>    }</div>
<div class="line"><span class="lineno">  378</span>    <a class="code hl_class" href="classabsl_1_1_time.html">absl::Time</a> now = <a class="code hl_function" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb">absl::Now</a>();</div>
<div class="line"><span class="lineno">  379</span>    <span class="keywordtype">double</span> <a class="code hl_typedef" href="namespaceabsl_1_1time__internal_1_1cctz.html#a8657fa8e941ee4c091cc6cb48650961a">seconds</a> = <a class="code hl_function" href="namespaceabsl.html#a0f34ac58acd0b8dbabfa259dd27e90e9">absl::ToDoubleSeconds</a>(now - last);</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    logger.Print(<span class="stringliteral">&quot;Step: %d&quot;</span>, step);</div>
<div class="line"><span class="lineno">  382</span>    logger.Print(</div>
<div class="line"><span class="lineno">  383</span>        <span class="stringliteral">&quot;Collected %5d states from %3d games, %.1f states/s; &quot;</span></div>
<div class="line"><span class="lineno">  384</span>        <span class="stringliteral">&quot;%.1f states/(s*actor), game length: %.1f&quot;</span>,</div>
<div class="line"><span class="lineno">  385</span>        num_states, num_trajectories, num_states / seconds,</div>
<div class="line"><span class="lineno">  386</span>        num_states / (config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">actors</a> * seconds),</div>
<div class="line"><span class="lineno">  387</span>        <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(num_states) / num_trajectories);</div>
<div class="line"><span class="lineno">  388</span>    logger.Print(<span class="stringliteral">&quot;Queue size: %d. Buffer size: %d. States seen: %d&quot;</span>, queue_size,</div>
<div class="line"><span class="lineno">  389</span>                 replay_buffer.Size(), replay_buffer.TotalAdded());</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">if</span> (stop-&gt;<a class="code hl_function" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075">StopRequested</a>()) {</div>
<div class="line"><span class="lineno">  392</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  393</span>    }</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    last = now;</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>    replay_buffer.SaveBuffer(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a55d9ee521fa0206897c132cb9812783d">path</a> + <span class="stringliteral">&quot;/replay_buffer.data&quot;</span>);</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>    VPNetModel::LossInfo losses;</div>
<div class="line"><span class="lineno">  400</span>    {  <span class="comment">// Extra scope to return the device for use for inference asap.</span></div>
<div class="line"><span class="lineno">  401</span>      DeviceManager::DeviceLoan learn_model =</div>
<div class="line"><span class="lineno">  402</span>          device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165">Get</a>(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9a1be5bec0281c1b6a9b88cf1a31321b">train_batch_size</a>, device_id);</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>      <span class="comment">// Let the device manager know that the first device is now</span></div>
<div class="line"><span class="lineno">  405</span>      <span class="comment">// off-limits for inference and should only be used for learning</span></div>
<div class="line"><span class="lineno">  406</span>      <span class="comment">// (if config.explicit_learning == true).</span></div>
<div class="line"><span class="lineno">  407</span>      device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a42a316b58f32d987ae41afdc178da911">SetLearning</a>(config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a1b154c87aa7db32356688042c269a7b0">explicit_learning</a>);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>      <span class="comment">// Learn from them.</span></div>
<div class="line"><span class="lineno">  410</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> = 0; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> &lt; replay_buffer.Size() / config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9a1be5bec0281c1b6a9b88cf1a31321b">train_batch_size</a>; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>++) {</div>
<div class="line"><span class="lineno">  411</span>        losses += learn_model-&gt;Learn(</div>
<div class="line"><span class="lineno">  412</span>            replay_buffer.Sample(&amp;rng, config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9a1be5bec0281c1b6a9b88cf1a31321b">train_batch_size</a>));</div>
<div class="line"><span class="lineno">  413</span>      }</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>      <span class="comment">// The device manager can now once again use the first device for</span></div>
<div class="line"><span class="lineno">  416</span>      <span class="comment">// inference (if it could not before).</span></div>
<div class="line"><span class="lineno">  417</span>      device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a42a316b58f32d987ae41afdc178da911">SetLearning</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  418</span>    }</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="comment">// Always save a checkpoint, either for keeping or for loading the weights</span></div>
<div class="line"><span class="lineno">  421</span>    <span class="comment">// to the other sessions. It only allows numbers, so use -1 as &quot;latest&quot;.</span></div>
<div class="line"><span class="lineno">  422</span>    std::string checkpoint_path = device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165">Get</a>(0, device_id)</div>
<div class="line"><span class="lineno">  423</span>        -&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a65dc38ee167b98a43c831f55141915f7">SaveCheckpoint</a>(VPNetModel::kMostRecentCheckpointStep);</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">if</span> (step % config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4a6221dce59186baf5ae68e801758bb9">checkpoint_freq</a> == 0) {</div>
<div class="line"><span class="lineno">  425</span>      device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165">Get</a>(0, device_id)-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a65dc38ee167b98a43c831f55141915f7">SaveCheckpoint</a>(step);</div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordflow">if</span> (device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a13ee074af0f7a1140b8c328ae9284301">Count</a>() &gt; 0) {</div>
<div class="line"><span class="lineno">  428</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> = 0; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> &lt; device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a13ee074af0f7a1140b8c328ae9284301">Count</a>(); ++<a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>) {</div>
<div class="line"><span class="lineno">  429</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> != device_id) {</div>
<div class="line"><span class="lineno">  430</span>          device_manager-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165">Get</a>(0, <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>)-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a07f597ead45df9b15172e1f0701447ae">LoadCheckpoint</a>(checkpoint_path);</div>
<div class="line"><span class="lineno">  431</span>        }</div>
<div class="line"><span class="lineno">  432</span>      }</div>
<div class="line"><span class="lineno">  433</span>    }</div>
<div class="line"><span class="lineno">  434</span>    logger.Print(<span class="stringliteral">&quot;Checkpoint saved: %s&quot;</span>, checkpoint_path);</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>    DataLogger::Record record = {</div>
<div class="line"><span class="lineno">  437</span>        {<span class="stringliteral">&quot;step&quot;</span>, <a class="code hl_function" href="namespaceabsl_1_1time__internal_1_1cctz_1_1detail.html#a0db0aec625a5f8f8f294104b08dd99fa">step</a>},</div>
<div class="line"><span class="lineno">  438</span>        {<span class="stringliteral">&quot;total_states&quot;</span>, replay_buffer.TotalAdded()},</div>
<div class="line"><span class="lineno">  439</span>        {<span class="stringliteral">&quot;states_per_s&quot;</span>, num_states / <a class="code hl_typedef" href="namespaceabsl_1_1time__internal_1_1cctz.html#a8657fa8e941ee4c091cc6cb48650961a">seconds</a>},</div>
<div class="line"><span class="lineno">  440</span>        {<span class="stringliteral">&quot;states_per_s_actor&quot;</span>, num_states / (config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9328128047c27c33821d45de7f91e612">actors</a> * <a class="code hl_typedef" href="namespaceabsl_1_1time__internal_1_1cctz.html#a8657fa8e941ee4c091cc6cb48650961a">seconds</a>)},</div>
<div class="line"><span class="lineno">  441</span>        {<span class="stringliteral">&quot;total_trajectories&quot;</span>, total_trajectories},</div>
<div class="line"><span class="lineno">  442</span>        {<span class="stringliteral">&quot;trajectories_per_s&quot;</span>, num_trajectories / <a class="code hl_typedef" href="namespaceabsl_1_1time__internal_1_1cctz.html#a8657fa8e941ee4c091cc6cb48650961a">seconds</a>},</div>
<div class="line"><span class="lineno">  443</span>        {<span class="stringliteral">&quot;queue_size&quot;</span>, queue_size},</div>
<div class="line"><span class="lineno">  444</span>        {<span class="stringliteral">&quot;game_length&quot;</span>, game_lengths.<a class="code hl_function" href="classopen__spiel_1_1_basic_stats.html#a319382642f8fb5eb9328b29e766d20f4">ToJson</a>()},</div>
<div class="line"><span class="lineno">  445</span>        {<span class="stringliteral">&quot;game_length_hist&quot;</span>, game_lengths_hist.ToJson()},</div>
<div class="line"><span class="lineno">  446</span>        {<span class="stringliteral">&quot;outcomes&quot;</span>, outcomes.ToJson()},</div>
<div class="line"><span class="lineno">  447</span>        {<span class="stringliteral">&quot;value_accuracy&quot;</span>,</div>
<div class="line"><span class="lineno">  448</span>         json::TransformToArray(value_accuracies,</div>
<div class="line"><span class="lineno">  449</span>                                [](<span class="keyword">auto</span> v) { <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca9e3669d19b675bd57058fd4664205d2a">v</a>.ToJson(); })},</div>
<div class="line"><span class="lineno">  450</span>        {<span class="stringliteral">&quot;value_prediction&quot;</span>,</div>
<div class="line"><span class="lineno">  451</span>         json::TransformToArray(value_predictions,</div>
<div class="line"><span class="lineno">  452</span>                                [](<span class="keyword">auto</span> v) { <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca9e3669d19b675bd57058fd4664205d2a">v</a>.ToJson(); })},</div>
<div class="line"><span class="lineno">  453</span>        {<span class="stringliteral">&quot;eval&quot;</span>, json::Object({</div>
<div class="line"><span class="lineno">  454</span>                     {<span class="stringliteral">&quot;count&quot;</span>, eval_results-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#af9f13cc9e977653cb3d6a53ad7697704">EvalCount</a>()},</div>
<div class="line"><span class="lineno">  455</span>                     {<span class="stringliteral">&quot;results&quot;</span>, json::CastToArray(eval_results-&gt;<a class="code hl_function" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#aef50405351fb7327726388f169848300">AvgResults</a>())},</div>
<div class="line"><span class="lineno">  456</span>                 })},</div>
<div class="line"><span class="lineno">  457</span>        {<span class="stringliteral">&quot;batch_size&quot;</span>, eval-&gt;BatchSizeStats().ToJson()},</div>
<div class="line"><span class="lineno">  458</span>        {<span class="stringliteral">&quot;batch_size_hist&quot;</span>, eval-&gt;BatchSizeHistogram().ToJson()},</div>
<div class="line"><span class="lineno">  459</span>        {<span class="stringliteral">&quot;loss&quot;</span>, json::Object({</div>
<div class="line"><span class="lineno">  460</span>                     {<span class="stringliteral">&quot;policy&quot;</span>, losses.Policy()},</div>
<div class="line"><span class="lineno">  461</span>                     {<span class="stringliteral">&quot;value&quot;</span>, losses.Value()},</div>
<div class="line"><span class="lineno">  462</span>                     {<span class="stringliteral">&quot;l2reg&quot;</span>, losses.L2()},</div>
<div class="line"><span class="lineno">  463</span>                     {<span class="stringliteral">&quot;sum&quot;</span>, losses.Total()},</div>
<div class="line"><span class="lineno">  464</span>                 })},</div>
<div class="line"><span class="lineno">  465</span>    };</div>
<div class="line"><span class="lineno">  466</span>    eval-&gt;ResetBatchSizeStats();</div>
<div class="line"><span class="lineno">  467</span>    logger.Print(<span class="stringliteral">&quot;Losses: policy: %.4f, value: %.4f, l2: %.4f, sum: %.4f&quot;</span>,</div>
<div class="line"><span class="lineno">  468</span>                 losses.Policy(), losses.Value(), losses.L2(), losses.Total());</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    LRUCacheInfo cache_info = eval-&gt;CacheInfo();</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">if</span> (cache_info.size &gt; 0) {</div>
<div class="line"><span class="lineno">  472</span>      logger.Print(<a class="code hl_function" href="namespaceabsl.html#a98cbbfcb2d5675cc43cc9a278c015294">absl::StrFormat</a>(</div>
<div class="line"><span class="lineno">  473</span>          <span class="stringliteral">&quot;Cache size: %d/%d: %.1f%%, hits: %d, misses: %d, hit rate: %.3f%%&quot;</span>,</div>
<div class="line"><span class="lineno">  474</span>          cache_info.size, cache_info.max_size, 100.0 * cache_info.Usage(),</div>
<div class="line"><span class="lineno">  475</span>          cache_info.hits, cache_info.misses, 100.0 * cache_info.HitRate()));</div>
<div class="line"><span class="lineno">  476</span>      eval-&gt;ClearCache();</div>
<div class="line"><span class="lineno">  477</span>    }</div>
<div class="line"><span class="lineno">  478</span>    record.emplace(<span class="stringliteral">&quot;cache&quot;</span>,</div>
<div class="line"><span class="lineno">  479</span>                   json::Object({</div>
<div class="line"><span class="lineno">  480</span>                       {<span class="stringliteral">&quot;size&quot;</span>, cache_info.size},</div>
<div class="line"><span class="lineno">  481</span>                       {<span class="stringliteral">&quot;max_size&quot;</span>, cache_info.max_size},</div>
<div class="line"><span class="lineno">  482</span>                       {<span class="stringliteral">&quot;usage&quot;</span>, cache_info.Usage()},</div>
<div class="line"><span class="lineno">  483</span>                       {<span class="stringliteral">&quot;requests&quot;</span>, cache_info.Total()},</div>
<div class="line"><span class="lineno">  484</span>                       {<span class="stringliteral">&quot;requests_per_s&quot;</span>, cache_info.Total() / seconds},</div>
<div class="line"><span class="lineno">  485</span>                       {<span class="stringliteral">&quot;hits&quot;</span>, cache_info.hits},</div>
<div class="line"><span class="lineno">  486</span>                       {<span class="stringliteral">&quot;misses&quot;</span>, cache_info.misses},</div>
<div class="line"><span class="lineno">  487</span>                       {<span class="stringliteral">&quot;misses_per_s&quot;</span>, cache_info.misses / <a class="code hl_typedef" href="namespaceabsl_1_1time__internal_1_1cctz.html#a8657fa8e941ee4c091cc6cb48650961a">seconds</a>},</div>
<div class="line"><span class="lineno">  488</span>                       {<span class="stringliteral">&quot;hit_rate&quot;</span>, cache_info.HitRate()},</div>
<div class="line"><span class="lineno">  489</span>                   }));</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    data_logger.Write(record);</div>
<div class="line"><span class="lineno">  492</span>    logger.Print(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  493</span>  }</div>
<div class="line"><span class="lineno">  494</span>}</div>
<div class="ttc" id="aclassabsl_1_1_time_html"><div class="ttname"><a href="classabsl_1_1_time.html">absl::Time</a></div><div class="ttdef"><b>Definition</b> <a href="time_8h_source.html#l00683">time.h:683</a></div></div>
<div class="ttc" id="aclassabsl_1_1optional_html"><div class="ttname"><a href="classabsl_1_1optional.html">absl::optional</a></div><div class="ttdef"><b>Definition</b> <a href="optional_8h_source.html#l00119">optional.h:123</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_basic_stats_html"><div class="ttname"><a href="classopen__spiel_1_1_basic_stats.html">open_spiel::BasicStats</a></div><div class="ttdef"><b>Definition</b> <a href="stats_8h_source.html#l00027">stats.h:27</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_basic_stats_html_a319382642f8fb5eb9328b29e766d20f4"><div class="ttname"><a href="classopen__spiel_1_1_basic_stats.html#a319382642f8fb5eb9328b29e766d20f4">open_spiel::BasicStats::ToJson</a></div><div class="ttdeci">json::Object ToJson() const</div><div class="ttdef"><b>Definition</b> <a href="stats_8h_source.html#l00069">stats.h:69</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_basic_stats_html_a3bda2bf3c739b5679d8ae69c2467395b"><div class="ttname"><a href="classopen__spiel_1_1_basic_stats.html#a3bda2bf3c739b5679d8ae69c2467395b">open_spiel::BasicStats::Reset</a></div><div class="ttdeci">void Reset()</div><div class="ttdef"><b>Definition</b> <a href="stats_8h_source.html#l00032">stats.h:32</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_basic_stats_html_a6aa54ee5d0274862cfb0636903ed7cce"><div class="ttname"><a href="classopen__spiel_1_1_basic_stats.html#a6aa54ee5d0274862cfb0636903ed7cce">open_spiel::BasicStats::Add</a></div><div class="ttdeci">void Add(double val)</div><div class="ttdef"><b>Definition</b> <a href="stats_8h_source.html#l00050">stats.h:50</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_data_logger_json_lines_html"><div class="ttname"><a href="classopen__spiel_1_1_data_logger_json_lines.html">open_spiel::DataLoggerJsonLines</a></div><div class="ttdef"><b>Definition</b> <a href="data__logger_8h_source.html#l00038">data_logger.h:38</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_histogram_named_html"><div class="ttname"><a href="classopen__spiel_1_1_histogram_named.html">open_spiel::HistogramNamed</a></div><div class="ttdef"><b>Definition</b> <a href="stats_8h_source.html#l00102">stats.h:102</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_histogram_numbered_html"><div class="ttname"><a href="classopen__spiel_1_1_histogram_numbered.html">open_spiel::HistogramNumbered</a></div><div class="ttdef"><b>Definition</b> <a href="stats_8h_source.html#l00089">stats.h:89</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_serializable_circular_buffer_html"><div class="ttname"><a href="classopen__spiel_1_1_serializable_circular_buffer.html">open_spiel::SerializableCircularBuffer</a></div><div class="ttdef"><b>Definition</b> <a href="serializable__circular__buffer_8h_source.html#l00036">serializable_circular_buffer.h:36</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_threaded_queue_html_a27ffd37c853a69bf56c1a4eef2ec93f9"><div class="ttname"><a href="classopen__spiel_1_1_threaded_queue.html#a27ffd37c853a69bf56c1a4eef2ec93f9">open_spiel::ThreadedQueue::Pop</a></div><div class="ttdeci">absl::optional&lt; T &gt; Pop()</div><div class="ttdef"><b>Definition</b> <a href="threaded__queue_8h_source.html#l00054">threaded_queue.h:54</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_threaded_queue_html_a879757635d08eaf0a6134bb9ea04bdde"><div class="ttname"><a href="classopen__spiel_1_1_threaded_queue.html#a879757635d08eaf0a6134bb9ea04bdde">open_spiel::ThreadedQueue::Size</a></div><div class="ttdeci">int Size()</div><div class="ttdef"><b>Definition</b> <a href="threaded__queue_8h_source.html#l00082">threaded_queue.h:82</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager_html_a13ee074af0f7a1140b8c328ae9284301"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a13ee074af0f7a1140b8c328ae9284301">open_spiel::algorithms::torch_az::DeviceManager::Count</a></div><div class="ttdeci">int Count() const</div><div class="ttdef"><b>Definition</b> <a href="device__manager_8h_source.html#l00093">device_manager.h:93</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager_html_a42a316b58f32d987ae41afdc178da911"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a42a316b58f32d987ae41afdc178da911">open_spiel::algorithms::torch_az::DeviceManager::SetLearning</a></div><div class="ttdeci">void SetLearning(bool value)</div><div class="ttdef"><b>Definition</b> <a href="device__manager_8h_source.html#l00091">device_manager.h:91</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager_html_aeeaf55c9b8f39c507240393308434165"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165">open_spiel::algorithms::torch_az::DeviceManager::Get</a></div><div class="ttdeci">DeviceLoan Get(int requests, int device_id=-1)</div><div class="ttdef"><b>Definition</b> <a href="device__manager_8h_source.html#l00070">device_manager.h:70</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results_html_aef50405351fb7327726388f169848300"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#aef50405351fb7327726388f169848300">open_spiel::algorithms::torch_az::EvalResults::AvgResults</a></div><div class="ttdeci">std::vector&lt; double &gt; AvgResults()</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00237">alpha_zero.cc:237</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results_html_af9f13cc9e977653cb3d6a53ad7697704"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#af9f13cc9e977653cb3d6a53ad7697704">open_spiel::algorithms::torch_az::EvalResults::EvalCount</a></div><div class="ttdeci">int EvalCount()</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00219">alpha_zero.cc:219</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_html_a07f597ead45df9b15172e1f0701447ae"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a07f597ead45df9b15172e1f0701447ae">open_spiel::algorithms::torch_az::VPNetModel::LoadCheckpoint</a></div><div class="ttdeci">void LoadCheckpoint(int step)</div><div class="ttdef"><b>Definition</b> <a href="vpnet_8cc_source.html#l00140">vpnet.cc:140</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_html_a65dc38ee167b98a43c831f55141915f7"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a65dc38ee167b98a43c831f55141915f7">open_spiel::algorithms::torch_az::VPNetModel::SaveCheckpoint</a></div><div class="ttdeci">std::string SaveCheckpoint(int step)</div><div class="ttdef"><b>Definition</b> <a href="vpnet_8cc_source.html#l00131">vpnet.cc:131</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_html_a74299f306339bc1d548e40a00117ec95"><div class="ttname"><a href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a74299f306339bc1d548e40a00117ec95">open_spiel::algorithms::torch_az::VPNetModel::Device</a></div><div class="ttdeci">const std::string Device() const</div><div class="ttdef"><b>Definition</b> <a href="vpnet_8h_source.html#l00127">vpnet.h:127</a></div></div>
<div class="ttc" id="anamespaceabsl_1_1time__internal_1_1cctz_1_1detail_html_a0db0aec625a5f8f8f294104b08dd99fa"><div class="ttname"><a href="namespaceabsl_1_1time__internal_1_1cctz_1_1detail.html#a0db0aec625a5f8f8f294104b08dd99fa">absl::time_internal::cctz::detail::step</a></div><div class="ttdeci">CONSTEXPR_F fields step(second_tag, fields f, diff_t n) noexcept</div><div class="ttdef"><b>Definition</b> <a href="civil__time__detail_8h_source.html#l00240">civil_time_detail.h:240</a></div></div>
<div class="ttc" id="anamespaceabsl_1_1time__internal_1_1cctz_html_a8657fa8e941ee4c091cc6cb48650961a"><div class="ttname"><a href="namespaceabsl_1_1time__internal_1_1cctz.html#a8657fa8e941ee4c091cc6cb48650961a">absl::time_internal::cctz::seconds</a></div><div class="ttdeci">std::chrono::duration&lt; std::int_fast64_t &gt; seconds</div><div class="ttdef"><b>Definition</b> <a href="time__zone_8h_source.html#l00040">time_zone.h:40</a></div></div>
<div class="ttc" id="anamespaceabsl_html_a0f34ac58acd0b8dbabfa259dd27e90e9"><div class="ttname"><a href="namespaceabsl.html#a0f34ac58acd0b8dbabfa259dd27e90e9">absl::ToDoubleSeconds</a></div><div class="ttdeci">double ToDoubleSeconds(Duration d)</div><div class="ttdef"><b>Definition</b> <a href="duration_8cc_source.html#l00596">duration.cc:596</a></div></div>
<div class="ttc" id="anamespaceabsl_html_a828e0f13fb3947cdf6406b7a4feec8aca03c7c0ace395d80182db07ae2c30f034"><div class="ttname"><a href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca03c7c0ace395d80182db07ae2c30f034">absl::FormatConversionChar::s</a></div><div class="ttdeci">@ s</div></div>
<div class="ttc" id="anamespaceabsl_html_a828e0f13fb3947cdf6406b7a4feec8aca9e3669d19b675bd57058fd4664205d2a"><div class="ttname"><a href="namespaceabsl.html#a828e0f13fb3947cdf6406b7a4feec8aca9e3669d19b675bd57058fd4664205d2a">absl::FormatConversionChar::v</a></div><div class="ttdeci">@ v</div></div>
<div class="ttc" id="anamespaceabsl_html_a98cbbfcb2d5675cc43cc9a278c015294"><div class="ttname"><a href="namespaceabsl.html#a98cbbfcb2d5675cc43cc9a278c015294">absl::StrFormat</a></div><div class="ttdeci">ABSL_MUST_USE_RESULT std::string StrFormat(const FormatSpec&lt; Args... &gt; &amp;format, const Args &amp;... args)</div><div class="ttdef"><b>Definition</b> <a href="str__format_8h_source.html#l00351">str_format.h:351</a></div></div>
<div class="ttc" id="apolicy__iteration_8cc_html_aef5972335703cda91a1daa78e046d9d5"><div class="ttname"><a href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a></div><div class="ttdeci">std::unique_ptr&lt; State &gt; state</div><div class="ttdef"><b>Definition</b> <a href="policy__iteration_8cc_source.html#l00030">policy_iteration.cc:30</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a4a6221dce59186baf5ae68e801758bb9"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a4a6221dce59186baf5ae68e801758bb9">open_spiel::algorithms::torch_az::AlphaZeroConfig::checkpoint_freq</a></div><div class="ttdeci">int checkpoint_freq</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00048">alpha_zero.h:48</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a59dd53e882cb137ef7695d34f8fa615c"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a59dd53e882cb137ef7695d34f8fa615c">open_spiel::algorithms::torch_az::AlphaZeroConfig::max_steps</a></div><div class="ttdeci">int max_steps</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00063">alpha_zero.h:63</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config_html_a9a1be5bec0281c1b6a9b88cf1a31321b"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_alpha_zero_config.html#a9a1be5bec0281c1b6a9b88cf1a31321b">open_spiel::algorithms::torch_az::AlphaZeroConfig::train_batch_size</a></div><div class="ttdeci">int train_batch_size</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8h_source.html#l00042">alpha_zero.h:42</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info_html_a106d8c2c2a6709d98fe1eb3b22f192df"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a106d8c2c2a6709d98fe1eb3b22f192df">open_spiel::algorithms::torch_az::StartInfo::start_time</a></div><div class="ttdeci">absl::Time start_time</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00056">alpha_zero.cc:56</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info_html_a391e225a39cbb2b05ad9de1e4e62b599"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a391e225a39cbb2b05ad9de1e4e62b599">open_spiel::algorithms::torch_az::StartInfo::start_step</a></div><div class="ttdeci">int start_step</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00057">alpha_zero.cc:57</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info_html_a72c40d01e4e73bde6b2c7da947f81d64"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a72c40d01e4e73bde6b2c7da947f81d64">open_spiel::algorithms::torch_az::StartInfo::total_trajectories</a></div><div class="ttdeci">int64_t total_trajectories</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00059">alpha_zero.cc:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="alpha__zero_8h_source.html#l00060">open_spiel::algorithms::torch_az::AlphaZeroConfig::actors</a>, <a class="el" href="stats_8h_source.html#l00050">open_spiel::BasicStats::Add()</a>, <a class="el" href="circular__buffer_8h_source.html#l00033">open_spiel::CircularBuffer&lt; T &gt;::Add()</a>, <a class="el" href="stats_8h_source.html#l00093">open_spiel::HistogramNumbered::Add()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00237">open_spiel::algorithms::torch_az::EvalResults::AvgResults()</a>, <a class="el" href="json_8h_source.html#l00127">open_spiel::json::CastToArray()</a>, <a class="el" href="alpha__zero_8h_source.html#l00048">open_spiel::algorithms::torch_az::AlphaZeroConfig::checkpoint_freq</a>, <a class="el" href="device__manager_8h_source.html#l00093">open_spiel::algorithms::torch_az::DeviceManager::Count()</a>, <a class="el" href="vpnet_8h_source.html#l00127">open_spiel::algorithms::torch_az::VPNetModel::Device()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00219">open_spiel::algorithms::torch_az::EvalResults::EvalCount()</a>, <a class="el" href="alpha__zero_8h_source.html#l00039">open_spiel::algorithms::torch_az::AlphaZeroConfig::explicit_learning</a>, <a class="el" href="device__manager_8h_source.html#l00070">open_spiel::algorithms::torch_az::DeviceManager::Get()</a>, <a class="el" href="lru__cache_8h_source.html#l00035">open_spiel::LRUCacheInfo::HitRate()</a>, <a class="el" href="lru__cache_8h_source.html#l00026">open_spiel::LRUCacheInfo::hits</a>, <a class="el" href="btree__benchmark_8cc_source.html#l00232">i</a>, <a class="el" href="vpnet_8h_source.html#l00102">open_spiel::algorithms::torch_az::VPNetModel::kMostRecentCheckpointStep</a>, <a class="el" href="vpnet_8h_source.html#l00059">open_spiel::algorithms::torch_az::VPNetModel::LossInfo::L2()</a>, <a class="el" href="vpnet_8cc_source.html#l00204">open_spiel::algorithms::torch_az::VPNetModel::Learn()</a>, <a class="el" href="vpnet_8h_source.html#l00093">open_spiel::algorithms::torch_az::VPNetModel::TrainInputs::legal_actions</a>, <a class="el" href="serializable__circular__buffer_8h_source.html#l00050">open_spiel::SerializableCircularBuffer&lt; T &gt;::LoadBuffer()</a>, <a class="el" href="vpnet_8cc_source.html#l00140">open_spiel::algorithms::torch_az::VPNetModel::LoadCheckpoint()</a>, <a class="el" href="lru__cache_8h_source.html#l00029">open_spiel::LRUCacheInfo::max_size</a>, <a class="el" href="alpha__zero_8h_source.html#l00063">open_spiel::algorithms::torch_az::AlphaZeroConfig::max_steps</a>, <a class="el" href="lru__cache_8h_source.html#l00027">open_spiel::LRUCacheInfo::misses</a>, <a class="el" href="clock_8cc_source.html#l00039">absl::Now()</a>, <a class="el" href="alpha__zero_8h_source.html#l00032">open_spiel::algorithms::torch_az::AlphaZeroConfig::path</a>, <a class="el" href="vpnet_8h_source.html#l00057">open_spiel::algorithms::torch_az::VPNetModel::LossInfo::Policy()</a>, <a class="el" href="threaded__queue_8h_source.html#l00054">open_spiel::ThreadedQueue&lt; T &gt;::Pop()</a>, <a class="el" href="logger_8h_source.html#l00053">open_spiel::FileLogger::Print()</a>, <a class="el" href="alpha__zero_8h_source.html#l00047">open_spiel::algorithms::torch_az::AlphaZeroConfig::replay_buffer_reuse</a>, <a class="el" href="alpha__zero_8h_source.html#l00046">open_spiel::algorithms::torch_az::AlphaZeroConfig::replay_buffer_size</a>, <a class="el" href="stats_8h_source.html#l00032">open_spiel::BasicStats::Reset()</a>, <a class="el" href="stats_8h_source.html#l00092">open_spiel::HistogramNumbered::Reset()</a>, <a class="el" href="circular__buffer_8h_source.html#l00043">open_spiel::CircularBuffer&lt; T &gt;::Sample()</a>, <a class="el" href="serializable__circular__buffer_8h_source.html#l00042">open_spiel::SerializableCircularBuffer&lt; T &gt;::SaveBuffer()</a>, <a class="el" href="vpnet_8cc_source.html#l00131">open_spiel::algorithms::torch_az::VPNetModel::SaveCheckpoint()</a>, <a class="el" href="time_8h_source.html#l00451">absl::Seconds()</a>, <a class="el" href="device__manager_8h_source.html#l00091">open_spiel::algorithms::torch_az::DeviceManager::SetLearning()</a>, <a class="el" href="circular__buffer_8h_source.html#l00057">open_spiel::CircularBuffer&lt; T &gt;::Size()</a>, <a class="el" href="threaded__queue_8h_source.html#l00082">open_spiel::ThreadedQueue&lt; T &gt;::Size()</a>, <a class="el" href="lru__cache_8h_source.html#l00028">open_spiel::LRUCacheInfo::size</a>, <a class="el" href="alpha__zero_8cc_source.html#l00057">open_spiel::algorithms::torch_az::StartInfo::start_step</a>, <a class="el" href="alpha__zero_8cc_source.html#l00056">open_spiel::algorithms::torch_az::StartInfo::start_time</a>, <a class="el" href="policy__iteration_8cc_source.html#l00030">state</a>, <a class="el" href="thread_8h_source.html#l00050">open_spiel::StopToken::StopRequested()</a>, <a class="el" href="str__format_8h_source.html#l00351">absl::StrFormat()</a>, <a class="el" href="duration_8cc_source.html#l00596">absl::ToDoubleSeconds()</a>, <a class="el" href="stats_8h_source.html#l00069">open_spiel::BasicStats::ToJson()</a>, <a class="el" href="stats_8h_source.html#l00094">open_spiel::HistogramNumbered::ToJson()</a>, <a class="el" href="vpnet_8h_source.html#l00060">open_spiel::algorithms::torch_az::VPNetModel::LossInfo::Total()</a>, <a class="el" href="lru__cache_8h_source.html#l00034">open_spiel::LRUCacheInfo::Total()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00059">open_spiel::algorithms::torch_az::StartInfo::total_trajectories</a>, <a class="el" href="circular__buffer_8h_source.html#l00063">open_spiel::CircularBuffer&lt; T &gt;::TotalAdded()</a>, <a class="el" href="alpha__zero_8h_source.html#l00042">open_spiel::algorithms::torch_az::AlphaZeroConfig::train_batch_size</a>, <a class="el" href="json_8h_source.html#l00139">open_spiel::json::TransformToArray()</a>, <a class="el" href="lru__cache_8h_source.html#l00031">open_spiel::LRUCacheInfo::Usage()</a>, and <a class="el" href="vpnet_8h_source.html#l00058">open_spiel::algorithms::torch_az::VPNetModel::LossInfo::Value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="alpha__zero_8cc_source.html#l00496">AlphaZero()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_cgraph">
<area shape="rect" title=" " alt="" coords="5,1162,157,1202"/>
<area shape="rect" href="classopen__spiel_1_1_basic_stats.html#a6aa54ee5d0274862cfb0636903ed7cce" title=" " alt="" coords="233,5,419,31"/>
<area shape="poly" title=" " alt="" coords="80,1161,91,936,114,578,130,395,151,232,175,108,188,66,203,40,217,29,220,33,207,44,193,68,180,110,156,233,136,395,119,579,96,936,86,1161"/>
<area shape="rect" href="classopen__spiel_1_1_circular_buffer.html#ad2de53bedb6f2123d64e6aa12b58b0b7" title=" " alt="" coords="225,55,427,80"/>
<area shape="poly" title=" " alt="" coords="81,1161,92,945,115,603,132,428,152,273,175,154,189,114,203,90,210,83,213,87,207,93,193,117,181,156,157,273,137,428,121,603,97,945,86,1161"/>
<area shape="rect" href="classopen__spiel_1_1_histogram_numbered.html#af1dd234caf1522f78f73d64c62591df1" title=" " alt="" coords="205,104,447,130"/>
<area shape="poly" title=" " alt="" coords="81,1161,93,954,117,628,134,462,154,314,177,202,189,164,203,141,205,138,209,141,207,144,194,166,182,203,159,315,139,462,122,629,98,954,86,1161"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#aef50405351fb7327726388f169848300" title=" " alt="" coords="247,154,405,210"/>
<area shape="poly" title=" " alt="" coords="80,1161,82,984,87,851,96,705,111,557,133,421,147,360,163,307,181,262,203,227,231,203,234,208,207,231,186,264,168,308,152,361,138,422,116,558,101,705,92,851,87,984,85,1161"/>
<area shape="rect" href="namespaceopen__spiel_1_1json.html#afaa0bf12de1061d4916a520d97cdc046" title=" " alt="" coords="502,256,667,297"/>
<area shape="poly" title=" " alt="" coords="81,1161,93,976,118,691,135,546,155,418,177,322,190,290,203,271,237,247,276,232,317,224,359,222,442,231,514,249,512,254,441,236,359,227,318,229,277,237,240,252,207,275,194,293,182,324,160,420,140,547,124,691,99,976,86,1161"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a13ee074af0f7a1140b8c328ae9284301" title=" " alt="" coords="237,349,415,405"/>
<area shape="poly" title=" " alt="" coords="80,1161,87,1015,105,791,121,674,142,566,169,477,185,442,203,415,222,399,225,403,207,419,189,445,174,479,147,568,126,675,110,792,92,1015,85,1161"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a74299f306339bc1d548e40a00117ec95" title=" " alt="" coords="245,429,406,485"/>
<area shape="poly" title=" " alt="" coords="81,1161,89,1028,110,829,126,725,146,629,171,550,186,519,203,495,229,474,233,479,207,499,191,522,176,552,151,631,131,726,115,830,94,1029,86,1162"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_eval_results.html#af9f13cc9e977653cb3d6a53ad7697704" title=" " alt="" coords="247,509,405,565"/>
<area shape="poly" title=" " alt="" coords="81,1161,92,1042,114,867,131,776,150,692,174,623,188,596,203,575,231,554,234,558,207,579,193,599,179,625,156,694,136,777,120,868,97,1043,86,1162"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#aeeaf55c9b8f39c507240393308434165" title=" " alt="" coords="222,588,430,629"/>
<area shape="poly" title=" " alt="" coords="82,1161,94,1055,118,900,135,821,154,748,177,687,203,646,213,636,217,640,207,649,182,690,159,749,140,822,124,901,99,1055,87,1162"/>
<area shape="rect" href="structopen__spiel_1_1_l_r_u_cache_info.html#ab23726ee0c9ad951d74688c5765c8ac2" title=" " alt="" coords="237,703,415,744"/>
<area shape="poly" title=" " alt="" coords="79,1161,83,1087,98,980,114,921,135,863,165,809,203,760,221,746,225,750,207,764,169,811,140,865,119,923,103,981,88,1087,85,1161"/>
<area shape="rect" href="structopen__spiel_1_1_l_r_u_cache_info.html#a32f56bb3c7d0ed9bd1c63c29ad9a377e" title=" " alt="" coords="495,695,673,736"/>
<area shape="poly" title=" " alt="" coords="82,1161,93,1060,116,917,132,843,152,777,175,724,189,704,203,689,240,667,281,654,324,649,368,649,411,655,452,664,523,687,522,692,451,669,410,660,367,655,324,654,282,659,242,672,206,694,193,707,180,727,157,779,138,845,121,918,98,1061,87,1162"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_1_1_loss_info.html#a223228c4ab1c3a8b9a3a7279c4bb3fb8" title=" " alt="" coords="504,761,665,817"/>
<area shape="poly" title=" " alt="" coords="79,1161,82,1091,87,1043,97,992,112,939,134,889,164,843,203,804,235,784,270,769,307,760,345,755,420,754,488,763,488,768,420,760,345,760,308,765,272,775,238,789,206,808,168,846,139,891,117,941,102,993,92,1044,87,1091,84,1162"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a3cd6b3933712da41eacac728cc0e5973" title=" " alt="" coords="245,1000,406,1055"/>
<area shape="poly" title=" " alt="" coords="97,1160,142,1113,172,1087,203,1065,230,1052,233,1056,206,1070,175,1092,146,1117,101,1163"/>
<area shape="rect" href="classopen__spiel_1_1_serializable_circular_buffer.html#a9d3a6c6f81e680a9657c083c9a3b2348" title=" " alt="" coords="240,1079,412,1120"/>
<area shape="poly" title=" " alt="" coords="139,1159,204,1136,243,1122,245,1128,206,1141,140,1164"/>
<area shape="rect" href="namespaceabsl.html#a98cbbfcb2d5675cc43cc9a278c015294" title=" " alt="" coords="528,1144,640,1170"/>
<area shape="poly" title=" " alt="" coords="157,1176,513,1158,513,1163,157,1181"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a07f597ead45df9b15172e1f0701447ae" title=" " alt="" coords="245,1408,406,1463"/>
<area shape="poly" title=" " alt="" coords="94,1202,136,1281,168,1327,206,1370,245,1398,242,1402,203,1373,164,1331,132,1284,89,1204"/>
<area shape="rect" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb" title=" " alt="" coords="544,1195,624,1220"/>
<area shape="poly" title=" " alt="" coords="157,1183,529,1202,529,1207,157,1189"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_1_1_loss_info.html#a3ec4b014375ed4077d9f2da65052a427" title=" " alt="" coords="504,844,665,899"/>
<area shape="poly" title=" " alt="" coords="84,1161,97,1115,119,1055,154,994,177,966,203,943,243,928,315,912,487,883,488,888,316,917,244,933,206,947,181,970,159,997,124,1058,102,1116,89,1162"/>
<area shape="rect" href="classopen__spiel_1_1_threaded_queue.html#a27ffd37c853a69bf56c1a4eef2ec93f9" title=" " alt="" coords="219,1333,433,1359"/>
<area shape="poly" title=" " alt="" coords="102,1201,147,1247,206,1295,237,1312,269,1325,267,1330,235,1316,203,1299,143,1251,98,1205"/>
<area shape="rect" href="classopen__spiel_1_1_file_logger.html#a56b1c28d743f30e0401814fae8dfdc3e" title=" " alt="" coords="250,1244,402,1285"/>
<area shape="poly" title=" " alt="" coords="140,1201,206,1224,245,1237,243,1242,204,1229,139,1206"/>
<area shape="rect" href="classopen__spiel_1_1_basic_stats.html#a3bda2bf3c739b5679d8ae69c2467395b" title=" " alt="" coords="248,1567,404,1608"/>
<area shape="poly" title=" " alt="" coords="85,1203,90,1271,108,1365,123,1416,144,1466,172,1513,206,1553,235,1572,232,1576,203,1558,167,1516,139,1469,118,1418,103,1366,85,1271,80,1203"/>
<area shape="rect" href="classopen__spiel_1_1_histogram_numbered.html#ae925c4561ea2bf8e594ef87e09e0476b" title=" " alt="" coords="220,1632,432,1673"/>
<area shape="poly" title=" " alt="" coords="84,1203,86,1280,91,1333,100,1392,115,1453,137,1513,167,1569,207,1618,211,1621,207,1625,203,1621,163,1572,132,1515,110,1454,95,1393,86,1334,81,1281,79,1203"/>
<area shape="rect" href="classopen__spiel_1_1_circular_buffer.html#a0ce7982b639398668e094ef1cd16fe38" title=" " alt="" coords="240,1698,412,1738"/>
<area shape="poly" title=" " alt="" coords="87,1202,100,1303,125,1448,141,1523,161,1590,182,1646,207,1683,228,1698,224,1703,203,1687,178,1648,155,1592,136,1524,120,1449,95,1304,82,1203"/>
<area shape="rect" href="classopen__spiel_1_1_serializable_circular_buffer.html#a6f0bda5d3dae44c6c6d4cd4d53f875ae" title=" " alt="" coords="239,1763,413,1804"/>
<area shape="poly" title=" " alt="" coords="87,1202,98,1315,121,1480,137,1565,157,1642,180,1706,193,1730,207,1748,226,1763,223,1767,203,1752,188,1733,175,1708,152,1644,132,1566,116,1481,93,1316,81,1203"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model.html#a65dc38ee167b98a43c831f55141915f7" title=" " alt="" coords="245,1488,406,1543"/>
<area shape="poly" title=" " alt="" coords="88,1202,98,1256,119,1329,135,1368,154,1406,178,1442,206,1473,233,1491,230,1496,203,1478,174,1445,150,1409,130,1370,114,1331,93,1258,82,1203"/>
<area shape="rect" href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67" title=" " alt="" coords="532,1853,636,1879"/>
<area shape="poly" title=" " alt="" coords="86,1203,94,1328,114,1514,130,1609,150,1696,176,1767,190,1794,206,1814,228,1827,259,1838,341,1853,434,1861,517,1864,516,1869,433,1866,341,1859,258,1843,226,1832,203,1817,186,1797,171,1769,145,1698,124,1610,109,1514,89,1329,81,1203"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_device_manager.html#a42a316b58f32d987ae41afdc178da911" title=" " alt="" coords="237,1929,415,1985"/>
<area shape="poly" title=" " alt="" coords="86,1203,93,1344,112,1558,128,1670,148,1773,175,1857,190,1890,207,1915,225,1931,222,1935,203,1919,185,1893,170,1859,143,1774,123,1671,107,1559,87,1344,80,1203"/>
<area shape="rect" href="classopen__spiel_1_1_circular_buffer.html#a87ec1c97cda7fdb627118bee72be53fb" title=" " alt="" coords="240,2008,412,2049"/>
<area shape="poly" title=" " alt="" coords="85,1203,89,1358,106,1597,121,1722,142,1837,171,1931,188,1968,207,1995,228,2012,225,2016,203,1999,183,1970,166,1933,137,1838,116,1723,100,1597,84,1358,80,1203"/>
<area shape="rect" href="classopen__spiel_1_1_threaded_queue.html#a879757635d08eaf0a6134bb9ea04bdde" title=" " alt="" coords="234,2074,418,2114"/>
<area shape="poly" title=" " alt="" coords="85,1203,88,1369,93,1492,102,1627,117,1762,139,1887,153,1942,168,1990,186,2029,207,2059,222,2072,219,2076,203,2063,182,2032,163,1992,147,1943,134,1888,112,1763,97,1627,88,1492,82,1369,80,1203"/>
<area shape="rect" href="classopen__spiel_1_1_stop_token.html#a6f24b7509d39170e844de885122de075" title=" " alt="" coords="249,2139,402,2180"/>
<area shape="poly" title=" " alt="" coords="85,1203,86,1380,90,1512,99,1657,113,1803,135,1938,149,1997,166,2049,185,2092,207,2124,220,2136,236,2145,233,2150,217,2140,203,2128,180,2095,161,2051,144,1999,130,1939,108,1804,93,1657,85,1512,80,1380,79,1203"/>
<area shape="rect" href="namespaceabsl.html#a0f34ac58acd0b8dbabfa259dd27e90e9" title=" " alt="" coords="246,1879,406,1904"/>
<area shape="poly" title=" " alt="" coords="86,1203,94,1335,114,1532,130,1635,150,1729,176,1806,191,1835,207,1858,233,1876,230,1881,203,1861,186,1838,171,1808,145,1730,125,1636,109,1533,89,1335,81,1203"/>
<area shape="rect" href="classopen__spiel_1_1_basic_stats.html#a319382642f8fb5eb9328b29e766d20f4" title=" " alt="" coords="248,2204,404,2245"/>
<area shape="poly" title=" " alt="" coords="86,1203,99,1404,124,1719,142,1880,161,2023,183,2132,195,2168,207,2190,219,2201,235,2210,232,2215,216,2206,203,2193,190,2170,178,2133,156,2024,136,1881,119,1719,94,1404,81,1203"/>
<area shape="rect" href="classopen__spiel_1_1_histogram_numbered.html#aab9ef6e83848bac0ee191aa98f5f4db8" title=" " alt="" coords="220,284,432,325"/>
<area shape="poly" title=" " alt="" coords="80,1161,83,1001,89,882,99,752,114,622,135,502,164,403,182,364,203,335,206,331,210,335,207,339,187,367,169,405,140,503,119,623,104,753,94,883,88,1001,85,1161"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_1_1_loss_info.html#afcbe21204315bef5a1d0214585b74f65" title=" " alt="" coords="245,818,406,874"/>
<area shape="poly" title=" " alt="" coords="83,1161,94,1107,116,1036,151,959,175,923,203,891,230,871,233,876,206,895,179,926,156,961,121,1037,99,1109,88,1162"/>
<area shape="rect" href="classopen__spiel_1_1algorithms_1_1torch__az_1_1_v_p_net_model_1_1_loss_info.html#a797f6f6ce93efb18b2e11fe8b24f6c6e" title=" " alt="" coords="504,929,665,985"/>
<area shape="poly" title=" " alt="" coords="86,1161,100,1122,124,1073,158,1024,179,1003,203,985,237,968,273,955,348,940,421,936,488,939,488,945,421,941,348,945,274,960,239,973,206,990,183,1007,162,1028,129,1076,105,1124,91,1163"/>
<area shape="rect" href="classopen__spiel_1_1_circular_buffer.html#a1ef7961236ed5c373d6fed456dc3f50d" title=" " alt="" coords="240,2270,412,2310"/>
<area shape="poly" title=" " alt="" coords="86,1203,98,1415,122,1751,139,1924,159,2076,182,2193,194,2232,207,2255,228,2272,225,2276,203,2259,189,2234,177,2194,154,2077,134,1924,117,1752,92,1416,81,1203"/>
<area shape="rect" href="namespaceopen__spiel_1_1json.html#a62980a75698f4220e325ccd53364c269" title=" " alt="" coords="235,2335,417,2376"/>
<area shape="poly" title=" " alt="" coords="86,1203,97,1428,121,1784,137,1968,157,2130,181,2254,193,2296,207,2321,223,2334,219,2338,203,2324,188,2298,175,2255,152,2131,132,1968,115,1785,91,1428,81,1203"/>
<area shape="rect" href="structopen__spiel_1_1_l_r_u_cache_info.html#a1aa5f45a215da06b59357fdcaef48d16" title=" " alt="" coords="237,2400,415,2441"/>
<area shape="poly" title=" " alt="" coords="86,1203,96,1438,119,1816,135,2011,155,2183,179,2315,193,2359,207,2386,224,2401,221,2405,203,2389,188,2361,174,2316,150,2184,130,2011,113,1817,90,1439,80,1203"/>
<area shape="rect" href="namespaceabsl.html#ae6fbe921bb3366983a0c238625d1048f" title=" " alt="" coords="517,169,651,195"/>
<area shape="poly" title=" " alt="" coords="406,180,501,180,501,185,406,185"/>
<area shape="poly" title=" " alt="" coords="415,718,479,716,479,721,416,723"/>
<area shape="rect" href="namespaceopen__spiel.html#a43513b6f8f3a26ce1a64a1a807df9011" title=" " alt="" coords="496,1087,673,1112"/>
<area shape="poly" title=" " alt="" coords="413,1097,480,1097,480,1102,413,1102"/>
<area shape="poly" title=" " alt="" coords="413,1116,514,1139,513,1144,412,1121"/>
<area shape="poly" title=" " alt="" coords="278,1407,279,1397,287,1388,303,1383,326,1381,352,1384,367,1390,365,1395,350,1389,326,1386,304,1388,290,1393,283,1399,283,1407"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="538,1488,630,1514"/>
<area shape="poly" title=" " alt="" coords="408,1453,524,1483,523,1488,406,1458"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a03ac95838baccb5f128b99788affe9f7" title=" " alt="" coords="746,1130,881,1170"/>
<area shape="poly" title=" " alt="" coords="624,1195,730,1168,731,1173,626,1200"/>
<area shape="rect" href="namespaceabsl.html#a466f5e42bfba7b7295daaa10d530172e" title=" " alt="" coords="721,1195,906,1220"/>
<area shape="poly" title=" " alt="" coords="625,1205,706,1205,706,1210,625,1210"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a08534fb0fd3d4cc76f89c49ea990770b" title=" " alt="" coords="750,1355,877,1396"/>
<area shape="poly" title=" " alt="" coords="626,1212,650,1219,675,1231,784,1343,780,1346,672,1235,649,1224,624,1217"/>
<area shape="rect" href="namespaceabsl.html#a9c808ce1e415bc23b0303e96414e404a" title=" " alt="" coords="747,1244,880,1270"/>
<area shape="poly" title=" " alt="" coords="626,1213,736,1238,735,1243,624,1219"/>
<area shape="poly" title=" " alt="" coords="285,1335,277,1325,282,1315,299,1309,326,1307,356,1309,371,1317,369,1321,355,1315,326,1312,300,1314,286,1319,283,1324,290,1331"/>
<area shape="rect" href="namespaceabsl.html#a6ab40a82498f46a1bc88f451a24e54b7" title=" " alt="" coords="514,1424,655,1450"/>
<area shape="poly" title=" " alt="" coords="416,1357,448,1369,463,1379,473,1389,482,1399,496,1409,510,1416,508,1421,494,1414,479,1403,469,1393,460,1383,446,1374,414,1362"/>
<area shape="poly" title=" " alt="" coords="635,1421,734,1394,735,1399,636,1426"/>
<area shape="poly" title=" " alt="" coords="363,1242,424,1211,494,1180,516,1172,518,1177,496,1185,426,1216,366,1247"/>
<area shape="poly" title=" " alt="" coords="402,1245,528,1217,529,1222,403,1251"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#a8d6b92c4076759a646ad110ad69f7c03" title=" " alt="" coords="516,1244,653,1285"/>
<area shape="poly" title=" " alt="" coords="402,1262,500,1262,500,1268,402,1268"/>
<area shape="rect" href="namespaceabsl.html#aee45114fa5eaa52393e9743f211784f2" title=" " alt="" coords="522,1309,646,1335"/>
<area shape="poly" title=" " alt="" coords="403,1279,509,1303,507,1308,402,1284"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#ad3e0b39c19efd6e65cd59b9dfe653323" title=" " alt="" coords="516,1359,653,1400"/>
<area shape="poly" title=" " alt="" coords="403,1276,448,1295,464,1307,473,1320,482,1333,497,1345,504,1350,501,1354,493,1350,478,1336,469,1323,460,1311,446,1299,401,1280"/>
<area shape="poly" title=" " alt="" coords="407,1508,523,1502,523,1507,407,1514"/>
<area shape="poly" title=" " alt="" coords="406,1881,516,1870,517,1875,406,1886"/>
<area shape="poly" title=" " alt="" coords="432,291,485,285,486,290,432,296"/>
<area shape="poly" title=" " alt="" coords="406,826,488,807,489,813,408,831"/>
<area shape="poly" title=" " alt="" coords="407,851,488,859,488,865,407,857"/>
<area shape="poly" title=" " alt="" coords="394,872,504,920,502,925,392,877"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a116924f1114dd4ba855b9028b443fff2_icgraph">
<area shape="rect" title=" " alt="" coords="205,5,356,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,5,157,46"/>
<area shape="poly" title=" " alt="" coords="189,28,157,28,157,23,189,23"/>
</map>
</div>

</div>
</div>
<a id="a4dbd22df502a575efc78f7b5d627d746" name="a4dbd22df502a575efc78f7b5d627d746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dbd22df502a575efc78f7b5d627d746">&#9670;&#160;</a></span>LoadModelConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> open_spiel::algorithms::torch_az::LoadModelConfig </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vpnet_8cc_source.html#l00066">66</a> of file <a class="el" href="vpnet_8cc_source.html">vpnet.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>                                                       {</div>
<div class="line"><span class="lineno">   68</span>  std::ifstream file;</div>
<div class="line"><span class="lineno">   69</span>  file.open(<a class="code hl_function" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df">absl::StrCat</a>(path, <span class="stringliteral">&quot;/&quot;</span>, filename));</div>
<div class="line"><span class="lineno">   70</span>  <a class="code hl_struct" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> net_config;</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>  file &gt;&gt; net_config;</div>
<div class="line"><span class="lineno">   73</span>  file.close();</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">return</span> net_config;</div>
<div class="line"><span class="lineno">   76</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="str__cat_8h_source.html#l00381">absl::StrCat()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a4dbd22df502a575efc78f7b5d627d746_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a4dbd22df502a575efc78f7b5d627d746_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a4dbd22df502a575efc78f7b5d627d746_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a4dbd22df502a575efc78f7b5d627d746_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,194,46"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="242,13,333,38"/>
<area shape="poly" title=" " alt="" coords="194,23,226,23,226,28,194,28"/>
</map>
</div>

</div>
</div>
<a id="a0467afc46ef19d4d99fe243c171721fa" name="a0467afc46ef19d4d99fe243c171721fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0467afc46ef19d4d99fe243c171721fa">&#9670;&#160;</a></span>operator&lt;&lt;()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; open_spiel::algorithms::torch_az::operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;</td>          <td class="paramname"><span class="paramname"><em>stream</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8cc_source.html#l00041">41</a> of file <a class="el" href="model_8cc_source.html">model.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>                                                                      {</div>
<div class="line"><span class="lineno">   42</span>  stream &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#ae548c06556e427bd0538a26a778bd924">observation_tensor_shape</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><span class="lineno">   43</span>         &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#ae548c06556e427bd0538a26a778bd924">observation_tensor_shape</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><span class="lineno">   44</span>         &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#ae548c06556e427bd0538a26a778bd924">observation_tensor_shape</a>[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><span class="lineno">   45</span>         &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a247cd8f33353efea3c88b044fb608b15">number_of_actions</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a3198de7548e8a57bf6ee52dade95a07a">nn_depth</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><span class="lineno">   46</span>         &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#adf046f8903f7122afe5a69a1aada973c">nn_width</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a9bd373ae078eeb8402298026f07876cb">learning_rate</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><span class="lineno">   47</span>         &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#adcc9fa5b43dd211623007741a03f70ca">weight_decay</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#af8144438be81bfdc8f0ac62749ad2709">nn_model</a>;</div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordflow">return</span> stream;</div>
<div class="line"><span class="lineno">   49</span>}</div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html_a247cd8f33353efea3c88b044fb608b15"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a247cd8f33353efea3c88b044fb608b15">open_spiel::algorithms::torch_az::ModelConfig::number_of_actions</a></div><div class="ttdeci">int number_of_actions</div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00064">model.h:64</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html_a3198de7548e8a57bf6ee52dade95a07a"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a3198de7548e8a57bf6ee52dade95a07a">open_spiel::algorithms::torch_az::ModelConfig::nn_depth</a></div><div class="ttdeci">int nn_depth</div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00065">model.h:65</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html_a9bd373ae078eeb8402298026f07876cb"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a9bd373ae078eeb8402298026f07876cb">open_spiel::algorithms::torch_az::ModelConfig::learning_rate</a></div><div class="ttdeci">double learning_rate</div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00067">model.h:67</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html_adcc9fa5b43dd211623007741a03f70ca"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#adcc9fa5b43dd211623007741a03f70ca">open_spiel::algorithms::torch_az::ModelConfig::weight_decay</a></div><div class="ttdeci">double weight_decay</div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00068">model.h:68</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html_adf046f8903f7122afe5a69a1aada973c"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#adf046f8903f7122afe5a69a1aada973c">open_spiel::algorithms::torch_az::ModelConfig::nn_width</a></div><div class="ttdeci">int nn_width</div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00066">model.h:66</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html_ae548c06556e427bd0538a26a778bd924"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#ae548c06556e427bd0538a26a778bd924">open_spiel::algorithms::torch_az::ModelConfig::observation_tensor_shape</a></div><div class="ttdeci">std::vector&lt; int &gt; observation_tensor_shape</div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00063">model.h:63</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config_html_af8144438be81bfdc8f0ac62749ad2709"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#af8144438be81bfdc8f0ac62749ad2709">open_spiel::algorithms::torch_az::ModelConfig::nn_model</a></div><div class="ttdeci">std::string nn_model</div><div class="ttdef"><b>Definition</b> <a href="model_8h_source.html#l00069">model.h:69</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8h_source.html#l00067">open_spiel::algorithms::torch_az::ModelConfig::learning_rate</a>, <a class="el" href="model_8h_source.html#l00065">open_spiel::algorithms::torch_az::ModelConfig::nn_depth</a>, <a class="el" href="model_8h_source.html#l00069">open_spiel::algorithms::torch_az::ModelConfig::nn_model</a>, <a class="el" href="model_8h_source.html#l00066">open_spiel::algorithms::torch_az::ModelConfig::nn_width</a>, <a class="el" href="model_8h_source.html#l00064">open_spiel::algorithms::torch_az::ModelConfig::number_of_actions</a>, <a class="el" href="model_8h_source.html#l00063">open_spiel::algorithms::torch_az::ModelConfig::observation_tensor_shape</a>, and <a class="el" href="model_8h_source.html#l00068">open_spiel::algorithms::torch_az::ModelConfig::weight_decay</a>.</p>

</div>
</div>
<a id="a654d47127d86b175b6fbb09a5fc990b2" name="a654d47127d86b175b6fbb09a5fc990b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654d47127d86b175b6fbb09a5fc990b2">&#9670;&#160;</a></span>operator&gt;&gt;()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::istream &amp; open_spiel::algorithms::torch_az::operator&gt;&gt; </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;</td>          <td class="paramname"><span class="paramname"><em>stream</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="model_8cc_source.html#l00027">27</a> of file <a class="el" href="model_8cc_source.html">model.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   27</span>                                                                {</div>
<div class="line"><span class="lineno">   28</span>  <span class="keywordtype">int</span> channels;</div>
<div class="line"><span class="lineno">   29</span>  <span class="keywordtype">int</span> height;</div>
<div class="line"><span class="lineno">   30</span>  <span class="keywordtype">int</span> width;</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>  stream &gt;&gt; channels &gt;&gt; height &gt;&gt; width &gt;&gt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a247cd8f33353efea3c88b044fb608b15">number_of_actions</a> &gt;&gt;</div>
<div class="line"><span class="lineno">   33</span>      config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a3198de7548e8a57bf6ee52dade95a07a">nn_depth</a> &gt;&gt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#adf046f8903f7122afe5a69a1aada973c">nn_width</a> &gt;&gt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#a9bd373ae078eeb8402298026f07876cb">learning_rate</a> &gt;&gt;</div>
<div class="line"><span class="lineno">   34</span>      config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#adcc9fa5b43dd211623007741a03f70ca">weight_decay</a> &gt;&gt; config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#af8144438be81bfdc8f0ac62749ad2709">nn_model</a>;</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>  config.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html#ae548c06556e427bd0538a26a778bd924">observation_tensor_shape</a> = {channels, height, width};</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  <span class="keywordflow">return</span> stream;</div>
<div class="line"><span class="lineno">   39</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="model_8h_source.html#l00067">open_spiel::algorithms::torch_az::ModelConfig::learning_rate</a>, <a class="el" href="model_8h_source.html#l00065">open_spiel::algorithms::torch_az::ModelConfig::nn_depth</a>, <a class="el" href="model_8h_source.html#l00069">open_spiel::algorithms::torch_az::ModelConfig::nn_model</a>, <a class="el" href="model_8h_source.html#l00066">open_spiel::algorithms::torch_az::ModelConfig::nn_width</a>, <a class="el" href="model_8h_source.html#l00064">open_spiel::algorithms::torch_az::ModelConfig::number_of_actions</a>, <a class="el" href="model_8h_source.html#l00063">open_spiel::algorithms::torch_az::ModelConfig::observation_tensor_shape</a>, and <a class="el" href="model_8h_source.html#l00068">open_spiel::algorithms::torch_az::ModelConfig::weight_decay</a>.</p>

</div>
</div>
<a id="a50e57a250c58223d4f65dddb330040d9" name="a50e57a250c58223d4f65dddb330040d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50e57a250c58223d4f65dddb330040d9">&#9670;&#160;</a></span>PlayGame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a> open_spiel::algorithms::torch_az::PlayGame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classopen__spiel_1_1_logger.html">Logger</a> *</td>          <td class="paramname"><span class="paramname"><em>logger</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>game_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classopen__spiel_1_1_game.html">open_spiel::Game</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classopen__spiel_1_1algorithms_1_1_m_c_t_s_bot.html">MCTSBot</a> &gt; &gt; *</td>          <td class="paramname"><span class="paramname"><em>bots</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::mt19937 *</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>temperature</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>temperature_drop</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>cutoff_value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>verbose</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="alpha__zero_8cc_source.html#l00104">104</a> of file <a class="el" href="alpha__zero_8cc_source.html">alpha_zero.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  107</span>                                                               {</div>
<div class="line"><span class="lineno">  108</span>  std::unique_ptr&lt;open_spiel::State&gt; <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a> = game.NewInitialState();</div>
<div class="line"><span class="lineno">  109</span>  std::vector&lt;std::string&gt; history;</div>
<div class="line"><span class="lineno">  110</span>  <a class="code hl_struct" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">Trajectory</a> trajectory;</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;IsChanceNode()) {</div>
<div class="line"><span class="lineno">  114</span>      <a class="code hl_typedef" href="namespaceopen__spiel.html#ac4ea6d9d7193ac74f6f333b954e3810f">open_spiel::ActionsAndProbs</a> outcomes = <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;ChanceOutcomes();</div>
<div class="line"><span class="lineno">  115</span>      <a class="code hl_typedef" href="namespaceopen__spiel.html#a8aa5fc5cff0ef466697b1df5cbfcbd3a">open_spiel::Action</a> <a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a> =</div>
<div class="line"><span class="lineno">  116</span>          <a class="code hl_function" href="namespaceopen__spiel.html#a5eb64a0ea2eb4de455fbb51e4824c65b">open_spiel::SampleAction</a>(outcomes, *rng).first;</div>
<div class="line"><span class="lineno">  117</span>      <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;ApplyAction(<a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a>);</div>
<div class="line"><span class="lineno">  118</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  119</span>      <a class="code hl_typedef" href="namespaceopen__spiel.html#a8e9bf6a040c687a9f0c8393728dc0121">open_spiel::Player</a> <a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a> = <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;CurrentPlayer();</div>
<div class="line"><span class="lineno">  120</span>      std::unique_ptr&lt;SearchNode&gt; root = (*bots)[<a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>]-&gt;MCTSearch(*<a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>);</div>
<div class="line"><span class="lineno">  121</span>      <a class="code hl_typedef" href="namespaceopen__spiel.html#ac4ea6d9d7193ac74f6f333b954e3810f">open_spiel::ActionsAndProbs</a> policy;</div>
<div class="line"><span class="lineno">  122</span>      policy.reserve(root-&gt;children.size());</div>
<div class="line"><span class="lineno">  123</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_struct" href="structopen__spiel_1_1algorithms_1_1_search_node.html">SearchNode</a>&amp; c : root-&gt;children) {</div>
<div class="line"><span class="lineno">  124</span>        policy.emplace_back(c.action,</div>
<div class="line"><span class="lineno">  125</span>                            std::pow(c.explore_count, 1.0 / temperature));</div>
<div class="line"><span class="lineno">  126</span>      }</div>
<div class="line"><span class="lineno">  127</span>      <a class="code hl_function" href="namespaceopen__spiel.html#af4e1a06b98575bc24c84e635a12efec4">NormalizePolicy</a>(&amp;policy);</div>
<div class="line"><span class="lineno">  128</span>      <a class="code hl_typedef" href="namespaceopen__spiel.html#a8aa5fc5cff0ef466697b1df5cbfcbd3a">open_spiel::Action</a> <a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a>;</div>
<div class="line"><span class="lineno">  129</span>      <span class="keywordflow">if</span> (history.size() &gt;= temperature_drop) {</div>
<div class="line"><span class="lineno">  130</span>        <a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a> = root-&gt;BestChild().action;</div>
<div class="line"><span class="lineno">  131</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  132</span>        <a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a> = <a class="code hl_function" href="namespaceopen__spiel.html#a5eb64a0ea2eb4de455fbb51e4824c65b">open_spiel::SampleAction</a>(policy, *rng).first;</div>
<div class="line"><span class="lineno">  133</span>      }</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>      <span class="keywordtype">double</span> root_value = root-&gt;total_reward / root-&gt;explore_count;</div>
<div class="line"><span class="lineno">  136</span>      trajectory.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#a423c93d77625404e42fe9e8bbb373a2b">states</a>.push_back(Trajectory::State{</div>
<div class="line"><span class="lineno">  137</span>          <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;ObservationTensor(), <a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>, <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;LegalActions(), <a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a>,</div>
<div class="line"><span class="lineno">  138</span>          std::move(policy), root_value});</div>
<div class="line"><span class="lineno">  139</span>      std::string action_str = <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;ActionToString(<a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>, <a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a>);</div>
<div class="line"><span class="lineno">  140</span>      history.push_back(action_str);</div>
<div class="line"><span class="lineno">  141</span>      <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;ApplyAction(<a class="code hl_variable" href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a>);</div>
<div class="line"><span class="lineno">  142</span>      <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><span class="lineno">  143</span>        logger-&gt;<a class="code hl_function" href="classopen__spiel_1_1_logger.html#a2ac1d943258600354c2853700fd5a8f0">Print</a>(<span class="stringliteral">&quot;Player: %d, action: %s&quot;</span>, <a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>, action_str);</div>
<div class="line"><span class="lineno">  144</span>      }</div>
<div class="line"><span class="lineno">  145</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;IsTerminal()) {</div>
<div class="line"><span class="lineno">  146</span>        trajectory.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#ac01679b0df3f210aebc9f19be32fe57a">returns</a> = <a class="code hl_variable" href="policy__iteration_8cc.html#aef5972335703cda91a1daa78e046d9d5">state</a>-&gt;Returns();</div>
<div class="line"><span class="lineno">  147</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  148</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::abs(root_value) &gt; cutoff_value) {</div>
<div class="line"><span class="lineno">  149</span>        trajectory.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#ac01679b0df3f210aebc9f19be32fe57a">returns</a>.resize(2);</div>
<div class="line"><span class="lineno">  150</span>        trajectory.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#ac01679b0df3f210aebc9f19be32fe57a">returns</a>[<a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>] = root_value;</div>
<div class="line"><span class="lineno">  151</span>        trajectory.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#ac01679b0df3f210aebc9f19be32fe57a">returns</a>[1 - <a class="code hl_variable" href="basic__tests_8cc.html#af61d6983a9396a11078805087518af88">player</a>] = -root_value;</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  153</span>      }</div>
<div class="line"><span class="lineno">  154</span>    }</div>
<div class="line"><span class="lineno">  155</span>  }</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  logger-&gt;<a class="code hl_function" href="classopen__spiel_1_1_logger.html#a2ac1d943258600354c2853700fd5a8f0">Print</a>(<span class="stringliteral">&quot;Game %d: Returns: %s; Actions: %s&quot;</span>, game_num,</div>
<div class="line"><span class="lineno">  158</span>                <a class="code hl_function" href="namespaceabsl.html#a66735d042e8e255930c66b67f3b39244">absl::StrJoin</a>(trajectory.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#ac01679b0df3f210aebc9f19be32fe57a">returns</a>, <span class="stringliteral">&quot; &quot;</span>),</div>
<div class="line"><span class="lineno">  159</span>                <a class="code hl_function" href="namespaceabsl.html#a66735d042e8e255930c66b67f3b39244">absl::StrJoin</a>(history, <span class="stringliteral">&quot; &quot;</span>));</div>
<div class="line"><span class="lineno">  160</span>  <span class="keywordflow">return</span> trajectory;</div>
<div class="line"><span class="lineno">  161</span>}</div>
<div class="ttc" id="abasic__tests_8cc_html_aa9cf7d0afedceb0d21dd5f412fe08c18"><div class="ttname"><a href="basic__tests_8cc.html#aa9cf7d0afedceb0d21dd5f412fe08c18">action</a></div><div class="ttdeci">Action action</div><div class="ttdef"><b>Definition</b> <a href="basic__tests_8cc_source.html#l00051">basic_tests.cc:51</a></div></div>
<div class="ttc" id="aclassopen__spiel_1_1_logger_html_a2ac1d943258600354c2853700fd5a8f0"><div class="ttname"><a href="classopen__spiel_1_1_logger.html#a2ac1d943258600354c2853700fd5a8f0">open_spiel::Logger::Print</a></div><div class="ttdeci">virtual void Print(const std::string &amp;str)=0</div></div>
<div class="ttc" id="anamespaceabsl_html_a66735d042e8e255930c66b67f3b39244"><div class="ttname"><a href="namespaceabsl.html#a66735d042e8e255930c66b67f3b39244">absl::StrJoin</a></div><div class="ttdeci">std::string StrJoin(Iterator start, Iterator end, absl::string_view sep, Formatter &amp;&amp;fmt)</div><div class="ttdef"><b>Definition</b> <a href="str__join_8h_source.html#l00239">str_join.h:239</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_html_a5eb64a0ea2eb4de455fbb51e4824c65b"><div class="ttname"><a href="namespaceopen__spiel.html#a5eb64a0ea2eb4de455fbb51e4824c65b">open_spiel::SampleAction</a></div><div class="ttdeci">std::pair&lt; Action, double &gt; SampleAction(const ActionsAndProbs &amp;outcomes, absl::BitGenRef rng)</div><div class="ttdef"><b>Definition</b> <a href="spiel_8cc_source.html#l00270">spiel.cc:270</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_html_a8aa5fc5cff0ef466697b1df5cbfcbd3a"><div class="ttname"><a href="namespaceopen__spiel.html#a8aa5fc5cff0ef466697b1df5cbfcbd3a">open_spiel::Action</a></div><div class="ttdeci">int64_t Action</div><div class="ttdef"><b>Definition</b> <a href="spiel__utils_8h_source.html#l00133">spiel_utils.h:133</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_html_a8e9bf6a040c687a9f0c8393728dc0121"><div class="ttname"><a href="namespaceopen__spiel.html#a8e9bf6a040c687a9f0c8393728dc0121">open_spiel::Player</a></div><div class="ttdeci">int Player</div><div class="ttdef"><b>Definition</b> <a href="spiel__utils_8h_source.html#l00132">spiel_utils.h:132</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_html_ac4ea6d9d7193ac74f6f333b954e3810f"><div class="ttname"><a href="namespaceopen__spiel.html#ac4ea6d9d7193ac74f6f333b954e3810f">open_spiel::ActionsAndProbs</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; Action, double &gt; &gt; ActionsAndProbs</div><div class="ttdef"><b>Definition</b> <a href="spiel_8h_source.html#l00198">spiel.h:198</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_html_af4e1a06b98575bc24c84e635a12efec4"><div class="ttname"><a href="namespaceopen__spiel.html#af4e1a06b98575bc24c84e635a12efec4">open_spiel::NormalizePolicy</a></div><div class="ttdeci">void NormalizePolicy(ActionsAndProbs *policy)</div><div class="ttdef"><b>Definition</b> <a href="spiel_8cc_source.html#l00264">spiel.cc:264</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1_search_node_html"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1_search_node.html">open_spiel::algorithms::SearchNode</a></div><div class="ttdef"><b>Definition</b> <a href="mcts_8h_source.html#l00114">mcts.h:114</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory_html"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html">open_spiel::algorithms::torch_az::Trajectory</a></div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00090">alpha_zero.cc:90</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory_html_a423c93d77625404e42fe9e8bbb373a2b"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#a423c93d77625404e42fe9e8bbb373a2b">open_spiel::algorithms::torch_az::Trajectory::states</a></div><div class="ttdeci">std::vector&lt; State &gt; states</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00100">alpha_zero.cc:100</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory_html_ac01679b0df3f210aebc9f19be32fe57a"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_trajectory.html#ac01679b0df3f210aebc9f19be32fe57a">open_spiel::algorithms::torch_az::Trajectory::returns</a></div><div class="ttdeci">std::vector&lt; double &gt; returns</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00101">alpha_zero.cc:101</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__tests_8cc_source.html#l00051">action</a>, <a class="el" href="spiel_8cc_source.html#l00264">open_spiel::NormalizePolicy()</a>, <a class="el" href="basic__tests_8cc_source.html#l00050">player</a>, <a class="el" href="classopen__spiel_1_1_logger.html#a2ac1d943258600354c2853700fd5a8f0">open_spiel::Logger::Print()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00101">open_spiel::algorithms::torch_az::Trajectory::returns</a>, <a class="el" href="spiel_8cc_source.html#l00270">open_spiel::SampleAction()</a>, <a class="el" href="policy__iteration_8cc_source.html#l00030">state</a>, <a class="el" href="alpha__zero_8cc_source.html#l00100">open_spiel::algorithms::torch_az::Trajectory::states</a>, and <a class="el" href="str__join_8h_source.html#l00239">absl::StrJoin()</a>.</p>

<p class="reference">Referenced by <a class="el" href="alpha__zero_8cc_source.html#l00179">actor()</a>, and <a class="el" href="alpha__zero_8cc_source.html#l00256">evaluator()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_cgraph">
<area shape="rect" title=" " alt="" coords="5,168,157,209"/>
<area shape="rect" href="namespaceopen__spiel.html#af4e1a06b98575bc24c84e635a12efec4" title=" " alt="" coords="205,77,391,102"/>
<area shape="poly" title=" " alt="" coords="110,165,153,138,204,113,223,105,225,110,206,117,156,143,113,170"/>
<area shape="rect" href="classopen__spiel_1_1_logger.html#a2ac1d943258600354c2853700fd5a8f0" title=" " alt="" coords="233,127,363,167"/>
<area shape="poly" title=" " alt="" coords="157,171,217,160,218,165,158,176"/>
<area shape="rect" href="namespaceopen__spiel.html#a5eb64a0ea2eb4de455fbb51e4824c65b" title=" " alt="" coords="212,216,384,241"/>
<area shape="poly" title=" " alt="" coords="158,200,210,209,209,215,157,205"/>
<area shape="rect" href="namespaceabsl.html#a66735d042e8e255930c66b67f3b39244" title=" " alt="" coords="251,300,345,325"/>
<area shape="poly" title=" " alt="" coords="120,207,262,289,259,294,117,211"/>
<area shape="rect" href="namespaceabsl.html#ae6fbe921bb3366983a0c238625d1048f" title=" " alt="" coords="442,29,577,54"/>
<area shape="poly" title=" " alt="" coords="357,74,434,56,435,61,359,79"/>
<area shape="rect" href="namespaceabsl.html#af37cda8b31ee20257caf8799ed35a66e" title=" " alt="" coords="451,78,568,104"/>
<area shape="poly" title=" " alt="" coords="392,88,436,88,436,93,392,93"/>
<area shape="rect" href="namespaceabsl_1_1container__algorithm__internal.html#a06daa82467b235da8b6b9b1d09b520a1" title=" " alt="" coords="628,71,795,111"/>
<area shape="poly" title=" " alt="" coords="566,53,614,64,613,70,565,58"/>
<area shape="rect" href="namespaceabsl_1_1container__algorithm__internal.html#a00879fc0ada934de06b3b429cecddb57" title=" " alt="" coords="628,5,795,46"/>
<area shape="poly" title=" " alt="" coords="577,34,613,31,613,36,578,39"/>
<area shape="poly" title=" " alt="" coords="569,88,613,88,613,94,569,94"/>
<area shape="poly" title=" " alt="" coords="551,75,631,49,633,54,553,80"/>
<area shape="poly" title=" " alt="" coords="263,217,256,207,260,197,274,191,298,189,324,192,337,198,335,203,322,197,298,194,275,196,263,201,261,206,267,214"/>
<area shape="rect" href="namespaceabsl.html#af52417fc36b2948cfca4fae144b0046f" title=" " alt="" coords="460,212,559,237"/>
<area shape="poly" title=" " alt="" coords="384,224,444,223,444,228,384,229"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#a0eebfd02e61f2e234a5295efe985f198" title=" " alt="" coords="630,137,793,178"/>
<area shape="poly" title=" " alt="" coords="550,208,632,181,634,186,552,213"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#ab540f8d00b33fedfcd4c8044b16ca079" title=" " alt="" coords="635,203,788,243"/>
<area shape="poly" title=" " alt="" coords="560,221,620,221,620,226,560,227"/>
<area shape="rect" href="namespaceabsl_1_1random__internal.html#a8207d795f98f94f497a3e777e2a26084" title=" " alt="" coords="635,268,788,309"/>
<area shape="poly" title=" " alt="" coords="554,235,631,260,630,265,552,240"/>
<area shape="rect" href="namespaceabsl_1_1strings__internal.html#ad5b694c25b0f1ab42df683172f72e1ce" title=" " alt="" coords="439,325,580,366"/>
<area shape="poly" title=" " alt="" coords="346,317,424,330,423,335,345,322"/>
<area shape="rect" href="classabsl_1_1string__view.html#acdd63d87adecc9cb89e3bb2c4efedf47" title=" " alt="" coords="635,382,788,408"/>
<area shape="poly" title=" " alt="" coords="581,360,642,375,641,381,580,366"/>
<area shape="rect" href="classabsl_1_1string__view.html#a3950f228eccec8f88e34b9a90ad94428" title=" " alt="" coords="636,333,787,358"/>
<area shape="poly" title=" " alt="" coords="581,343,621,343,621,348,581,348"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a50e57a250c58223d4f65dddb330040d9_icgraph">
<area shape="rect" title=" " alt="" coords="404,39,555,79"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a6ce4e92571dc52dbf4adc2c85c0aeb0d" title=" " alt="" coords="205,5,356,46"/>
<area shape="poly" title=" " alt="" coords="388,46,356,41,357,36,389,41"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a93a78c3862b261da879f8fa47863e224" title=" " alt="" coords="205,71,356,111"/>
<area shape="poly" title=" " alt="" coords="389,76,357,81,356,76,388,71"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,39,157,79"/>
<area shape="poly" title=" " alt="" coords="190,44,157,49,157,44,189,38"/>
<area shape="poly" title=" " alt="" coords="189,79,157,74,157,69,190,74"/>
</map>
</div>

</div>
</div>
<a id="a74e1169d351ea651f9f0577190f31190" name="a74e1169d351ea651f9f0577190f31190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74e1169d351ea651f9f0577190f31190">&#9670;&#160;</a></span>SaveModelConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool open_spiel::algorithms::torch_az::SaveModelConfig </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_model_config.html">ModelConfig</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>net_config</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vpnet_8cc_source.html#l00045">45</a> of file <a class="el" href="vpnet_8cc_source.html">vpnet.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>                                                    {</div>
<div class="line"><span class="lineno">   47</span>  std::ofstream file;</div>
<div class="line"><span class="lineno">   48</span>  file.open(<a class="code hl_function" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df">absl::StrCat</a>(path, <span class="stringliteral">&quot;/&quot;</span>, filename));</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordflow">if</span> (!file) {</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   52</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   53</span>    file &lt;&lt; net_config;</div>
<div class="line"><span class="lineno">   54</span>  }</div>
<div class="line"><span class="lineno">   55</span>  file.close();</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   58</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="str__cat_8h_source.html#l00381">absl::StrCat()</a>.</p>

<p class="reference">Referenced by <a class="el" href="vpnet_8cc_source.html#l00095">CreateGraphDef()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,196,46"/>
<area shape="rect" href="namespaceabsl.html#a0a9abdb6ee6367339931d4cab29d50df" title=" " alt="" coords="244,13,335,38"/>
<area shape="poly" title=" " alt="" coords="196,23,228,23,228,28,196,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a74e1169d351ea651f9f0577190f31190_icgraph">
<area shape="rect" title=" " alt="" coords="435,5,625,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a961b83641d3a89f6507458f98a273132" title=" " alt="" coords="205,5,387,46"/>
<area shape="poly" title=" " alt="" coords="420,28,388,28,388,23,420,23"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,5,157,46"/>
<area shape="poly" title=" " alt="" coords="189,28,157,28,157,23,189,23"/>
</map>
</div>

</div>
</div>
<a id="a812e290fffa06f3d711e2035347de6e4" name="a812e290fffa06f3d711e2035347de6e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a812e290fffa06f3d711e2035347de6e4">&#9670;&#160;</a></span>StartInfoFromLearnerJson()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html">StartInfo</a> open_spiel::algorithms::torch_az::StartInfoFromLearnerJson </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="alpha__zero_8cc_source.html#l00062">62</a> of file <a class="el" href="alpha__zero_8cc_source.html">alpha_zero.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>                                                          {</div>
<div class="line"><span class="lineno">   63</span>  <a class="code hl_struct" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html">StartInfo</a> start_info;</div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_class" href="classopen__spiel_1_1file_1_1_file.html">file::File</a> learner_file(path + <span class="stringliteral">&quot;/learner.jsonl&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">   65</span>  std::vector&lt;std::string&gt; learner_lines = <a class="code hl_function" href="namespaceabsl.html#a5f113a4d08f171c39b3b4f2709d154bb">absl::StrSplit</a>(</div>
<div class="line"><span class="lineno">   66</span>      learner_file.ReadContents(), <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">   67</span>  std::string last_learner_line;</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  <span class="comment">// Get the last non-empty line in learner.jsonl.</span></div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> = learner_lines.size() - 1; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a> &gt;= 0; <a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>--) {</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">if</span> (!learner_lines[<a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>].empty()) {</div>
<div class="line"><span class="lineno">   72</span>      last_learner_line = learner_lines[<a class="code hl_variable" href="btree__benchmark_8cc.html#a717c50cfde3924051c279a89096afd3d">i</a>];</div>
<div class="line"><span class="lineno">   73</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="line"><span class="lineno">   75</span>  }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <a class="code hl_typedef" href="namespaceopen__spiel_1_1json.html#a2fca7da0268e1ad563a1e45d72e69a5b">json::Object</a> last_learner_json = json::FromString(</div>
<div class="line"><span class="lineno">   78</span>      last_learner_line).value().GetObject();</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>  start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a106d8c2c2a6709d98fe1eb3b22f192df">start_time</a> = <a class="code hl_function" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb">absl::Now</a>() - <a class="code hl_function" href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67">absl::Seconds</a>(</div>
<div class="line"><span class="lineno">   81</span>      last_learner_json[<span class="stringliteral">&quot;time_rel&quot;</span>].GetDouble());</div>
<div class="line"><span class="lineno">   82</span>  start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a391e225a39cbb2b05ad9de1e4e62b599">start_step</a> = last_learner_json[<span class="stringliteral">&quot;step&quot;</span>].GetInt() + 1;</div>
<div class="line"><span class="lineno">   83</span>  start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a02c3632bb9ff1612dc925ca02843df17">model_checkpoint_step</a> = VPNetModel::kMostRecentCheckpointStep;</div>
<div class="line"><span class="lineno">   84</span>  start_info.<a class="code hl_variable" href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a72c40d01e4e73bde6b2c7da947f81d64">total_trajectories</a> =</div>
<div class="line"><span class="lineno">   85</span>      last_learner_json[<span class="stringliteral">&quot;total_trajectories&quot;</span>].GetInt();</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  <span class="keywordflow">return</span> start_info;</div>
<div class="line"><span class="lineno">   88</span>}</div>
<div class="ttc" id="aclassopen__spiel_1_1file_1_1_file_html"><div class="ttname"><a href="classopen__spiel_1_1file_1_1_file.html">open_spiel::file::File</a></div><div class="ttdef"><b>Definition</b> <a href="utils_2file_8h_source.html#l00028">file.h:28</a></div></div>
<div class="ttc" id="anamespaceopen__spiel_1_1json_html_a2fca7da0268e1ad563a1e45d72e69a5b"><div class="ttname"><a href="namespaceopen__spiel_1_1json.html#a2fca7da0268e1ad563a1e45d72e69a5b">open_spiel::json::Object</a></div><div class="ttdeci">std::map&lt; std::string, Value &gt; Object</div><div class="ttdef"><b>Definition</b> <a href="json_8h_source.html#l00040">json.h:40</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info_html"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html">open_spiel::algorithms::torch_az::StartInfo</a></div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00055">alpha_zero.cc:55</a></div></div>
<div class="ttc" id="astructopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info_html_a02c3632bb9ff1612dc925ca02843df17"><div class="ttname"><a href="structopen__spiel_1_1algorithms_1_1torch__az_1_1_start_info.html#a02c3632bb9ff1612dc925ca02843df17">open_spiel::algorithms::torch_az::StartInfo::model_checkpoint_step</a></div><div class="ttdeci">int model_checkpoint_step</div><div class="ttdef"><b>Definition</b> <a href="alpha__zero_8cc_source.html#l00058">alpha_zero.cc:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="json_8cc_source.html#l00336">open_spiel::json::FromString()</a>, <a class="el" href="btree__benchmark_8cc_source.html#l00232">i</a>, <a class="el" href="vpnet_8h_source.html#l00102">open_spiel::algorithms::torch_az::VPNetModel::kMostRecentCheckpointStep</a>, <a class="el" href="alpha__zero_8cc_source.html#l00058">open_spiel::algorithms::torch_az::StartInfo::model_checkpoint_step</a>, <a class="el" href="clock_8cc_source.html#l00039">absl::Now()</a>, <a class="el" href="file_8cc_source.html#l00070">open_spiel::file::File::ReadContents()</a>, <a class="el" href="time_8h_source.html#l00451">absl::Seconds()</a>, <a class="el" href="alpha__zero_8cc_source.html#l00057">open_spiel::algorithms::torch_az::StartInfo::start_step</a>, <a class="el" href="alpha__zero_8cc_source.html#l00056">open_spiel::algorithms::torch_az::StartInfo::start_time</a>, <a class="el" href="str__split_8h_source.html#l00499">absl::StrSplit()</a>, and <a class="el" href="alpha__zero_8cc_source.html#l00059">open_spiel::algorithms::torch_az::StartInfo::total_trajectories</a>.</p>

<p class="reference">Referenced by <a class="el" href="alpha__zero_8cc_source.html#l00496">AlphaZero()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_cgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_cgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_cgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_cgraph">
<area shape="rect" title=" " alt="" coords="5,255,244,295"/>
<area shape="rect" href="namespaceopen__spiel_1_1json.html#ab0b18fc544b6c6adc02331449457dc34" title=" " alt="" coords="292,97,479,122"/>
<area shape="poly" title=" " alt="" coords="142,252,204,192,245,159,290,131,302,126,305,131,293,136,248,164,207,196,146,256"/>
<area shape="rect" href="namespaceabsl.html#a316c486d0d8e740b8ead5b7638d14dbb" title=" " alt="" coords="345,146,426,172"/>
<area shape="poly" title=" " alt="" coords="171,252,339,176,341,181,173,257"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#aa63f4c68070f41ccfd81aa8c1d594b43" title=" " alt="" coords="317,255,454,295"/>
<area shape="poly" title=" " alt="" coords="244,272,301,272,301,278,244,278"/>
<area shape="rect" href="namespaceabsl.html#a1e6efc5516746f611fed68ca25227f67" title=" " alt="" coords="333,320,438,345"/>
<area shape="poly" title=" " alt="" coords="221,293,318,315,317,320,220,299"/>
<area shape="rect" href="namespaceabsl.html#a5f113a4d08f171c39b3b4f2709d154bb" title=" " alt="" coords="337,369,434,394"/>
<area shape="poly" title=" " alt="" coords="164,294,223,325,293,355,323,365,321,370,291,360,221,330,161,298"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a03ac95838baccb5f128b99788affe9f7" title=" " alt="" coords="552,5,687,46"/>
<area shape="poly" title=" " alt="" coords="425,153,452,146,477,133,494,115,501,96,508,76,525,56,536,48,539,52,529,60,513,78,506,98,498,118,481,137,454,151,427,158"/>
<area shape="rect" href="namespaceabsl.html#a466f5e42bfba7b7295daaa10d530172e" title=" " alt="" coords="527,70,711,96"/>
<area shape="poly" title=" " alt="" coords="425,147,478,132,526,113,563,99,565,104,528,117,480,138,427,153"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a08534fb0fd3d4cc76f89c49ea990770b" title=" " alt="" coords="1159,143,1286,183"/>
<area shape="poly" title=" " alt="" coords="426,156,711,154,1111,156,1144,157,1144,162,1111,162,711,159,426,161"/>
<area shape="rect" href="namespaceabsl.html#a9c808ce1e415bc23b0303e96414e404a" title=" " alt="" coords="552,172,686,197"/>
<area shape="poly" title=" " alt="" coords="426,161,537,173,537,178,426,166"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a38be6aa6cfdce9ed5fe2adf2c1a300bc" title=" " alt="" coords="759,171,887,211"/>
<area shape="poly" title=" " alt="" coords="686,184,744,186,744,191,686,189"/>
<area shape="rect" href="namespaceabsl_1_1time__internal.html#a159819a84704eb739e572c4a49a5a238" title=" " alt="" coords="935,171,1111,211"/>
<area shape="poly" title=" " alt="" coords="887,188,919,188,919,194,887,194"/>
<area shape="poly" title=" " alt="" coords="1111,176,1143,171,1144,177,1112,181"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#abc3213ab1b9a8e71a537235c5e76332a" title=" " alt="" coords="550,221,688,262"/>
<area shape="poly" title=" " alt="" coords="454,263,535,251,535,256,455,268"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#a570b746651abb3cefb08bce834dba10f" title=" " alt="" coords="550,287,688,327"/>
<area shape="poly" title=" " alt="" coords="455,282,535,293,535,298,454,287"/>
<area shape="rect" href="classopen__spiel_1_1file_1_1_file.html#a24c02912790125aa0eb21a8e855623b3" title=" " alt="" coords="550,352,688,393"/>
<area shape="poly" title=" " alt="" coords="455,293,480,305,505,321,528,337,542,343,540,348,526,341,502,325,478,309,453,298"/>
<area shape="poly" title=" " alt="" coords="439,338,480,354,496,367,505,380,513,392,528,402,579,421,621,429,663,424,710,402,732,386,751,366,780,318,800,269,812,226,818,227,806,271,785,321,755,369,735,390,713,407,664,429,621,435,577,426,526,407,510,396,500,383,492,370,478,359,437,343"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_icgraph.png" border="0" usemap="#anamespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_icgraph" alt=""/></div>
<map name="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_icgraph" id="anamespaceopen__spiel_1_1algorithms_1_1torch__az_a812e290fffa06f3d711e2035347de6e4_icgraph">
<area shape="rect" title=" " alt="" coords="205,5,443,46"/>
<area shape="rect" href="namespaceopen__spiel_1_1algorithms_1_1torch__az.html#a141f9989682f14bd0a5d4e153d4e2fd4" title=" " alt="" coords="5,5,157,46"/>
<area shape="poly" title=" " alt="" coords="189,28,157,28,157,23,189,23"/>
</map>
</div>

</div>
</div>
<a id="ad12240e5450fc2c9e2946f6388d59da2" name="ad12240e5450fc2c9e2946f6388d59da2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad12240e5450fc2c9e2946f6388d59da2">&#9670;&#160;</a></span>TORCH_MODULE() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel::algorithms::torch_az::TORCH_MODULE </td>
          <td>(</td>
          <td class="paramtype">MLPBlock</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afd268144d66f4661b9243fd74d92b2db" name="afd268144d66f4661b9243fd74d92b2db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd268144d66f4661b9243fd74d92b2db">&#9670;&#160;</a></span>TORCH_MODULE() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel::algorithms::torch_az::TORCH_MODULE </td>
          <td>(</td>
          <td class="paramtype">MLPOutputBlock</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af05778b3c19d991920d68c3dde16c92f" name="af05778b3c19d991920d68c3dde16c92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af05778b3c19d991920d68c3dde16c92f">&#9670;&#160;</a></span>TORCH_MODULE() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel::algorithms::torch_az::TORCH_MODULE </td>
          <td>(</td>
          <td class="paramtype">Model</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a55556f7c3be87ce31808db62f9c98f" name="a1a55556f7c3be87ce31808db62f9c98f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a55556f7c3be87ce31808db62f9c98f">&#9670;&#160;</a></span>TORCH_MODULE() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel::algorithms::torch_az::TORCH_MODULE </td>
          <td>(</td>
          <td class="paramtype">ResInputBlock</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0588dda1c353f6d26ea04e1f5098ca01" name="a0588dda1c353f6d26ea04e1f5098ca01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0588dda1c353f6d26ea04e1f5098ca01">&#9670;&#160;</a></span>TORCH_MODULE() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel::algorithms::torch_az::TORCH_MODULE </td>
          <td>(</td>
          <td class="paramtype">ResOutputBlock</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a919778bcd5aec8a8418d825d12b59b7d" name="a919778bcd5aec8a8418d825d12b59b7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919778bcd5aec8a8418d825d12b59b7d">&#9670;&#160;</a></span>TORCH_MODULE() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel::algorithms::torch_az::TORCH_MODULE </td>
          <td>(</td>
          <td class="paramtype">ResTorsoBlock</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e151002142b677bb6393e692b172856" name="a1e151002142b677bb6393e692b172856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e151002142b677bb6393e692b172856">&#9670;&#160;</a></span>TorchDeviceName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string open_spiel::algorithms::torch_az::TorchDeviceName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>device</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vpnet_8cc_source.html#l00088">88</a> of file <a class="el" href="vpnet_8cc_source.html">vpnet.cc</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   88</span>                                                   {</div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordflow">if</span> (device[0] == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">return</span> device.substr(1);</div>
<div class="line"><span class="lineno">   91</span>  }</div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordflow">return</span> device;</div>
<div class="line"><span class="lineno">   93</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
