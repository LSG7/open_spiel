<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: open_spiel.python.algorithms.sample_some_states Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceopen__spiel.html">open_spiel</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python.html">python</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms.html">algorithms</a></li><li class="navelem"><a class="el" href="namespaceopen__spiel_1_1python_1_1algorithms_1_1sample__some__states.html">sample_some_states</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">open_spiel.python.algorithms.sample_some_states Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a36c46cf0b7098f2c8cfe37fd08eac0e6" id="r_a36c46cf0b7098f2c8cfe37fd08eac0e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36c46cf0b7098f2c8cfe37fd08eac0e6">sample_some_states</a> (game, max_states=100, make_distribution_fn=lambda states:[1/<a class="el" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states)] *<a class="el" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states))</td></tr>
<tr class="separator:a36c46cf0b7098f2c8cfe37fd08eac0e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Example algorithm to sample some states from a game.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a36c46cf0b7098f2c8cfe37fd08eac0e6" name="a36c46cf0b7098f2c8cfe37fd08eac0e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36c46cf0b7098f2c8cfe37fd08eac0e6">&#9670;&#160;</a></span>sample_some_states()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">open_spiel.python.algorithms.sample_some_states.sample_some_states </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>game</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_states</em></span><span class="paramdefsep"> = </span><span class="paramdefval">100</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>make_distribution_fn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">lambda&#160;states:&#160;[1&#160;/&#160;<a class="el" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states)]&#160;*&#160;<a class="el" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states)</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Samples some states in the game.

This can be run for large games, in contrast to `get_all_states`. It is useful
for tests that need to check a predicate only on a subset of the game, since
generating the whole game is infeasible.

Currently only works for sequential games. For simultaneous games and mean
field games it returns only the initial state.

The algorithm maintains a list of states and repeatedly picks a random state
from the list to expand until enough states have been sampled.

Arguments:
  game: The game to analyze, as returned by `load_game`.
  max_states: The maximum number of states to return. Negative means no limit.
  make_distribution_fn: Function that takes a list of states and returns a
    corresponding distribution (as a list of floats). Only used for mean field
    games.

Returns:
  A `list` of `pyspiel.State`.
</pre> 
<p class="definition">Definition at line <a class="el" href="sample__some__states_8py_source.html#l00021">21</a> of file <a class="el" href="sample__some__states_8py_source.html">sample_some_states.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   24</span>    make_distribution_fn=<span class="keyword">lambda</span> states: [1 / <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states)] * <a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states)):</div>
<div class="line"><span class="lineno">   25</span>  <span class="stringliteral">&quot;&quot;&quot;Samples some states in the game.</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">  This can be run for large games, in contrast to `get_all_states`. It is useful</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">  for tests that need to check a predicate only on a subset of the game, since</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">  generating the whole game is infeasible.</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">  Currently only works for sequential games. For simultaneous games and mean</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">  field games it returns only the initial state.</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">  The algorithm maintains a list of states and repeatedly picks a random state</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">  from the list to expand until enough states have been sampled.</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">  Arguments:</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    game: The game to analyze, as returned by `load_game`.</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">    max_states: The maximum number of states to return. Negative means no limit.</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    make_distribution_fn: Function that takes a list of states and returns a</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">      corresponding distribution (as a list of floats). Only used for mean field</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">      games.</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    A `list` of `pyspiel.State`.</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordflow">if</span> game.get_type().dynamics <span class="keywordflow">in</span> [</div>
<div class="line"><span class="lineno">   48</span>      pyspiel.GameType.Dynamics.SIMULTANEOUS,</div>
<div class="line"><span class="lineno">   49</span>      pyspiel.GameType.Dynamics.MEAN_FIELD</div>
<div class="line"><span class="lineno">   50</span>  ]:</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">return</span> [game.new_initial_state()]</div>
<div class="line"><span class="lineno">   52</span>  states = []</div>
<div class="line"><span class="lineno">   53</span>  unexplored_actions = []</div>
<div class="line"><span class="lineno">   54</span>  indexes_with_unexplored_actions = set()</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>  <span class="keyword">def </span>add_state(state):</div>
<div class="line"><span class="lineno">   57</span>    states.append(state)</div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> state.is_terminal():</div>
<div class="line"><span class="lineno">   59</span>      unexplored_actions.append(<span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   61</span>      indexes_with_unexplored_actions.add(<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states) - 1)</div>
<div class="line"><span class="lineno">   62</span>      unexplored_actions.append(set(state.legal_actions()))</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  <span class="keyword">def </span>expand_random_state():</div>
<div class="line"><span class="lineno">   65</span>    index = random.choice(list(indexes_with_unexplored_actions))</div>
<div class="line"><span class="lineno">   66</span>    state = states[index]</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">if</span> state.is_mean_field_node():</div>
<div class="line"><span class="lineno">   68</span>      child = state.clone()</div>
<div class="line"><span class="lineno">   69</span>      child.update_distribution(</div>
<div class="line"><span class="lineno">   70</span>          make_distribution_fn(child.distribution_support()))</div>
<div class="line"><span class="lineno">   71</span>      indexes_with_unexplored_actions.remove(index)</div>
<div class="line"><span class="lineno">   72</span>      <span class="keywordflow">return</span> child</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   74</span>      actions = unexplored_actions[index]</div>
<div class="line"><span class="lineno">   75</span>      <span class="keyword">assert</span> actions, f<span class="stringliteral">&quot;Empty actions for state {state}&quot;</span></div>
<div class="line"><span class="lineno">   76</span>      action = random.choice(list(actions))</div>
<div class="line"><span class="lineno">   77</span>      actions.remove(action)</div>
<div class="line"><span class="lineno">   78</span>      <span class="keywordflow">if</span> <span class="keywordflow">not</span> actions:</div>
<div class="line"><span class="lineno">   79</span>        indexes_with_unexplored_actions.remove(index)</div>
<div class="line"><span class="lineno">   80</span>      <span class="keywordflow">return</span> state.child(action)</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  add_state(game.new_initial_state())</div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">while</span> (<a class="code hl_variable" href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a>(states) &lt; max_states) <span class="keywordflow">and</span> indexes_with_unexplored_actions:</div>
<div class="line"><span class="lineno">   84</span>    add_state(expand_random_state())</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> states:</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;get_some_states sampled 0 states!&quot;</span>)</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordflow">return</span> states</div>
<div class="ttc" id="alow__level__alloc__test_8cc_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="low__level__alloc__test_8cc.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition</b> <a href="low__level__alloc__test_8cc_source.html#l00046">low_level_alloc_test.cc:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="low__level__alloc__test_8cc_source.html#l00046">len</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
