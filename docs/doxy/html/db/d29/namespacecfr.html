<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open spiel: cfr Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open spiel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">cfr Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d5b/classcfr_1_1_players.html">Players</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad58ab306ec2dd1587d80e2fbe5ed8985" id="r_ad58ab306ec2dd1587d80e2fbe5ed8985"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad58ab306ec2dd1587d80e2fbe5ed8985">compute_reach_probabilities</a> (HistoryNode history_tree_node, List[InfostateMapping] all_infostates_map)</td></tr>
<tr class="separator:ad58ab306ec2dd1587d80e2fbe5ed8985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae556d2b6f1c21ec9f92cf42cd8c58b46" id="r_ae556d2b6f1c21ec9f92cf42cd8c58b46"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae556d2b6f1c21ec9f92cf42cd8c58b46">compute_reach_probability_dfs</a> (HistoryNode history_tree_node, List[InfostateMapping] all_infostates_map)</td></tr>
<tr class="separator:ae556d2b6f1c21ec9f92cf42cd8c58b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d97f9eb14e38de2652acbe7da181823" id="r_a4d97f9eb14e38de2652acbe7da181823"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d97f9eb14e38de2652acbe7da181823">_get_opponent</a> (int player)</td></tr>
<tr class="separator:a4d97f9eb14e38de2652acbe7da181823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a304c8490923635d1ad586ad7c6a501ef" id="r_a304c8490923635d1ad586ad7c6a501ef"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a304c8490923635d1ad586ad7c6a501ef">compute_best_response_values</a> (InfostateNode infostate)</td></tr>
<tr class="separator:a304c8490923635d1ad586ad7c6a501ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e03be82cd94a669342c9a3c5dd6a7a8" id="r_a3e03be82cd94a669342c9a3c5dd6a7a8"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3e03be82cd94a669342c9a3c5dd6a7a8">compute_best_response_policy</a> (InfostateNode infostate)</td></tr>
<tr class="separator:a3e03be82cd94a669342c9a3c5dd6a7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728464b52c9ada7300cef1d1f7537518" id="r_a728464b52c9ada7300cef1d1f7537518"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a728464b52c9ada7300cef1d1f7537518">compute_counterfactual_values</a> (InfostateNode infostate)</td></tr>
<tr class="separator:a728464b52c9ada7300cef1d1f7537518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4251ee22cef1853cf44975ca37dd725d" id="r_a4251ee22cef1853cf44975ca37dd725d"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4251ee22cef1853cf44975ca37dd725d">update_regrets</a> (List[InfostateNode] infostates)</td></tr>
<tr class="separator:a4251ee22cef1853cf44975ca37dd725d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e8b7bd47d726188028324726632a3d" id="r_a94e8b7bd47d726188028324726632a3d"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94e8b7bd47d726188028324726632a3d">compute_next_policy</a> (List[InfostateNode] infostates, bool cfr_plus=False)</td></tr>
<tr class="separator:a94e8b7bd47d726188028324726632a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fcf7319beaa9529aebdfa00b189cda8" id="r_a0fcf7319beaa9529aebdfa00b189cda8"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fcf7319beaa9529aebdfa00b189cda8">cumulate_average_policy</a> (List[InfostateNode] infostates, int weight=1)</td></tr>
<tr class="separator:a0fcf7319beaa9529aebdfa00b189cda8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97950e103a001c0c5611a708c9ab165c" id="r_a97950e103a001c0c5611a708c9ab165c"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97950e103a001c0c5611a708c9ab165c">normalize_average_policy</a> (infostates)</td></tr>
<tr class="separator:a97950e103a001c0c5611a708c9ab165c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae80c7949d554069f34a9b5782aab41de" id="r_ae80c7949d554069f34a9b5782aab41de"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae80c7949d554069f34a9b5782aab41de">best_response_counterfactual_regret_minimization_iteration</a> (HistoryNode history_tree_node, List[InfostateNode] infostate_nodes, List[InfostateMapping] all_infostates_map)</td></tr>
<tr class="separator:ae80c7949d554069f34a9b5782aab41de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5f39720dae9b68ca4020aafa698aa4" id="r_acd5f39720dae9b68ca4020aafa698aa4"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd5f39720dae9b68ca4020aafa698aa4">counterfactual_regret_minimization_iteration</a> (GameTree cfr_game_tree, bool alternating_updates, bool cfr_plus, int weight=1)</td></tr>
<tr class="separator:acd5f39720dae9b68ca4020aafa698aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae255061c0c44a2fb14a05d0073b9b742" id="r_ae255061c0c44a2fb14a05d0073b9b742"><td class="memItemLeft" align="right" valign="top">Tuple[List[float], List[float]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae255061c0c44a2fb14a05d0073b9b742">compute_cfr_plus_values</a> (GameTree cfr_game_tree, int steps)</td></tr>
<tr class="separator:ae255061c0c44a2fb14a05d0073b9b742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c5637b2be205f9cac71365300e4bba" id="r_a12c5637b2be205f9cac71365300e4bba"><td class="memItemLeft" align="right" valign="top">Tuple[List[float], List[float]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12c5637b2be205f9cac71365300e4bba">compute_cfr_values</a> (GameTree cfr_game_tree, int steps)</td></tr>
<tr class="separator:a12c5637b2be205f9cac71365300e4bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Counterfactual Regret Minimization.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a4d97f9eb14e38de2652acbe7da181823" name="a4d97f9eb14e38de2652acbe7da181823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d97f9eb14e38de2652acbe7da181823">&#9670;&#160;</a></span>_get_opponent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> int cfr._get_opponent </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>player</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00125">125</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  125</span><span class="keyword">def </span>_get_opponent(player: int) -&gt; int:</div>
<div class="line"><span class="lineno">  126</span>  <span class="keywordflow">return</span> -1 * player + 3</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae80c7949d554069f34a9b5782aab41de" name="ae80c7949d554069f34a9b5782aab41de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae80c7949d554069f34a9b5782aab41de">&#9670;&#160;</a></span>best_response_counterfactual_regret_minimization_iteration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.best_response_counterfactual_regret_minimization_iteration </td>
          <td>(</td>
          <td class="paramtype">HistoryNode</td>          <td class="paramname"><span class="paramname"><em>history_tree_node</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[InfostateNode]</td>          <td class="paramname"><span class="paramname"><em>infostate_nodes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[InfostateMapping]</td>          <td class="paramname"><span class="paramname"><em>all_infostates_map</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculates CFRBR values.

Args:
  history_tree_node: Game tree HistoryTreeNode which is the root of the game
    tree.
  infostate_nodes: List of all information state nodes.
  all_infostates_map: List of dictionaries (mapping from information state
    string representation to information state object) for each players
    (including chance player). This list will be empty when this function is
    called fot the first time and it'll be population during DFS tree
    traversal.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00299">299</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  302</span>    all_infostates_map: List[InfostateMapping]) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  303</span>  <span class="stringliteral">&quot;&quot;&quot;Calculates CFRBR values.</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">    history_tree_node: Game tree HistoryTreeNode which is the root of the game</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">      tree.</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">    infostate_nodes: List of all information state nodes.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">    all_infostates_map: List of dictionaries (mapping from information state</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">      string representation to information state object) for each players</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">      (including chance player). This list will be empty when this function is</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">      called fot the first time and it&#39;ll be population during DFS tree</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">      traversal.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  315</span>  compute_next_policy(list(all_infostates_map[Players.PLAYER_1].values()))</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>  compute_reach_probabilities(history_tree_node, all_infostates_map)</div>
<div class="line"><span class="lineno">  318</span>  cumulate_average_policy(list(all_infostates_map[Players.PLAYER_1].values()))</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>  compute_best_response_policy(infostate_nodes[Players.PLAYER_2])</div>
<div class="line"><span class="lineno">  321</span>  compute_reach_probabilities(history_tree_node, all_infostates_map)</div>
<div class="line"><span class="lineno">  322</span>  compute_counterfactual_values(infostate_nodes[Players.PLAYER_1])</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  update_regrets(list(all_infostates_map[Players.PLAYER_1].values()))</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00160">compute_best_response_policy()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00193">compute_counterfactual_values()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00238">compute_next_policy()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00035">compute_reach_probabilities()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00268">cumulate_average_policy()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00224">update_regrets()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_ae80c7949d554069f34a9b5782aab41de_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_ae80c7949d554069f34a9b5782aab41de_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_ae80c7949d554069f34a9b5782aab41de_cgraph" id="adb/d29/namespacecfr_ae80c7949d554069f34a9b5782aab41de_cgraph">
<area shape="rect" title=" " alt="" coords="5,201,219,242"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a3e03be82cd94a669342c9a3c5dd6a7a8" title=" " alt="" coords="278,29,460,70"/>
<area shape="poly" title=" " alt="" coords="129,199,186,141,224,109,265,81,278,74,280,79,268,85,227,113,190,145,133,203"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a728464b52c9ada7300cef1d1f7537518" title=" " alt="" coords="280,119,458,159"/>
<area shape="poly" title=" " alt="" coords="175,198,266,168,286,162,288,167,267,174,177,203"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a94e8b7bd47d726188028324726632a3d" title=" " alt="" coords="288,184,450,209"/>
<area shape="poly" title=" " alt="" coords="219,208,272,203,273,208,220,214"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ad58ab306ec2dd1587d80e2fbe5ed8985" title=" " alt="" coords="267,233,471,258"/>
<area shape="poly" title=" " alt="" coords="220,229,251,232,251,237,219,234"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a0fcf7319beaa9529aebdfa00b189cda8" title=" " alt="" coords="296,283,442,323"/>
<area shape="poly" title=" " alt="" coords="179,240,267,268,288,275,286,280,266,274,177,245"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a4251ee22cef1853cf44975ca37dd725d" title=" " alt="" coords="306,348,432,373"/>
<area shape="poly" title=" " alt="" coords="137,240,194,287,230,312,268,333,292,342,291,347,266,337,227,316,191,291,134,244"/>
<area shape="poly" title=" " alt="" coords="321,29,318,19,326,10,343,5,369,3,396,5,413,11,411,16,395,10,369,8,344,10,329,15,324,21,326,28"/>
<area shape="poly" title=" " alt="" coords="321,119,318,109,326,100,343,94,369,92,396,94,413,101,411,106,395,100,369,97,344,99,329,104,324,110,326,117"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae556d2b6f1c21ec9f92cf42cd8c58b46" title=" " alt="" coords="519,233,738,258"/>
<area shape="poly" title=" " alt="" coords="471,243,503,243,503,248,471,248"/>
<area shape="poly" title=" " alt="" coords="586,234,577,224,583,214,600,208,629,206,661,209,677,216,675,221,660,214,629,211,601,214,586,218,583,224,590,231"/>
</map>
</div>

</div>
</div>
<a id="a3e03be82cd94a669342c9a3c5dd6a7a8" name="a3e03be82cd94a669342c9a3c5dd6a7a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e03be82cd94a669342c9a3c5dd6a7a8">&#9670;&#160;</a></span>compute_best_response_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float cfr.compute_best_response_policy </td>
          <td>(</td>
          <td class="paramtype">InfostateNode</td>          <td class="paramname"><span class="paramname"><em>infostate</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate best response policy and returns best response value of infostate.

Args:
  infostate: Information state.

Returns:
  Best response value similar to what compute_best_response_values returns.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00160">160</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  160</span><span class="keyword">def </span>compute_best_response_policy(infostate: InfostateNode) -&gt; float:</div>
<div class="line"><span class="lineno">  161</span>  <span class="stringliteral">&quot;&quot;&quot;Calculate best response policy and returns best response value of infostate.</span></div>
<div class="line"><span class="lineno">  162</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">    infostate: Information state.</span></div>
<div class="line"><span class="lineno">  165</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  166</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  167</span><span class="stringliteral">    Best response value similar to what compute_best_response_values returns.</span></div>
<div class="line"><span class="lineno">  168</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordflow">if</span> infostate.is_terminal():</div>
<div class="line"><span class="lineno">  170</span>    terminal_utility = 0</div>
<div class="line"><span class="lineno">  171</span>    <span class="keywordflow">for</span> history_node <span class="keywordflow">in</span> infostate.history_nodes:</div>
<div class="line"><span class="lineno">  172</span>      terminal_utility += history_node.reach_probs[</div>
<div class="line"><span class="lineno">  173</span>          0] * history_node.reach_probs[_get_opponent(</div>
<div class="line"><span class="lineno">  174</span>              infostate.player)] * history_node.world_state.get_utility(</div>
<div class="line"><span class="lineno">  175</span>                  infostate.player)</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">return</span> terminal_utility</div>
<div class="line"><span class="lineno">  177</span>  action_values = {action: 0 <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate.get_actions()}</div>
<div class="line"><span class="lineno">  178</span>  infostate_actions = infostate.get_actions()</div>
<div class="line"><span class="lineno">  179</span>  <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  180</span>    action_values[action] = 0</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">for</span> child <span class="keywordflow">in</span> infostate.children[action].values():</div>
<div class="line"><span class="lineno">  182</span>      action_values[action] += compute_best_response_policy(child)</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  infostate.policy = {action: 0 <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate.get_actions()}</div>
<div class="line"><span class="lineno">  185</span>  max_action_value = max(action_values.values())</div>
<div class="line"><span class="lineno">  186</span>  <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">if</span> action_values[action] == max_action_value:</div>
<div class="line"><span class="lineno">  188</span>      infostate.policy[action] = 1</div>
<div class="line"><span class="lineno">  189</span>      <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  190</span>  <span class="keywordflow">return</span> max_action_value</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00160">compute_best_response_policy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00302">best_response_counterfactual_regret_minimization_iteration()</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00160">compute_best_response_policy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_cgraph" id="adb/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,187,70"/>
<area shape="poly" title=" " alt="" coords="61,29,60,19,65,10,78,5,96,3,116,5,128,11,125,16,114,10,96,8,79,10,69,14,65,20,66,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_icgraph" id="adb/d29/namespacecfr_a3e03be82cd94a669342c9a3c5dd6a7a8_icgraph">
<area shape="rect" title=" " alt="" coords="767,39,949,79"/>
<area shape="poly" title=" " alt="" coords="898,26,883,20,858,17,835,19,820,24,815,30,817,37,812,39,810,29,817,20,833,14,858,12,884,14,900,21"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae80c7949d554069f34a9b5782aab41de" title=" " alt="" coords="506,5,719,46"/>
<area shape="poly" title=" " alt="" coords="752,47,719,43,720,38,752,42"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="543,71,682,111"/>
<area shape="poly" title=" " alt="" coords="752,75,683,85,682,79,751,70"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,37,458,78"/>
<area shape="poly" title=" " alt="" coords="527,83,458,74,459,68,528,77"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,103,458,143"/>
<area shape="poly" title=" " alt="" coords="528,104,459,113,458,108,528,99"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,103,208,143"/>
<area shape="poly" title=" " alt="" coords="240,126,208,126,208,120,240,120"/>
</map>
</div>

</div>
</div>
<a id="a304c8490923635d1ad586ad7c6a501ef" name="a304c8490923635d1ad586ad7c6a501ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a304c8490923635d1ad586ad7c6a501ef">&#9670;&#160;</a></span>compute_best_response_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float cfr.compute_best_response_values </td>
          <td>(</td>
          <td class="paramtype">InfostateNode</td>          <td class="paramname"><span class="paramname"><em>infostate</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns best response value for an infostate.

Args:
  infostate: Information state.

Returns:
  Best response value, which is the maximum action value chosen among all
  actions values of possible actions from infostate. If information state is a
  terminal node in the game tree, this value is calculated from history nodes
  reach probability for player and opponent, and game utility of terminal
  node. If infostate is not terminal, this value will be calculated in a
  recursive way.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00129">129</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span><span class="keyword">def </span>compute_best_response_values(infostate: InfostateNode) -&gt; float:</div>
<div class="line"><span class="lineno">  130</span>  <span class="stringliteral">&quot;&quot;&quot;Returns best response value for an infostate.</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    infostate: Information state.</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    Best response value, which is the maximum action value chosen among all</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    actions values of possible actions from infostate. If information state is a</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    terminal node in the game tree, this value is calculated from history nodes</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    reach probability for player and opponent, and game utility of terminal</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    node. If infostate is not terminal, this value will be calculated in a</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    recursive way.</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">if</span> infostate.is_terminal():</div>
<div class="line"><span class="lineno">  144</span>    terminal_utility = 0</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">for</span> history_node <span class="keywordflow">in</span> infostate.history_nodes:</div>
<div class="line"><span class="lineno">  146</span>      terminal_utility += history_node.reach_probs[</div>
<div class="line"><span class="lineno">  147</span>          0] * history_node.reach_probs[_get_opponent(</div>
<div class="line"><span class="lineno">  148</span>              infostate.player)] * history_node.world_state.get_utility(</div>
<div class="line"><span class="lineno">  149</span>                  infostate.player)</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">return</span> terminal_utility</div>
<div class="line"><span class="lineno">  151</span>  action_values = {action: 0 <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate.get_actions()}</div>
<div class="line"><span class="lineno">  152</span>  infostate_actions = infostate.get_actions()</div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  154</span>    action_values[action] = 0</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">for</span> child <span class="keywordflow">in</span> infostate.children[action].values():</div>
<div class="line"><span class="lineno">  156</span>      action_values[action] += compute_best_response_values(child)</div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">return</span> max(action_values.values())</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00129">compute_best_response_values()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00129">compute_best_response_values()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00407">compute_cfr_plus_values()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00449">compute_cfr_values()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_cgraph" id="adb/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,187,70"/>
<area shape="poly" title=" " alt="" coords="61,29,60,19,65,10,78,5,96,3,116,5,128,11,125,16,114,10,96,8,79,10,69,14,65,20,66,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_icgraph" id="adb/d29/namespacecfr_a304c8490923635d1ad586ad7c6a501ef_icgraph">
<area shape="rect" title=" " alt="" coords="710,103,892,143"/>
<area shape="poly" title=" " alt="" coords="836,89,823,84,801,81,780,83,768,88,763,94,765,101,760,103,758,93,765,84,779,78,801,76,825,78,838,85"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="514,37,654,78"/>
<area shape="poly" title=" " alt="" coords="716,100,654,81,655,76,718,95"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="513,103,655,143"/>
<area shape="poly" title=" " alt="" coords="695,126,656,126,656,120,695,120"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="506,168,662,193"/>
<area shape="poly" title=" " alt="" coords="708,150,636,169,635,164,706,145"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,5,458,46"/>
<area shape="poly" title=" " alt="" coords="499,48,458,43,459,37,499,43"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,71,458,111"/>
<area shape="poly" title=" " alt="" coords="499,73,459,79,458,73,499,67"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,71,208,111"/>
<area shape="poly" title=" " alt="" coords="240,94,208,94,208,88,240,88"/>
</map>
</div>

</div>
</div>
<a id="ae255061c0c44a2fb14a05d0073b9b742" name="ae255061c0c44a2fb14a05d0073b9b742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae255061c0c44a2fb14a05d0073b9b742">&#9670;&#160;</a></span>compute_cfr_plus_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[List[float], List[float]] cfr.compute_cfr_plus_values </td>
          <td>(</td>
          <td class="paramtype">GameTree</td>          <td class="paramname"><span class="paramname"><em>cfr_game_tree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>steps</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Performs CFR-plus algorithm for a given number of steps.

Args:
  cfr_game_tree: Game tree for an imperfect information game. This game tree
    is game tree of an openspiel game.
  steps: Number of CFR-plus steps.

Returns:
  best_response_values_p1: List of best response values for player 1. The
  length of this list is equal to the number of steps.
  best_response_values_p2: List of best response values for player 2. The
  length of this list is equal to the number of steps.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00406">406</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  407</span>                            steps: int) -&gt; Tuple[List[float], List[float]]:</div>
<div class="line"><span class="lineno">  408</span>  <span class="stringliteral">&quot;&quot;&quot;Performs CFR-plus algorithm for a given number of steps.</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">    cfr_game_tree: Game tree for an imperfect information game. This game tree</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">      is game tree of an openspiel game.</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral">    steps: Number of CFR-plus steps.</span></div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral">    best_response_values_p1: List of best response values for player 1. The</span></div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral">    length of this list is equal to the number of steps.</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    best_response_values_p2: List of best response values for player 2. The</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral">    length of this list is equal to the number of steps.</span></div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  421</span>  best_response_values_p1 = []</div>
<div class="line"><span class="lineno">  422</span>  best_response_values_p2 = []</div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(steps):</div>
<div class="line"><span class="lineno">  424</span>    counterfactual_regret_minimization_iteration(</div>
<div class="line"><span class="lineno">  425</span>        cfr_game_tree=cfr_game_tree,</div>
<div class="line"><span class="lineno">  426</span>        alternating_updates=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  427</span>        cfr_plus=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  428</span>        weight=i + 1)</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    game_tree_copy = copy.deepcopy(cfr_game_tree)</div>
<div class="line"><span class="lineno">  431</span>    normalize_average_policy(</div>
<div class="line"><span class="lineno">  432</span>        game_tree_copy.all_infostates_map[Players.PLAYER_1].values())</div>
<div class="line"><span class="lineno">  433</span>    normalize_average_policy(</div>
<div class="line"><span class="lineno">  434</span>        game_tree_copy.all_infostates_map[Players.PLAYER_2].values())</div>
<div class="line"><span class="lineno">  435</span>    compute_reach_probabilities(game_tree_copy.first_history_node,</div>
<div class="line"><span class="lineno">  436</span>                                game_tree_copy.all_infostates_map)</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    best_response_values_p1.append(</div>
<div class="line"><span class="lineno">  439</span>        compute_best_response_values(</div>
<div class="line"><span class="lineno">  440</span>            game_tree_copy.infostate_nodes[Players.PLAYER_1]))</div>
<div class="line"><span class="lineno">  441</span>    best_response_values_p2.append(</div>
<div class="line"><span class="lineno">  442</span>        compute_best_response_values(</div>
<div class="line"><span class="lineno">  443</span>            game_tree_copy.infostate_nodes[Players.PLAYER_2]))</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>  <span class="keywordflow">return</span> best_response_values_p1, best_response_values_p2</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00129">compute_best_response_values()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00035">compute_reach_probabilities()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00331">counterfactual_regret_minimization_iteration()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00287">normalize_average_policy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_ae255061c0c44a2fb14a05d0073b9b742_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_ae255061c0c44a2fb14a05d0073b9b742_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_ae255061c0c44a2fb14a05d0073b9b742_cgraph" id="adb/d29/namespacecfr_ae255061c0c44a2fb14a05d0073b9b742_cgraph">
<area shape="rect" title=" " alt="" coords="5,120,148,161"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a304c8490923635d1ad586ad7c6a501ef" title=" " alt="" coords="196,29,377,70"/>
<area shape="poly" title=" " alt="" coords="124,117,195,86,222,74,224,79,197,91,126,122"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ad58ab306ec2dd1587d80e2fbe5ed8985" title=" " alt="" coords="425,49,629,74"/>
<area shape="poly" title=" " alt="" coords="148,125,434,75,435,80,149,131"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="216,144,357,200"/>
<area shape="poly" title=" " alt="" coords="148,149,201,157,200,162,148,154"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a97950e103a001c0c5611a708c9ab165c" title=" " alt="" coords="212,224,360,265"/>
<area shape="poly" title=" " alt="" coords="109,159,150,185,197,210,209,215,206,220,194,215,147,189,106,163"/>
<area shape="poly" title=" " alt="" coords="247,29,245,19,251,10,265,5,286,3,309,5,323,11,320,16,308,10,286,8,266,10,254,15,250,20,252,28"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae556d2b6f1c21ec9f92cf42cd8c58b46" title=" " alt="" coords="677,49,897,74"/>
<area shape="poly" title=" " alt="" coords="630,59,662,59,662,64,630,64"/>
<area shape="poly" title=" " alt="" coords="744,50,736,40,741,30,758,24,787,22,819,25,835,32,833,37,818,30,787,27,759,30,744,34,741,40,748,47"/>
<area shape="poly" title=" " alt="" coords="344,142,375,124,399,103,424,85,440,77,442,82,426,89,402,107,379,128,347,146"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a728464b52c9ada7300cef1d1f7537518" title=" " alt="" coords="438,123,616,163"/>
<area shape="poly" title=" " alt="" coords="357,161,422,153,423,158,358,166"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a94e8b7bd47d726188028324726632a3d" title=" " alt="" coords="446,188,608,213"/>
<area shape="poly" title=" " alt="" coords="358,178,431,186,430,192,357,183"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a0fcf7319beaa9529aebdfa00b189cda8" title=" " alt="" coords="454,237,600,278"/>
<area shape="poly" title=" " alt="" coords="359,198,426,223,444,229,442,234,424,228,357,203"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a4251ee22cef1853cf44975ca37dd725d" title=" " alt="" coords="464,302,590,328"/>
<area shape="poly" title=" " alt="" coords="359,196,379,210,395,231,403,251,410,270,427,288,451,300,449,305,423,292,406,273,398,253,390,234,375,214,356,201"/>
<area shape="poly" title=" " alt="" coords="482,123,480,113,487,104,503,98,527,96,553,98,569,105,567,110,552,104,527,101,504,103,490,108,485,114,487,121"/>
</map>
</div>

</div>
</div>
<a id="a12c5637b2be205f9cac71365300e4bba" name="a12c5637b2be205f9cac71365300e4bba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12c5637b2be205f9cac71365300e4bba">&#9670;&#160;</a></span>compute_cfr_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[List[float], List[float]] cfr.compute_cfr_values </td>
          <td>(</td>
          <td class="paramtype">GameTree</td>          <td class="paramname"><span class="paramname"><em>cfr_game_tree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>steps</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Performs CFR algorithm for a given number of steps.

Args:
  cfr_game_tree: Game tree for an imperfect information game. This game tree
    is game tree of an openspiel game.
  steps: Number of CFR-plus steps.

Returns:
  best_response_values_p1: List of best response values for player 1. The
  length of this list is equal to the number of steps.
  best_response_values_p2: List of best response values for player 2. The
  length of this list is equal to the number of steps.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00448">448</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  449</span>                       steps: int) -&gt; Tuple[List[float], List[float]]:</div>
<div class="line"><span class="lineno">  450</span>  <span class="stringliteral">&quot;&quot;&quot;Performs CFR algorithm for a given number of steps.</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral">    cfr_game_tree: Game tree for an imperfect information game. This game tree</span></div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">      is game tree of an openspiel game.</span></div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">    steps: Number of CFR-plus steps.</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">    best_response_values_p1: List of best response values for player 1. The</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">    length of this list is equal to the number of steps.</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">    best_response_values_p2: List of best response values for player 2. The</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral">    length of this list is equal to the number of steps.</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  463</span>  best_response_values_p1 = []</div>
<div class="line"><span class="lineno">  464</span>  best_response_values_p2 = []</div>
<div class="line"><span class="lineno">  465</span>  <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(steps):</div>
<div class="line"><span class="lineno">  466</span>    counterfactual_regret_minimization_iteration(</div>
<div class="line"><span class="lineno">  467</span>        cfr_game_tree=cfr_game_tree, alternating_updates=<span class="keyword">False</span>, cfr_plus=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    normalize_average_policy(</div>
<div class="line"><span class="lineno">  470</span>        cfr_game_tree.all_infostates_map[Players.PLAYER_1].values())</div>
<div class="line"><span class="lineno">  471</span>    normalize_average_policy(</div>
<div class="line"><span class="lineno">  472</span>        cfr_game_tree.all_infostates_map[Players.PLAYER_2].values())</div>
<div class="line"><span class="lineno">  473</span>    compute_reach_probabilities(cfr_game_tree.first_history_node,</div>
<div class="line"><span class="lineno">  474</span>                                cfr_game_tree.all_infostates_map)</div>
<div class="line"><span class="lineno">  475</span>    best_response_values_p1.append(</div>
<div class="line"><span class="lineno">  476</span>        compute_best_response_values(</div>
<div class="line"><span class="lineno">  477</span>            cfr_game_tree.infostate_nodes[Players.PLAYER_1]))</div>
<div class="line"><span class="lineno">  478</span>    best_response_values_p2.append(</div>
<div class="line"><span class="lineno">  479</span>        compute_best_response_values(</div>
<div class="line"><span class="lineno">  480</span>            cfr_game_tree.infostate_nodes[Players.PLAYER_2]))</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>  <span class="keywordflow">return</span> best_response_values_p1, best_response_values_p2</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00129">compute_best_response_values()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00035">compute_reach_probabilities()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00331">counterfactual_regret_minimization_iteration()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00287">normalize_average_policy()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a12c5637b2be205f9cac71365300e4bba_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_a12c5637b2be205f9cac71365300e4bba_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a12c5637b2be205f9cac71365300e4bba_cgraph" id="adb/d29/namespacecfr_a12c5637b2be205f9cac71365300e4bba_cgraph">
<area shape="rect" title=" " alt="" coords="5,128,162,153"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a304c8490923635d1ad586ad7c6a501ef" title=" " alt="" coords="210,29,391,70"/>
<area shape="poly" title=" " alt="" coords="115,124,235,74,237,79,117,129"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ad58ab306ec2dd1587d80e2fbe5ed8985" title=" " alt="" coords="439,49,643,74"/>
<area shape="poly" title=" " alt="" coords="162,124,447,75,448,80,162,130"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="230,144,371,200"/>
<area shape="poly" title=" " alt="" coords="163,149,215,157,214,162,162,155"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a97950e103a001c0c5611a708c9ab165c" title=" " alt="" coords="226,224,374,265"/>
<area shape="poly" title=" " alt="" coords="107,151,154,180,211,210,223,215,221,220,209,215,151,185,104,156"/>
<area shape="poly" title=" " alt="" coords="259,29,257,19,264,10,279,5,300,3,324,5,338,11,336,16,322,10,300,8,280,10,267,15,263,21,265,28"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae556d2b6f1c21ec9f92cf42cd8c58b46" title=" " alt="" coords="691,49,911,74"/>
<area shape="poly" title=" " alt="" coords="644,59,676,59,676,64,644,64"/>
<area shape="poly" title=" " alt="" coords="758,50,750,40,755,30,772,24,801,22,833,25,849,32,847,37,832,30,801,27,773,30,758,34,755,40,762,47"/>
<area shape="poly" title=" " alt="" coords="358,142,389,124,413,103,438,85,454,77,456,82,440,89,416,107,393,128,361,146"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a728464b52c9ada7300cef1d1f7537518" title=" " alt="" coords="452,123,630,163"/>
<area shape="poly" title=" " alt="" coords="371,161,436,153,437,158,372,166"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a94e8b7bd47d726188028324726632a3d" title=" " alt="" coords="460,188,622,213"/>
<area shape="poly" title=" " alt="" coords="372,178,445,186,444,192,371,183"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a0fcf7319beaa9529aebdfa00b189cda8" title=" " alt="" coords="468,237,614,278"/>
<area shape="poly" title=" " alt="" coords="373,198,440,223,458,229,456,234,438,228,371,203"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a4251ee22cef1853cf44975ca37dd725d" title=" " alt="" coords="478,302,604,328"/>
<area shape="poly" title=" " alt="" coords="373,196,393,210,409,231,417,251,424,270,441,288,465,300,463,305,437,292,420,273,412,253,404,234,389,214,370,201"/>
<area shape="poly" title=" " alt="" coords="496,123,494,113,501,104,517,98,541,96,567,98,583,105,581,110,566,104,541,101,518,103,504,108,499,114,501,121"/>
</map>
</div>

</div>
</div>
<a id="a728464b52c9ada7300cef1d1f7537518" name="a728464b52c9ada7300cef1d1f7537518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728464b52c9ada7300cef1d1f7537518">&#9670;&#160;</a></span>compute_counterfactual_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float cfr.compute_counterfactual_values </td>
          <td>(</td>
          <td class="paramtype">InfostateNode</td>          <td class="paramname"><span class="paramname"><em>infostate</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns cfr value for an infostate.

Args:
  infostate: Information state.

Returns:
  Counterfactual value for infostate. This value is calculated from action
  value and policy of all legal actions of infostate information state.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00193">193</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  193</span><span class="keyword">def </span>compute_counterfactual_values(infostate: InfostateNode) -&gt; float:</div>
<div class="line"><span class="lineno">  194</span>  <span class="stringliteral">&quot;&quot;&quot;Returns cfr value for an infostate.</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">    infostate: Information state.</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    Counterfactual value for infostate. This value is calculated from action</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    value and policy of all legal actions of infostate information state.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  203</span>  <span class="keywordflow">if</span> infostate.is_terminal():</div>
<div class="line"><span class="lineno">  204</span>    terminal_utility = 0</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">for</span> history_node <span class="keywordflow">in</span> infostate.history_nodes:</div>
<div class="line"><span class="lineno">  206</span>      terminal_utility += history_node.reach_probs[</div>
<div class="line"><span class="lineno">  207</span>          0] * history_node.reach_probs[_get_opponent(</div>
<div class="line"><span class="lineno">  208</span>              infostate.player)] * history_node.world_state.get_utility(</div>
<div class="line"><span class="lineno">  209</span>                  infostate.player)</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">return</span> terminal_utility</div>
<div class="line"><span class="lineno">  211</span>  infostate_actions = infostate.get_actions()</div>
<div class="line"><span class="lineno">  212</span>  action_values = {action: 0 <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions}</div>
<div class="line"><span class="lineno">  213</span>  <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">for</span> child <span class="keywordflow">in</span> infostate.children[action].values():</div>
<div class="line"><span class="lineno">  215</span>      action_values[action] += compute_counterfactual_values(child)</div>
<div class="line"><span class="lineno">  216</span>  infostate.counterfactual_action_values = action_values</div>
<div class="line"><span class="lineno">  217</span>  counterfactual_value = 0</div>
<div class="line"><span class="lineno">  218</span>  <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  219</span>    counterfactual_value += infostate.policy[action] * action_values[action]</div>
<div class="line"><span class="lineno">  220</span>  infostate.counterfactual_value = counterfactual_value</div>
<div class="line"><span class="lineno">  221</span>  <span class="keywordflow">return</span> counterfactual_value</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00193">compute_counterfactual_values()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00302">best_response_counterfactual_regret_minimization_iteration()</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00193">compute_counterfactual_values()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00331">counterfactual_regret_minimization_iteration()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_cgraph" id="adb/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,184,70"/>
<area shape="poly" title=" " alt="" coords="60,29,59,19,64,10,76,5,95,3,114,5,126,11,123,16,112,10,94,8,78,10,68,14,64,20,66,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_icgraph" id="adb/d29/namespacecfr_a728464b52c9ada7300cef1d1f7537518_icgraph">
<area shape="rect" title=" " alt="" coords="767,71,946,111"/>
<area shape="poly" title=" " alt="" coords="896,58,882,52,856,49,833,51,819,56,814,62,816,69,811,71,808,61,816,52,832,46,857,44,883,46,898,53"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae80c7949d554069f34a9b5782aab41de" title=" " alt="" coords="506,5,719,46"/>
<area shape="poly" title=" " alt="" coords="763,69,691,49,692,44,764,64"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="543,71,682,111"/>
<area shape="poly" title=" " alt="" coords="752,94,683,94,683,88,752,88"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="542,135,683,191"/>
<area shape="poly" title=" " alt="" coords="772,119,684,145,683,140,770,114"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,7,458,47"/>
<area shape="poly" title=" " alt="" coords="527,73,441,51,442,45,529,67"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,72,458,113"/>
<area shape="poly" title=" " alt="" coords="528,94,459,94,459,89,528,89"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,72,208,113"/>
<area shape="poly" title=" " alt="" coords="240,95,208,95,208,90,240,90"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="286,140,428,181"/>
<area shape="poly" title=" " alt="" coords="526,165,428,164,428,158,526,159"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="279,205,435,230"/>
<area shape="poly" title=" " alt="" coords="527,184,421,207,420,202,526,179"/>
</map>
</div>

</div>
</div>
<a id="a94e8b7bd47d726188028324726632a3d" name="a94e8b7bd47d726188028324726632a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94e8b7bd47d726188028324726632a3d">&#9670;&#160;</a></span>compute_next_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.compute_next_policy </td>
          <td>(</td>
          <td class="paramtype">List[InfostateNode]</td>          <td class="paramname"><span class="paramname"><em>infostates</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>cfr_plus</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes policy of next iteration for each infostate in infostates.

Args:
  infostates: List of information states.
  cfr_plus: A flag which specifies if we update policy according to CFR or
    CFR-plus algorithm. True if we use CFR-plus, otherwise we use CFR.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00237">237</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  238</span>                        cfr_plus: bool = <span class="keyword">False</span>) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  239</span>  <span class="stringliteral">&quot;&quot;&quot;Computes policy of next iteration for each infostate in infostates.</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    infostates: List of information states.</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    cfr_plus: A flag which specifies if we update policy according to CFR or</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">      CFR-plus algorithm. True if we use CFR-plus, otherwise we use CFR.</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  246</span>  <span class="keywordflow">for</span> infostate <span class="keywordflow">in</span> infostates:</div>
<div class="line"><span class="lineno">  247</span>    infostate_actions = infostate.get_actions()</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">if</span> cfr_plus:</div>
<div class="line"><span class="lineno">  249</span>      <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  250</span>        infostate.regret[action] = max(infostate.regret[action], 0.0)</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    positive_regret_sum = 0</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  254</span>      <span class="keywordflow">if</span> infostate.regret[action] &gt; 0:</div>
<div class="line"><span class="lineno">  255</span>        positive_regret_sum += infostate.regret[action]</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    actions_count = len(infostate_actions)</div>
<div class="line"><span class="lineno">  258</span>    next_policy = {a: 1.0 / actions_count <span class="keywordflow">for</span> a <span class="keywordflow">in</span> infostate_actions}</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">if</span> positive_regret_sum &gt; 0:</div>
<div class="line"><span class="lineno">  261</span>      <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate_actions:</div>
<div class="line"><span class="lineno">  262</span>        next_policy[action] = max(infostate.regret[action],</div>
<div class="line"><span class="lineno">  263</span>                                  0) / positive_regret_sum</div>
<div class="line"><span class="lineno">  264</span>    infostate.policy = next_policy</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00302">best_response_counterfactual_regret_minimization_iteration()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00331">counterfactual_regret_minimization_iteration()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a94e8b7bd47d726188028324726632a3d_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_a94e8b7bd47d726188028324726632a3d_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a94e8b7bd47d726188028324726632a3d_icgraph" id="adb/d29/namespacecfr_a94e8b7bd47d726188028324726632a3d_icgraph">
<area shape="rect" title=" " alt="" coords="471,49,633,74"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae80c7949d554069f34a9b5782aab41de" title=" " alt="" coords="210,5,423,46"/>
<area shape="poly" title=" " alt="" coords="455,50,423,45,424,39,456,44"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="246,70,387,126"/>
<area shape="poly" title=" " alt="" coords="456,79,388,90,387,84,455,74"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="12,48,155,89"/>
<area shape="poly" title=" " alt="" coords="230,90,155,80,155,75,231,84"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="5,113,162,138"/>
<area shape="poly" title=" " alt="" coords="231,111,163,119,162,114,230,105"/>
</map>
</div>

</div>
</div>
<a id="ad58ab306ec2dd1587d80e2fbe5ed8985" name="ad58ab306ec2dd1587d80e2fbe5ed8985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad58ab306ec2dd1587d80e2fbe5ed8985">&#9670;&#160;</a></span>compute_reach_probabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.compute_reach_probabilities </td>
          <td>(</td>
          <td class="paramtype">HistoryNode</td>          <td class="paramname"><span class="paramname"><em>history_tree_node</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[InfostateMapping]</td>          <td class="paramname"><span class="paramname"><em>all_infostates_map</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes reach probabilities for game tree information states.

This function initializes counterfactual_reach_prob and player_reach_prob for
all information states in the game tree, and then these values will be
calculated in compute_reach_probability_dfs.

Args:
  history_tree_node: Game tree HistoryTreeNode which is the root of the game
    tree.
  all_infostates_map: List of dictionaries (mapping from information state
    string representation to information state object) for each players
    (including chance player). This list will be empty when this function is
    called fot the first time and it'll be population during DFS tree
    traversal.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00033">33</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>    all_infostates_map: List[InfostateMapping]) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   36</span>  <span class="stringliteral">&quot;&quot;&quot;Computes reach probabilities for game tree information states.</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">  This function initializes counterfactual_reach_prob and player_reach_prob for</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">  all information states in the game tree, and then these values will be</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">  calculated in compute_reach_probability_dfs.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    history_tree_node: Game tree HistoryTreeNode which is the root of the game</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">      tree.</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">    all_infostates_map: List of dictionaries (mapping from information state</span></div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">      string representation to information state object) for each players</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">      (including chance player). This list will be empty when this function is</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">      called fot the first time and it&#39;ll be population during DFS tree</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">      traversal.</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  <span class="keywordflow">for</span> infostate <span class="keywordflow">in</span> (list(all_infostates_map[Players.PLAYER_1].values()) +</div>
<div class="line"><span class="lineno">   53</span>                    list(all_infostates_map[Players.PLAYER_2].values())):</div>
<div class="line"><span class="lineno">   54</span>    infostate.counterfactual_reach_prob = 0.</div>
<div class="line"><span class="lineno">   55</span>    infostate.player_reach_prob = 0.</div>
<div class="line"><span class="lineno">   56</span>  compute_reach_probability_dfs(history_tree_node, all_infostates_map)</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00061">compute_reach_probability_dfs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00302">best_response_counterfactual_regret_minimization_iteration()</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00407">compute_cfr_plus_values()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00449">compute_cfr_values()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00331">counterfactual_regret_minimization_iteration()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_cgraph" id="adb/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,210,55"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae556d2b6f1c21ec9f92cf42cd8c58b46" title=" " alt="" coords="258,29,477,55"/>
<area shape="poly" title=" " alt="" coords="210,40,242,40,242,45,210,45"/>
<area shape="poly" title=" " alt="" coords="325,31,316,21,321,11,339,5,367,3,400,5,415,13,413,17,398,11,367,8,340,10,325,15,321,20,329,27"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_icgraph" id="adb/d29/namespacecfr_ad58ab306ec2dd1587d80e2fbe5ed8985_icgraph">
<area shape="rect" title=" " alt="" coords="767,136,972,161"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae80c7949d554069f34a9b5782aab41de" title=" " alt="" coords="506,5,719,46"/>
<area shape="poly" title=" " alt="" coords="835,129,782,95,718,61,687,49,689,44,720,57,784,90,838,124"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="543,71,682,111"/>
<area shape="poly" title=" " alt="" coords="793,134,682,109,683,104,795,129"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="286,179,428,219"/>
<area shape="poly" title=" " alt="" coords="752,156,633,164,506,176,429,188,428,183,506,171,633,159,751,151"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="279,248,435,273"/>
<area shape="poly" title=" " alt="" coords="846,174,792,218,757,240,720,256,646,273,570,280,498,279,435,274,436,269,498,274,570,275,645,268,718,251,755,235,789,214,843,170"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="542,186,683,242"/>
<area shape="poly" title=" " alt="" coords="802,168,684,198,683,193,801,163"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,20,458,61"/>
<area shape="poly" title=" " alt="" coords="527,77,458,63,459,58,528,72"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,85,458,126"/>
<area shape="poly" title=" " alt="" coords="528,98,459,103,458,97,528,93"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,85,208,126"/>
<area shape="poly" title=" " alt="" coords="240,108,208,108,208,103,240,103"/>
<area shape="poly" title=" " alt="" coords="526,211,428,206,428,200,526,206"/>
<area shape="poly" title=" " alt="" coords="527,232,432,249,431,244,526,227"/>
</map>
</div>

</div>
</div>
<a id="ae556d2b6f1c21ec9f92cf42cd8c58b46" name="ae556d2b6f1c21ec9f92cf42cd8c58b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae556d2b6f1c21ec9f92cf42cd8c58b46">&#9670;&#160;</a></span>compute_reach_probability_dfs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.compute_reach_probability_dfs </td>
          <td>(</td>
          <td class="paramtype">HistoryNode</td>          <td class="paramname"><span class="paramname"><em>history_tree_node</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List[InfostateMapping]</td>          <td class="paramname"><span class="paramname"><em>all_infostates_map</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate reach probability values in dfs tree.

This function is initially called by compute_reach_probabilities and it
computes reach probabilities for all information state nodes in the tree by
traversing the tree using DFS.

Args:
  history_tree_node: Game tree HistoryTreeNode which is the root of the game
    tree.
  all_infostates_map: List of dictionaries (mapping from information state
    string representation to information state object) for each players
    (including chance player). This list will be empty when this function is
    called fot the first time and it'll be population during DFS tree
    traversal.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00059">59</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>    all_infostates_map: List[InfostateMapping]) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   62</span>  <span class="stringliteral">&quot;&quot;&quot;Calculate reach probability values in dfs tree.</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">  This function is initially called by compute_reach_probabilities and it</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">  computes reach probabilities for all information state nodes in the tree by</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">  traversing the tree using DFS.</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    history_tree_node: Game tree HistoryTreeNode which is the root of the game</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">      tree.</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral">    all_infostates_map: List of dictionaries (mapping from information state</span></div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">      string representation to information state object) for each players</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">      (including chance player). This list will be empty when this function is</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">      called fot the first time and it&#39;ll be population during DFS tree</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">      traversal.</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>  world_state = history_tree_node.world_state</div>
<div class="line"><span class="lineno">   79</span>  infostate_p1 = all_infostates_map[Players.PLAYER_1][</div>
<div class="line"><span class="lineno">   80</span>      world_state.get_infostate_string(Players.PLAYER_1)]</div>
<div class="line"><span class="lineno">   81</span>  infostate_p2 = all_infostates_map[Players.PLAYER_2][</div>
<div class="line"><span class="lineno">   82</span>      world_state.get_infostate_string(Players.PLAYER_2)]</div>
<div class="line"><span class="lineno">   83</span>  infostate_p1.counterfactual_reach_prob += history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">   84</span>      0] * history_tree_node.reach_probs[Players.PLAYER_2]</div>
<div class="line"><span class="lineno">   85</span>  infostate_p2.counterfactual_reach_prob += history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">   86</span>      0] * history_tree_node.reach_probs[Players.PLAYER_1]</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  <span class="keywordflow">if</span> infostate_p1.player_reach_prob != 0.:</div>
<div class="line"><span class="lineno">   89</span>    <span class="keyword">assert</span> (infostate_p1.player_reach_prob == history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">   90</span>        Players.PLAYER_1])</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordflow">if</span> infostate_p2.player_reach_prob != 0.:</div>
<div class="line"><span class="lineno">   93</span>    <span class="keyword">assert</span> (infostate_p2.player_reach_prob == history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">   94</span>        Players.PLAYER_2])</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>  infostate_p1.player_reach_prob = history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">   97</span>      Players.PLAYER_1]</div>
<div class="line"><span class="lineno">   98</span>  infostate_p2.player_reach_prob = history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">   99</span>      Players.PLAYER_2]</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>  policy_p1 = infostate_p1.policy</div>
<div class="line"><span class="lineno">  102</span>  policy_p2 = infostate_p2.policy</div>
<div class="line"><span class="lineno">  103</span>  policy_chance = world_state.chance_policy</div>
<div class="line"><span class="lineno">  104</span>  actions_chance, actions_p1, actions_p2 = world_state.get_actions()</div>
<div class="line"><span class="lineno">  105</span>  <span class="keywordflow">for</span> action_chance <span class="keywordflow">in</span> actions_chance:</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">for</span> action_p1 <span class="keywordflow">in</span> actions_p1:</div>
<div class="line"><span class="lineno">  107</span>      <span class="keywordflow">for</span> action_p2 <span class="keywordflow">in</span> actions_p2:</div>
<div class="line"><span class="lineno">  108</span>        history_tree_node.action_probs[(</div>
<div class="line"><span class="lineno">  109</span>            action_chance, action_p1, action_p2)] = policy_chance[</div>
<div class="line"><span class="lineno">  110</span>                action_chance] * policy_p1[action_p1] * policy_p2[action_p2]</div>
<div class="line"><span class="lineno">  111</span>        child_node = history_tree_node.get_child(</div>
<div class="line"><span class="lineno">  112</span>            (action_chance, action_p1, action_p2))</div>
<div class="line"><span class="lineno">  113</span>        child_node.reach_probs[</div>
<div class="line"><span class="lineno">  114</span>            Players.CHANCE_PLAYER] = history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">  115</span>                Players.CHANCE_PLAYER] * policy_chance[action_chance]</div>
<div class="line"><span class="lineno">  116</span>        child_node.reach_probs[</div>
<div class="line"><span class="lineno">  117</span>            Players.PLAYER_1] = history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">  118</span>                Players.PLAYER_1] * policy_p1[action_p1]</div>
<div class="line"><span class="lineno">  119</span>        child_node.reach_probs[</div>
<div class="line"><span class="lineno">  120</span>            Players.PLAYER_2] = history_tree_node.reach_probs[</div>
<div class="line"><span class="lineno">  121</span>                Players.PLAYER_2] * policy_p2[action_p2]</div>
<div class="line"><span class="lineno">  122</span>        compute_reach_probability_dfs(child_node, all_infostates_map)</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00061">compute_reach_probability_dfs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00035">compute_reach_probabilities()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00061">compute_reach_probability_dfs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_cgraph" id="adb/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,225,55"/>
<area shape="poly" title=" " alt="" coords="79,31,71,21,76,11,91,5,115,3,142,5,156,12,153,17,140,10,115,8,92,10,79,15,77,20,83,27"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_icgraph" id="adb/d29/namespacecfr_ae556d2b6f1c21ec9f92cf42cd8c58b46_icgraph">
<area shape="rect" title=" " alt="" coords="1020,136,1239,161"/>
<area shape="poly" title=" " alt="" coords="1175,124,1160,117,1129,114,1102,116,1087,121,1083,126,1091,133,1087,137,1078,127,1083,117,1101,111,1129,109,1162,112,1177,119"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ad58ab306ec2dd1587d80e2fbe5ed8985" title=" " alt="" coords="767,136,972,161"/>
<area shape="poly" title=" " alt="" coords="1004,151,972,151,972,146,1004,146"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae80c7949d554069f34a9b5782aab41de" title=" " alt="" coords="506,5,719,46"/>
<area shape="poly" title=" " alt="" coords="835,129,782,95,718,61,687,49,689,44,720,57,784,90,838,124"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="543,71,682,111"/>
<area shape="poly" title=" " alt="" coords="793,134,682,109,683,104,795,129"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="286,179,428,219"/>
<area shape="poly" title=" " alt="" coords="752,156,633,164,506,176,429,188,428,183,506,171,633,159,751,151"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="279,248,435,273"/>
<area shape="poly" title=" " alt="" coords="846,174,792,218,757,240,720,256,646,273,570,280,498,279,435,274,436,269,498,274,570,275,645,268,718,251,755,235,789,214,843,170"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="542,186,683,242"/>
<area shape="poly" title=" " alt="" coords="802,168,684,198,683,193,801,163"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,20,458,61"/>
<area shape="poly" title=" " alt="" coords="527,77,458,63,459,58,528,72"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,85,458,126"/>
<area shape="poly" title=" " alt="" coords="528,98,459,103,458,97,528,93"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,85,208,126"/>
<area shape="poly" title=" " alt="" coords="240,108,208,108,208,103,240,103"/>
<area shape="poly" title=" " alt="" coords="526,211,428,206,428,200,526,206"/>
<area shape="poly" title=" " alt="" coords="527,232,432,249,431,244,526,227"/>
</map>
</div>

</div>
</div>
<a id="acd5f39720dae9b68ca4020aafa698aa4" name="acd5f39720dae9b68ca4020aafa698aa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5f39720dae9b68ca4020aafa698aa4">&#9670;&#160;</a></span>counterfactual_regret_minimization_iteration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.counterfactual_regret_minimization_iteration </td>
          <td>(</td>
          <td class="paramtype">GameTree</td>          <td class="paramname"><span class="paramname"><em>cfr_game_tree</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>alternating_updates</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>cfr_plus</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>weight</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Performs one iteration of CFR or CFR-plus.

Args:
  cfr_game_tree: Game tree for an imperfect information game. This game tree
    is game tree of an openspiel game.
  alternating_updates: Boolean flag to do alternative update for players
    policies or not. If True, alternative updates will be performed (meaning
    we first calculate average policy, counterfactual values, regrets and next
    policy for player 1 first and then calculate all of these for player 2),
    otherwise both players average policies, counterfactual values and regrets
    will be updated right after each other (meaning, for example we calculate
    next_policy of player 1, and then next policy of player 2. Then, we
    calculate average policy for player 1 and then average policy for player
    2, and so on).
  cfr_plus: Boolean flag indicating if we perform CFR algorithm or CFR-plus.
    If True, we perform CFR-plus algorithm, otherwise we perform CFR
    algorithm.
  weight: The weight we use to update policy and sum of weighted average
    policy.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00327">327</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  331</span>    weight: int = 1) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  332</span>  <span class="stringliteral">&quot;&quot;&quot;Performs one iteration of CFR or CFR-plus.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    cfr_game_tree: Game tree for an imperfect information game. This game tree</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">      is game tree of an openspiel game.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    alternating_updates: Boolean flag to do alternative update for players</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">      policies or not. If True, alternative updates will be performed (meaning</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">      we first calculate average policy, counterfactual values, regrets and next</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">      policy for player 1 first and then calculate all of these for player 2),</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">      otherwise both players average policies, counterfactual values and regrets</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">      will be updated right after each other (meaning, for example we calculate</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">      next_policy of player 1, and then next policy of player 2. Then, we</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">      calculate average policy for player 1 and then average policy for player</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">      2, and so on).</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    cfr_plus: Boolean flag indicating if we perform CFR algorithm or CFR-plus.</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">      If True, we perform CFR-plus algorithm, otherwise we perform CFR</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">      algorithm.</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    weight: The weight we use to update policy and sum of weighted average</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral">      policy.</span></div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  352</span>  <span class="keywordflow">if</span> alternating_updates:</div>
<div class="line"><span class="lineno">  353</span>    compute_reach_probabilities(cfr_game_tree.first_history_node,</div>
<div class="line"><span class="lineno">  354</span>                                cfr_game_tree.all_infostates_map)</div>
<div class="line"><span class="lineno">  355</span>    cumulate_average_policy(</div>
<div class="line"><span class="lineno">  356</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_1].values()),</div>
<div class="line"><span class="lineno">  357</span>        weight)</div>
<div class="line"><span class="lineno">  358</span>    compute_counterfactual_values(</div>
<div class="line"><span class="lineno">  359</span>        cfr_game_tree.infostate_nodes[Players.PLAYER_1])</div>
<div class="line"><span class="lineno">  360</span>    update_regrets(</div>
<div class="line"><span class="lineno">  361</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_1].values()))</div>
<div class="line"><span class="lineno">  362</span>    compute_next_policy(</div>
<div class="line"><span class="lineno">  363</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_1].values()),</div>
<div class="line"><span class="lineno">  364</span>        cfr_plus)</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    compute_reach_probabilities(cfr_game_tree.first_history_node,</div>
<div class="line"><span class="lineno">  367</span>                                cfr_game_tree.all_infostates_map)</div>
<div class="line"><span class="lineno">  368</span>    cumulate_average_policy(</div>
<div class="line"><span class="lineno">  369</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_2].values()),</div>
<div class="line"><span class="lineno">  370</span>        weight)</div>
<div class="line"><span class="lineno">  371</span>    compute_counterfactual_values(</div>
<div class="line"><span class="lineno">  372</span>        cfr_game_tree.infostate_nodes[Players.PLAYER_2])</div>
<div class="line"><span class="lineno">  373</span>    update_regrets(</div>
<div class="line"><span class="lineno">  374</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_2].values()))</div>
<div class="line"><span class="lineno">  375</span>    compute_next_policy(</div>
<div class="line"><span class="lineno">  376</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_2].values()),</div>
<div class="line"><span class="lineno">  377</span>        cfr_plus)</div>
<div class="line"><span class="lineno">  378</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  379</span>    compute_next_policy(</div>
<div class="line"><span class="lineno">  380</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_1].values()),</div>
<div class="line"><span class="lineno">  381</span>        cfr_plus)</div>
<div class="line"><span class="lineno">  382</span>    compute_next_policy(</div>
<div class="line"><span class="lineno">  383</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_2].values()),</div>
<div class="line"><span class="lineno">  384</span>        cfr_plus)</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>    compute_reach_probabilities(cfr_game_tree.first_history_node,</div>
<div class="line"><span class="lineno">  387</span>                                cfr_game_tree.all_infostates_map)</div>
<div class="line"><span class="lineno">  388</span>    cumulate_average_policy(</div>
<div class="line"><span class="lineno">  389</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_1].values()),</div>
<div class="line"><span class="lineno">  390</span>        weight)</div>
<div class="line"><span class="lineno">  391</span>    cumulate_average_policy(</div>
<div class="line"><span class="lineno">  392</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_2].values()),</div>
<div class="line"><span class="lineno">  393</span>        weight)</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    compute_counterfactual_values(</div>
<div class="line"><span class="lineno">  396</span>        cfr_game_tree.infostate_nodes[Players.PLAYER_1])</div>
<div class="line"><span class="lineno">  397</span>    compute_counterfactual_values(</div>
<div class="line"><span class="lineno">  398</span>        cfr_game_tree.infostate_nodes[Players.PLAYER_2])</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    update_regrets(</div>
<div class="line"><span class="lineno">  401</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_1].values()))</div>
<div class="line"><span class="lineno">  402</span>    update_regrets(</div>
<div class="line"><span class="lineno">  403</span>        list(cfr_game_tree.all_infostates_map[Players.PLAYER_2].values()))</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00193">compute_counterfactual_values()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00238">compute_next_policy()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00035">compute_reach_probabilities()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00268">cumulate_average_policy()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00224">update_regrets()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00407">compute_cfr_plus_values()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00449">compute_cfr_values()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_cgraph.png" border="0" usemap="#adb/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_cgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_cgraph" id="adb/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_cgraph">
<area shape="rect" title=" " alt="" coords="5,128,147,184"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a728464b52c9ada7300cef1d1f7537518" title=" " alt="" coords="208,29,386,70"/>
<area shape="poly" title=" " alt="" coords="115,126,152,102,193,79,207,74,209,78,196,84,155,106,117,130"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a94e8b7bd47d726188028324726632a3d" title=" " alt="" coords="216,94,378,120"/>
<area shape="poly" title=" " alt="" coords="146,138,221,121,222,126,148,143"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ad58ab306ec2dd1587d80e2fbe5ed8985" title=" " alt="" coords="195,144,399,169"/>
<area shape="poly" title=" " alt="" coords="147,154,179,154,179,159,147,159"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a0fcf7319beaa9529aebdfa00b189cda8" title=" " alt="" coords="224,193,370,234"/>
<area shape="poly" title=" " alt="" coords="148,172,209,188,208,193,146,177"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a4251ee22cef1853cf44975ca37dd725d" title=" " alt="" coords="234,258,360,284"/>
<area shape="poly" title=" " alt="" coords="109,183,149,215,196,243,220,253,218,258,193,248,146,219,106,187"/>
<area shape="poly" title=" " alt="" coords="255,29,253,19,260,10,275,5,297,3,321,5,335,11,333,16,319,10,297,8,276,10,263,15,258,21,260,28"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae556d2b6f1c21ec9f92cf42cd8c58b46" title=" " alt="" coords="447,144,666,169"/>
<area shape="poly" title=" " alt="" coords="399,154,431,154,431,159,399,159"/>
<area shape="poly" title=" " alt="" coords="514,145,505,135,511,125,528,119,557,117,589,120,605,127,603,132,588,125,557,122,529,124,514,129,511,134,518,141"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_icgraph" id="adb/d29/namespacecfr_acd5f39720dae9b68ca4020aafa698aa4_icgraph">
<area shape="rect" title=" " alt="" coords="210,27,351,83"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="12,5,155,46"/>
<area shape="poly" title=" " alt="" coords="194,45,155,39,156,34,195,40"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="5,70,162,96"/>
<area shape="poly" title=" " alt="" coords="195,70,162,75,161,69,194,65"/>
</map>
</div>

</div>
</div>
<a id="a0fcf7319beaa9529aebdfa00b189cda8" name="a0fcf7319beaa9529aebdfa00b189cda8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fcf7319beaa9529aebdfa00b189cda8">&#9670;&#160;</a></span>cumulate_average_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.cumulate_average_policy </td>
          <td>(</td>
          <td class="paramtype">List[InfostateNode]</td>          <td class="paramname"><span class="paramname"><em>infostates</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>weight</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Cumulates policy values of each infostate in infostates.

For each infostate, we update average policy and the sum of weighted average
policy.

Args:
  infostates: List of information states.
  weight: The weight we use to update policy and sum of weighted average
    policy. For CFR algorithm, weight is 1.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00267">267</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  268</span>                            weight: int = 1) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  269</span>  <span class="stringliteral">&quot;&quot;&quot;Cumulates policy values of each infostate in infostates.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">  For each infostate, we update average policy and the sum of weighted average</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">  policy.</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    infostates: List of information states.</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    weight: The weight we use to update policy and sum of weighted average</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">      policy. For CFR algorithm, weight is 1.</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  279</span>  <span class="keywordflow">for</span> infostate <span class="keywordflow">in</span> infostates:</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate.get_actions():</div>
<div class="line"><span class="lineno">  281</span>      infostate.average_policy[</div>
<div class="line"><span class="lineno">  282</span>          action] += infostate.player_reach_prob * infostate.policy[</div>
<div class="line"><span class="lineno">  283</span>              action] * weight</div>
<div class="line"><span class="lineno">  284</span>    infostate.average_policy_weight_sum += infostate.player_reach_prob * weight</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00302">best_response_counterfactual_regret_minimization_iteration()</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00331">counterfactual_regret_minimization_iteration()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a0fcf7319beaa9529aebdfa00b189cda8_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_a0fcf7319beaa9529aebdfa00b189cda8_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a0fcf7319beaa9529aebdfa00b189cda8_icgraph" id="adb/d29/namespacecfr_a0fcf7319beaa9529aebdfa00b189cda8_icgraph">
<area shape="rect" title=" " alt="" coords="767,71,913,111"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae80c7949d554069f34a9b5782aab41de" title=" " alt="" coords="506,5,719,46"/>
<area shape="poly" title=" " alt="" coords="752,69,685,49,687,44,754,63"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="543,71,682,111"/>
<area shape="poly" title=" " alt="" coords="752,94,683,94,683,88,752,88"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="542,135,683,191"/>
<area shape="poly" title=" " alt="" coords="760,119,685,143,683,138,758,114"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,7,458,47"/>
<area shape="poly" title=" " alt="" coords="527,73,441,51,442,45,529,67"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,72,458,113"/>
<area shape="poly" title=" " alt="" coords="528,94,459,94,459,89,528,89"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,72,208,113"/>
<area shape="poly" title=" " alt="" coords="240,95,208,95,208,90,240,90"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="286,140,428,181"/>
<area shape="poly" title=" " alt="" coords="526,165,428,164,428,158,526,159"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="279,205,435,230"/>
<area shape="poly" title=" " alt="" coords="527,184,421,207,420,202,526,179"/>
</map>
</div>

</div>
</div>
<a id="a97950e103a001c0c5611a708c9ab165c" name="a97950e103a001c0c5611a708c9ab165c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97950e103a001c0c5611a708c9ab165c">&#9670;&#160;</a></span>normalize_average_policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.normalize_average_policy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>infostates</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Updates infostate policy by normalizing average policy.

Args:
  infostates: List of information states that their policies will be updated.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00287">287</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  287</span><span class="keyword">def </span>normalize_average_policy(infostates) -&gt; None:</div>
<div class="line"><span class="lineno">  288</span>  <span class="stringliteral">&quot;&quot;&quot;Updates infostate policy by normalizing average policy.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">    infostates: List of information states that their policies will be updated.</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  293</span>  <span class="keywordflow">for</span> infostate <span class="keywordflow">in</span> infostates:</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate.get_actions():</div>
<div class="line"><span class="lineno">  295</span>      infostate.policy[action] = infostate.average_policy[</div>
<div class="line"><span class="lineno">  296</span>          action] / infostate.average_policy_weight_sum</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00407">compute_cfr_plus_values()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00449">compute_cfr_values()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a97950e103a001c0c5611a708c9ab165c_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_a97950e103a001c0c5611a708c9ab165c_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a97950e103a001c0c5611a708c9ab165c_icgraph" id="adb/d29/namespacecfr_a97950e103a001c0c5611a708c9ab165c_icgraph">
<area shape="rect" title=" " alt="" coords="710,103,859,143"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="514,37,654,78"/>
<area shape="poly" title=" " alt="" coords="705,100,648,81,650,76,707,95"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="513,103,655,143"/>
<area shape="poly" title=" " alt="" coords="695,126,656,126,656,120,695,120"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="506,168,662,193"/>
<area shape="poly" title=" " alt="" coords="697,151,633,169,631,164,696,146"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,5,458,46"/>
<area shape="poly" title=" " alt="" coords="499,48,458,43,459,37,499,43"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,71,458,111"/>
<area shape="poly" title=" " alt="" coords="499,73,459,79,458,73,499,67"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,71,208,111"/>
<area shape="poly" title=" " alt="" coords="240,94,208,94,208,88,240,88"/>
</map>
</div>

</div>
</div>
<a id="a4251ee22cef1853cf44975ca37dd725d" name="a4251ee22cef1853cf44975ca37dd725d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4251ee22cef1853cf44975ca37dd725d">&#9670;&#160;</a></span>update_regrets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None cfr.update_regrets </td>
          <td>(</td>
          <td class="paramtype">List[InfostateNode]</td>          <td class="paramname"><span class="paramname"><em>infostates</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Updates regret value for each infostate in infostates.

Args:
  infostates: List of information states
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00224">224</a> of file <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html">cfr.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  224</span><span class="keyword">def </span>update_regrets(infostates: List[InfostateNode]) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  225</span>  <span class="stringliteral">&quot;&quot;&quot;Updates regret value for each infostate in infostates.</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    infostates: List of information states</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordflow">for</span> infostate <span class="keywordflow">in</span> infostates:</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">for</span> action <span class="keywordflow">in</span> infostate.get_actions():</div>
<div class="line"><span class="lineno">  232</span>      current_regret = infostate.counterfactual_action_values[</div>
<div class="line"><span class="lineno">  233</span>          action] - infostate.counterfactual_value</div>
<div class="line"><span class="lineno">  234</span>      infostate.regret[action] += current_regret</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00302">best_response_counterfactual_regret_minimization_iteration()</a>, <a class="el" href="../../d5/d26/meta__learning_8py_source.html#l00193">meta_learning.cfr_br_meta_data()</a>, and <a class="el" href="../../dd/d56/examples_2meta__cfr_2sequential__games_2cfr_8py_source.html#l00331">counterfactual_regret_minimization_iteration()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d29/namespacecfr_a4251ee22cef1853cf44975ca37dd725d_icgraph.png" border="0" usemap="#adb/d29/namespacecfr_a4251ee22cef1853cf44975ca37dd725d_icgraph" alt=""/></div>
<map name="adb/d29/namespacecfr_a4251ee22cef1853cf44975ca37dd725d_icgraph" id="adb/d29/namespacecfr_a4251ee22cef1853cf44975ca37dd725d_icgraph">
<area shape="rect" title=" " alt="" coords="767,78,893,104"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae80c7949d554069f34a9b5782aab41de" title=" " alt="" coords="506,5,719,46"/>
<area shape="poly" title=" " alt="" coords="770,76,682,49,684,44,771,71"/>
<area shape="rect" href="../../d3/daf/namespacemeta__learning.html#abce3f8d690aa12445b4253646adb5aab" title=" " alt="" coords="543,71,682,111"/>
<area shape="poly" title=" " alt="" coords="752,94,683,94,683,88,752,88"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#acd5f39720dae9b68ca4020aafa698aa4" title=" " alt="" coords="542,135,683,191"/>
<area shape="poly" title=" " alt="" coords="775,112,684,142,683,137,774,107"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#ac5fca08ce149d88cac82afbef9357dd5" title=" " alt="" coords="256,7,458,47"/>
<area shape="poly" title=" " alt="" coords="527,73,441,51,442,45,529,67"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a3e1c20d318fde5ec8b70116474332f9e" title=" " alt="" coords="256,72,458,113"/>
<area shape="poly" title=" " alt="" coords="528,94,459,94,459,89,528,89"/>
<area shape="rect" href="../../d9/d3c/classmeta__learning_1_1_meta_c_f_r_regret_agent.html#a9aee90f600acde07afefbe381fb0aa7e" title=" " alt="" coords="5,72,208,113"/>
<area shape="poly" title=" " alt="" coords="240,95,208,95,208,90,240,90"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#ae255061c0c44a2fb14a05d0073b9b742" title=" " alt="" coords="286,140,428,181"/>
<area shape="poly" title=" " alt="" coords="526,165,428,164,428,158,526,159"/>
<area shape="rect" href="../../db/d29/namespacecfr.html#a12c5637b2be205f9cac71365300e4bba" title=" " alt="" coords="279,205,435,230"/>
<area shape="poly" title=" " alt="" coords="527,184,421,207,420,202,526,179"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
