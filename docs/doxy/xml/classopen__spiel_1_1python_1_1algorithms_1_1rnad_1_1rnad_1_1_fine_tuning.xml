<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.11.0" xml:lang="en-US">
  <compounddef id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning" kind="class" language="Python" prot="public">
    <compoundname>open_spiel::python::algorithms::rnad::rnad::FineTuning</compoundname>
    <sectiondef kind="public-static-attrib">
      <memberdef kind="variable" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1ae299eda6f8b1ef7c2f237d2dbfdd12fa" prot="public" static="yes" mutable="no">
        <type>int</type>
        <definition>int open_spiel.python.algorithms.rnad.rnad.FineTuning::from_learner_steps</definition>
        <argsstring></argsstring>
        <name>from_learner_steps</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning.from_learner_steps</qualifiedname>
        <initializer>=  -1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="155" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="155" bodyend="-1"/>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a9db6771f9cda74f67f8bf06dff9db2cf" compoundref="rnad_8py" startline="165" endline="173">open_spiel.python.algorithms.rnad.rnad.FineTuning.__call__</referencedby>
      </memberdef>
      <memberdef kind="variable" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a1eb7d63b37ba5cfa7643f4686acd38ae" prot="public" static="yes" mutable="no">
        <type>float</type>
        <definition>float open_spiel.python.algorithms.rnad.rnad.FineTuning::policy_threshold</definition>
        <argsstring></argsstring>
        <name>policy_threshold</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning.policy_threshold</qualifiedname>
        <initializer>=  0.03</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="158" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="158" bodyend="-1"/>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1aa8d1993fe61f5efc648ac3f500a8c64b" compoundref="rnad_8py" startline="185" endline="198">open_spiel.python.algorithms.rnad.rnad.FineTuning._threshold</referencedby>
      </memberdef>
      <memberdef kind="variable" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1ad9af89b9012c1ff8b779a4af2d27c84d" prot="public" static="yes" mutable="no">
        <type>int</type>
        <definition>int open_spiel.python.algorithms.rnad.rnad.FineTuning::policy_discretization</definition>
        <argsstring></argsstring>
        <name>policy_discretization</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning.policy_discretization</qualifiedname>
        <initializer>=  32</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="162" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="162" bodyend="-1"/>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a6ec47dc2f210442a5a612d92396a1e8d" compoundref="rnad_8py" startline="199" endline="218">open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize</referencedby>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a50c1c1a97acfce35b35e7690a53db543" compoundref="rnad_8py" startline="219" endline="261">open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize_single</referencedby>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-attrib">
      <memberdef kind="variable" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1adee208d4242d7c9222eac82efab392b9" prot="public" static="no" mutable="no">
        <type></type>
        <definition>open_spiel.python.algorithms.rnad.rnad.FineTuning::from_learner_steps</definition>
        <argsstring></argsstring>
        <name>from_learner_steps</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning.from_learner_steps</qualifiedname>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="169" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="169" bodyend="-1"/>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a9db6771f9cda74f67f8bf06dff9db2cf" compoundref="rnad_8py" startline="165" endline="173">open_spiel.python.algorithms.rnad.rnad.FineTuning.__call__</referencedby>
      </memberdef>
    </sectiondef>
    <sectiondef kind="public-func">
      <memberdef kind="function" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a9db6771f9cda74f67f8bf06dff9db2cf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>chex.Array</type>
        <definition> chex.Array open_spiel.python.algorithms.rnad.rnad.FineTuning.__call__</definition>
        <argsstring>(self, chex.Array policy, chex.Array mask, int learner_steps)</argsstring>
        <name>__call__</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning.__call__</qualifiedname>
        <param>
          <type>self</type>
          <defname>self</defname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>policy</declname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>mask</declname>
        </param>
        <param>
          <type>int</type>
          <declname>learner_steps</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>A configurable fine tuning of a policy.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="164" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="165" bodyend="173"/>
        <references refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1ae299eda6f8b1ef7c2f237d2dbfdd12fa" compoundref="rnad_8py" startline="155">open_spiel.python.algorithms.rnad.rnad.FineTuning.from_learner_steps</references>
      </memberdef>
      <memberdef kind="function" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a30384a99f2e41f676058fbe79bbc0bd1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>chex.Array</type>
        <definition> chex.Array open_spiel.python.algorithms.rnad.rnad.FineTuning.post_process_policy</definition>
        <argsstring>(self, chex.Array policy, chex.Array mask)</argsstring>
        <name>post_process_policy</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning.post_process_policy</qualifiedname>
        <param>
          <type>self</type>
          <defname>self</defname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>policy</declname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>mask</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Unconditionally post process a given masked policy.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="174" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="178" bodyend="184"/>
        <references refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a6ec47dc2f210442a5a612d92396a1e8d" compoundref="rnad_8py" startline="199" endline="218">open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize</references>
        <references refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1aa8d1993fe61f5efc648ac3f500a8c64b" compoundref="rnad_8py" startline="185" endline="198">open_spiel.python.algorithms.rnad.rnad.FineTuning._threshold</references>
      </memberdef>
    </sectiondef>
    <sectiondef kind="protected-func">
      <memberdef kind="function" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1aa8d1993fe61f5efc648ac3f500a8c64b" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>chex.Array</type>
        <definition> chex.Array open_spiel.python.algorithms.rnad.rnad.FineTuning._threshold</definition>
        <argsstring>(self, chex.Array policy, chex.Array mask)</argsstring>
        <name>_threshold</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning._threshold</qualifiedname>
        <param>
          <type>self</type>
          <defname>self</defname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>policy</declname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>mask</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Remove from the support the actions &apos;a&apos; where policy(a) &lt; threshold.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="185" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="185" bodyend="198"/>
        <references refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a1eb7d63b37ba5cfa7643f4686acd38ae" compoundref="rnad_8py" startline="158">open_spiel.python.algorithms.rnad.rnad.FineTuning.policy_threshold</references>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a30384a99f2e41f676058fbe79bbc0bd1" compoundref="rnad_8py" startline="178" endline="184">open_spiel.python.algorithms.rnad.rnad.FineTuning.post_process_policy</referencedby>
      </memberdef>
      <memberdef kind="function" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a6ec47dc2f210442a5a612d92396a1e8d" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>chex.Array</type>
        <definition> chex.Array open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize</definition>
        <argsstring>(self, chex.Array policy)</argsstring>
        <name>_discretize</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize</qualifiedname>
        <param>
          <type>self</type>
          <defname>self</defname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>policy</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Round all action probabilities to a multiple of 1/self.discretize.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="199" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="199" bodyend="218"/>
        <references refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a50c1c1a97acfce35b35e7690a53db543" compoundref="rnad_8py" startline="219" endline="261">open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize_single</references>
        <references refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1ad9af89b9012c1ff8b779a4af2d27c84d" compoundref="rnad_8py" startline="162">open_spiel.python.algorithms.rnad.rnad.FineTuning.policy_discretization</references>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a30384a99f2e41f676058fbe79bbc0bd1" compoundref="rnad_8py" startline="178" endline="184">open_spiel.python.algorithms.rnad.rnad.FineTuning.post_process_policy</referencedby>
      </memberdef>
      <memberdef kind="function" id="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a50c1c1a97acfce35b35e7690a53db543" prot="protected" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>chex.Array</type>
        <definition> chex.Array open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize_single</definition>
        <argsstring>(self, chex.Array mu)</argsstring>
        <name>_discretize_single</name>
        <qualifiedname>open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize_single</qualifiedname>
        <param>
          <type>self</type>
          <defname>self</defname>
        </param>
        <param>
          <type>chex.Array</type>
          <declname>mu</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>A version of self._discretize but for the unbatched data.</verbatim> </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="open_spiel/python/algorithms/rnad/rnad.py" line="219" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="219" bodyend="261"/>
        <references refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1ad9af89b9012c1ff8b779a4af2d27c84d" compoundref="rnad_8py" startline="162">open_spiel.python.algorithms.rnad.rnad.FineTuning.policy_discretization</references>
        <referencedby refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a6ec47dc2f210442a5a612d92396a1e8d" compoundref="rnad_8py" startline="199" endline="218">open_spiel.python.algorithms.rnad.rnad.FineTuning._discretize</referencedby>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><verbatim>Fine tuning options, aka policy post-processing.

Even when fully trained, the resulting softmax-based policy may put
a small probability mass on bad actions. This results in an agent
waiting for the opponent (itself in self-play) to commit an error.

To address that the policy is post-processed using:
- thresholding: any action with probability smaller than self.threshold
  is simply removed from the policy.
- discretization: the probability values are rounded to the closest
  multiple of 1/self.discretization.

The post-processing is used on the learner, and thus must be jit-friendly.
</verbatim> </para>
    </detaileddescription>
    <collaborationgraph>
      <node id="1">
        <label>open_spiel.python.algorithms.rnad.rnad.FineTuning</label>
        <link refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning"/>
      </node>
    </collaborationgraph>
    <location file="open_spiel/python/algorithms/rnad/rnad.py" line="137" column="1" bodyfile="open_spiel/python/algorithms/rnad/rnad.py" bodystart="137" bodyend="261"/>
    <listofallmembers>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a9db6771f9cda74f67f8bf06dff9db2cf" prot="public" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>__call__</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a6ec47dc2f210442a5a612d92396a1e8d" prot="protected" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>_discretize</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a50c1c1a97acfce35b35e7690a53db543" prot="protected" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>_discretize_single</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1aa8d1993fe61f5efc648ac3f500a8c64b" prot="protected" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>_threshold</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1ae299eda6f8b1ef7c2f237d2dbfdd12fa" prot="public" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>from_learner_steps</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1adee208d4242d7c9222eac82efab392b9" prot="public" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>from_learner_steps</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1ad9af89b9012c1ff8b779a4af2d27c84d" prot="public" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>policy_discretization</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a1eb7d63b37ba5cfa7643f4686acd38ae" prot="public" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>policy_threshold</name></member>
      <member refid="classopen__spiel_1_1python_1_1algorithms_1_1rnad_1_1rnad_1_1_fine_tuning_1a30384a99f2e41f676058fbe79bbc0bd1" prot="public" virt="non-virtual"><scope>open_spiel::python::algorithms::rnad::rnad::FineTuning</scope><name>post_process_policy</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
